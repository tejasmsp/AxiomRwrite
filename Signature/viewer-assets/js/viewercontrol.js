var IPCC = IPCC || {}; IPCC.Type = IPCC.Type || {}; IPCC.Type.prototype = IPCC.Type.prototype || Object.prototype; IPCC.Type.registerNamespace = function (namespacePath) { var rootObject = window; var namespaceParts = namespacePath.split('.'); var getTypeName = function () { return this.__typeName; }; for (var i = 0; i < namespaceParts.length; i++) { var currentPart = namespaceParts[i]; var ns = rootObject[currentPart]; var nsType = typeof (ns); if ((nsType !== "undefined") && (ns !== null)) { if (nsType === "function") { throw new Error("namespace error: " + namespacePath); } if ((typeof (ns) !== "object") || (ns instanceof Array)) { throw new Error("Name space error: " + ns); } } if (!ns) { ns = rootObject[currentPart] = {}; } if (!ns.__namespace) { ns.__namespace = true; ns.__typeName = namespaceParts.slice(0, i + 1).join('.'); ns.getName = getTypeName; } rootObject = ns; } }; IPCC.Sys = IPCC.Sys || {}; IPCC.Sys.UI = IPCC.Sys.UI || {}; IPCC.Sys.UI.Control = IPCC.Sys.UI.Control || {}; IPCC.Type.registerNamespace('IPCC.Web.UI'); IPCC.initializePageViewPlugin = function (Hk, Wi) { var pN = Wi.handleTouchEvents !== false; var TZ = new IPCC.Web.UI.PageView(Hk, pN); if (Wi) { IPCC.ada(TZ, Wi); } TZ.rc(Hk); TZ.initialize(); return TZ; }; IPCC.initializePageListPlugin = function (Hk, aH) { var Ue = new IPCC.PageList(Hk); if (aH) { IPCC.ada(Ue, aH); } Ue.rc(Hk); Ue.initialize(); return Ue; }; IPCC.Web.regEnum = function (name, flags) { for (var i in this.prototype) { if (this.prototype.hasOwnProperty(i)) { this[i] = this.prototype[i]; } } this.__typeName = name; this.__flags = flags; this.__enum = true; }; IPCC.Web.regClass = function (typeName, baseType, interfaceTypes) { this.prototype.constructor = this; this.__typeName = typeName; this.__class = true; if (baseType) { this.__baseType = baseType; for (var OH in baseType.prototype) { if (baseType.prototype.hasOwnProperty(OH)) { var avn = baseType.prototype[OH]; if (!this.prototype[OH]) { this.prototype[OH] = avn; } } } } return this; }; IPCC.Web.aIa = function (aal, aam, amy) { if (aam) { if (!amy) { aam.apply(aal); } else { aam.apply(aal, amy); } } return aal; }; IPCC.Web.UI.DebugErrorLevel = function () { }; IPCC.Web.UI.DebugErrorLevel.registerEnum = IPCC.Web.regEnum; IPCC.Web.UI.DebugErrorLevel.prototype = { Production: 0, Development: 1, Detailed: 2 }; IPCC.Web.UI.DebugErrorLevel.registerEnum('IPCC.Web.UI.DebugErrorLevel', false); IPCC.Web.UI.DebugItemCause = function () { }; IPCC.Web.UI.DebugItemCause.registerEnum = IPCC.Web.regEnum; IPCC.Web.UI.DebugItemCause.prototype = { FunctionCall: 0, Exception: 1, Custom: 2, UserAction: 3, Warning: 4 }; IPCC.Web.UI.DebugItemCause.registerEnum('IPCC.Web.UI.DebugItemCause', false); IPCC.Web.UI.MouseButton = function () { if (arguments.length !== 0) { throw new IPCC.Web.UI.ImGearParameterCountException(); } throw new IPCC.Web.UI.ImGearNotImplementedException(); }; IPCC.Web.UI.MouseButton.registerEnum = IPCC.Web.regEnum; IPCC.Web.UI.MouseButton.prototype = { leftButton: 0, middleButton: 1, rightButton: 2 }; IPCC.Web.UI.MouseButton.registerEnum("IPCC.Web.UI.MouseButton"); IPCC.Web.UI.Key = function () { if (arguments.length !== 0) { throw new IPCC.Web.UI.ImGearParameterCountException(); } throw new IPCC.Web.UI.ImGearNotImplementedException(); }; IPCC.Web.UI.Key.registerEnum = IPCC.Web.regEnum; IPCC.Web.UI.Key.prototype = { backspace: 8, tab: 9, enter: 13, esc: 27, space: 32, pageUp: 33, pageDown: 34, end: 35, home: 36, left: 37, up: 38, right: 39, down: 40, del: 127 }; IPCC.Web.UI.Key.registerEnum("IPCC.Web.UI.Key"); IPCC.Web.UI.al = function (avH) { var au = avH; var aiA = this.type = au.type.toLowerCase(); var Qo = typeof au.changedTouches !== 'undefined'; this.rawEvent = au; this.altKey = au.altKey; if (typeof (au.button) !== 'undefined') { this.button = (typeof (au.which) !== 'undefined') ? au.button : (au.button === 4) ? IPCC.Web.UI.MouseButton.middleButton : (au.button === 2) ? IPCC.Web.UI.MouseButton.rightButton : IPCC.Web.UI.MouseButton.leftButton; } if (aiA === 'keypress') { this.charCode = au.charCode || au.keyCode; } else if (au.keyCode && (au.keyCode === 46)) { this.keyCode = 127; } else { this.keyCode = au.keyCode; } this.clientX = (Qo) ? au.changedTouches[0].clientX : au.clientX; this.clientY = (Qo) ? au.changedTouches[0].clientY : au.clientY; this.ctrlKey = au.ctrlKey; this.target = au.target ? au.target : au.srcElement; function aqT(bL) { var aY = 0; var fJ = 0; while (bL && !isNaN(bL.offsetLeft) && !isNaN(bL.offsetTop)) { aY += bL.offsetLeft - bL.scrollLeft; fJ += bL.offsetTop - bL.scrollTop; if (bL.offsetparent) { bL = bL.offsetParent; } else { bL = bL.parentNode; } } return { top: fJ, left: aY }; }; var eU = "" + aiA; var wr = 'key'; if (eU.substr(0, wr.length) !== wr) { if ((typeof (au.offsetX) !== 'undefined') && (typeof (au.offsetY) !== 'undefined')) { this.offsetX = au.offsetX; this.offsetY = au.offsetY; } else if (this.target && (this.target.nodeType !== 3) && (typeof (au.clientX) === 'number')) { var Lj = aqT(this.target); var ck = this.target; var bY = ck.ownerDocument || ck.document || ck; var kX = bY.defaultView || bY.parentWindow; this.offsetX = (kX.pageXOffset || 0) + au.clientX - Lj.left; this.offsetY = (kX.pageYOffset || 0) + au.clientY - Lj.top; } } this.screenX = (Qo) ? au.changedTouches[0].screenX : au.screenX; this.screenY = (Qo) ? au.changedTouches[0].screenY : au.screenY; this.shiftKey = au.shiftKey; }; IPCC.Web.UI.al.prototype = { preventDefault: function () { if (arguments.length !== 0) { throw new IPCC.Web.UI.ImGearParameterCountException(); } if (this.rawEvent.preventDefault) { this.rawEvent.preventDefault(); } else if (window.event) { this.rawEvent.returnValue = false; } }, stopPropagation: function () { if (arguments.length !== 0) { throw new IPCC.Web.UI.ImGearParameterCountException(); } if (this.rawEvent.stopPropagation) { this.rawEvent.stopPropagation(); } else if (window.event) { this.rawEvent.cancelBubble = true; } } }; IPCC.Web.UI.al.registerClass = IPCC.Web.regClass; IPCC.Web.UI.al.registerClass('IPCC.Web.UI.al'); IPCC.ada = function (cD, mC) { var uE; for (var dC in mC) { if (mC.hasOwnProperty(dC)) { var bj = mC[dC]; var azM = cD["get_" + dC]; var adh = cD["set_" + dC]; if (typeof (adh) === 'function') { adh.apply(cD, [bj]); } else if (bj instanceof Array) { uE = azM.apply(cD); if (!(uE instanceof Array)) { throw new new IPCC.Web.UI.ImGearInvalidOperationException(dC + " is not an Array property"); } for (var G = 0, aj = uE.length, tZ = bj.length; G < tZ; G++, aj++) { uE[aj] = bj[G]; } } } } }; IPCC.Web.UI.al.addHandler = function (element, eventName, handler, autoRemove) { IPCC.Web.UI.al.aad(element); if (eventName === "error") { throw new IPCC.Web.UI.ImGearInvalidOperationException(IPCC.gF.addHandlerCantBeUsedForError); } if (!element.bC) { element.bC = {}; } var eventCache = element.bC[eventName]; if (!eventCache) { element.bC[eventName] = eventCache = []; } var browserHandler; if (element.addEventListener) { browserHandler = function (e) { return handler.call(element, new IPCC.Web.UI.al(e)); }; element.addEventListener(eventName, browserHandler, false); } else if (element.attachEvent) { browserHandler = function () { var e = {}; try { var doc = element.ownerDocument || element.document || element; var ck = doc.defaultView || doc.parentWindow; e = ck.event; } catch (ex) { } return handler.call(element, new IPCC.Web.UI.al(e)); }; element.attachEvent('on' + eventName, browserHandler); } eventCache[eventCache.length] = { handler: handler, browserHandler: browserHandler, autoRemove: autoRemove }; if (autoRemove) { var d = element.dispose; if (d !== IPCC.Web.UI.al.ajv) { element.dispose = IPCC.Web.UI.al.ajv; if (typeof (d) !== "undefined") { element.aqM = d; } } } }; IPCC.Web.UI.al.clearHandlers = function (element) { IPCC.Web.UI.al.aad(element); IPCC.Web.UI.al.afr(element, false); }; IPCC.Web.UI.al.afr = function (element, autoRemoving) { if (element.bC) { var cache = element.bC; for (var name in cache) { if (cache.hasOwnProperty(name)) { var handlers = cache[name]; for (var i = handlers.length - 1; i >= 0; i--) { var entry = handlers[i]; if (!autoRemoving || entry.autoRemove) { IPCC.Web.UI.al.removeHandler(element, name, entry.handler); } } } } element.bC = null; } }; IPCC.Web.UI.al.ajv = function () { IPCC.Web.UI.al.afr(this, true); var d = this.aqM, type = typeof (d); if (type !== "undefined") { this.dispose = d; this.aqM = null; if (type === "function") { this.dispose(); } } }; IPCC.Web.UI.al.removeHandler = function (element, eventName, handler) { IPCC.Web.UI.al.dn(element, eventName, handler); }; IPCC.Web.UI.al.dn = function (element, eventName, handler) { IPCC.Web.UI.al.aad(element); var browserHandler = null; if ((typeof (element.bC) !== 'object') || !element.bC) { throw new IPCC.Web.UI.ImGearInvalidOperationException('DOM event handler was not added through the DomEvent.addHandler method.'); } var cache = element.bC[eventName]; if (!(cache instanceof Array)) { throw new IPCC.Web.UI.ImGearInvalidOperationException('DOM event handler was not added through the DomEvent.addHandler method.'); } for (var i = 0, l = cache.length; i < l; i++) { if (cache[i].handler === handler) { browserHandler = cache[i].browserHandler; break; } } if (typeof (browserHandler) !== 'function') { throw new IPCC.Web.UI.ImGearInvalidOperationException('Handler was not added through the IPCC.Web.UI.al.addHandler method.'); } if (element.removeEventListener) { element.removeEventListener(eventName, browserHandler, false); } else if (element.detachEvent) { element.detachEvent('on' + eventName, browserHandler); } cache.splice(i, 1); }; IPCC.Web.UI.al.aad = function (element) { if (element.tagName && (element.tagName.toUpperCase() === "SCRIPT")) { return; } var doc = element.ownerDocument || element.document || element; if ((typeof (element.document) !== 'object') && (element !== doc) && (typeof (element.nodeType) !== 'number')) { throw new IPCC.Web.UI.ImGearArgumentException("element", IPCC.gF.argumentDomNode); } }; IPCC.qP = function (cr, zC) { var K = this; this.cr = cr; this.zC = zC; this.aGt = function () { return K.cr; }; this.aIG = function () { return K.zC; }; }; IPCC.qP.prototype.get_propertyName = function () { return this.cr; }; IPCC.qP.prototype.get_propertyInfo = function () { return this.zC; }; IPCC.Web.vo = function (aY) { return !isNaN(aY - 0) && aY !== null; }; IPCC.aCx = function ImageGearIndexOf(array, item, start) { if (typeof (item) === "undefined") { return -1; } var length = array.length; if (length !== 0) { start = start - 0; if (isNaN(start)) { start = 0; } else { if (isFinite(start)) { start = start - (start % 1); } if (start < 0) { start = Math.max(0, length + start); } } for (var i = start; i < length; i++) { if ((typeof (array[i]) !== "undefined") && (array[i] === item)) { return i; } } } return -1; }; IPCC.Web.UI.fR = function fR() { if (arguments.length !== 0) { throw new IPCC.Web.UI.ImGearParameterCountException(); } this.Lq = {}; }; IPCC.Web.UI.fR.prototype.du = function (fg, V) { var fm = this.ado(fg, true); fm[fm.length] = V; }; IPCC.Web.UI.fR.prototype.addHandler = function (fg, V) { this.du(fg, V); }; IPCC.Web.UI.fR.prototype.dn = function (fg, V) { var us = this.ado(fg); if (!us) { return; } var ak = IPCC.aCx(us, V); if (ak >= 0) { us.splice(ak, 1); } }; IPCC.Web.UI.fR.prototype.removeHandler = function (fg, V) { this.dn(fg, V); }; IPCC.Web.UI.fR.prototype.getHandler = function (fg) { var us = this.ado(fg); if (!us || (us.length === 0)) { return null; } var fm = us.slice(); us = fm; return function (source, args) { for (var G = 0, tZ = us.length; G < tZ; G++) { us[G](source, args); } }; }; IPCC.Web.UI.fR.prototype.ado = function (fg, asK) { if (!this.Lq[fg]) { if (!asK) { return null; } this.Lq[fg] = []; } return this.Lq[fg]; }; IPCC.Web.Kh = IPCC.Kh || {}; IPCC.Web.Kh.Ve = function (aq) { if (!this.Ht[0][0][0]) { this.XO(); } var G, aj, eU, Hf, acT, mE = this.Ht[0][4], xS = this.Ht[1], ug = aq.length, TG = 1; if (ug !== 4 && ug !== 6 && ug !== 8) { throw new IPCC.Web.UI.ImGearArgumentException('none', "invalid aes key size"); } this.aq = [Hf = aq.slice(0), acT = []]; for (G = ug; G < 4 * ug + 28; G++) { eU = Hf[G - 1]; if (G % ug === 0 || (ug === 8 && G % ug === 4)) { eU = mE[eU >>> 24] << 24 ^ mE[eU >> 16 & 255] << 16 ^ mE[eU >> 8 & 255] << 8 ^ mE[eU & 255]; if (G % ug === 0) { eU = eU << 8 ^ eU >>> 24 ^ TG << 24; TG = TG << 1 ^ (TG >> 7) * 283; } } Hf[G] = Hf[G - ug] ^ eU; } for (aj = 0; G; aj++, G--) { eU = Hf[aj & 3 ? G : G - 4]; if (G <= 4 || aj < 4) { acT[aj] = eU; } else { acT[aj] = xS[0][mE[eU >>> 24]] ^ xS[1][mE[eU >> 16 & 255]] ^ xS[2][mE[eU >> 8 & 255]] ^ xS[3][mE[eU & 255]]; } } }; IPCC.Web.Kh.Ve.prototype = { SF: function (dc) { return this.axh(dc, 1); }, Ht: [[[], [], [], [], []], [[], [], [], [], []]], XO: function () { var QY = this.Ht[0], xS = this.Ht[1], mE = QY[4], aAB = xS[4], G, aY, Au, eY = [], jr = [], Vp, ahW, aiR, jq, RW, QP; for (G = 0; G < 256; G++) { jr[(eY[G] = G << 1 ^ (G >> 7) * 283) ^ G] = G; } for (aY = Au = 0; !mE[aY]; aY ^= Vp || 1, Au = jr[Au] || 1) { jq = Au ^ Au << 1 ^ Au << 2 ^ Au << 3 ^ Au << 4; jq = jq >> 8 ^ jq & 255 ^ 99; mE[aY] = jq; aAB[jq] = aY; aiR = eY[ahW = eY[Vp = eY[aY]]]; QP = aiR * 0x1010101 ^ ahW * 0x10001 ^ Vp * 0x101 ^ aY * 0x1010100; RW = eY[jq] * 0x101 ^ jq * 0x1010100; for (G = 0; G < 4; G++) { QY[G][aY] = RW = RW << 24 ^ RW >>> 8; xS[G][jq] = QP = QP << 24 ^ QP >>> 8; } } for (G = 0; G < 5; G++) { QY[G] = QY[G].slice(0); xS[G] = xS[G].slice(0); } }, axh: function (Jr, JJ) { if (Jr.length !== 4) { throw new IPCC.Web.UI.ImGearArgumentException('blocksize', 'Invalid block size'); } var aq = this.aq[JJ], dH = Jr[0] ^ aq[0], fC = Jr[JJ ? 3 : 1] ^ aq[1], he = Jr[2] ^ aq[2], eY = Jr[JJ ? 1 : 3] ^ aq[3], xA, ang, aqG, atM = aq.length / 4 - 2, G, Et = 4, gq = [0, 0, 0, 0], Lz = this.Ht[JJ], RE = Lz[0], Qs = Lz[1], RA = Lz[2], Sl = Lz[3], mE = Lz[4]; for (G = 0; G < atM; G++) { xA = RE[dH >>> 24] ^ Qs[fC >> 16 & 255] ^ RA[he >> 8 & 255] ^ Sl[eY & 255] ^ aq[Et]; ang = RE[fC >>> 24] ^ Qs[he >> 16 & 255] ^ RA[eY >> 8 & 255] ^ Sl[dH & 255] ^ aq[Et + 1]; aqG = RE[he >>> 24] ^ Qs[eY >> 16 & 255] ^ RA[dH >> 8 & 255] ^ Sl[fC & 255] ^ aq[Et + 2]; eY = RE[eY >>> 24] ^ Qs[dH >> 16 & 255] ^ RA[fC >> 8 & 255] ^ Sl[he & 255] ^ aq[Et + 3]; Et += 4; dH = xA; fC = ang; he = aqG; } for (G = 0; G < 4; G++) { gq[JJ ? 3 & -G : G] = mE[dH >>> 24] << 24 ^ mE[fC >> 16 & 255] << 16 ^ mE[he >> 8 & 255] << 8 ^ mE[eY & 255] ^ aq[Et++]; xA = dH; dH = fC; fC = he; he = eY; eY = xA; } return gq; } }; IPCC.Web.axO = '8.4'; IPCC.Web.aEB = 24; IPCC.Web.va = IPCC.Web.va || {}; IPCC.Web.va.ZD = function (va) { if (!this.aq[0]) { this.XO(); } if (va) { this.fi = va.fi.slice(0); this.Ai = va.Ai.slice(0); this.cz = va.cz; } else { this.aeV(); } }; IPCC.Web.va.ZD.va = function (dc) { return (new IPCC.Web.va.ZD()).axw(dc).awA(); }; IPCC.Web.va.ZD.prototype = { aJC: 512, aeV: function () { this.fi = this.TO.slice(0); this.Ai = []; this.cz = 0; return this; }, axw: function (dc) { if (typeof dc === "string") { dc = IPCC.Web.Codec.GR.te(dc); } var G, fC = this.Ai = IPCC.Web.gW.aax(this.Ai, dc), alU = this.cz, atv = this.cz = alU + IPCC.Web.gW.xK(dc); for (G = 512 + alU & -512; G <= atv; G += 512) { this.Nh(fC.splice(0, 16)); } return this; }, awA: function () { var G, fC = this.Ai, fi = this.fi; fC = IPCC.Web.gW.aax(fC, [IPCC.Web.gW.Jw(1, 1)]); for (G = fC.length + 2; G & 15; G++) { fC.push(0); } fC.push(Math.floor(this.cz / 0x100000000)); fC.push(this.cz | 0); while (fC.length) { this.Nh(fC.splice(0, 16)); } this.aeV(); return fi; }, TO: [], aq: [], XO: function () { var G = 0, Jn = 2, ab; function ajM(aY) { return (aY - Math.floor(aY)) * 0x100000000 | 0; }; ari: for (; G < 64; Jn++) { for (ab = 2; ab * ab <= Jn; ab++) { if (Jn % ab === 0) { continue ari; } } if (G < 8) { this.TO[G] = ajM(Math.pow(Jn, 1 / 2)); } this.aq[G] = ajM(Math.pow(Jn, 1 / 3)); G++; } }, Nh: function (awg) { var G, eU, dH, fC, kX = awg.slice(0), fi = this.fi, dh = this.aq, abf = fi[0], tX = fi[1], Mo = fi[2], Qv = fi[3], vE = fi[4], QR = fi[5], LD = fi[6], abM = fi[7]; for (G = 0; G < 64; G++) { if (G < 16) { eU = kX[G]; } else { dH = kX[(G + 1) & 15]; fC = kX[(G + 14) & 15]; eU = kX[G & 15] = ((dH >>> 7 ^ dH >>> 18 ^ dH >>> 3 ^ dH << 25 ^ dH << 14) + (fC >>> 17 ^ fC >>> 19 ^ fC >>> 10 ^ fC << 15 ^ fC << 13) + kX[G & 15] + kX[(G + 9) & 15]) | 0; } eU = (eU + abM + (vE >>> 6 ^ vE >>> 11 ^ vE >>> 25 ^ vE << 26 ^ vE << 21 ^ vE << 7) + (LD ^ vE & (QR ^ LD)) + dh[G]); abM = LD; LD = QR; QR = vE; vE = Qv + eU | 0; Qv = Mo; Mo = tX; tX = abf; abf = (eU + ((tX & Mo) ^ (Qv & (tX ^ Mo))) + (tX >>> 2 ^ tX >>> 13 ^ tX >>> 22 ^ tX << 30 ^ tX << 19 ^ tX << 10)) | 0; } fi[0] = fi[0] + abf | 0; fi[1] = fi[1] + tX | 0; fi[2] = fi[2] + Mo | 0; fi[3] = fi[3] + Qv | 0; fi[4] = fi[4] + vE | 0; fi[5] = fi[5] + QR | 0; fi[6] = fi[6] + LD | 0; fi[7] = fi[7] + abM | 0; } }; IPCC.Web.Bd = function (ts, dm) { return IPCC.Web.agO(false, arguments); }; IPCC.Web.amM = function (ts, dm) { return IPCC.Web.agO(true, arguments); }; IPCC.Web.agO = function (useLocale, dm) { var bM = ''; var ts = dm[0]; for (var G = 0; ;) { var dZ = ts.indexOf('{', G); var ot = ts.indexOf('}', G); if ((dZ < 0) && (ot < 0)) { bM += ts.slice(G); break; } if ((ot > 0) && ((ot < dZ) || (dZ < 0))) { if (ts.charAt(close + 1) !== '}') { throw new IPCC.Web.UI.ImGearArgumentException('format', 'The format string contains an unmatched opening or closing brace.'); } bM += ts.slice(G, ot + 1); G = ot + 2; continue; } bM += ts.slice(G, dZ); G = dZ + 1; if (ts.charAt(G) === '{') { bM += '{'; G++; continue; } if (ot < 0) { throw new IPCC.Web.UI.ImGearArgumentException('format', 'The format string contains an unmatched opening or closing brace.'); } var Qa = ts.substring(G, ot); var To = Qa.indexOf(':'); var anA = parseInt((To < 0) ? Qa : Qa.substring(0, To), 10) + 1; if (isNaN(anA)) { throw new IPCC.Web.UI.ImGearArgumentException('format', 'The format string is invalid.'); } var ade = (To < 0) ? '' : Qa.substring(To + 1); var uM = dm[anA]; if (typeof (uM) === "undefined" || uM === null) { uM = ''; } if (uM.toFormattedString) { bM += uM.toFormattedString(ade); } else if (useLocale && uM.amM) { bM += uM.amM(ade); } else if (uM.format) { bM += uM.format(ade); } else { bM += uM.toString(); } G = ot + 1; } return bM; }; IPCC.Web.UI.ImGearException = function (message, errorInfo) { this.message = message; var K = this; if (errorInfo) { for (var US in errorInfo) { if (errorInfo.hasOwnProperty(US)) { K[US] = errorInfo[US]; } } } }; IPCC.Web.UI.ImGearException.prototype = new Error(); IPCC.Web.UI.ImGearException.registerClass = IPCC.Web.regClass; IPCC.Web.UI.ImGearException.registerClass('IPCC.Web.UI.ImGearException'); IPCC.Web.UI.ImGearHttpException = function (statusCode, message, customErrorCode) { var ho = "IPCC.Web.UI.ImGearHttpException: "; if (message) { ho += message; } this.message = ho; this.statusCode = statusCode; this.customErrorCode = customErrorCode; }; IPCC.Web.UI.ImGearHttpException.prototype = new Error(); IPCC.Web.UI.ImGearHttpException.registerClass = IPCC.Web.regClass; IPCC.Web.UI.ImGearHttpException.registerClass('IPCC.Web.UI.ImGearHttpException'); IPCC.Web.UI.ImGearArgumentException = function (paramName, message) { var ho = "IPCC.Web.UI.ImGearArgumentException: " + (message ? message : IPCC.gF.argument); if (paramName) { if (typeof (paramName) !== "undefined" && paramName !== null) { ho += "\n" + IPCC.Web.Bd(IPCC.gF.paramName, paramName); } } this.message = ho; this.paramName = paramName; }; IPCC.Web.UI.ImGearArgumentException.prototype = new Error(); IPCC.Web.UI.ImGearArgumentException.registerClass = IPCC.Web.regClass; IPCC.Web.UI.ImGearArgumentException.registerClass('IPCC.Web.UI.ImGearArgumentException'); IPCC.Web.UI.ImGearArgumentNullException = function (paramName, message) { var ho = "IPCC.Web.UI.ImGearArgumentNullException: " + (message ? message : IPCC.gF.argumentNull); if (paramName) { if (typeof (paramName) !== "undefined" && paramName !== null) { ho += "\n" + IPCC.Web.Bd(IPCC.Res.paramName, paramName); } } this.message = ho; this.paramName = paramName; }; IPCC.Web.UI.ImGearArgumentNullException.prototype = new Error(); IPCC.Web.UI.ImGearArgumentNullException.registerClass = IPCC.Web.regClass; IPCC.Web.UI.ImGearArgumentNullException.registerClass('IPCC.Web.UI.ImGearArgumentNullException'); IPCC.Web.UI.ImGearArgumentOutOfRangeException = function (paramName, actualValue, message) { var ho = "IPCC.Web.UI.ImGearArgumentOutOfRangeException: " + (message ? message : IPCC.gF.argumentOutOfRange); if (paramName) { if (typeof (paramName) !== "undefined" && paramName !== null) { ho += "\n" + IPCC.Web.Bd(IPCC.gF.paramName, paramName); } } if (typeof (actualValue) !== "undefined" && actualValue !== null) { ho += "\n" + IPCC.Web.Bd(IPCC.gF.actualValue, actualValue); } this.message = ho; this.paramName = paramName; this.actualValue = actualValue; }; IPCC.Web.UI.ImGearArgumentOutOfRangeException.prototype = new Error(); IPCC.Web.UI.ImGearArgumentOutOfRangeException.registerClass = IPCC.Web.regClass; IPCC.Web.UI.ImGearArgumentOutOfRangeException.registerClass('IPCC.Web.UI.ImGearArgumentOutOfRangeException'); IPCC.Web.UI.ImGearArgumentTypeException = function (paramName, actualType, expectedType, message) { var ho = "IPCC.Web.UI.ImGearArgumentTypeException "; if (message) { ho += message; } else if (actualType && expectedType) { if (typeof (actualType.getName) === 'function' && typeof (expectedType.getName) === 'function') { ho += IPCC.Web.Bd(IPCC.gF.argumentTypeWithTypes, actualType.getName(), expectedType.getName()); } else { ho += "actualType = " + actualType + " expectedType =  " + expectedType; } } else { ho += IPCC.gF.argumentType; } if (paramName) { if (typeof (paramName) !== "undefined" && paramName !== null) { ho += "\n" + IPCC.Web.Bd(IPCC.gF.paramName, paramName); } } this.message = ho; this.paramName = paramName; this.actualType = actualType; this.expectedType = expectedType; }; IPCC.Web.UI.ImGearArgumentTypeException.prototype = new Error(); IPCC.Web.UI.ImGearArgumentTypeException.registerClass = IPCC.Web.regClass; IPCC.Web.UI.ImGearArgumentTypeException.registerClass('IPCC.Web.UI.ImGearArgumentTypeException'); IPCC.Web.UI.ImGearArgumentUndefinedException = function (paramName, message) { var ho = "IPCC.Web.UI.ImGearArgumentUndefinedException: " + (message ? message : IPCC.gF.argumentUndefined); if (paramName) { if (typeof (paramName) !== "undefined" && paramName !== null) { ho += "\n" + IPCC.Web.Bd(IPCC.Res.paramName, paramName); } } this.message = ho; this.paramName = paramName; }; IPCC.Web.UI.ImGearArgumentUndefinedException.prototype = new Error(); IPCC.Web.UI.ImGearArgumentUndefinedException.registerClass = IPCC.Web.regClass; IPCC.Web.UI.ImGearArgumentUndefinedException.registerClass('IPCC.Web.UI.ImGearArgumentUndefinedException'); IPCC.Web.UI.ImGearInvalidOperationException = function (message) { var ho = "IPCC.Web.UI.ImGearInvalidOperationException: " + (message ? message : IPCC.gF.invalidOperation); this.message = ho; }; IPCC.Web.UI.ImGearInvalidOperationException.protype = new Error(); IPCC.Web.UI.ImGearInvalidOperationException.registerClass = IPCC.Web.regClass; IPCC.Web.UI.ImGearInvalidOperationException.registerClass('IPCC.Web.UI.ImGearInvalidOperationException'); IPCC.Web.UI.ImGearNotImplementedException = function (message) { var ho = "IPCC.Web.UI.ImGearNotImplementedException: " + (message ? message : IPCC.gF.notImplemented); this.message = ho; }; IPCC.Web.UI.ImGearNotImplementedException.prototype = new Error(); IPCC.Web.UI.ImGearNotImplementedException.registerClass = IPCC.Web.regClass; IPCC.Web.UI.ImGearNotImplementedException.registerClass('IPCC.Web.UI.ImGearNotImplementedException'); IPCC.Web.UI.ImGearParameterCountException = function (message) { var ho = "IPCC.Web.UI.ImGearParameterCountException: " + (message ? message : IPCC.gF.parameterCount); this.message = ho; }; IPCC.Web.UI.ImGearParameterCountException.prootype = new Error(); IPCC.Web.UI.ImGearParameterCountException.registerClass = IPCC.Web.regClass; IPCC.Web.UI.ImGearParameterCountException.registerClass('IPCC.Web.UI.ImGearParameterCountException'); IPCC.Web.aq = [0x4B1C9AAE, 0x25AE1AB6, 0x48E3F1C8, 0x8D61FC1A]; IPCC.Web.gW = { aaS: function (dH, tI, anN) { dH = IPCC.Web.gW.akX(dH.slice(tI / 32), 32 - (tI & 31)).slice(1); return (anN === undefined) ? dH : IPCC.Web.gW.aCj(dH, anN - tI); }, abP: function (dH, tI, abV) { var aY, Ym = Math.floor((-tI - abV) & 31); if ((tI + abV - 1 ^ tI) & -32) { aY = (dH[tI / 32 | 0] << (32 - Ym)) ^ (dH[tI / 32 + 1 | 0] >>> Ym); } else { aY = dH[tI / 32 | 0] >>> Ym; } return aY & ((1 << abV) - 1); }, aax: function (AY, xA) { if (AY.length === 0 || xA.length === 0) { return AY.concat(xA); } var jc = AY[AY.length - 1], uU = IPCC.Web.gW.aaF(jc); if (uU === 32) { return AY.concat(xA); } else { return IPCC.Web.gW.akX(xA, uU, jc | 0, AY.slice(0, AY.length - 1)); } }, xK: function (dH) { var tZ = dH.length, aY; if (tZ === 0) { return 0; } aY = dH[tZ - 1]; return (tZ - 1) * 32 + IPCC.Web.gW.aaF(aY); }, aCj: function (dH, dg) { if (dH.length * 32 < dg) { return dH; } dH = dH.slice(0, Math.ceil(dg / 32)); var tZ = dH.length; dg = dg & 31; if (tZ > 0 && dg) { dH[tZ - 1] = IPCC.Web.gW.Jw(dg, dH[tZ - 1] & 0x80000000 >> (dg - 1), 1); } return dH; }, Jw: function (dg, aY, ec) { if (dg === 32) { return aY; } return (ec ? aY | 0 : aY << (32 - dg)) + dg * 0x10000000000; }, aaF: function (aY) { return Math.round(aY / 0x10000000000) || 32; }, axQ: function (dH, fC) { if (IPCC.Web.gW.xK(dH) !== IPCC.Web.gW.xK(fC)) { return false; } var aY = 0, G; for (G = 0; G < dH.length; G++) { aY |= dH[G] ^ fC[G]; } return (aY === 0); }, akX: function (dH, uU, Kd, gq) { var G, apf = 0, YA; if (gq === undefined) { gq = []; } for (; uU >= 32; uU -= 32) { gq.push(Kd); Kd = 0; } if (uU === 0) { return gq.concat(dH); } for (G = 0; G < dH.length; G++) { gq.push(Kd | dH[G] >>> uU); Kd = dH[G] << (32 - uU); } apf = dH.length ? dH[dH.length - 1] : 0; YA = IPCC.Web.gW.aaF(apf); gq.push(IPCC.Web.gW.Jw(uU + YA & 31, (uU + YA > 32) ? Kd : gq.pop(), 1)); return gq; }, aiV: function (aY, fJ) { return [aY[0] ^ fJ[0], aY[1] ^ fJ[1], aY[2] ^ fJ[2], aY[3] ^ fJ[3]]; } }; IPCC.Web.hm = IPCC.Web.hm || {}; IPCC.Web.rG = false; IPCC.Web.adD = []; IPCC.Web.hm.GR = { nh: function (fm) { var gq = "", tf = IPCC.Web.gW.xK(fm), G, eU; for (G = 0; G < tf / 8; G++) { if ((G & 3) === 0) { eU = fm[G / 4]; } gq += String.fromCharCode(eU >>> 24); eU <<= 8; } return decodeURIComponent(escape(gq)); }, te: function (cI) { cI = unescape(encodeURIComponent(cI)); var gq = [], G, eU = 0; for (G = 0; G < cI.length; G++) { eU = eU << 8 | cI.charCodeAt(G); if ((G & 3) === 3) { gq.push(eU); eU = 0; } } if (G & 3) { gq.push(IPCC.Web.gW.Jw(8 * (G & 3), eU)); } return gq; } }; IPCC.Web.uN = false; IPCC.Web.hm.nC = { As: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/", nh: function (fm, atZ, am) { var gq = "", G, fw = 0, he = IPCC.Web.hm.nC.As, xQ = 0, tf = IPCC.Web.gW.xK(fm); if (am) { he = he.substr(0, 62) + '-_'; } for (G = 0; gq.length * 6 < tf;) { gq += he.charAt((xQ ^ fm[G] >>> fw) >>> 26); if (fw < 6) { xQ = fm[G] << (6 - fw); fw += 26; G++; } else { xQ <<= 6; fw -= 6; } } while ((gq.length & 3) && !atZ) { gq += "="; } return gq; }, te: function (cI, am) { cI = cI.replace(/\s|=/g, ''); var gq = [], G, fw = 0, he = IPCC.Web.hm.nC.As, xQ = 0, aY; if (am) { he = he.substr(0, 62) + '-_'; } for (G = 0; G < cI.length; G++) { aY = he.indexOf(cI.charAt(G)); if (aY < 0) { throw new IPCC.Web.UI.ImGearArgumentException('base64', 'Invalid base64'); } if (fw > 26) { fw -= 26; gq.push(xQ ^ aY >>> fw); xQ = aY << (32 - fw); } else { fw += 6; xQ ^= aY << (32 - fw); } } if (fw & 56) { gq.push(IPCC.Web.gW.Jw(fw & 56, xQ, 1)); } return gq; } }; IPCC.Web.hm.Fr = { nh: function (fm) { return IPCC.Web.hm.nC.nh(fm, 1, 1); }, te: function (cI) { return IPCC.Web.hm.nC.te(cI, 1); } }; IPCC.Web.nr = []; IPCC.Web.Pi = IPCC.Web.Pi || {}; IPCC.Web.Pi.anI = { dC: "cbc", agm: function (TK, XT, gO, zV) { if (zV && zV.length) { throw new IPCC.Web.UI.ImGearArgumentException('data', 'cannot authenticate data'); } if (IPCC.Web.gW.xK(gO) !== 128) { throw new IPCC.Web.UI.ImGearArgumentException('iv', 'invalid data'); } var G, kX = IPCC.Web.gW, Tw = kX.aiV, tf = kX.xK(XT), aoU = 0, rM = []; if (tf & 7) { throw new IPCC.Web.UI.ImGearInvalidOperationException('padding works only for multiple bytes'); } for (G = 0; aoU + 128 <= tf; G += 4, aoU += 128) { gO = TK.agm(Tw(gO, XT.slice(G, G + 4))); rM.splice(G, 0, gO[0], gO[1], gO[2], gO[3]); } tf = (16 - ((tf >> 3) & 15)) * 0x1010101; gO = TK.agm(Tw(gO, kX.aax(XT, [tf, tf, tf, tf]).slice(G, G + 4))); rM.splice(G, 0, gO[0], gO[1], gO[2], gO[3]); return rM; }, SF: function (TK, SV, gO, zV) { if (zV && zV.length) { throw new IPCC.Web.UI.ImGearArgumentException(zV, "cbc can't authenticate data"); } if (IPCC.Web.gW.xK(gO) !== 128) { throw new IPCC.Web.UI.ImGearArgumentException('iv', "cbc iv must be 128 bits"); } if ((IPCC.Web.gW.xK(SV) & 127) || !SV.length) { throw new IPCC.Web.UI.ImGearInvalidOperationException("cbc ciphertext must be a positive multiple of the block size"); } var G, kX = IPCC.Web.gW, Tw = kX.aiV, vR, ur, rM = []; zV = zV || []; for (G = 0; G < SV.length; G += 4) { vR = SV.slice(G, G + 4); ur = Tw(gO, TK.SF(vR)); rM.splice(G, 0, ur[0], ur[1], ur[2], ur[3]); gO = vR; } vR = rM[G - 1] & 255; if (vR === 0 || vR > 16) { throw new IPCC.Web.UI.ImGearInvalidOperationException('pkcs#5 padding corrupt'); } ur = vR * 0x1010101; if (!kX.axQ(kX.aaS([ur, ur, ur, ur], 0, vR * 8), kX.aaS(rM, rM.length * 32 - vR * 8, rM.length * 32))) { throw new IPCC.Web.UI.ImGearInvalidOperationException('2pkcs#5 padding corrupt'); } return kX.aaS(rM, 0, rM.length * 32 - vR * 8); } }; IPCC.Web.aGh = 0; IPCC.Web.bC = new IPCC.Web.UI.fR(); IPCC.Web.aJG = function (V) { IPCC.Web.bC.du(IPCC.gF.prodInfo, V); }; IPCC.Web.aJl = function (V) { IPCC.Web.bC.dn(IPCC.gF.prodInfo, V); }; IPCC.Web.aKA = function (V) { IPCC.Web.bC.du(IPCC.gF.prodFailInfo, V); }; IPCC.Web.aJk = function (V) { IPCC.Web.bC.dn(IPCC.gF.prodFailInfo, V); }; IPCC.Web.aM = function (cA, L) { var V = IPCC.Web.bC.getHandler(cA); if (V !== null) { V(IPCC.Web, L); } }; IPCC.Web.aKl = function (Hz) { var tz = Hz.length; var AA = Math.ceil(tz / 4), SM; var fw = []; fw.length = AA; for (var lQ = 0, gv = 0; lQ < AA; lQ++, gv += 4) { fw[lQ] = ((Hz[gv] & 0xff) << 24) + ((Hz[gv + 1] & 0xff) << 16) + ((Hz[gv + 2] & 0xff) << 8) + (Hz[gv + 3] & 0xff); } if (gv < tz) { SM[lQ] = 0; for (var Ah = 0; gv < tz; gv++, Ah++) { SM[lQ] += (Hz[gv++] & 0xff) << (3 - Ah); } } return fw; }; IPCC.Web.arf = function (az) { var tz = az.length; var AA = Math.ceil(tz / 4); var fw = []; fw.length = AA; for (var lQ = 0, gv = 0; lQ < AA; lQ++, gv += 4) { fw[lQ] = ((az.charCodeAt(gv) & 0xff) << 24) + ((az.charCodeAt(gv + 1) & 0xff) << 16) + ((az.charCodeAt(gv + 2) & 0xff) << 8) + ((az.charCodeAt(gv + 3) & 0xff)); } if (gv < tz) { fw[lQ] = 0; for (var Ah = 0; gv < tz; gv++, Ah++) { fw[lQ] += (az.charCodeAt(gv++) & 0xff) << (3 - Ah); } } return fw; }; IPCC.Web.aHP = function (Ai) { var EL = new Uint8Array(Ai); var tz = EL.length; var AA = Math.ceil(tz / 4), SM; var fw = []; fw.length = AA; for (var lQ = 0, gv = 0; lQ < AA; lQ++, gv += 4) { fw[lQ] = (EL[gv] << 24) + (EL[gv + 1] << 16) + (EL[gv + 2] << 8) + EL[gv + 3]; } if (gv < tz) { fw[lQ] = 0; for (var Ah = 0; gv < tz; gv++, Ah++) { SM[lQ] += EL[gv++] << (3 - Ah); } } return fw; }; IPCC.Web.Hw = function (fw, gO) { var aq = [0x116D0662, 0xA8BB5E38, 0x4D7F93C8, 0xA61D2F6B, 0xADB1384D, 0x3D4AC7FB, 0x4E6EB64E, 0x6F4D7E8F]; return IPCC.Web.AB(fw, aq, gO); }; IPCC.Web.AB = function (fw, aq, gO) { try { var Qh = new IPCC.Web.Kh.Ve(aq); var dc = IPCC.Web.Pi.anI.SF(Qh, fw, gO); return dc; } catch (bJ) { return; } }; IPCC.Web.Hg = function (Ji) { return IPCC.Web.arf(Ji.responseText); }; IPCC.Web.aEN = function (aDB, gO, zL) { var Wu; var dc; var Qh; var fw; try { Qh = new IPCC.Web.Kh.Ve(zL.adD); fw = IPCC.Web.hm.nC.te(aDB); Wu = IPCC.Web.Pi.anI.SF(Qh, fw, gO); dc = IPCC.Web.hm.GR.nh(Wu); } catch (bJ) { IPCC.Web.nr[0] = 0; IPCC.Web.rG = false; return; } var bM; if (Wu) { bM = IPCC.ct.pG(dc); if (bM) { if (bM.v === IPCC.Web.qS.adU() && bM.p === IPCC.Web.qS.aea()) { if (bM.f) { var dg = bM.f.length, fm = bM.f; if (bM.f.length > 0) { IPCC.Web.nr.splice(0); for (var G = 0; G < dg; G++) { IPCC.Web.nr.push(fm[G]); } IPCC.Web.rG = true; IPCC.Web.uN = false; } } else { IPCC.Web.rG = false; IPCC.Web.uN = false; } } } } }; IPCC.Web.OA = function (aoZ) { if (IPCC.Web.rG) { return; } if (IPCC.Web.uN) { return; } if (!aoZ) { return; } var gO = IPCC.Web.qS.Ow(4); var zL = { adD: [] }; function fa(bF) { try { if (bF.status === 200) { IPCC.Web.aEN(bF.responseText, gO, zL); } else { IPCC.Web.nr[0] = 0; IPCC.Web.rG = false; IPCC.Web.uN = false; throw new IPCC.Web.UI.ImGearHttpException(bF.status, 'failure to get product info'); } } catch (e) { IPCC.Web.uN = false; throw new IPCC.Web.UI.ImGearException('failure to get product info', { name: 'Product Infomation' }); } finally { if (bF.status === 200) { if (IPCC.Web.rG === true) { IPCC.Web.aM(IPCC.gF.prodInfo, null); } else { IPCC.Web.aM(IPCC.gF.prodFailInfo, null); } } else { IPCC.Web.aM(IPCC.gF.prodFailInfo, null); } } }; function eZ(bM) { try { IPCC.Web.nr[0] = 0; IPCC.Web.rG = false; IPCC.Web.uN = false; throw new IPCC.Web.UI.ImGearHttpException(bM.response.status, 'failure to get product info'); } catch (e) { IPCC.Web.uN = false; throw new IPCC.Web.UI.ImGearException('failure to get product info', { name: 'Product Infomation' }); } finally { IPCC.Web.aM(IPCC.gF.prodFailInfo, null); } }; setTimeout(function () { IPCC.J.mt.dZ({ method: 'GET', url: IPCC.Web.qS.aHa(aoZ, gO, zL), headers: { 'Content-Type': 'application/json' } }).then(fa, eZ); }, 500); IPCC.Web.aGh++; IPCC.Web.uN = true; }; IPCC.Web.PE = function () { var Gh = new Date(); var avC = new Date(Gh.getYear(), Gh.getMonth(), Gh.getDate(), Gh.getHours(), Gh.getMinutes(), Gh.getSeconds()); return (+avC); }; IPCC.Web.qS = { Ow: function (eo) { var JL = []; var Zh = IPCC.Web.amd().ahV; for (var G = 0; G < eo; G++) { JL.push(Zh()); } return JL; }, abx: function (eo, eb) { var JL = []; var Zh = IPCC.Web.amd(eb).ahV; for (var G = 0; G < eo; G++) { JL.push(Zh()); } return JL; }, aHa: function (cI, gO, zL) { return cI + IPCC.gF.fwdslash + IPCC.gF.svctype + IPCC.gF.fwdslash + IPCC.gF.viewer + IPCC.gF.querySymb + IPCC.gF.version + IPCC.Web.qS.adU() + '&' + IPCC.gF.iv + IPCC.Web.qS.azX(gO, zL) + '&' + IPCC.gF.param + IPCC.Web.qS.aea(); }, adU: function () { return IPCC.Web.axO; }, aea: function () { return IPCC.Web.aEB; }, azX: function (gO, zL) { var eo, iO = true, gq = "", NY, Zu, abm, Sf, My, apn; for (eo = 0; eo < 4; eo++) { if (!iO) { gq += '-'; } else { iO = false; } My = 0; for (NY = 0; NY < 4; NY++) { Sf = eo * 32 + NY * 8; Zu = IPCC.Web.gW.abP(gO, Sf, 4); gq += Zu.toString(16).toUpperCase(); abm = IPCC.Web.gW.abP(gO, Sf + 4, 4); gq += abm.toString(16).toUpperCase(); apn = (Zu * 16 + abm + IPCC.Web.gW.abP(IPCC.Web.aq, Sf, 8)) % 256; My = My | (apn << (24 - (NY * 8))); } zL.adD[eo] = My; } return gq; } }; IPCC.ct = IPCC.ct || {}; IPCC.ct.pG = IPCC.ct.pG || function (cI, aBA) { if (cI === "") { cI = '""'; } try { if (typeof YUI !== 'undefined') { var aoz; YUI().use('json-parse', function (Y) { aoz = Y.JSON.parse(cI); }); return aoz; } else { var agY = cI.replace(new RegExp('(^|[^\\\\])\\"\\\\/Date\\((-?[0-9]+)(?:[a-zA-Z]|(?:\\+|-)[0-9]{4})?\\)\\\\/\\"', 'g'), "$1new Date($2)"); var aFQ = new RegExp('[^,:{}\\[\\]0-9.\\-+Eaeflnr-u \\n\\r\\t]', 'g'); var aHg = new RegExp('"(\\\\.|[^"\\\\])*"', 'g'); if (aBA && aFQ.test(agY.replace(aHg, ''))) { throw null; } return eval('(' + agY + ')'); } } catch (e) { throw new IPCC.Web.UI.ImGearArgumentException('str', 'Cannot deserialize. The data does not correspond to valid JSON.'); } }; IPCC.gm = {}; IPCC.gm.InternetExplorer = {}; IPCC.gm.Firefox = {}; IPCC.gm.Safari = {}; IPCC.gm.Opera = {}; IPCC.gm.agent = null; IPCC.gm.hasDebuggerStatement = false; IPCC.gm.name = navigator.appName; IPCC.gm.version = parseFloat(navigator.appVersion); IPCC.gm.documentMode = 0; if (navigator.userAgent.indexOf(' MSIE ') > -1) { IPCC.gm.agent = IPCC.gm.InternetExplorer; IPCC.gm.version = parseFloat(navigator.userAgent.match(/MSIE (\d+\.\d+)/)[1]); if (IPCC.gm.version >= 8) { if (document.documentMode >= 7) { IPCC.gm.documentMode = document.documentMode; } } IPCC.gm.hasDebuggerStatement = true; } else if (navigator.userAgent.indexOf(' Firefox/') > -1) { IPCC.gm.agent = IPCC.gm.Firefox; IPCC.gm.version = parseFloat(navigator.userAgent.match(/ Firefox\/(\d+\.\d+)/)[1]); IPCC.gm.name = 'Firefox'; IPCC.gm.hasDebuggerStatement = true; } else if (navigator.userAgent.indexOf(' AppleWebKit/') > -1) { IPCC.gm.agent = IPCC.gm.Safari; IPCC.gm.version = parseFloat(navigator.userAgent.match(/ AppleWebKit\/(\d+(\.\d+)?)/)[1]); IPCC.gm.name = 'Safari'; } else if (navigator.userAgent.indexOf('Opera/') > -1) { IPCC.gm.agent = IPCC.gm.Opera; } IPCC.Is = function (Tc) { this.sG = (typeof (Tc) !== 'undefined' && Tc !== null && Tc !== '') ? [Tc.toString()] : []; this.F = {}; this.dg = 0; }; IPCC.Is.prototype.oU = function (az) { this.sG[this.sG.length] = az; }; IPCC.Is.prototype.aIK = function (az) { this.sG[this.sG.length] = ((typeof (az) === 'undefined') || (az === null) || (az === '')) ? '\r\n' : az + '\r\n'; }; IPCC.Is.prototype.aGQ = function () { this.sG = []; this.F = {}; this.dg = 0; }; IPCC.Is.prototype.aJj = function () { if (this.sG.length === 0) { return true; } return this.toString() === ''; }; IPCC.Is.prototype.awB = function (CR) { CR = CR || ''; var parts = this.sG; if (this.dg !== parts.length) { this.F = {}; this.dg = parts.length; } var val = this.F; if (typeof (val[CR]) === 'undefined') { if (CR !== '') { for (var i = 0; i < parts.length;) { if ((typeof (parts[i]) === 'undefined') || (parts[i] === '') || (parts[i] === null)) { parts.splice(i, 1); } else { i++; } } } val[CR] = this.sG.join(CR); } return val[CR]; }; IPCC.Web.hK = function (fm, elt) { var len = fm.length >>> 0; var from = Number(arguments[2]) || 0; from = (from < 0) ? Math.ceil(from) : Math.floor(from); if (from < 0) { from += len; } for (; from < len; from++) { if (from in fm && fm[from] === elt) { return from; } } return -1; }; IPCC.ct.SC = []; IPCC.ct.Jz = []; IPCC.ct.aJu = new RegExp('(^|[^\\\\])\\"\\\\/Date\\((-?[0-9]+)(?:[a-zA-Z]|(?:\\+|-)[0-9]{4})?\\)\\\\/\\"', 'g'); IPCC.ct.Gp = {}; IPCC.ct.axj = new RegExp('["\\\\\\x00-\\x1F]', 'i'); IPCC.ct.ayH = new RegExp('["\\\\\\x00-\\x1F]', 'g'); IPCC.ct.aJx = new RegExp('[^,:{}\\[\\]0-9.\\-+Eaeflnr-u \\n\\r\\t]', 'g'); IPCC.ct.aKf = new RegExp('"(\\\\.|[^"\\\\])*"', 'g'); IPCC.ct.aHv = '__type'; IPCC.ct.TO = function () { var replaceChars = ['\\u0000', '\\u0001', '\\u0002', '\\u0003', '\\u0004', '\\u0005', '\\u0006', '\\u0007', '\\b', '\\t', '\\n', '\\u000b', '\\f', '\\r', '\\u000e', '\\u000f', '\\u0010', '\\u0011', '\\u0012', '\\u0013', '\\u0014', '\\u0015', '\\u0016', '\\u0017', '\\u0018', '\\u0019', '\\u001a', '\\u001b', '\\u001c', '\\u001d', '\\u001e', '\\u001f']; IPCC.ct.Jz[0] = '\\'; IPCC.ct.SC['\\'] = new RegExp('\\\\', 'g'); IPCC.ct.Gp['\\'] = '\\\\'; IPCC.ct.Jz[1] = '"'; IPCC.ct.SC['"'] = new RegExp('"', 'g'); IPCC.ct.Gp['"'] = '\\"'; for (var i = 0; i < 32; i++) { var c = String.fromCharCode(i); IPCC.ct.Jz[i + 2] = c; IPCC.ct.SC[c] = new RegExp(c, 'g'); IPCC.ct.Gp[c] = replaceChars[i]; } }; IPCC.ct.aeN = function (object, gz) { gz.oU(object.toString()); }; IPCC.ct.afK = function (object, gz) { if (isFinite(object)) { gz.oU(String(object)); } else { throw new IPCC.Web.UI.ImGearInvalidOperationException('Cannot serialize non finite numbers.'); } }; IPCC.ct.aff = function (string, gz) { gz.oU('"'); if (IPCC.ct.axj.test(string)) { if (IPCC.ct.Jz.length === 0) { IPCC.ct.TO(); } if (string.length < 128) { string = string.replace(IPCC.ct.ayH, function (x) { return IPCC.ct.Gp[x]; }); } else { for (var i = 0; i < 34; i++) { var c = IPCC.ct.Jz[i]; if (string.indexOf(c) !== -1) { if (IPCC.gm.agent === IPCC.gm.Opera || IPCC.gm.agent === IPCC.gm.FireFox) { string = string.split(c).join(IPCC.ct.Gp[c]); } else { string = string.replace(IPCC.ct.SC[c], IPCC.ct.Gp[c]); } } } } } gz.oU(string); gz.oU('"'); }; IPCC.ct.OC = function (object, gz, sort, prevObjects) { var i; switch (typeof object) { case 'object': if (object) { if (prevObjects) { for (var j = 0; j < prevObjects.length; j++) { if (prevObjects[j] === object) { throw new IPCC.Web.UI.ImGearInvalidOperationException('Cannot serialize object with cyclic reference within child properties.'); } } } else { prevObjects = []; } try { prevObjects[prevObjects.length] = object; if (typeof (object) === "number") { IPCC.ct.afK(object, gz); } else if (typeof (object) === "boolean") { IPCC.ct.aeN(object, gz); } else if (typeof (object) === "string") { IPCC.ct.aff(object, gz); } else if (object instanceof Array) { gz.oU('['); for (i = 0; i < object.length; ++i) { if (i > 0) { gz.oU(','); } IPCC.ct.OC(object[i], gz, false, prevObjects); } gz.oU(']'); } else { var properties = []; var propertyCount = 0; for (var name in object) { if (object.hasOwnProperty(name)) { var eU = "" + name; var wr = '$'; if ((eU.substr(0, wr.length) === wr)) { continue; } if (name === IPCC.ct.aHv && propertyCount !== 0) { properties[propertyCount++] = properties[0]; properties[0] = name; } else { properties[propertyCount++] = name; } } } if (sort) { properties.sort(); } gz.oU('{'); var needComma = false; for (i = 0; i < propertyCount; i++) { var value = object[properties[i]]; if (typeof value !== 'undefined' && typeof value !== 'function') { if (needComma) { gz.oU(','); } else { needComma = true; } IPCC.ct.OC(properties[i], gz, sort, prevObjects); gz.oU(':'); IPCC.ct.OC(value, gz, sort, prevObjects); } } gz.oU('}'); } } finally { prevObjects.splice(prevObjects.length - 1); } } else { gz.oU('null'); } break; case 'number': IPCC.ct.afK(object, gz); break; case 'string': IPCC.ct.aff(object, gz); break; case 'boolean': IPCC.ct.aeN(object, gz); break; default: gz.oU('null'); break; } }; IPCC.ct.YU = IPCC.ct.YU || function (object) { var gz = new IPCC.Is(); IPCC.ct.OC(object, gz, false); return gz.awB(); }; IPCC.gF = { 'paramName': 'Parameter name: {0}', 'svctype': 'License', 'argumentNull': 'Value cannot be null.', 'spc': ' ', 'actualValue': 'Actual value was {0}.', 'fwdslash': '/', 'prodInfo': 'prodInfoPass', 'argumentOutOfRange': 'Specified argument was out of the range of valid values.', 'argumentTypeWithTypes': 'Object of type \'{0}\' cannot be converted to type \'{1}\'.', 'argumentType': 'Object cannot be converted to the required type.', 'invalidOperation': 'Operation is not valid due to the current state of the object.', 'notImplemented': 'The method or operation is not implemented.', 'argument': 'Value does not fall within the expected range.', 'prodFailInfo': 'prodInfoFail', 'svcReqStr': '', 'viewer': 'ClientViewer', 'querySymb': '?', 'version': 'v=', 'iv': 'iv=', 'param': 'p=' }; IPCC.Web.aqO = function aJv() { var jQ = 0xefc8249d; var vB = function (dc) { dc = dc.toString(); for (var G = 0; G < dc.length; G++) { jQ += dc.charCodeAt(G); var fi = 0.02519603282416938 * jQ; jQ = fi >>> 0; fi -= jQ; fi *= jQ; jQ = fi >>> 0; fi -= jQ; jQ += fi * 0x100000000; } return (jQ >>> 0) * 2.3283064365386963e-10; }; vB.wX = 'Mash 0.9'; return vB; }; IPCC.Web.amd = function aJV() { return (function (dm) { var CX = 0; var Dx = 0; var Do = 0; var he = 1; if (dm.length === 0) { dm = [+new Date()]; } var vB = IPCC.Web.aqO(); CX = vB(' '); Dx = vB(' '); Do = vB(' '); for (var G = 0; G < dm.length; G++) { CX -= vB(dm[G]); if (CX < 0) { CX += 1; } Dx -= vB(dm[G]); if (Dx < 0) { Dx += 1; } Do -= vB(dm[G]); if (Do < 0) { Do += 1; } } vB = null; var AI = function () { var um = 2091639 * CX + he * 2.3283064365386963e-10; CX = Dx; Dx = Do; Do = um - (he = um | 0); return Do; }; AI.ahV = function () { return AI() * 0x100000000; }; AI.aKd = function () { return AI() + (AI() * 0x200000 | 0) * 1.1102230246251565e-16; }; AI.wX = 'Alea 0.9'; AI.dm = dm; return AI; }(Array.prototype.slice.call(arguments))); }; IPCC.ad = { aa: function (F, dC, aa) { if (typeof (F) !== aa) { throw new IPCC.Web.UI.ImGearArgumentTypeException(dC, typeof (F), aa); } }, jt: function (F, dC) { IPCC.ad.aa(F, dC, 'string'); }, gb: function (F, dC) { if (!(F instanceof Date)) { throw new IPCC.Web.UI.ImGearArgumentTypeException(dC, typeof (F), "Date"); } }, hL: function (F, dC) { IPCC.ad.aa(F, dC, 'number'); if (!isFinite(F)) { throw new IPCC.Web.UI.ImGearArgumentOutOfRangeException(dC, F, 'The value must be a number.'); } }, mL: function (F, dC, yC, AK) { IPCC.ad.aa(F, dC, 'number'); if (F < yC || F > AK || !isFinite(F)) { throw new IPCC.Web.UI.ImGearArgumentOutOfRangeException(dC, F, 'The value must be a number between ' + yC + ' and ' + AK + ' inclusive.'); } }, WG: function (F, dC, KL) { IPCC.ad.aa(F, dC, 'number'); var G; for (G = 0; G < KL.length; G++) { if (F === KL[G]) { return; } } var Ra = ''; for (G = 0; G < KL.length; G++) { if (G > 0) { if (G === KL.length - 1) { Ra += ' or '; } else { Ra += ', '; } } Ra += KL[G]; } throw new IPCC.Web.UI.ImGearArgumentOutOfRangeException(dC, F, 'The value must be ' + Ra + '.'); }, ps: function (F, dC, yC, AK) { IPCC.ad.mL(F, dC, yC, AK); if (F !== Math.floor(F)) { throw new IPCC.Web.UI.ImGearArgumentException(dC, 'The value must be an integer.'); } }, dU: function (F, dC) { IPCC.ad.aa(F, dC, 'string'); if (!F.match(/#[0-9A-Fa-f]{6}/)) { throw new IPCC.Web.UI.ImGearArgumentException(dC, 'Colors must be strings that begin with a # symbol, followed by 6 hexadecimal digits.'); } }, abc: function (F, dC) { IPCC.ad.aa(F, dC, 'string'); if (!F.match(/#[0-9A-Fa-f]{6}|transparent/)) { throw new IPCC.Web.UI.ImGearArgumentException(dC, 'Colors must be strings that begin with a # symbol, followed by 6 hexadecimal digits or comply with other W3C accepted color values like "transparent".'); } }, lm: function (F, dC, lm, anm) { IPCC.ad.aa(F, dC, 'number'); var cr; var aaE = 0; for (cr in lm) { if (lm.hasOwnProperty(cr)) { if (anm) { aaE |= lm[cr]; } else { if (F === lm[cr]) { return; } } } } var cI = ""; if (anm) { if ((F | aaE) === aaE) { return; } else { throw new IPCC.Web.UI.ImGearArgumentOutOfRangeException(dC, F, 'The value must be zero or more members of the ' + cI + ' enumeration.'); } } throw new IPCC.Web.UI.ImGearArgumentOutOfRangeException(dC, F, 'The value must be a member of the ' + cI + ' enumeration.'); }, be: function (F, dC) { IPCC.ad.hL(F.x, dC + '.x'); IPCC.ad.hL(F.y, dC + '.y'); }, h: function (F, dC) { IPCC.ad.hL(F.x, dC + '.x'); IPCC.ad.hL(F.y, dC + '.y'); IPCC.ad.hL(F.width, dC + '.width'); IPCC.ad.hL(F.height, dC + '.height'); } }; IPCC.FA = function () { function Fm() { return Math.floor((Math.random() * 10)).toString(); }; var gb = new Date(); return Fm() + Fm() + '_' + gb.getTime() + "_" + Fm() + Fm() + Fm() + Fm(); }; IPCC.gG = { io: function (ic, OG) { var aa, cI, eL; if (ic === null) { return 'null'; } if (!OG) { OG = 0; } aa = typeof (ic); if (aa === 'undefined') { return 'undefined'; } else if (aa === 'number' || aa === 'boolean') { return ic.toString(); } else if (aa === 'string') { return '\'' + ic + '\''; } else if (aa === 'function') { return 'function'; } else { if (OG < 0) { return 'ic'; } cI = '{'; for (eL in ic) { if (ic.hasOwnProperty(eL)) { if (cI.length > 2) { cI += ', '; } cI += eL; cI += ': '; cI += IPCC.gG.io(ic[eL], OG - 1); } } cI += '}'; return cI; } }, Sa: function (az) { var traceElement = document.getElementById('TraceConsole'); if (traceElement && (traceElement.tagName.toUpperCase() === 'TEXTAREA')) { traceElement.value += az + '\n'; } }, aKp: function () { var traceElement = document.getElementById('TraceConsole'); if (traceElement && (traceElement.tagName.toUpperCase() === 'TEXTAREA')) { traceElement.value = ''; } }, iP: function (hb, Kb, as, FR, Ek) { var az = "PCC Controls - "; az += (FR) ? FR : " "; az += " parent Div id = "; az += (Ek) ? Ek : " "; if (Kb) { switch (Kb) { case 0: az += " FunctionCall "; break; case 1: az += " Exception "; break; case 2: az += " Custom "; break; case 3: az += " UserAction "; break; case 4: az += " Warning "; break; default: az += " unknown "; } } az += " - " + hb; if ((typeof (Debug) !== 'undefined') && Debug.writeln) { Debug.writeln(az); } if (window.console && window.console.log) { window.console.log(az); } if (window.opera) { window.opera.postError(az); } if (window.debugService) { window.debugService.trace(az); } var traceElement = document.getElementById('TraceConsole'); if (traceElement && (traceElement.tagName.toUpperCase() === 'TEXTAREA')) { traceElement.value += az + '\n'; } var Nz; try { Nz = onPCCItemLogged; } catch (ex) { } if (Nz && (typeof (Nz)).toLowerCase() === 'function') { var dm = new IPCC.Web.UI.LogItemEventArgs(); dm.message = hb; dm.cause = Kb; dm.level = as; dm.id = Ek; Nz(dm); } } }; IPCC.wk = { zoomInMenuItem: "Zoom In 25%", zoomOutMenuItem: "Zoom Out 25%", fullImageMenuItem: "Full Image", fullWidthMenuItem: "Full Width", fullHeightMenuItem: "Full Height", oneToOneRatioMenuItem: "1 to 1 Ratio", actualSizeMenuItem: "Actual Size", rotateRightMenuItem: "Rotate Clockwise", rotateLeftMenuItem: "Rotate Counter-Clockwise", mirrorHorizontalMenuItem: "Mirror Horizontal", mirrorVerticalMenuItem: "Mirror Vertical", panToolMenuItem: "Pan Tool", areaSelectionToolMenuItem: "Area Selection Tool", zoomRectangleToolMenuItem: "Zoom Rectangle Tool", flyingMagnifierToolMenuItem: "Flying Magnifier Tool", createTextMarkToolMenuItem: "Create Text Mark", createLineMarkToolMenuItem: "Create Line Mark", createPolygonMarkToolMenuItem: "Create Polygon Mark", createPolylineMarkToolMenuItem: "Create Polyline Mark", createRectangleMarkToolMenuItem: "Create Rectangle Mark", createEllipseMarkToolMenuItem: "Create Ellipse Mark", createFreehandMarkToolMenuItem: "Create Freehand Mark", editMarksToolMenuItem: "Edit Marks", runMarksToolMenuItem: "Run Marks", createStampMarkToolMenuItem: "Create Stamp Mark", createHighlightMarkToolMenuItem: "Create Highlight Mark", thicknessMenu: { item1: "1", item2: "2", item3: "3", item4: "4", item5: "5", item6: "6", item7: "7", item8: "8" }, opacityMenu: { translucent: "Translucent (127)", opaque: "Opaque (255)" }, calloutTypeMenu: { line: "Line", triangle: "Triangle" }, borderThicknessMenuItem: "Border Thickness", borderColorMenuItem: "Border Color...", fillColorMenuItem: "Fill Color...", lineThicknessMenuItem: "Thickness", lineColorMenuItem: "Color...", fontMenuItem: "Font...", opacityMenuItem: "Opacity", calloutTypeMenuItem: "Callout Type", calloutVisibleMenuItem: "Callout Visible", moveToBackMenuItem: "Move to Back", moveBackwardMenuItem: "Move Backward", moveForwardMenuItem: "Move Forward", moveToFrontMenuItem: "Move to Front", deleteMarkMenuItem: "Delete Mark", zoomToFitMenuItem: "Zoom to Fit", orientationMenuItem: "Orientation", mouseToolsMenuItem: "Mouse Tools", rectangleMarkPropertiesMenuItem: "Properties", textMarkPropertiesMenuItem: "Properties", polygonMarkPropertiesMenuItem: "Properties", polylineMarkPropertiesMenuItem: "Properties", lineMarkPropertiesMenuItem: "Properties", markOrderingMenuItem: "Ordering", stampMarkPropertiesMenuItem: "Properties", selectColor: "Select Color", selectFont: "Select Font", ok: "OK", cancel: "CANCEL", red: "Red", green: "Green", blue: "Blue", font: "Font", size: "Size", italic: "Italic", bold: "Bold", underline: "Underline", strikeout: "Strikeout" }; IPCC.Web.pI = function () { if (this.agH === undefined) { var Da = document.createElement("div"); Da.style.overflow = 'scroll'; Da.style.position = 'absolute'; Da.style.top = '-9999px'; document.body.appendChild(Da); this.agH = Da.offsetWidth - Da.clientWidth; document.body.removeChild(Da); } return this.agH; }; IPCC.Type.registerNamespace('IPCC.Web.UI'); IPCC.Web.UI.MouseTool = function () { }; IPCC.Web.UI.MouseTool.registerEnum = IPCC.Web.regEnum; IPCC.Web.UI.MouseTool.prototype = { None: 0, Magnifier: 1, RectangleZoom: 2, HandPan: 3, Select: 4, CreateRectangleMark: 5, CreateEllipseMark: 6, CreateLineMark: 7, CreatePolylineMark: 8, CreateFreehandMark: 9, CreatePolygonMark: 10, CreateTextMark: 11, EditMarks: 12, RunMarks: 13, SelectText: 14, CreateStampMark: 15, CreateHighlightTextMark: 16, CreateTextSelectionRedaction: 17, CreateRectangleRedactionMark: 18, CreateImageStampAnnotationMark: 19, CreateImageStampRedactionMark: 20, CreateTextHyperlinkMark: 21, CreateTextInputSignatureMark: 22, CreateStrikethroughMark: 23, CreateTextAreaSignatureMark: 24 }; IPCC.Web.UI.MouseTool.registerEnum('IPCC.Web.UI.MouseTool', false); IPCC.Web.UI.FitType = function () { }; IPCC.Web.UI.FitType.registerEnum = IPCC.Web.regEnum; IPCC.Web.UI.FitType.prototype = { FullImage: 0, FullWidth: 1, FullHeight: 2, ActualSize: 3, OneToOne: 4, Rectangle: 5 }; IPCC.Web.UI.FitType.registerEnum('IPCC.Web.UI.FitType', false); IPCC.Web.UI.ScrollBars = function () { }; IPCC.Web.UI.ScrollBars.registerEnum = IPCC.Web.regEnum; IPCC.Web.UI.ScrollBars.prototype = { None: 0, Both: 3, Auto: 4 }; IPCC.Web.UI.ScrollBars.registerEnum('IPCC.Web.UI.ScrollBars', false); IPCC.Web.UI.MarkHandleMode = function () { }; IPCC.Web.UI.MarkHandleMode.registerEnum = IPCC.Web.regEnum; IPCC.Web.UI.MarkHandleMode.prototype = { HideSideHandlesWhenClose: 0, HideCornerHandlesWhenClose: 1 }; IPCC.Web.UI.MarkHandleMode.registerEnum('IPCC.Web.UI.MarkHandleMode', false); IPCC.Web.UI.ImGearArtDataServices = function () { }; IPCC.Web.UI.ImGearArtDataServices.registerEnum = IPCC.Web.regEnum; IPCC.Web.UI.ImGearArtDataServices.prototype = { None: 0, ArtDataService: 1 }; IPCC.Web.UI.ImGearArtDataServices.registerEnum('IPCC.Web.UI.ImGearArtDataServices', false); IPCC.Web.UI.Rectangle = function (x, y, width, height) { if (width < 0) { x += width; width = -width; } if (height < 0) { y += height; height = -height; } this.x = x; this.y = y; this.width = width; this.height = height; return this; }; IPCC.Web.UI.Rectangle.prototype = { intersect: function (rectangle) { var aY = Math.max(this.x, rectangle.x); var ax = Math.min(this.x + this.width, rectangle.x + rectangle.width) - aY; var fJ = Math.max(this.y, rectangle.y); var cR = Math.min(this.y + this.height, rectangle.y + rectangle.height) - fJ; if (ax <= 0 || cR <= 0) { aY = fJ = ax = cR = 0; } this.x = aY; this.y = fJ; this.width = ax; this.height = cR; }, union: function (rectangle) { var ip = Math.min(this.x, rectangle.x); var _top = Math.min(this.y, rectangle.y); var iG = Math.max(this.x + this.width, rectangle.x + rectangle.width); var jY = Math.max(this.y + this.height, rectangle.y + rectangle.height); this.x = ip; this.y = _top; this.width = iG - ip; this.height = jY - _top; return this; }, scale: function (Vt, Su) { Su = Su || Vt; var ip = this.x * Vt; var _top = this.y * Su; var ax = this.width * Vt; var cR = this.height * Su; this.x = ip; this.y = _top; this.width = ax; this.height = cR; return this; }, toString: function () { return 'Rectangle(' + this.x + ', ' + this.y + ', ' + this.width + ', ' + this.height + ')'; }, contains: function (point) { return point.x >= this.x && point.y >= this.y && point.x < this.x + this.width && point.y < this.y + this.height; }, clone: function () { return new IPCC.Web.UI.Rectangle(this.x, this.y, this.width, this.height); }, equals: function (other) { return this.x === other.x && this.y === other.y && this.width === other.width && this.height === other.height; } }; IPCC.Web.UI.Rectangle.registerClass = IPCC.Web.regClass; IPCC.Web.UI.Rectangle.registerClass('IPCC.Web.UI.Rectangle'); IPCC.Web.UI.Point = function (x, y) { this.x = x; this.y = y; return this; }; IPCC.Web.UI.Point.prototype = { toString: function () { return 'Point(' + this.x + ', ' + this.y + ')'; }, constrain: function (rectangle) { this.x = Math.min(Math.max(this.x, rectangle.x), rectangle.x + rectangle.width); this.y = Math.min(Math.max(this.y, rectangle.y), rectangle.y + rectangle.height); } }; IPCC.Web.UI.Point.registerClass = IPCC.Web.regClass; IPCC.Web.UI.Point.registerClass('IPCC.Web.UI.Point'); IPCC.Web.UI.PointCollection = function () { var ag = []; var bC = new IPCC.Web.UI.fR(); this.arV = function (be) { var L = new IPCC.Web.UI.PointEventArgs(); L.point = be; L.length = 1; ag.push(new IPCC.Web.UI.Point(be.x, be.y)); L.index = ag.length - 1; this.aM('pointAdded', L); }; this.arn = function (apK) { var L = new IPCC.Web.UI.PointEventArgs(); L.index = ag.length; L.length = apK.get_length(); function nD(be) { ag.push(be); }; apK.forEach(nD, {}); if (L.length > 0) { this.aM('pointAdded', L); } }; this.mR = function (kg, ca) { var Yh = [].concat(ag); var G; for (G = 0; G < Yh.length; G++) { kg.call(ca, new IPCC.Web.UI.Point(Yh[G].x, Yh[G].y), G, this); } }; this.Bq = function (ak) { lO(ak); var eL = ag[ak]; return new IPCC.Web.UI.Point(eL.x, eL.y); }; this.aFM = function (ak, be) { lO(ak); IPCC.ad.be(be, 'point'); var Pz = ag[ak]; if (Pz.x === be.x && Pz.y === be.y) { return; } Pz.x = be.x; Pz.y = be.y; var L = new IPCC.Web.UI.PointEventArgs(); L.point = be; L.index = ak; L.length = 1; this.aM('pointChanged', L); }; this.fb = function () { return ag.length; }; this.aCT = function (ak) { lO(ak); var L = new IPCC.Web.UI.PointEventArgs(); L.point = ag[ak]; L.index = ak; L.length = 1; ag.splice(ak, 1); this.aM('pointRemoved', L); }; this.aCZ = function () { if (ag.length < 1) { return; } var L = new IPCC.Web.UI.PointEventArgs(); L.index = 0; L.length = ag.length; ag = []; this.aM('pointRemoved', L); }; this.amA = function (eW, fe) { if (eW === 0 && fe === 0) { return; } IPCC.ad.hL(eW, 'deltaX'); IPCC.ad.hL(fe, 'deltaY'); var G; for (G = 0; G < ag.length; G++) { ag[G].x += eW; ag[G].y += fe; } var L = new IPCC.Web.UI.PointEventArgs(); L.index = 0; L.length = ag.length; this.aM('pointChanged', L); }; this.wz = function () { if (ag.length < 1) { return new IPCC.Web.UI.Rectangle(0, 0, 0, 0); } var G, ip = ag[0].x, iG = ag[0].x, _top = ag[0].y, jY = ag[0].y; for (G = 1; G < ag.length; G++) { var be = ag[G]; ip = Math.min(ip, be.x); iG = Math.max(iG, be.x); _top = Math.min(_top, be.y); jY = Math.max(jY, be.y); } return new IPCC.Web.UI.Rectangle(ip, _top, iG - ip, jY - _top); }; function lO(ak) { if (ak > ag.length - 1 || (ak < 0)) { throw new IPCC.Web.UI.ImGearArgumentOutOfRangeException('index', ak); } }; this.atc = function (V) { bC.addHandler('pointAdded', V); }; this.aEJ = function (V) { bC.removeHandler('pointAdded', V); }; this.arY = function (V) { bC.addHandler('pointChanged', V); }; this.aDl = function (V) { bC.removeHandler('pointChanged', V); }; this.ase = function (V) { bC.addHandler('pointRemoved', V); }; this.aCX = function (V) { bC.removeHandler('pointRemoved', V); }; this.aM = function (cA, L) { var V = bC.getHandler(cA); if (V !== null) { V(this, L); } }; return this; }; IPCC.Web.UI.PointCollection.prototype = { toString: function () { return 'PointCollection with ' + this.get_length() + ' points'; }, addPoint: function (point) { this.arV(point); }, addPoints: function (pointCollection) { this.arn(pointCollection); }, forEach: function (method, context) { this.mR(method, context); }, getPoint: function (index) { return this.Bq(index); }, setPoint: function (index, point) { this.aFM(index, point); }, get_length: function () { return this.fb(); }, removePoint: function (index) { this.aCT(index); }, removeAllPoints: function () { this.aCZ(); }, moveAllPoints: function (deltaX, deltaY) { this.amA(deltaX, deltaY); }, add_pointAdded: function (handler) { this.atc(handler); }, remove_pointAdded: function (handler) { this.aEJ(handler); }, add_pointChanged: function (handler) { this.arY(handler); }, remove_pointChanged: function (handler) { this.aDl(handler); }, add_pointRemoved: function (handler) { this.ase(handler); }, remove_pointRemoved: function (handler) { this.aCX(handler); } }; IPCC.Web.UI.PointCollection.registerClass = IPCC.Web.regClass; IPCC.Web.UI.PointCollection.registerClass('IPCC.Web.UI.PointCollection'); IPCC.Web.UI.PageViewState = function () { return this; }; IPCC.Web.UI.PageViewState.prototype = { documentIdentifier: '', encodedDocumentIdentifier: '', pageNumber: 0, viewFitType: IPCC.Web.UI.FitType.FullImage, viewRectangle: new IPCC.Web.UI.Rectangle(0, 0, 0, 0), viewRotationDegreesClockwise: 0, viewMirror: false, viewZoomFactor: undefined, encryption: false }; IPCC.Web.UI.PageViewState.registerClass = IPCC.Web.regClass; IPCC.Web.UI.PageViewState.registerClass('IPCC.Web.UI.PageViewState'); IPCC.Web.UI.ThumbnailViewState = function () { return this; }; IPCC.Web.UI.ThumbnailViewState.prototype = { documentIdentifier: '', encodedDocumentIdentifier: '', pageNumber: 0, selected: false }; IPCC.Web.UI.ThumbnailViewState.registerClass = IPCC.Web.regClass; IPCC.Web.UI.ThumbnailViewState.registerClass('IPCC.Web.UI.ThumbnailViewState'); IPCC.Web.UI.LogItemEventArgs = function () { return this; }; IPCC.Web.UI.LogItemEventArgs.registerClass = IPCC.Web.regClass; IPCC.Web.UI.LogItemEventArgs.prototype = {}; IPCC.Web.UI.LogItemEventArgs.registerClass('IPCC.Web.UI.LogItemEventArgs'); IPCC.Web.UI.LogItem = IPCC.Web.UI.LogItemEventArgs; IPCC.Web.UI.MouseEventArgs = function () { var ahs = false; this.aAR = function () { ahs = true; }; this.agM = function () { return ahs; }; return this; }; IPCC.Web.UI.MouseEventArgs.prototype = { preventDefault: function () { this.aAR(); } }; IPCC.Web.UI.MouseEventArgs.registerClass = IPCC.Web.regClass; IPCC.Web.UI.MouseEventArgs.registerClass('IPCC.Web.UI.MouseEventArgs'); IPCC.Web.UI.MouseEvent = IPCC.Web.UI.MouseEventArgs; IPCC.Web.UI.PointEventArgs = function () { return this; }; IPCC.Web.UI.PointEventArgs.registerClass = IPCC.Web.regClass; IPCC.Web.UI.PointEventArgs.prototype = {}; IPCC.Web.UI.PointEventArgs.registerClass('IPCC.Web.UI.PointEventArgs'); IPCC.Web.UI.CommentEventArgs = function () { return this; }; IPCC.Web.UI.CommentEventArgs.registerClass = IPCC.Web.regClass; IPCC.Web.UI.CommentEventArgs.prototype = {}; IPCC.Web.UI.CommentEventArgs.registerClass('IPCC.Web.UI.CommentEventArgs'); IPCC.Web.UI.ImGearPageOpenFailedEventArgs = function () { return this; }; IPCC.Web.UI.ImGearPageOpenFailedEventArgs.registerClass = IPCC.Web.regClass; IPCC.Web.UI.ImGearPageOpenFailedEventArgs.prototype = {}; IPCC.Web.UI.ImGearPageOpenFailedEventArgs.registerClass('IPCC.Web.UI.ImGearPageOpenFailedEventArgs'); IPCC.Web.UI.TextSelectedEventArgs = function () { return this; }; IPCC.Web.UI.TextSelectedEventArgs.registerClass = IPCC.Web.regClass; IPCC.Web.UI.TextSelectedEventArgs.prototype = {}; IPCC.Web.UI.TextSelectedEventArgs.registerClass('IPCC.Web.UI.TextSelectedEventArgs'); IPCC.Web.UI.PageView = function (element, pN, St) { var es = this; var bf; var C; var rF = 0; var pp = ''; var Ae = false; var bC = new IPCC.Web.UI.fR(); var fs = null; var wk = IPCC.wk; var abZ = IPCC.wk; var Kl = 0.0; var Jb = false; var Sv = 0; var aqg = -1; var apQ = -1; var aro = -1; function it(wL) { if (!C) { return false; } return C.it(wL); }; this.bK = function (fH, hV) { if (it(IPCC.Web.UI.DebugErrorLevel.Production)) { C.bK(fH, hV); } }; this.aI = function (fH, eB, jB) { if (!it(IPCC.Web.UI.DebugErrorLevel.Development)) { return; } var aw = fH + '('; var G; for (G = 0; G < eB.length; G++) { if (G > 0) { aw += ', '; } aw += IPCC.gG.io(eB[G], (jB ? jB : 0)); } aw += ')'; this.mB(aw, IPCC.Web.UI.DebugErrorLevel.Development); }; this.wb = function (fH, eB, js, jB) { if (!it(IPCC.Web.UI.DebugErrorLevel.Development)) { return; } var aw = fH + '('; var G; for (G = 0; G < eB.length; G++) { if (G > 0) { aw += ', '; } aw += IPCC.gG.io(eB[G], (jB ? jB : 0)); } aw += ') = '; aw += IPCC.gG.io(js, 1); this.mB(aw, IPCC.Web.UI.DebugErrorLevel.Development); }; this.ah = function (fH, eB, js) { if (!it(IPCC.Web.UI.DebugErrorLevel.Detailed)) { return; } var aw = fH + '('; var G; for (G = 0; G < eB.length; G++) { if (G > 0) { aw += ', '; } aw += IPCC.gG.io(eB[G], 0); } aw += ') = '; aw += IPCC.gG.io(js, 1); this.mB(aw, IPCC.Web.UI.DebugErrorLevel.Detailed); }; this.mB = function (hb, as) { if (C) { C.iP(hb, IPCC.Web.UI.DebugItemCause.FunctionCall, as); } }; this.iP = function (hb) { if (C) { C.iP(hb, IPCC.Web.UI.DebugItemCause.Custom, IPCC.Web.UI.DebugErrorLevel.Production); } }; this.rC = function () { return C.get_debug(); }; this.Ck = function (F) { C.set_debug(F); }; this.pm = function () { return C.pm(); }; this.uG = function (F) { IPCC.ad.lm(F, 'value', IPCC.Web.UI.DebugErrorLevel); C.uG(F); }; this.aKr = function (F) { Jb = F; }; this.aHe = function () { return Jb; }; var qq = function () { if (C.cX() === undefined) { throw new IPCC.Web.UI.ImGearInvalidOperationException('You cannot perform this operation unless an image is open (and it has completed the opening process).'); } }; function du(cA, V) { bC.addHandler(cA, V); }; function dn(cA, V) { bC.removeHandler(cA, V); }; this.Jq = function (ll, dm) { C.aDx(ll, dm); }; this.aEc = function (dm, R) { C.xh(R); C.cn(); }; this.KN = function (V) { du('pageOpening', V); }; this.HJ = function (V) { dn('pageOpening', V); }; this.LW = function (V) { du('pageOpened', V); }; this.HD = function (V) { dn('pageOpened', V); }; this.Ya = function (V) { du('pageClosed', V); }; this.XW = function (V) { dn('pageClosed', V); }; this.BI = function (V) { du('pageOpenFailed', V); }; this.BD = function (V) { dn('pageOpenFailed', V); }; this.Lk = function (V) { du('pageDisplayed', V); }; this.GY = function (V) { dn('pageDisplayed', V); }; this.BS = function (V) { du('mouseDown', V); }; this.Fc = function (V) { dn('mouseDown', V); }; this.Dg = function (V) { du('mouseMove', V); }; this.Gs = function (V) { dn('mouseMove', V); }; this.Eu = function (V) { du('mouseUp', V); }; this.DH = function (V) { dn('mouseUp', V); }; this.WP = function (V) { du('contextMenu', V); }; this.WV = function (V) { dn('contextMenu', V); }; this.yd = function (V) { du('markAdded', V); }; this.zu = function (V) { dn('markAdded', V); }; this.We = function (V) { du('markCreating', V); }; this.Xe = function (V) { dn('markCreating', V); }; this.Fb = function (V) { du('markChanged', V); }; this.Gb = function (V) { dn('markChanged', V); }; this.yp = function (V) { du('markRemoved', V); }; this.zp = function (V) { dn('markRemoved', V); }; this.EY = function (V) { du('markReordered', V); }; this.Fu = function (V) { dn('markReordered', V); }; this.Qf = function (V) { du('marksLoaded', V); }; this.TW = function (V) { dn('marksLoaded', V); }; this.EJ = function (V) { du('markSelectionChanged', V); }; this.EO = function (V) { dn('markSelectionChanged', V); }; this.xq = function (V) { du('textPageReady', V); }; this.yI = function (V) { dn('textPageReady', V); }; this.YE = function (V) { du('selectTextMouseToolCompleted', V); }; this.Xd = function (V) { dn('selectTextMouseToolCompleted', V); }; this.XA = function (V) { du('exceptionThrown', V); }; this.ZI = function (V) { du('scaleChanged', V); }; this.WZ = function (V) { dn('scaleChanged', V); }; this.Wh = function (V) { dn('exceptionThrown', V); }; this.Cg = function (V) { du('textExtractionFailed', V); }; this.EU = function (V) { dn('textExtractionFailed', V); }; this.lg = function (V) { du('propertyChanged', V); }; this.nt = function (V) { dn('propertyChanged', V); }; var aM = function (cA, L) { try { var V; V = bC.getHandler(cA); if (V) { V(es, L); } } catch (e) { es.bK(cA + 'Event', e); } }; var jH = function (cA) { function qx(aB, L) { aM(cA, L); }; C['add_' + cA](qx); }; var MX = function (cA) { function qx(aB, L) { if (Ae && C.Ia()) { Eb(); } aM(cA, L); }; C['add_' + cA](qx); }; function Eb() { var dW, hC, sd; if (pp !== '') { sd = document.getElementById(pp); if (sd) { dW = es.wm(); hC = '{encodedDocumentIdentifier:"' + dW.encodedDocumentIdentifier; hC += '",pageNumber:' + dW.pageNumber.toString(); hC += ',viewFitType:' + dW.viewFitType.toString(); if (dW.viewRectangle && dW.viewFitType === IPCC.Web.UI.FitType.Rectangle) { hC += ',viewRectangle:{x:' + dW.viewRectangle.x.toFixed(5); hC += ',y:' + dW.viewRectangle.y.toFixed(5); hC += ',width:' + dW.viewRectangle.width.toFixed(5); hC += ',height:' + dW.viewRectangle.height.toFixed(5); hC += '}'; } if (dW.viewRotationDegreesClockwise) { hC += ',viewRotationDegreesClockwise:' + dW.viewRotationDegreesClockwise.toString(); } if (dW.viewMirror) { hC += ',viewMirror:' + dW.viewMirror.toString(); } if (dW.viewZoomFactor) { hC += ',viewZoomFactor:' + dW.viewZoomFactor.toString(); } if (Ae) { var aX = C.eI(); if (aX) { hC += ',artPageJson:"' + IPCC.gB.sv(aX.saveToJson()) + '"'; } } hC += '}'; sd.value = hC; } } }; var aaG = function () { function qx(aB, L) { var BW = true; switch (L.get_propertyName()) { case 'documentIdentifier': case 'pageNumber': case 'artPage': case 'includeArtInPostBack': case 'displayedPageRectangle': Eb(); break; case 'magnifierWindowPosition': case 'magnifierIsVisible': case 'cursor': case 'markCursor': case 'inProgressMark': case 'HV': case 'vM': BW = false; break; case 'HQ': if (C.Ia()) { Eb(); } BW = false; break; } if (BW) { aM('propertyChanged', L); } }; C.lg(qx); }; this.aba = function (aa) { IPCC.ad.lm(aa, 'type', IPCC.Web.UI.FitType); if (aa === IPCC.Web.UI.FitType.Rectangle) { throw new IPCC.Web.UI.ImGearArgumentException('type', 'The value must be a member of the IPCC.Web.UI.FitType enumeration (other than Rectangle).'); } qq(); fs = { aEu: true, viewFitType: aa }; Xq(); }; this.gJ = function () { return C.cX() !== undefined; }; this.kO = function () { qq(); return C.cX().width; }; this.iE = function () { qq(); return C.cX().height; }; this.aFb = function () { qq(); return C.cX().hi; }; this.aFk = function () { return C.bG().eV().Ew(); }; this.aFE = function () { qq(); return C.cX().hk; }; this.wK = function () { if (!C || !(C.cX())) { return ''; } return C.cX().get_identifier(); }; this.Dj = function () { if (!C || !(C.cX())) { return ''; } return C.cX().get_encodedIdentifier(); }; this.mc = function () { if (!C || !(C.cX())) { return -1; } return C.cX().aD; }; this.ZE = function () { if (!C || !(C.cX())) { return 0; } return C.cX().eD; }; this.alr = function () { var ap = C.cX(); if (!ap) { return new IPCC.Web.UI.Rectangle(0, 0, 0, 0); } var aU = C.ff(); aU.x = aU.y = 0; var ut = C.bG().eV(); ut.Ap(); var eJ = ut.ud(aU); if (eJ.x < 0) { eJ.width += eJ.x; eJ.x = 0; } if (eJ.y < 0) { eJ.height += eJ.y; eJ.y = 0; } if (eJ.x + eJ.width > ap.width) { eJ.width = ap.width - eJ.x; } if (eJ.y + eJ.height > ap.height) { eJ.height = ap.height - eJ.y; } return eJ; }; function Cq() { var cV = {}, ci = C.bG().eV(); cV.documentIdentifier = es.wK(); cV.encodedDocumentIdentifier = es.Dj(); cV.pageNumber = es.mc(); cV.artPage = es.eI(); cV.referenceDocumentIdentifier = es.wK(); cV.referencePageNumber = es.mc(); cV.viewFitType = IPCC.Web.UI.FitType.Rectangle; cV.viewRectangle = es.alr(); cV.imGearPage = es.lc(); cV.transientArtPage = es.mK(); var ce = ci.Ew(); if (ce !== 0) { cV.viewRotationDegreesClockwise = ce; } if (ci.Ki()) { cV.viewMirror = true; } return cV; }; this.SS = function (bh, cz) { C.SS(bh, cz); }; this.wm = function () { var cV; if (bf) { cV = new IPCC.Web.UI.PageViewState(); cV.documentIdentifier = bf.documentIdentifier; cV.encodedDocumentIdentifier = bf.encodedDocumentIdentifier; cV.pageNumber = bf.pageNumber; cV.artPage = bf.artPage; cV.artPageJson = bf.artPageJson; cV.referenceDocumentIdentifier = bf.documentIdentifier; cV.referencePageNumber = bf.pageNumber; cV.viewFitType = bf.viewFitType; cV.viewRectangle = bf.viewRectangle; cV.viewRotationDegreesClockwise = bf.viewRotationDegreesClockwise; cV.viewMirror = bf.viewMirror; cV.viewZoomFactor = bf.viewZoomFactor; cV.transientArtPage = bf.transientArtPage; } else { cV = Cq(); } return cV; }; this.TU = function (ab) { var aU = C.ff(); this.aiX(ab, { x: aU.width / 2, y: aU.height / 2 }); }; this.aiX = function (ab, fL) { IPCC.ad.mL(ab, 'factor', 1.01, 20); IPCC.ad.be(fL, 'point'); qq(); var bm = C.bG(); var bz = bm.eV(); var bb = C.cX(); var lW = bz.qs(); if (lW * ab > bb.sV) { ab = bb.sV / lW; } bz.xH(ab, ab, fL.x, fL.y); bz.kY(bb, C.ff()); fs = null; bm.lv(bz); }; this.UV = function (ab) { var aU = C.ff(); this.ahL(ab, { x: aU.width / 2, y: aU.height / 2 }); }; this.ahL = function (ab, fL) { IPCC.ad.mL(ab, 'factor', 1.01, 20); IPCC.ad.be(fL, 'point'); qq(); var bm = C.bG(); var bz = bm.eV(); var bb = C.cX(); var lW = bz.qs(); if (lW / ab < bb.uV) { ab = lW / bb.uV; } bz.xH(1 / ab, 1 / ab, fL.x, fL.y); bz.kY(bb, C.ff()); fs = null; bm.lv(bz); }; this.kD = function (ab) { var aU = C.ff(); this.awh(ab, { x: aU.width / 2, y: aU.height / 2 }); }; this.awh = function (ab, fL) { IPCC.ad.be(fL, 'point'); qq(); var bm = C.bG(); var bz = bm.eV(); var bb = C.cX(); var lW = bz.qs(); if (ab > bb.sV) { ab = bb.sV; } else if (ab < bb.uV) { ab = bb.uV; } bz.xH(ab / lW, ab / lW, fL.x, fL.y); bz.kY(bb, C.ff()); fs = null; bm.lv(bz); }; this.xW = function (tG) { IPCC.ad.WG(tG, 'degreesClockwise', [90, 180, 270, -90, -180, -270]); qq(); var bm = C.bG(); var bz = bm.eV(); var aU = C.ff(); bz.agn(tG, aU.width / 2, aU.height / 2); bz.kY(C.cX(), C.ff()); fs = null; bm.lv(bz); }; this.aoe = function () { qq(); var bm = C.bG(); var bz = bm.eV(); var aU = C.ff(); bz.xH(-1, 1, aU.width / 2, aU.height / 2); bz.kY(C.cX(), C.ff()); fs = null; bm.lv(bz); }; this.aFo = function (eJ) { IPCC.ad.h(eJ, 'pageRectangle'); qq(); var bm = C.bG(); var bz = bm.eV(); var aU = C.ff(); var bb = C.cX(); bz.Rr(bb, aU, eJ); bz.kY(bb, C.ff()); fs = null; bm.lv(bz); }; this.aGp = function (cS) { IPCC.ad.be(cS, 'imagePoint'); qq(); var bm = C.bG(); var bz = bm.eV(); var aU = C.ff(); bz.agy(aU, cS); bz.kY(C.cX(), C.ff()); fs = null; bm.lv(bz); }; this.akC = function () { qq(); fs = null; var bm = C.bG(); var bz = bm.eV(); var aU = C.ff(); bz.xH(1, -1, aU.width / 2, aU.height / 2); bz.kY(C.cX(), C.ff()); fs = null; bm.lv(bz); }; this.cn = function () { C.cn(); }; this.La = function () { C.La(); }; var Xq = function () { var bb = C.cX(); var aU = C.ff(); var bz; if (!fs) { bz = C.bG().eV(); bz.kY(bb, aU); C.bG().lv(bz); return; } if (fs.aEu) { bz = C.bG().eV(); } else { bz = new IPCC.ef(); bz.acW(bb, aU); if (fs.viewRotationDegreesClockwise) { bz.rotate(fs.viewRotationDegreesClockwise); } if (fs.viewMirror) { bz.axV(aU); } } if (fs.viewZoomFactor) { if (fs.viewZoomFactor > bb.sV) { fs.viewZoomFactor = bb.sV; } else if (fs.viewZoomFactor < bb.uV) { fs.viewZoomFactor = bb.uV; } fs.viewFitType = IPCC.Web.UI.FitType.ActualSize; bz.UB(fs.viewFitType, bb, aU); bz.scale(fs.viewZoomFactor, fs.viewZoomFactor); } else { if (!fs.viewFitType && fs.viewFitType !== 0) { fs.viewFitType = IPCC.Web.UI.FitType.FullImage; } if (fs.viewFitType === IPCC.Web.UI.FitType.Rectangle && !fs.viewRectangle) { fs.viewFitType = IPCC.Web.UI.FitType.FullImage; } if (fs.viewFitType !== IPCC.Web.UI.FitType.Rectangle) { bz.UB(fs.viewFitType, bb, aU); } else { bz.Rr(bb, aU, fs.viewRectangle); } } bz.kY(bb, aU); C.bG().lv(bz); }; var apu = function (Kg) { fs = Kg; Sv = 0; Xq(); }; this.aaK = function (eo) { var nU = false; if (IPCC.Web.nr.length > 0) { if (Array.prototype.indexOf) { if (IPCC.Web.nr.indexOf(eo) >= 0) { return true; } } else { if (IPCC.Web.hK(IPCC.Web.nr, eo) >= 0) { return true; } } } return nU; }; this.Fj = function (bo) { rF++; var KO = rF; var ace = {}; Kl = 0.0; C.SP = 0.0; IPCC.gB.Vh(bo); if (it(IPCC.Web.UI.DebugErrorLevel.Development)) { var aw = 'opening documentIdentifier "' + bo.documentIdentifier + '", pageNumber ' + bo.pageNumber; this.mB(aw, IPCC.Web.UI.DebugErrorLevel.Development); } bf = new IPCC.Web.UI.PageViewState(); var G; for (G in bo) { if (bo.hasOwnProperty(G)) { bf[G] = bo[G]; } } if (bo.documentIdentifier === '') { this.yM(); return; } if (IPCC.Web.UI.ArtPage) { if (bf) { if (!bf.artPage) { var aX = new IPCC.Web.UI.ArtPage(); if (bf.artPageJson) { aX.loadFromJson(bf.artPageJson); } bf.artPage = aX; } if (!bf.documentArtPage) { var eO = new IPCC.Web.UI.ArtPage(); bf.documentArtPage = eO; } if (this.iw() === true) { if (!bf.imGearPage) { var bY = new IPCC.Web.UI.ImGearDocument({ documentIdentifier: bo.documentIdentifier, imageServicePath: this.mz() }); bf.imGearPage = new IPCC.Web.UI.ImGearPage({ pageNumber: bo.pageNumber, bE: bY }); bY.get_pages().addPage(bf.imGearPage); } if (!bf.transientArtPage) { bf.transientArtPage = new IPCC.Web.UI.ArtPage(); } } } } if (bf.viewRotationDegreesClockwise) { IPCC.ad.WG(bf.viewRotationDegreesClockwise, 'parameters.viewRotationDegreesClockwise', [0, 90, 180, 270, -90, -180, -270]); } if (bf.viewFitType) { IPCC.ad.lm(bf.viewFitType, 'parameters.viewFitType', IPCC.Web.UI.FitType); } if (bf.viewZoomFactor) { IPCC.ad.mL(bf.viewZoomFactor, 'parameters.viewZoomFactor', 0, 20); } aM('pageOpening', bo); var ap = new IPCC.gB(bo.encodedDocumentIdentifier, bo.pageNumber, 0, 0, 0, 0); var mH = function () { if (KO !== rF) { return; } var pR = null; if (C.cX()) { pR = Cq(); } C.bG().ny(); C.xB(ap); apu(bf); if (bo.artServiceOption === IPCC.Web.UI.ImGearArtDataServices.ArtDataService) { if (bf) { if (bf.artPage) { C.kc(bf.artPage); C.eI().loadFromJson(ap.amZ); } } } else { if (bf) { if (bf.artPage) { C.kc(bf.artPage); } if (bf.documentArtPage) { C.LE(bf.documentArtPage); } if (C.iw() === true) { if (bf.imGearPage) { var Xs = bf.imGearPage.get_pageWidth(); var Zr = bf.imGearPage.get_pageHeight(); bf.imGearPage.iA(es.eG()); if (!Xs) { bf.imGearPage.FX(es.get_pageWidth()); } if (!Zr) { bf.imGearPage.FM(es.get_pageHeight()); } C.tO(bf.imGearPage); if (typeof (C.lc().Bx === 'function')) { if (!C.lc().cv().Ar()) { bf.imGearPage.tm(es.hT()); setTimeout(C.lc().Bx, 1000); } } } if (bf.transientArtPage) { C.uD(bf.transientArtPage); } } } } bf = null; if (pR) { aM('pageClosed', pR); } Eb(); aM('pageOpened', bo); }; if (bo.artServiceOption === IPCC.Web.UI.ImGearArtDataServices.ArtDataService) { if (bf) { if (!bf.artPageJson) { ap.axz(C.mz(), C, mH, ace); } else { ap.Nd(C.mz(), C, mH); } } } else { ap.Nd(C.mz(), C, mH); } }; this.yM = function () { rF++; if (!(C.cX())) { return; } var pR = Cq(); C.xB(undefined); C.kc(undefined); C.tO(undefined); C.uD(undefined); this.cn(); Eb(); var bg; bg = es.gx(); if (bg.igElements) { if (bg.igElements.su) { bg.igElements.su.Lw = null; bg.igElements.su.Iu = null; bg.igElements.su.LC = null; bg.igElements.su = null; } bg.igElements.Dz = null; bg.igElements.fT = null; bg.igElements.gD = null; bg.igElements.dA = null; bg.igElements.nI = null; bg.igElements.nd = null; bg.igElements.mX = null; bg.igElements.so = null; bg.igElements.QK = null; bg.igElements.UF = null; bg.igElements.sK = null; } es = null; bg.bB = null; aM('pageClosed', pR); }; this.axZ = function (bo) { rF++; var KO = rF; Kl = 0.0; C.SP = 0.0; IPCC.gB.Vh(bo); if (it(IPCC.Web.UI.DebugErrorLevel.Development)) { var aw = 'opening documentIdentifier "' + bo.documentIdentifier + '", pageNumber ' + bo.pageNumber; this.mB(aw, IPCC.Web.UI.DebugErrorLevel.Development); } bf = new IPCC.Web.UI.PageViewState(); var G; for (G in bo) { if (bo.hasOwnProperty(G)) { bf[G] = bo[G]; } } if (bo.documentIdentifier === '') { this.yM(); return; } if (IPCC.Web.UI.ArtPage) { if (bf) { if (!bf.artPage) { var aX = new IPCC.Web.UI.ArtPage(); bf.artPage = aX; } if (!bf.documentArtPage) { var eO = new IPCC.Web.UI.ArtPage(); bf.documentArtPage = eO; } if (this.iw() === true) { if (!bf.imGearPage) { var bY = new IPCC.Web.UI.ImGearDocument({ documentIdentifier: bo.documentIdentifier, imageServicePath: this.mz() }); bf.imGearPage = new IPCC.Web.UI.ImGearPage({ pageNumber: bo.pageNumber, bE: bY }); bY.get_pages().addPage(bf.imGearPage); } if (!bf.transientArtPage) { bf.transientArtPage = new IPCC.Web.UI.ArtPage(); } } } } if (bf.viewRotationDegreesClockwise) { IPCC.ad.WG(bf.viewRotationDegreesClockwise, 'parameters.viewRotationDegreesClockwise', [0, 90, 180, 270, -90, -180, -270]); } if (bf.viewFitType) { IPCC.ad.lm(bf.viewFitType, 'parameters.viewFitType', IPCC.Web.UI.FitType); } if (bf.viewZoomFactor) { IPCC.ad.mL(bf.viewZoomFactor, 'parameters.viewZoomFactor', 0, 20); } aM('pageOpening', bo); var ap = new IPCC.gB(bo.encodedDocumentIdentifier, bo.pageNumber, 0, 0, 0, 0); var mH = function () { if (KO !== rF) { return; } var pR = null; if (C.cX()) { pR = Cq(); } C.bG().ny(); C.xB(ap); apu(bf); if (bf) { if (bf.artPage) { C.kc(bf.artPage); } if (bf.documentArtPage) { C.LE(bf.documentArtPage); } if (C.iw() === true) { if (bf.imGearPage) { var Xs = bf.imGearPage.get_pageWidth(); var Zr = bf.imGearPage.get_pageHeight(); bf.imGearPage.iA(es.eG()); if (!Xs) { bf.imGearPage.FX(es.get_pageWidth()); } if (!Zr) { bf.imGearPage.FM(es.get_pageHeight()); } C.tO(bf.imGearPage); if (typeof (C.lc().Bx === 'function')) { if (!C.lc().cv().Ar()) { bf.imGearPage.tm(es.hT()); setTimeout(C.lc().Bx, 1000); } } } if (bf.transientArtPage) { C.uD(bf.transientArtPage); } } } bf = null; if (pR) { aM('pageClosed', pR); } Eb(); aM('pageOpened', bo); }; ap.axq(C.mz(), C, mH); }; this.aHl = function () { rF++; if (!(C.cX())) { return; } var ap = C.cX(); C.xB(undefined); this.cn(); C.xB(ap); }; this.Du = function (yX) { C.Du(yX); }; this.kc = function (F) { C.kc(F); }; this.eI = function () { return C.eI(); }; this.LE = function (F) { C.LE(F); }; this.Qr = function () { return C.Qr(); }; this.mK = function () { return C.mK(); }; this.uD = function (F) { C.uD(F); }; this.zI = function () { return C.zI(); }; this.Ze = function (F) { C.Ze(F); }; this.uR = function (F) { C.uR(F); }; this.nQ = function () { return C.nQ(); }; this.aIE = function (F) { abZ = this.aue(F); }; this.ju = function () { return abZ; }; this.Qn = function (F) { C.Qn(F); }; this.NC = function () { return C.NC(); }; this.kU = function () { return C.kU(); }; this.rq = function (F) { C.rq(F); }; this.zY = function (F) { C.zY(F); }; this.Mk = function () { return C.Mk(); }; this.Av = function (EK) { C.Av(EK); }; this.Ak = function () { return C.Ak(); }; this.aue = function (dN) { var aq = '', PZ = '', UH = function (aC) { var uc = 0, aq; for (aq in aC) { if (aC.hasOwnProperty(aq)) { uc += 1; } } return uc; }; for (aq in wk) { if (wk.hasOwnProperty(aq)) { if (typeof dN[aq] === 'undefined') { dN[aq] = wk[aq]; } if (typeof dN[aq] === 'object') { if (!UH(dN[aq])) { dN[aq] = wk[aq]; } else if (UH(dN[aq]) !== UH(wk[aq])) { for (PZ in wk[aq]) { if (typeof dN[aq][PZ] === 'undefined') { dN[aq][PZ] = wk[aq][PZ]; } } } } } } return dN; }; this.aGi = function (aGv) { if (aGv === false) { IPCC.jp = false; C.fz([new IPCC.qQ(), new IPCC.fN(), new IPCC.dK(), new IPCC.cY(false)]); } else { IPCC.jp = true; IPCC.agX = this.ju(); C.fz([new IPCC.qQ(), new IPCC.fN(), new IPCC.gf(), new IPCC.dK(), new IPCC.cY(false)]); } }; this.ny = function () { var bm = C.bG(); if (!bm.Cd()) { return; } C.bG().ny(); }; this.aGu = function (eJ) { IPCC.ad.h(eJ, 'pageRectangle'); var ap = C.cX(); if (ap) { C.bG().showSelection(eJ); } }; this.DO = function (cS) { IPCC.ad.be(cS, 'imagePoint'); if (C.cX()) { C.bG().DO(new IPCC.Web.UI.Point(cS.x, cS.y)); } }; this.Ei = function (cS) { IPCC.ad.be(cS, 'imagePoint'); if (C.cX()) { C.bG().Ei(new IPCC.Web.UI.Point(cS.x, cS.y)); } }; this.xf = function () { if (C.cX() && C.bG().Cd()) { return C.bG().xf(); } return new IPCC.Web.UI.Rectangle(0, 0, 0, 0); }; this.aET = function () { if (C.cX() && C.bG().Cd()) { var eJ = C.bG().xf(); return C.bG().eV().ud(eJ); } return new IPCC.Web.UI.Rectangle(0, 0, 0, 0); }; this.Cd = function () { return ! !(C.cX() && C.bG().Cd()); }; this.mz = function () { return C.mz(); }; this.Fi = function (F) { IPCC.ad.jt(F, 'value'); C.Fi(F); if (!IPCC.Web.rG) { if (IPCC.Web.uN === false) { IPCC.Web.OA(F); } } }; this.KM = function () { return pp; }; this.KP = function (F) { IPCC.ad.jt(F, 'value'); pp = F; }; this.ads = function () { return Ae; }; this.YP = function (F) { Ae = F; }; var lU = ''; this.rc = function (F) { C.rc(F); lU = F; }; this.gx = function () { return lU; }; this.aHI = function () { return C.bG().get_magnifierMagnification(); }; this.aHV = function (F) { IPCC.ad.mL(F, 'value', 1.5, 8); C.bG().set_magnifierMagnification(F); }; this.aEY = function () { return C.bG().vX().width; }; this.aIC = function (F) { IPCC.ad.mL(F, 'value', 25, 500); var uc = C.bG().vX(); uc.width = F; C.bG().set_magnifierWindowSize(uc); }; this.aHn = function () { return C.bG().vX().height; }; this.aHJ = function (F) { IPCC.ad.mL(F, 'value', 25, 500); var uc = C.bG().vX(); uc.height = F; C.bG().set_magnifierWindowSize(uc); }; this.RY = function () { return C.bG().RY(); }; this.Yp = function (F) { IPCC.ad.mL(F, 'value', -500, 500); C.bG().Yp(F); }; this.Sj = function () { return C.bG().Sj(); }; this.YN = function (F) { IPCC.ad.mL(F, 'value', -500, 500); C.bG().YN(F); }; this.adM = function () { return C.bG().adM(); }; this.Za = function (F) { IPCC.ad.mL(F, 'value', 0.1, 0.5); C.bG().Za(F); }; this.Cp = function () { return C.bG().Cp(); }; this.Mb = function (F) { C.bG().Mb(F); }; this.raisePropertyChanged = function (cr, zC) { if (C) { C.aL(cr, zC); } }; var bW = -1; this.adj = function () { return bW; }; this.aIQ = function (F) { C.rN = F; }; this.LJ = function (F) { IPCC.ad.lm(F, 'value', IPCC.Web.UI.MouseTool); if (bW !== F) { bW = F; var hS = "None"; switch (bW) { case IPCC.Web.UI.MouseTool.None: C.fz([]); break; case IPCC.Web.UI.MouseTool.Magnifier: if (IPCC.jp === true) { C.fz([new IPCC.wO(), new IPCC.fN(), new IPCC.gf(false, this.ju()), new IPCC.dK(), new IPCC.cY(false)]); } else { C.fz([new IPCC.wO(), new IPCC.fN(), new IPCC.dK(), new IPCC.cY(false)]); hS = "Magnifier"; } break; case IPCC.Web.UI.MouseTool.RectangleZoom: if (IPCC.jp === true) { C.fz([new IPCC.qQ(), new IPCC.fN(), new IPCC.gf(false, this.ju()), new IPCC.dK(), new IPCC.cY(false)]); } else { C.fz([new IPCC.qQ(), new IPCC.fN(), new IPCC.dK(), new IPCC.cY(false)]); } hS = "RectangleZoom"; break; case IPCC.Web.UI.MouseTool.HandPan: if (IPCC.jp === true) { C.fz([new IPCC.uy(), new IPCC.fN(), new IPCC.gf(false, this.ju()), new IPCC.dK(), new IPCC.cY(true)]); } else { C.fz([new IPCC.uy(), new IPCC.fN(), new IPCC.dK(), new IPCC.cY(true)]); } hS = "HandPan"; break; case IPCC.Web.UI.MouseTool.Select: if (IPCC.jp === true) { C.fz([new IPCC.ta(), new IPCC.fN(), new IPCC.gf(false, this.ju()), new IPCC.dK(), new IPCC.cY(false)]); } else { C.fz([new IPCC.ta(), new IPCC.fN(), new IPCC.dK(), new IPCC.cY(false)]); } hS = "Select"; break; case IPCC.Web.UI.MouseTool.CreateRectangleMark: if (IPCC.jp === true) { C.fz([new IPCC.fI(IPCC.Web.UI.MarkType.Rectangle), new IPCC.fN(), new IPCC.gf(true, this.ju()), new IPCC.dK(), new IPCC.cY(false)]); } else { C.fz([new IPCC.fI(IPCC.Web.UI.MarkType.Rectangle), new IPCC.fN(), new IPCC.dK(), new IPCC.cY(false)]); } hS = "CreateRectangleMark"; break; case IPCC.Web.UI.MouseTool.CreateRectangleRedactionMark: if (IPCC.jp === true) { C.fz([new IPCC.fI(IPCC.Web.UI.MarkType.RectangleRedaction), new IPCC.fN(), new IPCC.gf(true, this.ju()), new IPCC.dK(), new IPCC.cY(false)]); } else { C.fz([new IPCC.fI(IPCC.Web.UI.MarkType.RectangleRedaction), new IPCC.fN(), new IPCC.dK(), new IPCC.cY(false)]); } hS = "CreateRectangleRedactionMark"; break; case IPCC.Web.UI.MouseTool.CreateEllipseMark: if (IPCC.jp === true) { C.fz([new IPCC.fI(IPCC.Web.UI.MarkType.Ellipse), new IPCC.fN(), new IPCC.gf(true, this.ju()), new IPCC.dK(), new IPCC.cY(false)]); } else { C.fz([new IPCC.fI(IPCC.Web.UI.MarkType.Ellipse), new IPCC.fN(), new IPCC.dK(), new IPCC.cY(false)]); } hS = "CreateEllipseMark"; break; case IPCC.Web.UI.MouseTool.CreateLineMark: if (IPCC.jp === true) { C.fz([new IPCC.rJ(), new IPCC.fN(), new IPCC.gf(true, this.ju()), new IPCC.dK(), new IPCC.cY(false)]); } else { C.fz([new IPCC.rJ(), new IPCC.fN(), new IPCC.dK(), new IPCC.cY(false)]); } hS = "CreateLineMark"; break; case IPCC.Web.UI.MouseTool.CreatePolylineMark: if (IPCC.jp === true) { C.fz([new IPCC.pb(IPCC.Web.UI.MarkType.Polyline), new IPCC.fN(), new IPCC.gf(true, this.ju()), new IPCC.dK(), new IPCC.cY(false)]); } else { C.fz([new IPCC.pb(IPCC.Web.UI.MarkType.Polyline), new IPCC.fN(), new IPCC.dK(), new IPCC.cY(false)]); } hS = "CreatePolylineMark"; break; case IPCC.Web.UI.MouseTool.CreateFreehandMark: if (IPCC.jp === true) { C.fz([new IPCC.qb(), new IPCC.fN(), new IPCC.gf(true, this.ju()), new IPCC.dK(), new IPCC.cY(false)]); } else { C.fz([new IPCC.qb(), new IPCC.fN(), new IPCC.dK(), new IPCC.cY(false)]); } hS = "CreateFreehandMark"; break; case IPCC.Web.UI.MouseTool.CreatePolygonMark: if (IPCC.jp === true) { C.fz([new IPCC.pb(IPCC.Web.UI.MarkType.Polygon), new IPCC.fN(), new IPCC.gf(true, this.ju()), new IPCC.dK(), new IPCC.cY(false)]); } else { C.fz([new IPCC.pb(IPCC.Web.UI.MarkType.Polygon), new IPCC.fN(), new IPCC.dK(), new IPCC.cY(false)]); } hS = "CreatePolygonMark"; break; case IPCC.Web.UI.MouseTool.CreateTextMark: if (IPCC.jp === true) { C.fz([new IPCC.fI(IPCC.Web.UI.MarkType.Text), new IPCC.fN(), new IPCC.gf(true, this.ju()), new IPCC.dK(), new IPCC.cY(false)]); } else { C.fz([new IPCC.fI(IPCC.Web.UI.MarkType.Text), new IPCC.fN(), new IPCC.dK(), new IPCC.cY(false)]); } hS = "CreateTextMark"; break; case IPCC.Web.UI.MouseTool.CreateTextInputSignatureMark: if (IPCC.jp === true) { C.fz([new IPCC.fI(IPCC.Web.UI.MarkType.TextLine), new IPCC.fN(), new IPCC.gf(true, this.ju()), new IPCC.dK(), new IPCC.cY(false)]); } else { C.fz([new IPCC.fI(IPCC.Web.UI.MarkType.TextLine), new IPCC.fN(), new IPCC.dK(), new IPCC.cY(false)]); } hS = "CreateTextInputSignatureMark"; break; case IPCC.Web.UI.MouseTool.CreateTextAreaSignatureMark: C.fz([new IPCC.fI(IPCC.Web.UI.MarkType.TextAreaSignature), new IPCC.fN(), new IPCC.dK(), new IPCC.cY(false)]); hS = "CreateTextAreaSignatureMark"; break; case IPCC.Web.UI.MouseTool.EditMarks: if (IPCC.jp === true) { C.fz([new IPCC.oB(IPCC.Web.UI.MarkType.Text), new IPCC.fN(), new IPCC.gf(true, this.ju()), new IPCC.dK(), new IPCC.cY(false)]); } else { C.fz([new IPCC.oB(IPCC.Web.UI.MarkType.Text), new IPCC.fN(), new IPCC.dK(), new IPCC.cY(false)]); } hS = "EditMarks"; break; case IPCC.Web.UI.MouseTool.RunMarks: if (IPCC.jp === true) { C.fz([new IPCC.Oa(IPCC.Web.UI.MarkType.Text), new IPCC.fN(), new IPCC.gf(false, this.ju()), new IPCC.dK(), new IPCC.cY(false)]); } else { C.fz([new IPCC.Oa(IPCC.Web.UI.MarkType.Text), new IPCC.fN(), new IPCC.dK(), new IPCC.cY(false)]); } hS = "RunMarks"; break; case IPCC.Web.UI.MouseTool.CreateStampMark: if (IPCC.jp === true) { C.fz([new IPCC.fI(IPCC.Web.UI.MarkType.Stamp), new IPCC.fN(), new IPCC.gf(true, this.ju()), new IPCC.dK(), new IPCC.cY(false)]); } else { C.fz([new IPCC.fI(IPCC.Web.UI.MarkType.Stamp), new IPCC.fN(), new IPCC.dK(), new IPCC.cY(false)]); } hS = "CreateStampMark"; break; case IPCC.Web.UI.MouseTool.CreateImageStampAnnotationMark: if (IPCC.jp === true) { C.fz([new IPCC.fI(IPCC.Web.UI.MarkType.ImageStampAnnotation), new IPCC.fN(), new IPCC.gf(true, this.ju()), new IPCC.dK(), new IPCC.cY(false)]); } else { C.fz([new IPCC.fI(IPCC.Web.UI.MarkType.ImageStampAnnotation), new IPCC.fN(), new IPCC.dK(), new IPCC.cY(false)]); } hS = "CreateImageStampAnnotationMark"; break; case IPCC.Web.UI.MouseTool.CreateImageStampRedactionMark: if (IPCC.jp === true) { C.fz([new IPCC.fI(IPCC.Web.UI.MarkType.ImageStampRedaction), new IPCC.fN(), new IPCC.gf(true, this.ju()), new IPCC.dK(), new IPCC.cY(false)]); } else { C.fz([new IPCC.fI(IPCC.Web.UI.MarkType.ImageStampRedaction), new IPCC.fN(), new IPCC.dK(), new IPCC.cY(false)]); } hS = "CreateImageStampRedactionMark"; break; case IPCC.Web.UI.MouseTool.CreateHighlightTextMark: C.Jb = true; if (IPCC.jp === true) { C.fz([new IPCC.oI(), new IPCC.fN(), new IPCC.gf(false, this.ju()), new IPCC.dK(), new IPCC.cY(false)]); } else { C.fz([new IPCC.oI(), new IPCC.fN(), new IPCC.dK(), new IPCC.cY(false)]); } hS = "CreateHighlightTextMark"; break; case IPCC.Web.UI.MouseTool.SelectText: C.Jb = false; if (IPCC.jp === true) { C.fz([new IPCC.oI(), new IPCC.fN(), new IPCC.gf(false, this.ju()), new IPCC.dK(), new IPCC.cY(false)]); } else { C.fz([new IPCC.oI(), new IPCC.fN(), new IPCC.dK(), new IPCC.cY(false)]); } hS = "SelectText"; break; case IPCC.Web.UI.MouseTool.CreateStrikethroughMark: if (IPCC.jp === true) { C.fz([new IPCC.oI(), new IPCC.fN(), new IPCC.gf(true, this.ju()), new IPCC.dK(), new IPCC.cY(false)]); } else { C.fz([new IPCC.oI(), new IPCC.fN(), new IPCC.dK(), new IPCC.cY(false)]); } hS = "CreateStrikethroughMark"; break; } this.raisePropertyChanged('mouseTool', { mouseToolType: hS }); } }; this.Nx = function (aHr) { bW = -1; C.fz(aHr); }; this.aFi = function () { return C.bG().get_presentationQuality(); }; this.aHC = function (F) { IPCC.ad.mL(F, 'value', 0, 100); C.bG().set_presentationQuality(F); }; this.aFO = function () { return C.bG().get_scrollBars(); }; this.aDm = function (F) { IPCC.ad.lm(F, 'value', IPCC.Web.UI.ScrollBars); C.bG().set_scrollBars(F); }; this.axd = function (cS, aBF) { IPCC.ad.be(cS, 'imagePoint'); if (!(C.cX())) { return new IPCC.Web.UI.Point(0, 0); } var fL = C.bG().eV().transform(cS); if (aBF) { fL.constrain(C.ff()); } return fL; }; this.Lg = function (fL, aCM) { IPCC.ad.be(fL, 'windowPoint'); var ap = C.cX(); if (!ap) { return new IPCC.Web.UI.Point(0, 0); } var ut = C.bG().eV(); ut.Ap(); var cS = ut.transform(fL); if (aCM) { cS.constrain(ap); } return cS; }; function Wv() { var bg; bg = es.gx(); var aen = bg.clientWidth; var afn = bg.clientHeight; var aDL = (fs && fs.viewFitType === aqg && aen === apQ && afn === aro); if (aDL) { if (Sv > 2) { return; } Sv++; } else { aqg = fs ? fs.viewFitType : -1; apQ = aen; aro = afn; Sv = 0; } Xq(); }; function azk() { fs = null; }; function axg(aB, L) { switch (L.ee) { case IPCC.ft.ajC: es.aiX(1.25, L.Wb.windowPoint); break; case IPCC.ft.ahM: es.ahL(1.25, L.Wb.windowPoint); break; case IPCC.ft.XN: es.xW(L.F); break; case IPCC.ft.akA: es.akC(); break; case IPCC.ft.apr: es.aoe(); break; case IPCC.ft.ajx: es.aba(L.F); break; case IPCC.ft.afl: es.LJ(L.F); break; } }; this.iw = function () { return C.iw(); }; this.zr = function (F) { C.zr(F); }; this.cv = function () { return C.cv(); }; this.lc = function () { return C.lc(); }; this.tO = function (F) { C.tO(F); }; this.ou = function () { return C.get_requireRequestsOptimize(); }; this.tw = function (F) { C.tw(F); }; this.hT = function () { return C.hT(); }; this.tm = function (F) { C.tm(F); }; this.Ly = function (cS) { IPCC.ad.be(cS, 'imagePoint'); return C.Ly(cS); }; this.Cw = function (cQ) { C.Cw(cQ); }; this.WE = function () { C.WE(); }; this.QD = function (vm, cz) { var JZ = C.cv().gl().fb(); IPCC.ad.ps(vm, 'vm', 0, JZ - 1); C.QD(vm, cz); }; this.vk = function (cQ) { if (cQ === undefined) { C.bG().vk(cQ); return false; } var JZ = C.cv().gl().fb(); IPCC.ad.ps(cQ, 'textIndex', 0, JZ - 1); C.vk(cQ); return true; }; this.MR = function () { return ! !(C.cX() && C.iw() && C.cv().mw() === true && C.bG().MR()); }; this.acs = function () { var bm = C.bG(); bm.acs(); }; this.RO = function () { if (C.iw() && C.cv().mw() === true) { return Math.min(C.bG().aif(), C.bG().GZ()); } }; this.Gv = function () { if (C.iw() && C.cv().mw() === true) { return C.bG().Gv(); } }; this.Gz = function () { if (C.iw() && C.cv().mw() === true && C.bG().MR()) { return C.Gz(); } else { return ""; } }; this.GZ = function () { return C.bG().GZ(); }; this.atb = function () { return C.bG().get_cursor(); }; this.aIk = function (F) { C.bG().set_cursor(F); }; this.CK = function () { return C.CK(); }; this.Yw = function (F) { C.Yw(F); }; this.eG = function () { return C.eG(); }; this.iA = function (F) { C.iA(F); }; this.aCf = function () { C.bG().hideMagnifier(); }; this.aGz = function (fL) { C.bG().showMagnifier(fL); }; this.xh = function (R) { if (C.le().igElements) { C.xh(R); C.cn(); } }; this.KU = function () { C.KU(); }; this.Fa = function () { return C.Fa(); }; this.sm = function () { if (C.le().igElements) { C.sm(true); } }; function aAL(aB, L) { var yh = L.scaleFactor; var bx = { scaleType: "scaledDown", pageNumber: L.pageNumber }; if (Kl !== yh) { if (yh > Kl) { bx.scaleType = "scaledUp"; } Kl = yh; aM('scaleChanged', bx); } }; this.initialize = function () { C.act(this.gx().id); C.rc(this.gx().id); if (bW === -1) { this.LJ(IPCC.Web.UI.MouseTool.RectangleZoom); } jH('mouseDown'); jH('mouseMove'); jH('mouseUp'); jH('contextMenu'); jH('markCreating'); jH('pageOpenFailed'); jH('textPageReady'); jH('pageDisplayed'); jH('exceptionThrown'); jH('selectTextMouseToolCompleted'); MX('markAdded'); MX('markChanged'); MX('markRemoved'); jH('textExtractionFailed'); MX('markReordered'); MX('marksLoaded'); jH('markSelectionChanged'); aaG(); C.amw(Wv); C.asI(azk); C.aIs(axg); C.add_scaleChanged(aAL); C.aoV(); var bg = this.gx(); bg.bB = this; }; pN = (pN !== false); C = new IPCC.ajb(pN); C.aeT('PageView'); C.aEI(St); }; IPCC.Web.UI.PageView.prototype = { dispose: function () { this.aI('dispose', arguments); this.yM(); }, get_debug: function () { try { var ac = this.rC(); this.ah('get_debug', arguments, ac); return ac; } catch (e) { this.bK('get_debug', e); throw e; } }, set_debug: function (value) { try { this.aI('set_debug', arguments); var oD = this.rC(); this.Ck(value); if (!oD) { this.aI('set_debug', arguments); } } catch (e) { this.bK('set_debug', e); throw e; } }, get_debugErrorLevel: function () { try { var ac = this.pm(); this.ah('get_debugErrorLevel', arguments, ac); return ac; } catch (e) { this.bK('get_debugErrorLevel', e); throw e; } }, set_debugErrorLevel: function (value) { try { this.aI('set_debugErrorLevel', arguments); var oD = this.pm(); this.uG(value); if (oD < IPCC.Web.UI.DebugErrorLevel.Development) { this.aI('set_debugErrorLevel', arguments); } } catch (e) { this.bK('set_debugErrorLevel', e); throw e; } }, get_artServiceOption: function () { try { var ac = this.Ak(); this.ah('get_artServiceOption', arguments, ac); return ac; } catch (e) { this.bK('get_artServiceOption', e); throw e; } }, set_artServiceOption: function (value) { try { this.aI('set_artServiceOption', arguments); this.Av(value); } catch (e) { this.bK('set_artServiceOption', e); throw e; } }, add_pageOpening: function (handler) { try { this.KN(handler); } catch (e) { this.bK('add_pageOpening', e); throw e; } }, remove_pageOpening: function (handler) { try { this.HJ(handler); } catch (e) { this.bK('remove_pageOpening', e); throw e; } }, add_pageOpened: function (handler) { try { this.LW(handler); } catch (e) { this.bK('add_pageOpened', e); throw e; } }, remove_pageOpened: function (handler) { try { this.HD(handler); } catch (e) { this.bK('remove_pageOpened', e); throw e; } }, add_pageClosed: function (handler) { try { this.Ya(handler); } catch (e) { this.bK('add_pageClosed', e); throw e; } }, remove_pageClosed: function (handler) { try { this.XW(handler); } catch (e) { this.bK('remove_pageClosed', e); throw e; } }, add_pageOpenFailed: function (handler) { try { this.BI(handler); } catch (e) { this.bK('add_pageOpenFailed', e); throw e; } }, remove_pageOpenFailed: function (handler) { try { this.BD(handler); } catch (e) { this.bK('remove_pageOpenFailed', e); throw e; } }, add_pageDisplayed: function (handler) { try { this.Lk(handler); } catch (e) { this.bK('add_pageDisplayed', e); throw e; } }, remove_pageDisplayed: function (handler) { try { this.GY(handler); } catch (e) { this.bK('remove_pageDisplayed', e); throw e; } }, add_mouseDown: function (handler) { try { this.BS(handler); } catch (e) { this.bK('add_mouseDown', e); throw e; } }, remove_mouseDown: function (handler) { try { this.Fc(handler); } catch (e) { this.bK('remove_mouseDown', e); throw e; } }, add_mouseMove: function (handler) { try { this.Dg(handler); } catch (e) { this.bK('add_mouseMove', e); throw e; } }, remove_mouseMove: function (handler) { try { this.Gs(handler); } catch (e) { this.bK('remove_mouseMove', e); throw e; } }, add_mouseUp: function (handler) { try { this.Eu(handler); } catch (e) { this.bK('add_mouseUp', e); throw e; } }, remove_mouseUp: function (handler) { try { this.DH(handler); } catch (e) { this.bK('remove_mouseUp', e); throw e; } }, add_contextMenu: function (handler) { try { this.WP(handler); } catch (e) { this.bK('add_contextMenu', e); throw e; } }, remove_contextMenu: function (handler) { try { this.WV(handler); } catch (e) { this.bK('remove_contextMenu', e); throw e; } }, add_markAdded: function (handler) { try { this.yd(handler); } catch (e) { this.bK('add_markAdded', e); throw e; } }, remove_markAdded: function (handler) { try { this.zu(handler); } catch (e) { this.bK('remove_markAdded', e); throw e; } }, add_markCreating: function (handler) { try { this.We(handler); } catch (e) { this.bK('add_markCreating', e); throw e; } }, remove_markCreating: function (handler) { try { this.Xe(handler); } catch (e) { this.bK('remove_markCreating', e); throw e; } }, add_markChanged: function (handler) { try { this.Fb(handler); } catch (e) { this.bK('add_markChanged', e); throw e; } }, remove_markChanged: function (handler) { try { this.Gb(handler); } catch (e) { this.bK('remove_markChanged', e); throw e; } }, add_markRemoved: function (handler) { try { this.yp(handler); } catch (e) { this.bK('add_markRemoved', e); throw e; } }, remove_markRemoved: function (handler) { try { this.zp(handler); } catch (e) { this.bK('remove_markRemoved', e); throw e; } }, add_markReordered: function (handler) { try { this.EY(handler); } catch (e) { this.bK('add_markReordered', e); throw e; } }, remove_markReordered: function (handler) { try { this.Fu(handler); } catch (e) { this.bK('remove_markReordered', e); throw e; } }, add_marksLoaded: function (handler) { try { this.Qf(handler); } catch (e) { this.bK('add_marksLoaded', e); throw e; } }, remove_marksLoaded: function (handler) { try { this.TW(handler); } catch (e) { this.bK('remove_marksLoaded', e); throw e; } }, add_markSelectionChanged: function (handler) { try { this.EJ(handler); } catch (e) { this.bK('add_markSelectionChanged', e); throw e; } }, remove_markSelectionChanged: function (handler) { try { this.EO(handler); } catch (e) { this.bK('remove_markSelectionChanged', e); throw e; } }, add_selectTextMouseToolCompleted: function (handler) { try { this.YE(handler); } catch (e) { this.bK('add_selectTextMouseToolCompleted', e); throw e; } }, remove_selectTextMouseToolCompleted: function (handler) { try { this.Xd(handler); } catch (e) { this.bK('remove_selectTextMouseToolCompleted', e); throw e; } }, add_textPageReady: function (handler) { try { this.xq(handler); } catch (e) { this.bK('add_textPageReady', e); throw e; } }, remove_textPageReady: function (handler) { try { this.yI(handler); } catch (e) { this.bK('remove_textPageReady', e); throw e; } }, add_exceptionThrown: function (handler) { this.XA(handler); }, remove_exceptionThrown: function (handler) { this.Wh(handler); }, add_scaleChanged: function (handler) { try { this.ZI(handler); } catch (e) { this.bK('add_scaleChanged', e); throw e; } }, remove_scaleChanged: function (handler) { try { this.WZ(handler); } catch (e) { this.bK('remove_scaleChanged', e); throw e; } }, add_propertyChanged: function (handler) { try { this.lg(handler); } catch (e) { this.bK('add_propertyChanged', e); throw e; } }, remove_propertyChanged: function (handler) { try { this.nt(handler); } catch (e) { this.bK('remove_propertyChanged', e); throw e; } }, add_textExtractionFailed: function (handler) { this.Cg(handler); }, remove_textExtractionFailed: function (handler) { this.EU(handler); }, writeToLog: function (message) { try { this.iP(message); } catch (e) { this.bK('writeToLog', e); throw e; } }, fitPage: function (type) { try { this.aI('fitPage', arguments); this.aba(type); } catch (e) { this.bK('fitPage', e); throw e; } }, get_pageIsOpen: function () { try { var ac = this.gJ(); this.ah('get_pageIsOpen', arguments, ac); return ac; } catch (e) { this.bK('get_pageIsOpen', e); throw e; } }, get_pageWidth: function () { try { var ac = this.kO(); this.ah('get_pageWidth', arguments, ac); return ac; } catch (e) { this.bK('get_pageWidth', e); throw e; } }, get_pageHeight: function () { try { var ac = this.iE(); this.ah('get_pageHeight', arguments, ac); return ac; } catch (e) { this.bK('get_pageHeight', e); throw e; } }, get_pageXResolution: function () { try { var ac = this.aFb(); this.ah('get_pageXResolution', arguments, ac); return ac; } catch (e) { this.bK('get_pageXResolution', e); throw e; } }, get_pageYResolution: function () { try { var ac = this.aFE(); this.ah('get_pageYResolution', arguments, ac); return ac; } catch (e) { this.bK('get_pageYResolution', e); throw e; } }, get_documentIdentifier: function () { try { var ac = this.wK(); this.ah('get_documentIdentifier', arguments, ac); return ac; } catch (e) { this.bK('get_documentIdentifier', e); throw e; } }, get_encodedDocumentIdentifier: function () { try { var ac = this.Dj(); this.ah('get_encodedDocumentIdentifier', arguments, ac); return ac; } catch (e) { this.bK('get_encodedDocumentIdentifier', e); throw e; } }, get_pageNumber: function () { try { var ac = this.mc(); this.ah('get_pageNumber', arguments, ac); return ac; } catch (e) { this.bK('get_pageNumber', e); throw e; } }, get_documentPageCount: function () { try { var ac = this.ZE(); this.ah('get_documentPageCount', arguments, ac); return ac; } catch (e) { this.bK('get_documentPageCount', e); throw e; } }, get_displayedPageRectangle: function () { try { var ac = this.alr(); this.ah('get_displayedPageRectangle', arguments, ac); return ac; } catch (e) { this.bK('get_displayedPageRectangle', e); throw e; } }, get_currentState: function () { try { var ac = this.wm(); this.ah('get_currentState', arguments, ac); return ac; } catch (e) { this.bK('get_currentState', e); throw e; } }, zoomIn: function (factor) { try { this.aI('zoomIn', arguments); this.TU(factor); } catch (e) { this.bK('zoomIn', e); throw e; } }, zoomOut: function (factor) { try { this.aI('zoomOut', arguments); this.UV(factor); } catch (e) { this.bK('zoomOut', e); throw e; } }, zoom: function (factor) { try { this.aI('zoom', arguments); this.kD(factor); } catch (e) { this.bK('zoom', e); throw e; } }, rotate: function (degreesClockwise) { try { this.aI('rotate', arguments); this.xW(degreesClockwise); } catch (e) { this.bK('rotate', e); throw e; } }, showPageRectangle: function (imageRectangle) { try { this.aI('showPageRectangle', arguments, 1); this.aFo(imageRectangle); } catch (e) { this.bK('showPageRectangle', e); throw e; } }, showPagePointAtCenter: function (imagePoint) { try { this.aI('showPagePointAtCenter', arguments, 1); this.aGp(imagePoint); } catch (e) { this.bK('showPagePointAtCenter', e); throw e; } }, mirror: function () { try { this.aI('mirror', arguments); this.aoe(); } catch (e) { this.bK('mirror', e); throw e; } }, flip: function () { try { this.aI('flip', arguments); this.akC(); } catch (e) { this.bK('flip', e); throw e; } }, display: function () { try { this.aI('display', arguments); this.cn(); } catch (e) { this.bK('display', e); throw e; } }, openPage: function (parameters) { try { this.aI('openPage', arguments, 1); this.Fj(parameters); } catch (e) { this.bK('openPage', e); throw e; } }, closePage: function () { try { this.aI('closePage', arguments); this.yM(); } catch (e) { this.bK('closePage', e); throw e; } }, hideSelection: function () { try { this.aI('hideSelection', arguments); this.ny(); } catch (e) { this.bK('hideSelection', e); throw e; } }, showSelection: function (imageRectangle) { try { this.aI('showSelection', arguments); this.aGu(imageRectangle); } catch (e) { this.bK('showSelection', e); throw e; } }, showEmptySelection: function (imagePoint) { try { this.aI('showEmptySelection', arguments); this.DO(imagePoint); } catch (e) { this.bK('showEmptySelection', e); throw e; } }, extendSelection: function (imagePoint) { try { this.aI('extendSelection', arguments); this.Ei(imagePoint); } catch (e) { this.bK('extendSelection', e); throw e; } }, saveArtPage: function (onSave) { try { this.aI('saveArtPage', arguments); this.Du(onSave); } catch (e) { this.bK('saveArtPage', e); throw e; } }, get_selectionPageRectangle: function () { try { var ac = this.xf(); this.ah('get_selectionPageRectangle', arguments, ac); return ac; } catch (e) { this.bK('get_selectionPageRectangle', e); throw e; } }, get_selectionWindowRectangle: function () { try { var ac = this.aET(); this.ah('get_selectionWindowRectangle', arguments, ac); return ac; } catch (e) { this.bK('get_selectionWindowRectangle', e); throw e; } }, get_selectionIsVisible: function () { try { var ac = this.Cd(); this.ah('get_selectionIsVisible', arguments, ac); return ac; } catch (e) { this.bK('get_selectionIsVisible', e); throw e; } }, get_controlStateElementId: function () { try { var ac = this.KM(); this.ah('get_controlStateElementId', arguments, ac); return ac; } catch (e) { this.bK('get_controlStateElementId', e); throw e; } }, set_controlStateElementId: function (value) { try { this.aI('set_controlStateElementId', arguments); this.KP(value); } catch (e) { this.bK('set_controlStateElementId', e); throw e; } }, get_includeArtInPostBack: function () { try { var ac = this.ads(); this.ah('get_includeArtInPostBack', arguments, ac); return ac; } catch (e) { this.bK('get_includeArtInPostBack', e); throw e; } }, set_includeArtInPostBack: function (value) { try { this.aI('set_includeArtInPostBack', arguments); this.YP(value); } catch (e) { this.bK('set_includeArtInPostBack', e); throw e; } }, get_artPage: function () { try { var ac = this.eI(); this.ah('get_artPage', arguments, ac); return ac; } catch (e) { this.bK('get_artPage', e); throw e; } }, set_artPage: function (value) { try { this.aI('set_artPage', arguments); this.kc(value); } catch (e) { this.bK('set_artPage', e); throw e; } }, get_documentArtPage: function () { try { var ac = this.Qr(); this.ah('get_documentArtPage', arguments, ac); return ac; } catch (e) { this.bK('get_documentArtPage', e); throw e; } }, set_documentArtPage: function (value) { try { this.aI('set_documentArtPage', arguments); this.LE(value); } catch (e) { this.bK('set_documentArtPage', e); throw e; } }, get_transientArtPage: function () { try { var ac = this.mK(); this.ah('get_transientArtPage', arguments, ac); return ac; } catch (e) { this.bK('get_transientArtPage', e); throw e; } }, set_transientArtPage: function (value) { try { this.aI('set_transientArtPage', arguments); this.uD(value); } catch (e) { this.bK('set_transientArtPage', e); throw e; } }, get_imageHandlerUrl: function () { try { var ac = this.mz(); this.ah('get_imageHandlerUrl', arguments, ac); return ac; } catch (e) { this.bK('get_imageHandlerUrl', e); throw e; } }, set_imageHandlerUrl: function (value) { try { this.aI('set_imageHandlerUrl', arguments); this.Fi(value); } catch (e) { this.bK('set_imageHandlerUrl', e); throw e; } }, get_resourcePath: function () { try { var ac = this.nQ(); this.ah('get_resourcePath', arguments, ac); return ac; } catch (e) { this.bK('get_resourcePath', e); throw e; } }, set_resourcePath: function (F) { try { this.aI('set_resourcePath', arguments); this.uR(F); } catch (e) { this.bK('set_resourcePath', e); throw e; } }, get_contextMenuLanguageDictionary: function () { try { var ac = this.ju(); this.ah('get_contextMenuLanguageDictionary', arguments, ac); return ac; } catch (e) { this.bK('get_contextMenuLanguageDictionary', e); throw e; } }, set_contextMenuLanguageDictionary: function (F) { try { this.aI('set_contextMenuLanguageDictionary', arguments); this.aIE(F); } catch (e) { this.bK('set_contextMenuLanguageDictionary', e); throw e; } }, get_textRequired: function () { try { var ac = this.iw(); this.ah('get_textRequired', arguments, ac); return ac; } catch (e) { this.bK('get_textRequired', e); throw e; } }, set_textRequired: function (F) { try { this.aI('set_textRequired', arguments); this.zr(F); } catch (e) { this.bK('set_textRequired', e); throw e; } }, get_textPage: function () { try { var ac = this.cv(); this.ah('get_textPage', arguments, ac); return ac; } catch (e) { this.bK('get_textPage', e); throw e; } }, get_textSelectionIsVisible: function () { try { var ac = this.MR(); this.wb('textSelectionIsVisible', arguments, ac, 1); return ac; } catch (e) { this.bK('textSelectionIsVisible', e); throw e; } }, getSelectedText: function () { try { var ac = this.Gz(); this.wb('getSelectedText', arguments, ac, 1); return ac; } catch (e) { this.bK('getSelectedText', e); throw e; } }, get_requireRequestsOptimize: function () { try { var ac = this.ou(); this.ah('get_requireRequestsOptimize', arguments, ac); return ac; } catch (e) { this.bK('ou', e); throw e; } }, set_requireRequestsOptimize: function (value) { try { this.aI('set_requireRequestsOptimize', arguments); this.tw(value); } catch (e) { this.bK('set_requireRequestsOptimize', e); throw e; } }, get_magnifierMagnification: function () { try { var ac = this.aHI(); this.ah('get_magnifierMagnification', arguments, ac); return ac; } catch (e) { this.bK('get_magnifierMagnification', e); throw e; } }, set_magnifierMagnification: function (value) { try { this.aI('set_magnifierMagnification', arguments); this.aHV(value); } catch (e) { this.bK('set_magnifierMagnification', e); throw e; } }, get_magnifierWidth: function () { try { var ac = this.aEY(); this.ah('get_magnifierWidth', arguments, ac); return ac; } catch (e) { this.bK('get_magnifierWidth', e); throw e; } }, set_magnifierWidth: function (value) { try { this.aI('set_magnifierWidth', arguments); this.aIC(value); } catch (e) { this.bK('set_magnifierWidth', e); throw e; } }, get_magnifierHeight: function () { try { var ac = this.aHn(); this.ah('get_magnifierHeight', arguments, ac); return ac; } catch (e) { this.bK('get_magnifierHeight', e); throw e; } }, set_magnifierHeight: function (value) { try { this.aI('set_magnifierHeight', arguments); this.aHJ(value); } catch (e) { this.bK('set_magnifierHeight', e); throw e; } }, get_magnifierXOffset: function () { try { var ac = this.RY(); this.ah('get_magnifierXOffset', arguments, ac); return ac; } catch (e) { this.bK('get_magnifierXOffset', e); throw e; } }, set_magnifierXOffset: function (value) { try { this.aI('set_magnifierXOffset', arguments); this.Yp(value); } catch (e) { this.bK('set_magnifierXOffset', e); throw e; } }, get_magnifierYOffset: function () { try { var ac = this.Sj(); this.ah('get_magnifierYOffset', arguments, ac); return ac; } catch (e) { this.bK('get_magnifierYOffset', e); throw e; } }, set_magnifierYOffset: function (value) { try { this.aI('set_magnifierYOffset', arguments); this.YN(value); } catch (e) { this.bK('set_magnifierYOffset', e); throw e; } }, showMagnifier: function (windowPoint) { try { this.aI('showMagnifier', arguments, 1); this.aGz(windowPoint); } catch (e) { this.bK('showMagnifier', e); throw e; } }, hideMagnifier: function () { try { this.aI('hideMagnifier', arguments); this.aCf(); } catch (e) { this.bK('hideMagnifier', e); throw e; } }, get_markHandleSize: function () { try { var ac = this.adM(); this.ah('get_markHandleSize', arguments, ac); return ac; } catch (e) { this.bK('get_markHandleSize', e); throw e; } }, set_markHandleSize: function (value) { try { this.aI('set_markHandleSize', arguments); this.Za(value); } catch (e) { this.bK('set_markHandleSize', e); throw e; } }, get_markHandleMode: function () { try { var ac = this.Cp(); this.ah('get_markHandleMode', arguments, ac); return ac; } catch (e) { this.bK('get_markHandleMode', e); throw e; } }, set_markHandleMode: function (value) { try { this.aI('set_markHandleMode', arguments); this.Mb(value); } catch (e) { this.bK('set_markHandleMode', e); throw e; } }, get_mouseTool: function () { try { var ac = this.adj(); this.ah('get_mouseTool', arguments, ac); return ac; } catch (e) { this.bK('get_mouseTool', e); throw e; } }, set_mouseTool: function (value) { try { this.aI('set_mouseTool', arguments); this.LJ(value); } catch (e) { this.bK('set_mouseTool', e); throw e; } }, get_presentationQuality: function () { try { var ac = this.aFi(); this.ah('get_presentationQuality', arguments, ac); return ac; } catch (e) { this.bK('get_presentationQuality', e); throw e; } }, set_presentationQuality: function (value) { try { this.aI('set_presentationQuality', arguments); this.aHC(value); } catch (e) { this.bK('set_presentationQuality', e); throw e; } }, get_scrollBars: function () { try { var ac = this.aFO(); this.ah('get_scrollBars', arguments, ac); return ac; } catch (e) { this.bK('get_scrollBars', e); throw e; } }, set_scrollBars: function (value) { try { this.aI('set_scrollBars', arguments); this.aDm(value); } catch (e) { this.bK('set_scrollBars', e); throw e; } }, get_imGearPage: function () { try { var ac = this.lc(); this.ah('get_imGearPage', arguments, ac); return ac; } catch (e) { this.bK('get_imGearPage', e); throw e; } }, set_imGearPage: function (value) { try { this.aI('set_imGearPage', arguments); this.tO(value); } catch (e) { this.bK('set_imGearPage', e); throw e; } }, get_serviceResponseTimeout: function () { try { var ac = this.hT(); this.ah('get_serviceResponseTimeout', arguments, ac); return ac; } catch (e) { this.bK('get_serviceResponseTimeout', e); throw e; } }, set_serviceResponseTimeout: function (value) { try { this.aI('set_serviceResponseTimeout', arguments); this.tm(value); } catch (e) { this.bK('set_serviceResponseTimeout', e); throw e; } }, get_currentTextIndex: function () { try { var ac = this.GZ(); this.ah('get_currentTextIndex', arguments, ac); return ac; } catch (e) { this.bK('get_currentTextIndex', e); throw e; } }, get_cursor: function () { try { var ac = this.atb(); this.ah('get_cursor', arguments, ac); return ac; } catch (e) { this.bK('get_cursor', e); throw e; } }, set_cursor: function (value) { try { this.aI('set_cursor', arguments); this.aIk(value); } catch (e) { this.bK('set_cursor', e); throw e; } }, get_encryption: function () { try { var ac = this.eG(); this.ah('get_encryption', arguments, ac); return ac; } catch (e) { this.bK('get_encryption', e); throw e; } }, set_encryption: function (value) { try { this.aI('set_encryption', arguments); this.iA(value); } catch (e) { this.bK('set_encryption', e); throw e; } }, transformPagePointToWindow: function (imagePoint, constrainResultToWindow) { try { var ac = this.axd(imagePoint, constrainResultToWindow); this.wb('transformPagePointToWindow', arguments, ac, 1); return ac; } catch (e) { this.bK('transformPagePointToWindow', e); throw e; } }, transformWindowPointToPage: function (windowPoint, constrainResultToImage) { try { var ac = this.Lg(windowPoint, constrainResultToImage); this.wb('transformWindowPointToPage', arguments, ac, 1); return ac; } catch (e) { this.bK('transformWindowPointToPage', e); throw e; } }, transformPagePointToTextIndex: function (pagePoint) { try { var ac = this.Ly(pagePoint); this.wb('transformPagePointToTextIndex', arguments, ac, 1); return ac; } catch (e) { this.bK('transformPagePointToTextIndex', e); throw e; } }, removeAllHighlights: function () { try { this.aI('removeAllHighlights', arguments); this.WE(); } catch (e) { this.bK('removeAllHighlights', e); throw e; } }, showTextSelection: function (indexOfFirstCharacter, length) { try { this.aI('showTextSelection', arguments); this.QD(indexOfFirstCharacter, length); } catch (e) { this.bK('showTextSelection', e); throw e; } }, showEmptyTextSelection: function (textIndex) { try { this.aI('showEmptyTextSelection', arguments); this.Cw(textIndex); } catch (e) { this.bK('showEmptyTextSelection', e); throw e; } }, extendTextSelection: function (textIndex) { try { this.aI('extendTextSelection', arguments); this.vk(textIndex); } catch (e) { this.bK('extendTextSelection', e); throw e; } }, initializeViewControllers: function (showArtContextMenu) { try { this.aI('initializeViewControllers', arguments); this.aGi(showArtContextMenu); } catch (e) { this.bK('initializeViewControllers', e); throw e; } }, get_autoUpdate: function () { try { var ac = this.CK(); this.ah('get_autoUpdate', arguments, ac); return ac; } catch (e) { this.bK('get_autoUpdate', e); throw e; } }, set_autoUpdate: function (value) { try { this.aI('set_autoUpdate', arguments); this.Yw(value); } catch (e) { this.bK('set_autoUpdate', e); throw e; } } }; IPCC.Web.UI.PageView.registerClass = IPCC.Web.regClass; IPCC.Web.UI.PageView.registerClass('IPCC.Web.UI.PageView', IPCC.Sys.UI.Control); IPCC.Web.UI.ThumbnailView = function (element) { var es = this; var bf; var C; var rF = 0; var pp = ''; var Ae = false; var NU = ''; var sP = null; var qu = null; var Os = null; var pZ = false; var bC = new IPCC.Web.UI.fR(); function it(wL) { if (!C) { return false; } return C.it(wL); }; this.bK = function (fH, hV) { if (it(IPCC.Web.UI.DebugErrorLevel.Production)) { C.logException(fH, hV); } }; this.aI = function (fH, eB, jB) { if (!it(IPCC.Web.UI.DebugErrorLevel.Development)) { return; } var aw = fH + '('; var G; for (G = 0; G < eB.length; G++) { if (G > 0) { aw += ', '; } aw += IPCC.gG.io(eB[G], (jB ? jB : 0)); } aw += ')'; this.mB(aw, IPCC.Web.UI.DebugErrorLevel.Development); }; this.wb = function (fH, eB, js, jB) { if (!it(IPCC.Web.UI.DebugErrorLevel.Development)) { return; } var aw = fH + '('; var G; for (G = 0; G < eB.length; G++) { if (G > 0) { aw += ', '; } aw += IPCC.gG.io(eB[G], (jB ? jB : 0)); } aw += ') = '; aw += IPCC.gG.io(js, 1); this.mB(aw, IPCC.Web.UI.DebugErrorLevel.Development); }; this.ah = function (fH, eB, js) { if (!it(IPCC.Web.UI.DebugErrorLevel.Detailed)) { return; } var aw = fH + '('; var G; for (G = 0; G < eB.length; G++) { if (G > 0) { aw += ', '; } aw += IPCC.gG.io(eB[G], 0); } aw += ') = '; aw += IPCC.gG.io(js, 1); this.mB(aw, IPCC.Web.UI.DebugErrorLevel.Detailed); }; this.mB = function (hb, as) { if (C) { C.iP(hb, IPCC.Web.UI.DebugItemCause.FunctionCall, as); } }; this.iP = function (hb) { if (C) { C.iP(hb, IPCC.Web.UI.DebugItemCause.Custom, IPCC.Web.UI.DebugErrorLevel.Production); } }; this.rC = function () { return C.get_debug(); }; this.Ck = function (F) { C.set_debug(F); }; this.pm = function () { return C.pm(); }; this.uG = function (F) { IPCC.ad.lm(F, 'value', IPCC.Web.UI.DebugErrorLevel); C.uG(F); }; function du(cA, V) { bC.addHandler(cA, V); }; function dn(cA, V) { bC.removeHandler(cA, V); }; this.KN = function (V) { du('pageOpening', V); }; this.HJ = function (V) { dn('pageOpening', V); }; this.LW = function (V) { du('pageOpened', V); }; this.HD = function (V) { dn('pageOpened', V); }; this.Ya = function (V) { du('pageClosed', V); }; this.BI = function (V) { du('pageOpenFailed', V); }; this.BD = function (V) { dn('pageOpenFailed', V); }; this.Lk = function (V) { du('pageDisplayed', V); }; this.GY = function (V) { dn('pageDisplayed', V); }; this.XW = function (V) { dn('pageClosed', V); }; this.BS = function (V) { du('mouseDown', V); }; this.Fc = function (V) { dn('mouseDown', V); }; this.Dg = function (V) { du('mouseMove', V); }; this.Gs = function (V) { dn('mouseMove', V); }; this.Eu = function (V) { du('mouseUp', V); }; this.DH = function (V) { dn('mouseUp', V); }; this.WP = function (V) { du('contextMenu', V); }; this.WV = function (V) { dn('contextMenu', V); }; this.yd = function (V) { du('markAdded', V); }; this.zu = function (V) { dn('markAdded', V); }; this.Fb = function (V) { du('markChanged', V); }; this.Gb = function (V) { dn('markChanged', V); }; this.yp = function (V) { du('markRemoved', V); }; this.zp = function (V) { dn('markRemoved', V); }; this.EY = function (V) { du('markReordered', V); }; this.Fu = function (V) { dn('markReordered', V); }; this.Qf = function (V) { du('marksLoaded', V); }; this.TW = function (V) { dn('marksLoaded', V); }; this.aGe = function (V) { du('marksSaved', V); }; this.aCu = function (V) { dn('marksSaved', V); }; this.EJ = function (V) { du('markSelectionChanged', V); }; this.EO = function (V) { dn('markSelectionChanged', V); }; this.xq = function (V) { du('textPageReady', V); }; this.yI = function (V) { dn('textPageReady', V); }; this.ou = function () { return C.get_requireRequestsOptimize(); }; this.tw = function (F) { C.tw(F); }; this.raisePropertyChanged = function (cr) { if (C) { C.aL(cr); } }; var aM = function (cA, L) { try { var V; V = bC.getHandler(cA); if (V) { V(es, L); } } catch (e) { es.bK(cA + 'Event', e); } }; var jH = function (cA) { function qx(aB, L) { aM(cA, L); }; C['add_' + cA](qx); }; var Jg = function (cA) { function qx(aB, L) { if (C.Ia()) { qt(); } }; C['add_' + cA](qx); }; function qt() { var sd, dW, hC; if (pp !== '') { sd = document.getElementById(pp); if (sd) { dW = es.wm(); hC = '{encodedDocumentIdentifier:"' + dW.encodedDocumentIdentifier; hC += '",pageNumber:' + dW.pageNumber.toString(); hC += ',selected:' + pZ.toString(); if (Ae) { var aX = C.eI(); if (aX) { hC += ',artPageJson:"' + IPCC.gB.sv(aX.saveToJson()) + '"'; } } hC += '}'; sd.value = hC; } } }; var aaG = function () { function qx(aB, L) { var BW = true; switch (L.get_propertyName()) { case 'documentIdentifier': case 'pageNumber': case 'artPage': case 'includeArtInPostBack': qt(); break; case 'magnifierWindowPosition': case 'magnifierIsVisible': case 'cursor': case 'markCursor': case 'inProgressMark': case 'HV': case 'vM': BW = false; break; case 'HQ': if (C.Ia()) { qt(); } BW = false; break; } if (BW) { aM('propertyChanged', L); } }; C.lg(qx); }; this.wK = function () { if (!C || !(C.cX())) { return ''; } return C.cX().get_identifier(); }; this.Dj = function () { if (!C || !(C.cX())) { return ''; } return C.cX().get_encodedIdentifier(); }; this.mc = function () { if (!C || !(C.cX())) { return -1; } return C.cX().aD; }; this.ZE = function () { if (!C || !(C.cX())) { return 0; } return C.cX().eD; }; this.kO = function () { if (!C || !(C.cX())) { return 0; } return C.cX().width; }; this.iE = function () { if (!C || !(C.cX())) { return 0; } return C.cX().height; }; function Cq() { var cV = {}; cV.documentIdentifier = es.wK(); cV.encodedDocumentIdentifier = es.Dj(); cV.pageNumber = es.mc(); cV.referenceDocumentIdentifier = es.wK(); cV.referencePageNumber = es.mc(); cV.selected = es.Sk(); cV.artPage = es.eI(); cV.imGearPage = es.lc(); cV.transientArtPage = es.mK(); return cV; }; this.wm = function () { var cV; if (bf) { cV = new IPCC.Web.UI.ThumbnailViewState(); cV.documentIdentifier = bf.documentIdentifier; cV.encodedDocumentIdentifier = bf.encodedDocumentIdentifier; cV.pageNumber = bf.pageNumber; cV.referenceDocumentIdentifier = bf.documentIdentifier; cV.referencePageNumber = bf.pageNumber; cV.selected = bf.selected; cV.artPage = bf.artPage; cV.imGearPage = bf.imGearPage; cV.transientArtPage = bf.transientArtPage; } else { cV = Cq(); } return cV; }; this.aEQ = function () { return qu; }; this.aGO = function (value) { qu = value; }; var Zi = function () { var bm = C.bG(); var bb = C.cX(); var aU = C.ff(); var bz = bm.eV(); bz.acW(bb, aU); bz.agx(bb, aU); bz.kY(bb, aU); bm.lv(bz); }; this.cn = function () { C.cn(); }; function aeX() { if (Os) { Os.remove_pageOpened(afd); Os = null; } }; function afd(sender, eventArgs) { var bf = es.wm(); if (eventArgs.documentIdentifier !== bf.documentIdentifier || eventArgs.pageNumber !== bf.pageNumber) { aeX(); es.Pb(false); } }; function aeO() { if (!NU) { return; } if (!sP) { sP = document.getElementById(NU).bB; } if (sP) { var aBI = es.get_imGearPage(); if (aBI) { sP.set_imGearPage(es.get_imGearPage()); } } if (!sP) { return; } aeX(); sP.add_pageOpened(afd); Os = sP; var bf = es.wm(); if (bf.encodedDocumentIdentifier !== '') { sP.openPage({ encodedDocumentIdentifier: bf.encodedDocumentIdentifier, pageNumber: bf.pageNumber, viewFitType: qu.viewFitType, viewRotationDegreesClockwise: qu.viewRotationDegreesClockwise, viewZoomFactor: qu.viewZoomFactor, artPage: bf.artPage, imGearPage: es.lc() }); } }; this.aaK = function (eo) { var nU = false; if (IPCC.Web.nr.length > 0) { if (Array.prototype.indexOf) { if (IPCC.Web.nr.indexOf(eo) >= 0) { return true; } } else { if (IPCC.Web.hK(IPCC.Web.nr, eo) >= 0) { return true; } } } return nU; }; this.Fj = function (bo) { rF++; var KO = rF; var ace; IPCC.gB.Vh(bo); bf = new IPCC.Web.UI.ThumbnailViewState(); var G; for (G in bo) { if (bo.hasOwnProperty(G)) { bf[G] = bo[G]; } } if (bo.documentIdentifier === '') { this.yM(); return; } if (IPCC.Web.UI.ArtPage) { if (bf) { if (!bf.artPage) { var aX = new IPCC.Web.UI.ArtPage(); if (bf.artPageJson) { aX.loadFromJson(bf.artPageJson); } bf.artPage = aX; } if (this.iw() === true) { if (!bf.imGearPage) { var bY = new IPCC.Web.UI.ImGearDocument({ documentIdentifier: bo.documentIdentifier, imageServicePath: this.mz() }); bY.iA(es.eG()); bf.imGearPage = new IPCC.Web.UI.ImGearPage({ pageNumber: bo.pageNumber, bE: bY }); bf.imGearPage.iA(es.eG()); bY.get_pages().addPage(bf.imGearPage); } if (!bf.transientArtPage) { bf.transientArtPage = new IPCC.Web.UI.ArtPage(); } } } } aM('pageOpening', bo); if (pZ) { aeO(); } var ap = new IPCC.gB(bo.encodedDocumentIdentifier, bo.pageNumber, 0, 0, 0, 0); function arQ() { Zi(); if (bo.selected !== undefined) { es.set_selected(bo.selected); } bf = null; }; var mH = function () { if (KO !== rF) { return; } var pR = null; if (C.cX()) { pR = Cq(); } C.xB(ap); if (bo.artServiceOption === IPCC.Web.UI.ImGearArtDataServices.ArtDataService) { if (bf) { if (bf.artPage) { C.kc(bf.artPage); C.eI().loadFromJson(ap.amZ); } } } else { if (bf) { if (bf.artPage) { C.kc(bf.artPage); } if (C.iw() === true) { if (bf.imGearPage) { C.tO(bf.imGearPage); } if (bf.transientArtPage) { C.uD(bf.transientArtPage); } } } } arQ(); qt(); if (pR) { aM('pageClosed', pR); } qt(); aM('pageOpened', bo); }; if (bo.artServiceOption === IPCC.Web.UI.ImGearArtDataServices.ArtDataService) { if (bf) { if (!bf.artPageJson) { ap.axz(C.mz(), C, mH, ace); } else { ap.Nd(C.mz(), C, mH); } } } else { ap.Nd(C.mz(), C, mH); } }; this.yM = function () { bf = null; C.xB(undefined); es.cn(); qt(); aM('pageClosed', {}); }; this.Du = function (yX) { C.Du(yX); }; this.kc = function (F) { C.kc(F); }; this.eI = function () { return C.eI(); }; this.mK = function () { return C.mK(); }; this.uD = function (F) { C.uD(F); }; this.zI = function () { return C.zI(); }; this.Ze = function (F) { C.Ze(F); }; this.uR = function (F) { C.uR(F); }; this.nQ = function () { return C.nQ(); }; this.SS = function (bh, cz) { C.SS(bh, cz); }; this.Av = function (EK) { C.Av(EK); }; this.Ak = function () { return C.Ak(); }; this.Sk = function () { return pZ; }; this.Pb = function (F) { if (pZ !== F) { pZ = F; qt(); if (pZ) { aeO(); } this.raisePropertyChanged('selected'); } }; this.mz = function () { return C.mz(); }; this.Fi = function (F) { IPCC.ad.jt(F, 'value'); C.Fi(F); if (!IPCC.Web.rG) { if (IPCC.Web.uN === false) { IPCC.Web.OA(F); } } }; this.KM = function () { return pp; }; this.KP = function (F) { IPCC.ad.jt(F, 'value'); pp = F; }; this.ads = function () { return Ae; }; this.YP = function (F) { Ae = F; }; this.aFW = function () { return NU; }; this.aIi = function (F) { if (NU !== F) { NU = F; sP = null; this.raisePropertyChanged('pageViewClientID'); } }; this.Qn = function (F) { C.Qn(F); }; this.NC = function () { return C.NC(); }; this.zY = function (F) { C.zY(F); }; this.Mk = function () { return C.Mk(); }; var lU = ''; this.rc = function (F) { C.rc(F); lU = F; }; this.gx = function () { return lU; }; function Wv() { Zi(); }; this.iw = function () { return C.iw(); }; this.zr = function (F) { C.zr(F); }; this.cv = function () { return C.cv(); }; this.lc = function () { return C.lc(); }; this.tO = function (F) { C.tO(F); }; this.hT = function () { return C.hT(); }; this.tm = function (F) { C.tm(F); }; this.eG = function () { return C.eG(); }; this.iA = function (F) { C.iA(F); }; this.initialize = function () { var bg; C.act(this.gx().id); bg = this.gx(); bg.bB = this; var G; for (G = bg.childNodes.length - 1; G >= 0; G--) { if (bg.childNodes[G].tagName !== 'INPUT') { bg.removeChild(bg.childNodes[G]); } } C.aoV(); C.bG().set_cursor(IPCC.bP.None); C.bG().set_scrollBars(IPCC.Web.UI.ScrollBars.None); C.bG().set_presentationQuality(100); jH('mouseDown'); jH('mouseMove'); jH('mouseUp'); jH('pageOpenFailed'); jH('contextMenu'); jH('textPageReady'); jH('pageDisplayed'); Jg('markAdded'); Jg('markChanged'); Jg('markRemoved'); Jg('markReordered'); Jg('marksLoaded'); aaG(); C.amw(Wv); bg.bB = this; }; C = new IPCC.ajb(); C.aeT('ThumbnailView'); }; IPCC.Web.UI.ThumbnailView.prototype = { dispose: function () { this.aI('dispose', arguments); this.yM(); }, get_debug: function () { try { var ac = this.rC(); this.ah('get_debug', arguments, ac); return ac; } catch (e) { this.bK('get_debug', e); throw e; } }, set_debug: function (value) { try { this.aI('set_debug', arguments); var oD = this.rC(); this.Ck(value); if (!oD) { this.aI('set_debug', arguments); } } catch (e) { this.bK('set_debug', e); throw e; } }, get_debugErrorLevel: function () { try { var ac = this.pm(); this.ah('get_debugErrorLevel', arguments, ac); return ac; } catch (e) { this.bK('get_debugErrorLevel', e); throw e; } }, set_debugErrorLevel: function (value) { try { this.aI('set_debugErrorLevel', arguments); var oD = this.pm(); this.uG(value); if (oD < IPCC.Web.UI.DebugErrorLevel.Development) { this.aI('set_debugErrorLevel', arguments); } } catch (e) { this.bK('set_debugErrorLevel', e); throw e; } }, get_artServiceOption: function () { try { var ac = this.Ak(); this.ah('get_artServiceOption', arguments, ac); return ac; } catch (e) { this.bK('get_artServiceOption', e); throw e; } }, set_artServiceOption: function (value) { try { this.aI('set_artServiceOption', arguments); this.Av(value); } catch (e) { this.bK('set_artServiceOption', e); throw e; } }, add_pageOpening: function (handler) { try { this.KN(handler); } catch (e) { this.bK('add_pageOpening', e); throw e; } }, remove_pageOpening: function (handler) { try { this.HJ(handler); } catch (e) { this.bK('remove_pageOpening', e); throw e; } }, add_pageOpened: function (handler) { try { this.LW(handler); } catch (e) { this.bK('add_pageOpened', e); throw e; } }, remove_pageOpened: function (handler) { try { this.HD(handler); } catch (e) { this.bK('remove_pageOpened', e); throw e; } }, add_pageClosed: function (handler) { try { this.Ya(handler); } catch (e) { this.bK('add_pageClosed', e); throw e; } }, remove_pageClosed: function (handler) { try { this.XW(handler); } catch (e) { this.bK('remove_pageClosed', e); throw e; } }, add_pageOpenFailed: function (handler) { try { this.BI(handler); } catch (e) { this.bK('add_pageOpenFailed', e); throw e; } }, remove_pageOpenFailed: function (handler) { try { this.BD(handler); } catch (e) { this.bK('remove_pageOpenFailed', e); throw e; } }, add_pageDisplayed: function (handler) { try { this.Lk(handler); } catch (e) { this.bK('add_pageDisplayed', e); throw e; } }, remove_pageDisplayed: function (handler) { try { this.GY(handler); } catch (e) { this.bK('remove_pageDisplayed', e); throw e; } }, add_mouseDown: function (handler) { try { this.BS(handler); } catch (e) { this.bK('add_mouseDown', e); throw e; } }, remove_mouseDown: function (handler) { try { this.Fc(handler); } catch (e) { this.bK('remove_mouseDown', e); throw e; } }, add_mouseMove: function (handler) { try { this.Dg(handler); } catch (e) { this.bK('add_mouseMove', e); throw e; } }, remove_mouseMove: function (handler) { try { this.Gs(handler); } catch (e) { this.bK('remove_mouseMove', e); throw e; } }, add_mouseUp: function (handler) { try { this.Eu(handler); } catch (e) { this.bK('add_mouseUp', e); throw e; } }, remove_mouseUp: function (handler) { try { this.DH(handler); } catch (e) { this.bK('remove_mouseUp', e); throw e; } }, add_contextMenu: function (handler) { try { this.WP(handler); } catch (e) { this.bK('add_contextMenu', e); throw e; } }, remove_contextMenu: function (handler) { try { this.WV(handler); } catch (e) { this.bK('remove_contextMenu', e); throw e; } }, writeToLog: function (message) { try { this.iP(message); } catch (e) { this.bK('writeToLog', e); throw e; } }, get_documentIdentifier: function () { try { var ac = this.wK(); this.ah('get_documentIdentifier', arguments, ac); return ac; } catch (e) { this.bK('get_documentIdentifier', e); throw e; } }, get_encodedDocumentIdentifier: function () { try { var ac = this.Dj(); this.ah('get_encodedDocumentIdentifier', arguments, ac); return ac; } catch (e) { this.bK('get_encodedDocumentIdentifier', e); throw e; } }, get_pageNumber: function () { try { var ac = this.mc(); this.ah('get_pageNumber', arguments, ac); return ac; } catch (e) { this.bK('get_pageNumber', e); throw e; } }, get_documentPageCount: function () { try { var ac = this.ZE(); this.ah('get_documentPageCount', arguments, ac); return ac; } catch (e) { this.bK('get_documentPageCount', e); throw e; } }, get_pageWidth: function () { try { var ac = this.kO(); this.ah('get_pageWidth', arguments, ac); return ac; } catch (e) { this.bK('get_pageWidth', e); throw e; } }, get_pageHeight: function () { try { var ac = this.iE(); this.ah('get_pageHeight', arguments, ac); return ac; } catch (e) { this.bK('get_pageHeight', e); throw e; } }, get_currentState: function () { try { var ac = this.wm(); this.ah('get_currentState', arguments, ac); return ac; } catch (e) { this.bK('get_currentState', e); throw e; } }, openPage: function (parameters) { try { this.aI('openPage', arguments, 1); this.Fj(parameters); } catch (e) { this.bK('openPage', e); throw e; } }, closePage: function () { try { this.aI('closePage', arguments); this.yM(); } catch (e) { this.bK('closePage', e); throw e; } }, saveArtPage: function (onSave) { try { this.aI('saveArtPage', arguments); this.Du(onSave); } catch (e) { this.bK('saveArtPage', e); throw e; } }, display: function () { try { this.aI('display', arguments); this.cn(); } catch (e) { this.bK('display', e); throw e; } }, get_controlStateElementId: function () { try { var ac = this.KM(); this.ah('get_controlStateElementId', arguments, ac); return ac; } catch (e) { this.bK('get_controlStateElementId', e); throw e; } }, set_controlStateElementId: function (value) { try { this.aI('set_controlStateElementId', arguments); this.KP(value); } catch (e) { this.bK('set_controlStateElementId', e); throw e; } }, get_includeArtInPostBack: function () { try { var ac = this.ads(); this.ah('get_includeArtInPostBack', arguments, ac); return ac; } catch (e) { this.bK('get_includeArtInPostBack', e); throw e; } }, set_includeArtInPostBack: function (value) { try { this.aI('set_includeArtInPostBack', arguments); this.YP(value); } catch (e) { this.bK('set_includeArtInPostBack', e); throw e; } }, get_pageViewClientID: function () { try { var ac = this.aFW(); this.ah('get_pageViewClientID', arguments, ac); return ac; } catch (e) { this.bK('get_pageViewClientID', e); throw e; } }, set_pageViewClientID: function (value) { try { this.aI('set_pageViewClientID', arguments); this.aIi(value); } catch (e) { this.bK('set_pageViewClientID', e); throw e; } }, get_artPage: function () { try { var ac = this.eI(); this.ah('get_artPage', arguments, ac); return ac; } catch (e) { this.bK('get_artPage', e); throw e; } }, set_artPage: function (value) { try { this.aI('set_artPage', arguments); this.kc(value); } catch (e) { this.bK('set_artPage', e); throw e; } }, get_transientArtPage: function () { try { var ac = this.mK(); this.ah('get_transientArtPage', arguments, ac); return ac; } catch (e) { this.bK('get_transientArtPage', e); throw e; } }, set_transientArtPage: function (value) { try { this.aI('set_transientArtPage', arguments); this.uD(value); } catch (e) { this.bK('set_transientArtPage', e); throw e; } }, get_resourcePath: function () { try { var ac = this.nQ(); this.ah('get_resourcePath', arguments, ac); return ac; } catch (e) { this.bK('get_resourcePath', e); throw e; } }, set_resourcePath: function (F) { try { this.aI('set_resourcePath', arguments); this.uR(F); } catch (e) { this.bK('set_resourcePath', e); throw e; } }, get_imageHandlerUrl: function () { try { var ac = this.mz(); this.ah('get_imageHandlerUrl', arguments, ac); return ac; } catch (e) { this.bK('get_imageHandlerUrl', e); throw e; } }, set_imageHandlerUrl: function (value) { try { this.aI('set_imageHandlerUrl', arguments); this.Fi(value); } catch (e) { this.bK('set_imageHandlerUrl', e); throw e; } }, get_selected: function () { try { var ac = this.Sk(); this.ah('get_selected', arguments, ac); return ac; } catch (e) { this.bK('get_selected', e); throw e; } }, set_selected: function (value) { try { this.aI('set_selected', arguments); this.Pb(value); } catch (e) { this.bK('set_selected', e); throw e; } }, get_textRequired: function () { try { var ac = this.iw(); this.ah('get_textRequired', arguments, ac); return ac; } catch (e) { this.bK('get_textRequired', e); throw e; } }, set_textRequired: function (F) { try { this.aI('set_textRequired', arguments); this.zr(F); } catch (e) { this.bK('set_textRequired', e); throw e; } }, get_textPage: function () { try { var ac = this.cv(); this.ah('get_textPage', arguments, ac); return ac; } catch (e) { this.bK('get_textPage', e); throw e; } }, set_textPage: function (value) { try { this.aI('set_textPage', arguments); this.aEU(value); } catch (e) { this.bK('set_textPage', e); throw e; } }, get_imGearPage: function () { try { var ac = this.lc(); this.ah('get_imGearPage', arguments, ac); return ac; } catch (e) { this.bK('get_imGearPage', e); throw e; } }, set_imGearPage: function (value) { try { this.aI('set_imGearPage', arguments); this.tO(value); } catch (e) { this.bK('set_imGearPage', e); throw e; } }, add_textPageReady: function (handler) { try { this.xq(handler); } catch (e) { this.bK('add_textPageReady', e); throw e; } }, remove_textPageReady: function (handler) { try { this.yI(handler); } catch (e) { this.bK('remove_textPageReady', e); throw e; } }, get_requireRequestsOptimize: function () { try { var ac = this.ou(); this.ah('get_requireRequestsOptimize', arguments, ac); return ac; } catch (e) { this.bK('ou', e); throw e; } }, set_requireRequestsOptimize: function (value) { try { this.aI('set_requireRequestsOptimize', arguments); this.tw(value); } catch (e) { this.bK('set_requireRequestsOptimize', e); throw e; } }, get_serviceResponseTimeout: function () { try { var ac = this.hT(); this.ah('get_serviceResponseTimeout', arguments, ac); return ac; } catch (e) { this.bK('get_serviceResponseTimeout', e); throw e; } }, set_serviceResponseTimeout: function (value) { try { this.aI('set_serviceResponseTimeout', arguments); this.tm(value); } catch (e) { this.bK('set_serviceResponseTimeout', e); throw e; } }, get_encryption: function () { try { var ac = this.eG(); this.ah('get_encryption', arguments, ac); return ac; } catch (e) { this.bK('get_encryption', e); throw e; } }, set_encryption: function (value) { try { this.aI('set_encryption', arguments); this.iA(value); } catch (e) { this.bK('set_encryption', e); throw e; } } }; IPCC.Web.UI.ThumbnailView.registerClass = IPCC.Web.regClass; IPCC.Web.UI.ThumbnailView.registerClass('IPCC.Web.UI.ThumbnailView', IPCC.Sys.UI.Control); IPCC.ef = function (iy, jC, iS, jF, eP, gr) { if (arguments.length === 0) { iy = jF = 1; jC = iS = eP = gr = 0; } this.akh = function () { return iy * jF - jC * iS; }; this.aJp = function () { return iy === 1 && jC === 0 && iS === 0 && jF === 1 && eP === 0 && gr === 0; }; this.qy = function () { return iy; }; this.qk = function () { return jC; }; this.sC = function () { return iS; }; this.vV = function () { return jF; }; this.yB = function () { return eP; }; this.zT = function () { return gr; }; this.append = function (ci) { var JF = iy * ci.qy() + jC * ci.sC(); var Jf = iy * ci.qk() + jC * ci.vV(); var Kj = iS * ci.qy() + jF * ci.sC(); var IP = iS * ci.qk() + jF * ci.vV(); var Jk = eP * ci.qy() + gr * ci.sC() + ci.yB(); var Jh = eP * ci.qk() + gr * ci.vV() + ci.zT(); iy = JF; jC = Jf; iS = Kj; jF = IP; eP = Jk; gr = Jh; }; this.equals = function (F) { if (iy !== F.qy()) { return false; } if (jC !== F.qk()) { return false; } if (iS !== F.sC()) { return false; } if (jF !== F.vV()) { return false; } if (eP !== F.yB()) { return false; } if (gr !== F.zT()) { return false; } return true; }; this.Ap = function () { if (!this.ajf()) { throw new IPCC.Web.UI.ImGearArgumentException(null, 'Matrix has no inverse'); } var Il = this.akh(); var JF = jF / Il; var Jf = -jC / Il; var Kj = -iS / Il; var IP = iy / Il; var Jk = (iS * gr - jF * eP) / Il; var Jh = (jC * eP - iy * gr) / Il; iy = JF; jC = Jf; iS = Kj; jF = IP; eP = Jk; gr = Jh; }; this.BZ = function (ci) { var JF = ci.qy() * iy + ci.qk() * iS; var Jf = ci.qy() * jC + ci.qk() * jF; var Kj = ci.sC() * iy + ci.vV() * iS; var IP = ci.sC() * jC + ci.vV() * jF; var Jk = ci.yB() * iy + ci.zT() * iS + eP; var Jh = ci.yB() * jC + ci.zT() * jF + gr; iy = JF; jC = Jf; iS = Kj; jF = IP; eP = Jk; gr = Jh; }; this.xH = function (lk, rw, pl, nz) { eP -= pl; gr -= nz; this.scale(lk, rw); eP += pl; gr += nz; }; this.aDN = function () { iy = jF = 1; jC = iS = eP = gr = 0; }; this.transform = function (be) { var aY = be.x * iy + be.y * iS + eP; var fJ = be.y * jF + be.x * jC + gr; return new IPCC.Web.UI.Point(aY, fJ); }; this.oa = function (Zt, Zy) { eP += Zt; gr += Zy; }; this.awl = function (F) { if (Math.abs(iy - F.qy()) > 1e-8) { return false; } if (Math.abs(jC - F.qk()) > 1e-8) { return false; } if (Math.abs(iS - F.sC()) > 1e-8) { return false; } if (Math.abs(jF - F.vV()) > 1e-8) { return false; } if (Math.abs(eP - F.yB()) > 1e-8) { return false; } if (Math.abs(gr - F.zT()) > 1e-8) { return false; } return true; }; this.toString = function () { return '{' + iy.toFixed(6) + ', ' + jC.toFixed(6) + ', ' + iS.toFixed(6) + ', ' + jF.toFixed(6) + ', ' + eP.toFixed(3) + ', ' + gr.toFixed(3) + '}'; }; this.parse = function () { }; this.clone = function () { return new IPCC.ef(iy, jC, iS, jF, eP, gr); }; this.Qi = function (hj) { iy = hj.qy(); jC = hj.qk(); iS = hj.sC(); jF = hj.vV(); eP = hj.yB(); gr = hj.zT(); }; this.acW = function (bb, aU) { iy = 1; jF = aU.hk * bb.hi / (bb.hk * aU.hi); jC = iS = eP = gr = 0; }; this.UB = function (aa, bb, aU) { switch (aa) { case IPCC.Web.UI.FitType.FullImage: this.agx(bb, aU); break; case IPCC.Web.UI.FitType.FullWidth: this.agR(bb, aU); break; case IPCC.Web.UI.FitType.FullHeight: this.agU(bb, aU); break; case IPCC.Web.UI.FitType.ActualSize: this.agG(bb, aU); break; case IPCC.Web.UI.FitType.OneToOne: if (!(bb.sa)) { this.agG(bb, aU); } else { this.axY(bb, aU); } break; } }; this.agR = function (bb, aU) { var oc = this.qC(bb); var Cz = aU.width - 2; if (Cz < 1) { Cz = 1; } var ab = Cz / oc.width; this.scale(ab, ab); oc = this.qC(bb); if (oc.y < 0) { this.oa(0, -oc.y); } }; this.agU = function (bb, aU) { var oc = this.qC(bb); var Cz = aU.height - 2; if (Cz < 1) { Cz = 1; } var ab = Cz / oc.height; this.scale(ab, ab); oc = this.qC(bb); if (oc.x < 0) { this.oa(-oc.x, 0); } }; this.agx = function (bb, aU) { var lH = this.clone(); lH.agR(bb, aU); this.agU(bb, aU); if (Math.max(Math.abs(iy), Math.abs(jC)) > Math.max(Math.abs(lH.qy()), Math.abs(lH.qk()))) { this.Qi(lH); } }; this.agG = function (bb, aU) { var oc = this.qC({ x: 0, y: 0, width: bb.hi, height: bb.hk }); var ab = aU.hi / oc.width; this.scale(ab, ab); }; this.axY = function (bb, aU) { var oc = this.qC({ x: 0, y: 0, width: 1, height: 1 }); var ab = 1 / Math.min(oc.width, oc.height); this.scale(ab, ab); if (Math.abs(iy - 1) < 0.0001) { iy = 1; } if (Math.abs(jF - 1) < 0.0001) { jF = 1; } }; return this; }; IPCC.ef.prototype.ajf = function () { return Math.abs(this.akh()) > 1e-14; }; IPCC.ef.prototype.rotate = function (Cf) { this.agn(Cf, 0, 0); }; IPCC.ef.prototype.agn = function (Cf, pl, nz) { var IQ = Cf * Math.PI * 2 / 360; var jq = Math.sin(IQ); var he = Math.cos(IQ); var ci = new IPCC.ef(he, jq, -jq, he, pl * (1 - he) + nz * jq, nz * (1 - he) - pl * jq); this.append(ci); }; IPCC.ef.prototype.aEi = function (Cf, pl, nz) { var IQ = Cf * Math.PI * 2 / 360; var jq = Math.sin(IQ); var he = Math.cos(IQ); var ci = new IPCC.ef(he, jq, -jq, he, pl * (1 - he) + nz * jq, nz * (1 - he) - pl * jq); this.BZ(ci); }; IPCC.ef.prototype.aIH = function (Cf) { this.aEi(Cf, 0, 0); }; IPCC.ef.prototype.scale = function (lk, rw) { var ci = new IPCC.ef(lk, 0, 0, rw, 0, 0); this.append(ci); }; IPCC.ef.prototype.aKa = function (lk, rw, pl, nz) { var ci = new IPCC.ef(lk, 0, 0, rw, pl * (1 - lk), nz * (1 - rw)); this.BZ(ci); }; IPCC.ef.prototype.aIX = function (lk, rw) { var ci = new IPCC.ef(lk, 0, 0, rw, 0, 0); this.BZ(ci); }; IPCC.ef.prototype.skew = function (qg, sy) { var ci = new IPCC.ef(1, Math.tan(sy * Math.PI * 2 / 360), Math.tan(qg * Math.PI * 2 / 360), 1, 0, 0); this.append(ci); }; IPCC.ef.prototype.aJd = function (qg, sy) { var ci = new IPCC.ef(1, Math.tan(sy * Math.PI * 2 / 360), Math.tan(qg * Math.PI * 2 / 360), 1, 0, 0); this.BZ(ci); }; IPCC.ef.prototype.aJq = function (Zt, Zy) { var ci = new IPCC.ef(1, 0, 0, 1, Zt, Zy); this.BZ(ci); }; IPCC.ef.prototype.ud = function (h) { var eL = this.transform({ x: h.x, y: h.y }); var lN = eL.x; var oW = eL.x; var lK = eL.y; var nF = eL.y; eL = this.transform({ x: h.x + h.width, y: h.y }); lN = Math.min(lN, eL.x); oW = Math.max(oW, eL.x); lK = Math.min(lK, eL.y); nF = Math.max(nF, eL.y); eL = this.transform({ x: h.x + h.width, y: h.y + h.height }); lN = Math.min(lN, eL.x); oW = Math.max(oW, eL.x); lK = Math.min(lK, eL.y); nF = Math.max(nF, eL.y); eL = this.transform({ x: h.x, y: h.y + h.height }); lN = Math.min(lN, eL.x); oW = Math.max(oW, eL.x); lK = Math.min(lK, eL.y); nF = Math.max(nF, eL.y); return new IPCC.Web.UI.Rectangle(lN, lK, oW - lN, nF - lK); }; IPCC.ef.prototype.att = function (bb, aU, eR) { var aoB = this.clone(); aoB.Ap(); var aso = aoB.transform({ x: eR.x + eR.width / 2, y: eR.y + eR.height / 2 }); var ab = Math.min(aU.width / eR.width, aU.height / eR.height); ab -= 1e-10; var lW = this.qs(); if (lW * ab > bb.sV) { ab = bb.sV / lW; } if (lW * ab < bb.uV) { ab = bb.uV / lW; } this.scale(ab, ab); this.agy(aU, aso); }; IPCC.ef.prototype.Rr = function (bb, aU, eJ) { this.att(bb, aU, this.ud(eJ)); }; IPCC.ef.prototype.aIO = function (aU) { this.xH(1, -1, aU.width / 2, aU.height / 2); }; IPCC.ef.prototype.axV = function (aU) { this.xH(-1, 1, aU.width / 2, aU.height / 2); }; IPCC.ef.prototype.Uw = function (asl, arb) { var ahC = this.transform(asl); this.oa(arb.x - ahC.x, arb.y - ahC.y); }; IPCC.ef.prototype.agy = function (aU, cS) { var aeE = this.transform(cS); this.oa(aU.width / 2 - aeE.x, aU.height / 2 - aeE.y); }; IPCC.ef.prototype.kY = function (ap, aU) { var aY = 0, fJ = 0, end; var ob = this.qC(ap); if (ob.width < aU.width) { aY = (aU.width - ob.width) / 2 - ob.x; } else { end = ob.x + ob.width; if (end < aU.width) { aY = aU.width - end; } if (ob.x > 0) { aY = -ob.x; } } if (ob.height < aU.height) { fJ = (aU.height - ob.height) / 2 - ob.y; } else { end = ob.y + ob.height; if (end < aU.height) { fJ = aU.height - end; } if (ob.y > 0) { fJ = -ob.y; } } this.oa(aY, fJ); }; IPCC.ef.prototype.qC = function (ap) { return this.ud({ x: 0, y: 0, width: ap.width, height: ap.height }); }; IPCC.ef.prototype.Ki = function () { var ig, By, iG, yn, agc, iQ; ig = this.transform({ x: 0, y: 0 }); By = this.transform({ x: 0, y: 1 }); iG = this.transform({ x: 1, y: 0 }); yn = Math.atan2(By.y - ig.y, By.x - ig.x); agc = Math.atan2(iG.y - ig.y, iG.x - ig.x); iQ = yn - agc; if (iQ > Math.PI) { iQ = iQ - 2 * Math.PI; } if (iQ < -Math.PI) { iQ = iQ + 2 * Math.PI; } return iQ < 0; }; IPCC.ef.prototype.Ew = function () { var ig, By, yn; ig = this.transform({ x: 0, y: 0 }); By = this.transform({ x: 0, y: 1 }); yn = Math.atan2(By.y - ig.y, By.x - ig.x) - Math.PI / 2; if (yn < 0) { yn = yn + 2 * Math.PI; } return yn * 360 / (Math.PI * 2); }; IPCC.ef.prototype.qs = function () { var jD; var ig, sk; var eW, fe, bS; ig = this.transform({ x: 0, y: 0 }); sk = this.transform({ x: 1, y: 0 }); eW = sk.x - ig.x; fe = sk.y - ig.y; jD = eW * eW + fe * fe; sk = this.transform({ x: 0, y: 1 }); eW = sk.x - ig.x; fe = sk.y - ig.y; bS = Math.min(jD, eW * eW + fe * fe); sk = this.transform({ x: 1, y: 1 }); eW = sk.x - ig.x; fe = sk.y - ig.y; bS = Math.min(jD, eW * eW + fe * fe); sk = this.transform({ x: 1, y: -1 }); eW = sk.x - ig.x; fe = sk.y - ig.y; bS = Math.min(jD, eW * eW + fe * fe); return Math.sqrt(jD); }; IPCC.ef.aId = function () { return new IPCC.ef(1, 0, 0, 1, 0, 0); }; IPCC.EB = function (ax, cR, hi, hk) { this.width = ax; this.height = cR; this.hi = hi; this.hk = hk; return this; }; IPCC.EB.prototype = new IPCC.Web.UI.Rectangle(0, 0, 0, 0); IPCC.EB.prototype.toString = function () { return 'Space(' + this.width + ' x ' + this.height + ', ' + this.hi + ', ' + this.hk + ')'; }; IPCC.gB = function (lM, aD, ax, cR, hi, hk) { this.width = ax; this.height = cR; this.hi = hi; this.hk = hk; this.aD = aD || 0; this.eD = 0; this.sa = true; this.amZ = {}; this.zq = false; var K = this; this.aD = aD; this.get_url = function (iY, hA, bo) { hA = hA || 'Image'; bo = bo || ''; var GM = IPCC.gB.Lt(lM); var IF = false; if (/^[\x00-\x7F]*$/.test(GM)) { IF = true; } if (bo === null || bo === '') { if (hA === 'Attributes') { var sB = ''; if (!IPCC.yZ.Bv()) { sB = '&ContentType=png'; } if (!IF) { return iY + '/Page/q/' + aD.toString() + '/' + hA + '?DocumentID=e' + lM + sB; } else { return iY + '/Page/q/' + aD.toString() + '/' + hA + '?DocumentID=u' + encodeURIComponent(GM) + sB; } } else { if (hA === 'SvgImage') { if (!IF) { return iY + '/Page/q/' + aD.toString() + '?DocumentID=e' + lM + '&' + bo; } else { return iY + '/Page/q/' + aD.toString() + '?DocumentID=u' + encodeURIComponent(GM) + '&' + bo; } } if (!IF) { return iY + '/Page/q/' + aD.toString() + '/' + hA + '?DocumentID=e' + lM + '&' + bo; } else { return iY + '/Page/q/' + aD.toString() + '/' + hA + '?DocumentID=u' + encodeURIComponent(GM) + '&' + bo; } } } else { if (hA === 'SvgImage') { if (!IF) { return iY + '/Page/q/' + aD.toString() + '?DocumentID=e' + lM + '&' + bo; } else { return iY + '/Page/q/' + aD.toString() + '?DocumentID=u' + encodeURIComponent(GM) + '&' + bo; } } if (!IF) { return iY + '/Page/q/' + aD.toString() + '/' + hA + '?DocumentID=e' + lM + '&' + bo; } else { return iY + '/Page/q/' + aD.toString() + '/' + hA + '?DocumentID=u' + encodeURIComponent(GM) + '&' + bo; } } }; this.get_urlArt = function (iY, hA, bo) { hA = hA || 'Art'; bo = bo || ''; if (bo === null || bo === '') { if (hA === 'Art') { return iY + '/Page/q/' + aD.toString() + '/' + hA + '?DocumentID=e' + lM; } } else { return iY + '/Page/q/' + aD.toString() + '/' + hA + '?DocumentID=e' + lM + '&' + bo; } }; this.get_identifier = function () { return IPCC.gB.Lt(lM); }; this.get_encodedIdentifier = function () { return lM; }; this.toString = function () { return 'Image("' + lM + '", ' + this.aD + ', ' + this.width + ' x ' + this.height + ', ' + this.hi + ', ' + this.hk + ')'; }; function ahE(asm, C) { if (C.NC()) { K.sa = true; K.zq = false; return; } var acK = asm.split(','); var nm = false; for (var ar = 0; ar < acK.length; ar++) { if (acK[ar] === "SVG" || acK[ar] === "svg") { if (IPCC.yZ.Bv()) { K.zq = true; K.sa = false; } else { K.zq = false; } nm = true; break; } } if (!nm) { K.zq = false; K.sa = true; } if (C) { if (C.Qu) { C.Qu(K.zq); } } }; this.Nd = function (iY, C, DF) { C.aD = this.aD; var mn = 0; var nX = C.ou(); if (nX) { if (document.documentMode < 9) { nX = false; } } var pq = true; if (C.hT() === 0) { pq = false; } var mH = function (ei, bF) { try { if (ei === null) { throw new IPCC.Web.UI.ImGearArgumentException(null, 'Unable to load the specified image. Failed to obtain Image attributes. Returned JSON from the server is null'); } if (ei.errorCode) { if (ei.errorCode === 'SvgNotAvailable') { nX = false; K.width = +(ei.pageAttributes.imageWidth); K.height = +(ei.pageAttributes.imageHeight); K.hi = +(ei.pageAttributes.imageXResolution); if (K.hi <= 0) { K.hi = 72; } K.hk = +(ei.pageAttributes.imageYResolution); if (K.hk <= 0) { K.hk = 72; } K.eD = +(ei.pageAttributes.pageCount); K.sa = ei.pageAttributes.isRaster !== 'false'; ahE(ei.pageAttributes.contentType, C); } } else { K.width = +(ei.imageWidth); K.height = +(ei.imageHeight); K.hi = +(ei.imageXResolution); if (K.hi <= 0) { K.hi = 72; } K.hk = +(ei.imageYResolution); if (K.hk <= 0) { K.hk = 72; } K.eD = +(ei.pageCount); K.sa = ei.isRaster !== 'false'; ahE(ei.contentType, C); } var lV = bF.getResponseHeader("Accusoft-Data-Encrypted"); var JP = false; if (lV === "true") { JP = true; } C.adR(JP); if (DF) { DF(); } } catch (e) { C.bK('openPage', e); if (typeof (C.aM) === 'function') { var dz = new IPCC.Web.UI.ImGearPageOpenFailedEventArgs(); dz.exception = e; dz.pageNumber = C.aD; C.aM('pageOpenFailed', dz); } } }; function Sd() { nX = false; if (mn < 1) { var hc = { method: 'GET', url: K.get_url(iY, 'Attributes'), headers: { 'Content-Type': 'application/json' } }; if (pq === true) { hc.timeout = C.hT(); } IPCC.J.mt.dZ(hc).then(fa, eZ); mn++; } }; var aEo = function (gM, bF) { var ax; var cR; function atR() { var Ti; try { if (typeof JSON !== 'undefined') { Ti = JSON.parse(gM); } else { Ti = IPCC.ct.pG(gM); } } catch (bJ) { Ti = undefined; nX = true; } return Ti; }; try { ax = gM.match(/width=\"([0-9.]+)\"/); cR = gM.match(/height=\"([0-9.]+)\"/); if (ax && cR) { ax = Number(ax[1]); cR = Number(cR[1]); } else { throw "error"; } if (isNaN(ax) || isNaN(cR)) { throw "error"; } K.width = ax; K.height = cR; K.hi = 72; K.hk = 72; K.zq = true; K.sa = false; if (C) { if (typeof (C.Qu === 'function')) { C.Qu(K.zq); } } if (DF) { DF(); } } catch (e) { var bM = atR(); if (bM) { mH(bM, bF); return; } if (nX) { if (mn < 1) { nX = false; setTimeout(Sd, 10); return; } } C.bK('openPage', e); if (typeof (C.aM) === 'function') { var dz = new IPCC.Web.UI.ImGearPageOpenFailedEventArgs(); dz.exception = e; dz.pageNumber = C.aD; C.aM('pageOpenFailed', dz); } } }; function fa(bF) { var bM = null, cT; try { if (!nX) { if (typeof JSON !== 'undefined') { bM = JSON.parse(bF.responseText); } else { bM = IPCC.ct.pG(bF.responseText); } mH(bM, bF); } else { var ty; var lV = bF.getResponseHeader("Accusoft-Data-Encrypted"); if (lV === 'true' && C.eG() === true) { var sf = IPCC.Web.hm.nC.te(bF.getResponseHeader("Accusoft-Data-SK")); var aq = IPCC.Web.Hw(sf, hw); var fw = IPCC.Web.Hg(bF); var vb = IPCC.Web.AB(fw, aq, hw); ty = IPCC.Web.hm.GR.nh(vb); } else { ty = bF.responseText; } var Zx; if (ty.length >= 1000) { Zx = ty.substring(0, 1000); } else { Zx = ty.substring(0, ty.length); } aEo(Zx, bF); } } catch (ex) { if (nX) { nX = false; if (mn < 1) { setTimeout(Sd, 10); return; } } cT = "Attributes parsing error, Error message = " + ex.message; throw new IPCC.Web.UI.ImGearArgumentException(null, cT); } }; function eZ(bM) { try { var cT, kA, ly; if (!bM.response) { throw new IPCC.Web.UI.ImGearHttpException(bM.response.status, "Client timed out on load"); } if (bM.response.status === 403) { mn++; if (bM.response.statusText && bM.response.statusText !== "") { cT = "Expired viewer session ID, error message from the server: " + bM.response.statusText; } else { cT = "Expired viewer session ID. Np error text message was received from the server:"; } throw new IPCC.Web.UI.ImGearHttpException(bM.response.status, cT); } if (nX) { nX = false; if (mn < 1) { setTimeout(Sd, 10); return; } } ly = bM.response.getResponseHeader('Accusoft-Status-Message'); if (ly) { var pr; kA = bM.response.getResponseHeader('Accusoft-Status-Number'); if (IPCC.Web.vo(kA)) { pr = parseInt(kA, 10); } throw new IPCC.Web.UI.ImGearHttpException(bM.response.status, ly, pr); } else { if (bM.response.statusText && bM.response.statusText !== "") { cT = "Error message from the service: " + bM.response.statusText; } else { cT = "HTTP Error was received from the image server but the server did not provide any error description."; } throw new IPCC.Web.UI.ImGearHttpException(bM.response.status, cT); } } catch (e) { if (nX) { nX = false; if (mn < 1) { setTimeout(Sd, 10); return; } } C.bK('openPage', e); if (typeof (C.aM) === 'function') { var dz = new IPCC.Web.UI.ImGearPageOpenFailedEventArgs(); dz.exception = e; dz.pageNumber = C.aD; C.aM('pageOpenFailed', dz); } } }; var hw = IPCC.Web.qS.Ow(4, IPCC.Web.PE()); var nK = IPCC.Web.hm.Fr.nh(hw); var hc = { method: 'GET' }; if (!nX) { hc.url = this.get_url(iY, 'Attributes'); hc.headers = { 'Content-Type': 'application/json' }; } else { var am; if (C.eG() === true) { hw = IPCC.Web.qS.abx(4, IPCC.Web.PE()); nK = IPCC.Web.hm.Fr.nh(hw); am = this.get_url(iY, 'SvgImage', 'Scale=1&ContentType=' + IPCC.J.Yj + '&iv=' + nK); } else { am = this.get_url(iY, 'SvgImage', 'Scale=1&ContentType=' + IPCC.J.Yj); } hc.url = am; } IPCC.J.mt.dZ(hc).then(fa, eZ); }; this.axq = function (iY, C, DF) { C.aD = this.aD; var mn = 0; var pq = true; if (C.hT() === 0) { pq = false; } var mH = function (ei, bF) { try { if (ei === null) { throw new IPCC.Web.UI.ImGearArgumentException(null, 'Unable to load the specified image. Failed to obtain Image attributes. Returned JSON from the server is null'); } K.width = +(ei.imageWidth); K.height = +(ei.imageHeight); K.hi = +(ei.imageXResolution); if (K.hi <= 0) { K.hi = 72; } K.hk = +(ei.imageYResolution); if (K.hk <= 0) { K.hk = 72; } K.eD = +(ei.pageCount); K.sa = true; var lV = bF.getResponseHeader("Accusoft-Data-Encrypted"); var JP = false; if (lV === "true") { JP = true; } C.adR(JP); if (DF) { DF(); } } catch (e) { C.bK('openPage', e); if (typeof (C.aM) === 'function') { var dz = new IPCC.Web.UI.ImGearPageOpenFailedEventArgs(); dz.exception = e; dz.pageNumber = C.aD; C.aM('pageOpenFailed', dz); } } }; function fa(bF) { try { var fS = bF.status, bM, cT; if (fS === 200) { bM = null; try { if (typeof JSON !== 'undefined') { bM = JSON.parse(bF.responseText); } else { bM = IPCC.ct.pG(bF.responseText); } mH(bM, bF); } catch (ex) { cT = "Attributes parsing error, Error meesage = " + ex.message; throw new IPCC.Web.UI.ImGearArgumentException(null, cT); } } } catch (e) { C.bK('openPageForRaster', e); if (typeof (C.aM) === 'function') { var dz = new IPCC.Web.UI.ImGearPageOpenFailedEventArgs(); dz.exception = e; dz.pageNumber = C.aD; C.aM('pageOpenFailed', dz); } } }; function eZ(bM) { try { var fS = bM.response.status, cT, ly, kA; if (!bM.response) { throw new IPCC.Web.UI.ImGearHttpException(fS, "Client timed out on load"); } if (fS === 403) { mn++; if (bM.response.statusText && bM.response.statusText !== "") { cT = "Expired viewer session ID, error message from the server: " + bM.response.statusText; } else { cT = "Expired viewer session ID. No error text message was received from the server:"; } throw new IPCC.Web.UI.ImGearHttpException(fS, cT); } ly = bM.response.getResponseHeader('Accusoft-Status-Message'); if (ly) { var pr; kA = bM.response.getResponseHeader('Accusoft-Status-Number'); if (IPCC.Web.vo(kA)) { pr = parseInt(kA, 10); } throw new IPCC.Web.UI.ImGearHttpException(fS, ly, pr); } else { if (bM.response.statusText && bM.response.statusText !== "") { cT = "Error message from the service: " + bM.response.statusText; } else { cT = "HTTP Error was received from the image server but the server did not provide any error description."; } throw new IPCC.Web.UI.ImGearHttpException(fS, cT); } } catch (e) { C.bK('openPageForRaster', e); if (typeof (C.aM) === 'function') { var dz = new IPCC.Web.UI.ImGearPageOpenFailedEventArgs(); dz.exception = e; dz.pageNumber = C.aD; C.aM('pageOpenFailed', dz); } } }; var afB = { method: 'GET', url: this.get_url(iY, 'Attributes'), headers: { 'Content-Type': 'application/json' } }; if (pq === true) { afB.timeout = C.hT(); } IPCC.J.mt.dZ(afB).then(fa, eZ); }; return this; }; IPCC.gB.prototype = new IPCC.EB(0, 0, 0, 0); IPCC.gB.prototype.clone = function () { var acg = new IPCC.gB(this.get_encodedIdentifier(), this.aD, this.width, this.height, this.hi, this.hk); acg.eD = this.eD; acg.sa = this.sa; return acg; }; IPCC.gB.prototype.equals = function (F) { if (this.get_encodedIdentifier() !== F.get_encodedIdentifier()) { return false; } if (this.aD !== F.aD) { return false; } return true; }; IPCC.gB.prototype.sV = 8; IPCC.gB.prototype.uV = 0.000001; IPCC.gB.Vh = function (bo) { var JC = bo.referenceDocumentIdentifier; var aeK = IPCC.gB.sv(JC); var hQ = bo.encodedDocumentIdentifier; var kC = bo.documentIdentifier; var fp; if (hQ === '') { hQ = undefined; } if (kC === '') { kC = undefined; } if (JC && JC !== '') { if (hQ === aeK) { hQ = undefined; } if (kC === JC) { kC = undefined; } } if (kC) { fp = IPCC.gB.sv(kC); if (hQ) { if (hQ !== fp) { throw new IPCC.Web.UI.ImGearArgumentException('documentIdentifier', 'When both are specified, documentIdentifier and encodedDocumentIdentifier must reference the same document (and encodedDocumentIdentifier must be base64-encoded).'); } } else { hQ = fp; } } else { if (hQ) { kC = IPCC.gB.Lt(hQ); } } if (!hQ) { kC = JC; hQ = aeK; } var bp = bo.pageNumber; var aeD = bo.referencePageNumber; if (bp === aeD) { bp = undefined; } if (bp !== 0 && !bp) { bp = aeD; } bo.encodedDocumentIdentifier = hQ; bo.documentIdentifier = kC; bo.pageNumber = bp; }; IPCC.gB.sv = function (lw) { if (!lw || lw === '') { return ''; } var or = []; var G; for (G = 0; G < lw.length; G++) { or.push(lw.charCodeAt(G) % 256); or.push(Math.floor(lw.charCodeAt(G) / 256)); } or.push(0); or.push(0); var ME = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_'; var qB = [], tp; for (G = 0; G < or.length - 1; G += 3) { tp = or[G] * 0x10000 + or[G + 1] * 0x100 + or[G + 2]; qB.push(ME.charAt(Math.floor(tp / 0x40000))); qB.push(ME.charAt(Math.floor(tp / 0x1000) % 0x40)); qB.push(ME.charAt(Math.floor(tp / 0x40) % 0x40)); qB.push(ME.charAt(tp % 0x40)); } var abg = Math.ceil(lw.length * 16 / 6); while (qB.length > abg) { qB.pop(); } if ((qB.length % 4) === 3) { qB.push('1'); } else if ((qB.length % 4) === 2) { qB.push('2'); } else if ((qB.length % 4) === 0) { qB.push('0'); } return qB.join(''); }; IPCC.gB.Lt = function (lM) { if (!lM || lM === '') { return ''; } var ahq = lM.length - 1; var SR = [], tp; var sr, or = [], qZ = []; var G; for (G = 0; G < ahq; G++) { sr = lM.charCodeAt(G); if (sr > 64 && sr < 91) { qZ.push(sr - 65); } else if (sr > 96 && sr < 123) { qZ.push(sr - 97 + 26); } else if (sr > 47 && sr < 58) { qZ.push(sr - 48 + 52); } else if (sr === 45) { qZ.push(62); } else if (sr === 95) { qZ.push(63); } else { return ''; } } qZ.push(0); qZ.push(0); qZ.push(0); for (G = 0; G < qZ.length - 3; G += 4) { tp = qZ[G] * 0x40000 + qZ[G + 1] * 0x1000 + qZ[G + 2] * 0x40 + qZ[G + 3]; or.push(Math.floor(tp / 0x10000)); or.push(Math.floor(tp / 0x100) % 256); or.push(tp % 256); } for (G = 0; G < or.length - 1; G += 2) { SR.push(String.fromCharCode(or[G] + or[G + 1] * 0x100)); } var abg = Math.floor(ahq * 6 / 16); while (SR.length > abg) { SR.pop(); } return SR.join(''); }; IPCC.wO = function () { this.aR = false; this.C = false; }; IPCC.wO.prototype.nR = function (C) { C.bG().set_cursor(IPCC.bP.Magnifier); this.C = C; }; IPCC.wO.prototype.ec = function () { this.C = false; }; IPCC.wO.prototype.aV = function () { if (this.aR) { this.C.bG().hideMagnifier(); this.C.bG().set_cursor(this.ia); this.aR = false; } }; IPCC.wO.prototype.rZ = function () { this.aV(); }; IPCC.wO.prototype.jO = function (L) { this.aV(); if (L.domEvent.button === 0) { this.ia = this.C.bG().get_cursor(); this.C.bG().set_cursor(IPCC.bP.None); this.aR = true; this.C.bG().showMagnifier(L.windowPoint); this.C.cn(); } }; IPCC.wO.prototype.lp = function (L) { if (L.domEvent.button !== 0) { this.aV(); } if (this.aR) { this.C.bG().showMagnifier(L.windowPoint); this.C.cn(); } }; IPCC.wO.prototype.iB = function () { this.aV(); this.C.cn(); }; IPCC.wO.prototype.qE = function (L) { var aU = this.C.ff(); if (L.windowPoint.x <= 0 || L.windowPoint.x >= aU.width - 2) { this.aV(); } if (L.windowPoint.y <= 0 || L.windowPoint.y >= aU.height - 2) { this.aV(); } }; IPCC.qQ = function () { this.aR = false; this.C = false; }; IPCC.qQ.prototype.nR = function (C) { C.bG().set_cursor(IPCC.bP.RectangleZoom); this.C = C; }; IPCC.qQ.prototype.ec = function () { this.C = false; }; IPCC.qQ.prototype.aV = function () { if (this.aR) { this.C.bG().ny(); this.C.bG().set_cursor(this.ia); this.aR = false; this.C.cn(); } }; IPCC.qQ.prototype.rZ = function () { this.aV(); this.C.cn(); }; IPCC.qQ.prototype.jO = function (L) { this.aV(); if (L.domEvent.button === 0) { var bm = this.C.bG(); this.ia = bm.get_cursor(); bm.set_cursor(IPCC.bP.RectangleZoom); this.aR = true; bm.DO(L.constrainedImagePoint); this.tS = L.windowPoint; this.C.cn(); } }; IPCC.qQ.prototype.lp = function (L) { if (L.domEvent.button !== 0) { this.aV(); } if (this.aR) { var bm = this.C.bG(); bm.Ei(L.constrainedImagePoint); this.C.cn(); } }; IPCC.qQ.prototype.iB = function (L) { if (this.aR && L.domEvent.button === 0) { var fp = L.windowPoint.x - this.tS.x; var jD = fp * fp; fp = L.windowPoint.y - this.tS.y; jD += fp * fp; if (jD > 25) { var C = this.C; var bm = C.bG(); var bz = bm.eV(); var aU = C.ff(); var awf = aU.width; var aww = aU.height; var bb = C.cX(); bm.Ei(L.constrainedImagePoint); var jT = bm.xf(); bm.ny(); C.aM('userModifiedViewState', {}); bz.Rr(bb, aU, jT); bz.kY(bb, aU); bm.lv(bz); C.cn(); if (awf !== aU.width || aww !== aU.height) { bz = bm.eV(); bz.Rr(bb, aU, jT); bz.kY(bb, aU); bm.lv(bz); } } } this.aV(); }; IPCC.qQ.prototype.qE = function (L) { var aU = this.C.ff(); if (L.windowPoint.x <= 0 || L.windowPoint.x >= aU.width - 2) { this.aV(); } if (L.windowPoint.y <= 0 || L.windowPoint.y >= aU.height - 2) { this.aV(); } }; IPCC.qQ.prototype.lY = function () { this.aV(); }; IPCC.uy = function () { this.aR = false; this.C = false; }; IPCC.uy.prototype.nR = function (C) { C.bG().set_cursor(IPCC.bP.HandOpen); this.C = C; }; IPCC.uy.prototype.ec = function () { this.C = false; }; IPCC.uy.prototype.aV = function () { if (this.aR) { this.C.bG().set_cursor(this.ia); this.aR = false; } }; IPCC.uy.prototype.rZ = function () { this.aV(); }; IPCC.uy.prototype.jO = function (L) { this.aV(); if (L.domEvent.button === 0) { this.ia = this.C.bG().get_cursor(); this.C.bG().set_cursor(IPCC.bP.HandClosed); this.aR = true; this.Ta = L.imagePoint; } }; IPCC.uy.prototype.lp = function (L) { if (L.domEvent.button !== 0) { this.aV(); } if (this.aR) { var C = this.C; var bm = C.bG(); var bz = bm.eV(); var aU = C.ff(); bz.Uw(this.Ta, L.windowPoint); bz.kY(C.cX(), aU); C.aM('userModifiedViewState', {}); bm.lv(bz); C.cn(); } }; IPCC.uy.prototype.iB = function () { this.aV(); }; IPCC.uy.prototype.qE = function (L) { var aU = this.C.ff(); if (L.windowPoint.x <= 0 || L.windowPoint.x >= aU.width - 2) { this.aV(); } if (L.windowPoint.y <= 0 || L.windowPoint.y >= aU.height - 2) { this.aV(); } }; IPCC.uy.prototype.lY = function () { this.aV(); }; IPCC.ta = function () { this.aR = false; this.C = false; }; IPCC.ta.prototype.nR = function (C) { C.bG().set_cursor(IPCC.bP.Crosshair); this.C = C; }; IPCC.ta.prototype.ec = function () { this.C = false; }; IPCC.ta.prototype.aV = function () { if (this.aR) { this.C.ny(); this.C.bG().set_cursor(this.ia); this.aR = false; this.C.cn(); } }; IPCC.ta.prototype.rZ = function () { this.aV(); }; IPCC.ta.prototype.jO = function (L) { this.aV(); if (L.domEvent.button === 0) { var bm = this.C.bG(); this.ia = bm.get_cursor(); bm.set_cursor(IPCC.bP.Crosshair); this.aR = true; bm.DO(L.constrainedImagePoint); this.C.cn(); } }; IPCC.ta.prototype.lp = function (L) { if (L.domEvent.button !== 0) { this.aV(); } if (this.aR) { var bm = this.C.bG(); bm.Ei(L.constrainedImagePoint); this.C.cn(); } }; IPCC.ta.prototype.iB = function (L) { if (L.domEvent.button === 0) { this.aR = false; } this.aV(); }; IPCC.ta.prototype.qE = function (L) { var aU = this.C.ff(); if (L.windowPoint.x <= 0 || L.windowPoint.x >= aU.width - 2) { this.aV(); } if (L.windowPoint.y <= 0 || L.windowPoint.y >= aU.height - 2) { this.aV(); } }; IPCC.ta.prototype.lY = function () { this.aV(); }; IPCC.fN = function () { this.C = false; this.awP = 1.5; }; IPCC.fN.prototype.nR = function (C) { this.C = C; }; IPCC.fN.prototype.ec = function () { this.C = false; }; IPCC.fN.prototype.aV = function () { }; IPCC.fN.prototype.lY = function (L) { var bm = this.C.bG(); var bb = this.C.cX(); var aU = this.C.ff(); var bz = bm.eV(); var RS = L.wheelDelta / 120; if (L.domEvent.ctrlKey) { L.domEvent.preventDefault(); var ab = ((this.awP - 1) / 2) + 1; if (RS < 0) { ab = 1 / ab; } var lW = bz.qs(); if (lW * ab > bb.sV) { ab = bb.sV / lW; } if (lW * ab < bb.uV) { ab = bb.uV / lW; } bz.xH(ab, ab, L.windowPoint.x, L.windowPoint.y); bz.kY(bb, aU); this.C.aM('userModifiedViewState', {}); bm.lv(bz); } else { var aqf = bz.transform({ x: 0, y: 0 }); bz.oa(0, RS * aU.hk); bz.kY(bb, aU); var ape = bz.transform({ x: 0, y: 0 }); if (Math.abs(aqf.x - ape.x) > 0.001 || Math.abs(aqf.y - ape.y) > 0.001) { L.domEvent.preventDefault(); this.C.aM('userModifiedViewState', {}); bm.lv(bz); } } this.C.cn(); }; IPCC.fI = function (bi) { this.aR = false; this.C = false; this.bi = bi; switch (this.bi) { case IPCC.Web.UI.MarkType.Rectangle: this.cP = IPCC.bP.AddRectangleMark; break; case IPCC.Web.UI.MarkType.Ellipse: this.cP = IPCC.bP.AddEllipseMark; break; case IPCC.Web.UI.MarkType.Text: case IPCC.Web.UI.MarkType.TextLine: case IPCC.Web.UI.MarkType.TextAreaSignature: this.cP = IPCC.bP.AddTextMark; break; case IPCC.Web.UI.MarkType.Stamp: this.cP = IPCC.bP.AddStampMark; break; case IPCC.Web.UI.MarkType.ImageStampAnnotation: case IPCC.Web.UI.MarkType.ImageStampRedaction: this.cP = IPCC.bP.AddImageStampMark; break; case IPCC.Web.UI.MarkType.RectangleRedaction: this.cP = IPCC.bP.AddRectangleRedactionMark; break; case IPCC.Web.UI.MarkType.Highlight: case IPCC.Web.UI.MarkType.HighlightText: case IPCC.Web.UI.MarkType.TextSelectionRedaction: case IPCC.Web.UI.MarkType.Strikethrough: this.cP = IPCC.bP.AddRectangleMark; break; } }; IPCC.fI.prototype.nR = function (C) { C.bG().set_cursor(this.cP); this.C = C; }; IPCC.fI.prototype.ec = function () { this.C = false; }; IPCC.fI.prototype.aV = function () { if (this.aR) { this.R = null; this.C.pW(null); this.C.bG().set_cursor(this.ia); this.aR = false; this.C.cn(); } }; IPCC.fI.prototype.rZ = function () { this.aV(); }; IPCC.fI.prototype.jO = function (L) { this.aV(); if (L.domEvent.button === 0) { var bm = this.C.bG(); this.ia = bm.get_cursor(); bm.set_cursor(this.cP); this.aR = true; this.R = new IPCC.Web.UI.Mark(this.bi); this.R.set_rectangle({ x: L.imagePoint.x, y: L.imagePoint.y, width: 0, height: 0 }); this.C.pW(this.R); this.ue = L.imagePoint; this.tS = L.windowPoint; } }; IPCC.fI.prototype.lp = function (L) { if (L.domEvent.button !== 0) { this.aV(); } if (this.aR) { var mb = { x: Math.min(L.imagePoint.x, this.ue.x), y: Math.min(L.imagePoint.y, this.ue.y) }; mb.width = Math.max(L.imagePoint.x, this.ue.x) - mb.x; mb.height = Math.max(L.imagePoint.y, this.ue.y) - mb.y; this.R.set_rectangle(mb); this.C.cn(); } }; IPCC.fI.prototype.iB = function (L) { if (this.aR && L.domEvent.button === 0) { var fp = L.windowPoint.x - this.tS.x; var jD = fp * fp; fp = L.windowPoint.y - this.tS.y; jD += fp * fp; if (jD > 25) { var mb = { x: Math.min(L.imagePoint.x, this.ue.x), y: Math.min(L.imagePoint.y, this.ue.y) }; mb.width = Math.max(L.imagePoint.x, this.ue.x) - mb.x; mb.height = Math.max(L.imagePoint.y, this.ue.y) - mb.y; this.C.pW(null); this.R.set_rectangle(mb); var aZ = this.R; var C = this.C; var rd = { clientX: L.domEvent.clientX, clientY: L.domEvent.clientY }; this.C.eI().addMark(this.R, rd); if (aZ.jd() === IPCC.Web.UI.MarkType.Text || aZ.jd() === IPCC.Web.UI.MarkType.TextLine || aZ.jd() === IPCC.Web.UI.MarkType.TextAreaSignature) { C.xh(aZ); } C.cn(); } } this.aV(); }; IPCC.fI.prototype.qE = function (L) { var aU = this.C.ff(); if (L.windowPoint.x <= 0 || L.windowPoint.x >= aU.width - 2) { this.aV(); } if (L.windowPoint.y <= 0 || L.windowPoint.y >= aU.height - 2) { this.aV(); } }; IPCC.fI.prototype.lY = function () { this.aV(); }; IPCC.rJ = function () { this.aR = false; this.C = false; this.cP = IPCC.bP.AddLineMark; }; IPCC.rJ.prototype.nR = function (C) { C.bG().set_cursor(this.cP); this.C = C; }; IPCC.rJ.prototype.ec = function () { this.C = false; }; IPCC.rJ.prototype.aV = function () { if (this.aR) { this.R = null; this.C.pW(null); this.C.bG().set_cursor(this.ia); this.aR = false; this.C.cn(); } }; IPCC.rJ.prototype.rZ = function () { this.aV(); }; IPCC.rJ.prototype.jO = function (L) { this.aV(); if (L.domEvent.button === 0) { var bm = this.C.bG(); this.ia = bm.get_cursor(); bm.set_cursor(this.cP); this.aR = true; this.R = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.Line); this.R.get_points().setPoint(0, L.imagePoint); this.R.get_points().setPoint(1, L.imagePoint); this.C.pW(this.R); this.ue = L.imagePoint; this.tS = L.windowPoint; } }; IPCC.rJ.prototype.lp = function (L) { if (L.domEvent.button !== 0) { this.aV(); } if (this.aR) { this.R.get_points().setPoint(1, L.imagePoint); this.C.cn(); } }; IPCC.rJ.prototype.iB = function (L) { if (this.aR && L.domEvent.button === 0) { var fp = L.windowPoint.x - this.tS.x; var jD = fp * fp; fp = L.windowPoint.y - this.tS.y; jD += fp * fp; if (jD > 25) { var C = this.C; var rd = { clientX: L.domEvent.clientX, clientY: L.domEvent.clientY }; this.R.get_points().setPoint(1, L.imagePoint); this.C.pW(null); this.C.eI().addMark(this.R, rd); C.cn(); } } this.aV(); }; IPCC.rJ.prototype.qE = function (L) { var aU = this.C.ff(); if (L.windowPoint.x <= 0 || L.windowPoint.x >= aU.width - 2) { this.aV(); } if (L.windowPoint.y <= 0 || L.windowPoint.y >= aU.height - 2) { this.aV(); } }; IPCC.rJ.prototype.lY = function () { this.aV(); }; IPCC.qb = function () { this.aR = false; this.C = false; this.cP = IPCC.bP.AddFreehandMark; }; IPCC.qb.prototype.nR = function (C) { C.bG().set_cursor(this.cP); this.C = C; }; IPCC.qb.prototype.ec = function () { this.C = false; }; IPCC.qb.prototype.aV = function () { if (this.aR) { this.R = null; this.pF = null; this.C.pW(null); this.C.bG().set_cursor(this.ia); this.aR = false; } }; IPCC.qb.prototype.rZ = function () { this.aV(); }; IPCC.qb.prototype.jO = function (L) { this.aV(); if (L.domEvent.button === 0) { var bm = this.C.bG(); this.ia = bm.get_cursor(); bm.set_cursor(this.cP); this.aR = true; this.R = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.Polyline); this.R.get_points().addPoint(L.imagePoint); this.pF = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.Freehand); this.C.pW(this.R, this.pF); this.R.set_lineWidth(this.pF.dQ); this.R.set_lineColor(this.pF.gX); this.R.set_opacity(this.pF.dI); this.ue = L.imagePoint; this.tS = L.windowPoint; this.C.cn(); } }; IPCC.qb.prototype.lp = function (L) { if (L.domEvent.button !== 0) { this.aV(); } if (this.aR) { this.R.get_points().addPoint(L.imagePoint); this.C.cn(); } }; IPCC.qb.prototype.iB = function (L) { if (this.aR && L.domEvent.button === 0) { this.R.get_points().addPoint(L.imagePoint); var alV = this.R.get_points(); var ag = []; var ip = Number.MAX_VALUE, iG = 0, _top = Number.MAX_VALUE, jY = 0; var G = 0; for (G = 0; G < alV.get_length() ; G++) { var vi = alV.getPoint(G); if (vi.x < ip) { ip = vi.x; } if (vi.x > iG) { iG = vi.x; } if (vi.y < _top) { _top = vi.y; } if (vi.y > jY) { jY = vi.y; } ag.push({ x: vi.x, y: vi.y }); } var DK = 3; var uq; var sS = (ag.length < DK) ? ag : IPCC.J.filter(ag, function (bL) { if (uq) { var aY = bL.x - uq.x, fJ = bL.y - uq.y, eY = aY * aY + fJ * fJ; if (Math.sqrt(eY) < 4) { return false; } } bL.x = bL.x - ip; bL.y = bL.y - _top; uq = bL; return true; }); if (sS.length < DK) { sS = [ag[0], ag[ag.length - 1]]; } var cI = ''; uq = undefined; if (sS.length < DK) { cI += this.Qk(sS); } else { cI = 'M' + IPCC.J.bspline(sS); cI = cI.replace(/\d*\.?\d*/g, function (bj) { var JV = bj.indexOf('.'); if (bj.length && JV > 0) { return bj.substr(0, JV + 3); } else if (bj !== "") { return bj; } else { return bj; } }); } var ax = iG - ip; var cR = jY - _top; var rd = { clientX: L.domEvent.clientX, clientY: L.domEvent.clientY }; this.pF.set_rectangle({ x: ip, y: _top, width: ax, height: cR }); this.pF.set_pathString(cI); this.pF.set_pathWidth(ax); this.pF.set_pathHeight(cR); this.C.pW(null); this.C.eI().addMark(this.pF, rd); this.C.cn(); } this.aV(); }; IPCC.qb.prototype.Qk = function (gA, JR) { var adp = (JR && IPCC.J.Hd) ? 'm' : 'M'; var adv = (JR && IPCC.J.Hd) ? 'l' : 'L'; return IPCC.J.map(gA, function (bL, G) { if (G === 0) { return adp + bL.x + ',' + bL.y; } else { return adv + bL.x + ',' + bL.y; } }).join(''); }; IPCC.qb.prototype.qE = function (L) { var aU = this.C.ff(); if (L.windowPoint.x <= 0 || L.windowPoint.x >= aU.width - 2) { this.aV(); } if (L.windowPoint.y <= 0 || L.windowPoint.y >= aU.height - 2) { this.aV(); } }; IPCC.qb.prototype.lY = function () { this.aV(); }; IPCC.pb = function (bi) { this.aR = false; this.C = false; this.bi = bi; switch (this.bi) { case IPCC.Web.UI.MarkType.Polygon: this.cP = IPCC.bP.AddPolygonMark; break; case IPCC.Web.UI.MarkType.Polyline: this.cP = IPCC.bP.AddPolylineMark; this.abT = false; break; } }; IPCC.pb.prototype.nR = function (C) { C.bG().set_cursor(this.cP); this.C = C; }; IPCC.pb.prototype.ec = function () { this.C = false; }; IPCC.pb.prototype.aV = function () { if (this.aR) { if (arguments[0]) { if (arguments[0] === true) { if (this.R && this.abT === false) { this.C.eI().addMark(this.R); this.abT = true; this.C.cn(); } } } this.R = null; this.C.pW(null); this.C.bG().set_cursor(this.ia); this.aR = false; this.C.cn(); } }; IPCC.pb.prototype.rZ = function () { this.aV(); }; IPCC.pb.prototype.jO = function (L) { if (L.domEvent.button === 0) { if (!this.aR) { var bm = this.C.bG(); this.ia = bm.get_cursor(); bm.set_cursor(this.cP); this.aR = true; this.R = new IPCC.Web.UI.Mark(this.bi); this.R.get_points().addPoint(L.imagePoint); this.C.pW(this.R); } var ag = this.R.get_points(); if (ag.get_length() > 0) { ag.setPoint(ag.get_length() - 1, L.imagePoint); } ag.addPoint(L.imagePoint); this.ue = L.imagePoint; this.tS = L.windowPoint; this.C.cn(); } else { this.aV(); } }; IPCC.pb.prototype.vS = function (L) { if (this.aR && L.domEvent.button === 0) { var ag = this.R.get_points(), dg = ag.get_length(), XY, WH; if (dg > 2) { var afc = true; while (afc) { dg = ag.get_length(); XY = ag.getPoint(dg - 1); WH = ag.getPoint(dg - 2); if (XY.x === WH.x && XY.y === WH.y) { ag.removePoint(dg - 1); } else { afc = false; } } } if (ag.get_length() > 0) { ag.setPoint(ag.get_length() - 1, L.imagePoint); } this.C.pW(null); var rd = { clientX: L.domEvent.clientX, clientY: L.domEvent.clientY }; this.C.eI().addMark(this.R, rd); this.abT = true; this.C.cn(); } this.aV(); }; IPCC.pb.prototype.lp = function (L) { if (L.domEvent.button !== 0) { this.aV(); } if (this.aR) { var ag = this.R.get_points(); if (ag.get_length() > 0) { ag.setPoint(ag.get_length() - 1, L.imagePoint); } this.C.cn(); } }; IPCC.pb.prototype.qE = function (L) { var aU = this.C.ff(); if (L.windowPoint.x <= 0 || L.windowPoint.x >= aU.width - 2) { this.aV(); } if (L.windowPoint.y <= 0 || L.windowPoint.y >= aU.height - 2) { this.aV(); } }; IPCC.pb.prototype.lY = function () { this.aV(); }; IPCC.jp = true; IPCC.ft = { ajC: 1, ahM: 2, XN: 3, akA: 4, apr: 5, Ma: 6, Nf: 7, amx: 8, alW: 9, apG: 10, aqZ: 11, aqn: 12, aqc: 13, aiB: 14, ajx: 15, afl: 16 }; IPCC.agX = null; IPCC.gf = function (Ut, avF) { this.C = false; this.Ut = Ut; var lC = IPCC.Web.UI; var dN = avF; if (!dN || dN === null) { dN = IPCC.agX; } this.dN = dN; var awz = { az: dN.zoomInMenuItem, ee: IPCC.ft.ajC, F: 1.25 }; var awY = { az: dN.zoomOutMenuItem, ee: IPCC.ft.ahM, F: 1.25 }; var asd = { az: dN.fullImageMenuItem, F: lC.FitType.FullImage }; var auU = { az: dN.fullWidthMenuItem, F: lC.FitType.FullWidth }; var asV = { az: dN.fullHeightMenuItem, F: lC.FitType.FullHeight }; var avf = { az: dN.oneToOneRatioMenuItem, F: lC.FitType.OneToOne }; var aHK = { az: dN.actualSizeMenuItem, F: lC.FitType.ActualSize }; var azR = { az: dN.rotateRightMenuItem, ee: IPCC.ft.XN, F: 90 }; var azz = { az: dN.rotateLeftMenuItem, ee: IPCC.ft.XN, F: -90 }; var axS = { az: dN.mirrorHorizontalMenuItem, ee: IPCC.ft.akA }; var axT = { az: dN.mirrorVerticalMenuItem, ee: IPCC.ft.apr }; var Xj = { az: dN.panToolMenuItem, F: lC.MouseTool.HandPan }; var adH = { az: dN.areaSelectionToolMenuItem, F: lC.MouseTool.Select }; var UY = { az: dN.zoomRectangleToolMenuItem, F: lC.MouseTool.RectangleZoom }; var abi = { az: dN.flyingMagnifierToolMenuItem, F: lC.MouseTool.Magnifier }; var aqt = { az: dN.createTextMarkToolMenuItem, F: lC.MouseTool.CreateTextMark }; var arL = { az: dN.createLineMarkToolMenuItem, F: lC.MouseTool.CreateLineMark }; var apC = { az: dN.createRectangleMarkToolMenuItem, F: lC.MouseTool.CreateRectangleMark }; var arS = { az: dN.createEllipseMarkToolMenuItem, F: lC.MouseTool.CreateEllipseMark }; var auw = { az: dN.editMarksToolMenuItem, F: lC.MouseTool.EditMarks }; var asq = { az: dN.createStampMarkToolMenuItem, F: lC.MouseTool.CreateStampMark }; var auR = { az: dN.createHighlightMarkToolMenuItem, F: lC.MouseTool.CreateHighlightTextMark }; var akw = { ax: 55, ek: [{ az: dN.thicknessMenu.item1, F: 1 }, { az: dN.thicknessMenu.item2, F: 2 }, { az: dN.thicknessMenu.item3, F: 3 }, { az: dN.thicknessMenu.item4, F: 4 }, { az: dN.thicknessMenu.item5, F: 5 }, { az: dN.thicknessMenu.item6, F: 6 }, { az: dN.thicknessMenu.item7, F: 7 }, { az: dN.thicknessMenu.item8, F: 8 }] }; var axs = { ax: 145, ek: [{ az: dN.opacityMenu.translucent, F: 127 }, { az: dN.opacityMenu.opaque, F: 255 }] }; var Nj = { az: dN.borderThicknessMenuItem, ee: IPCC.ft.Ma, dC: 'lineWidth', pe: akw }; var Og = { az: dN.borderColorMenuItem, ee: IPCC.ft.Nf, dC: 'lineColor' }; var KS = { az: dN.fillColorMenuItem, ee: IPCC.ft.Nf, dC: 'fillColor' }; var app = { az: dN.lineThicknessMenuItem, ee: IPCC.ft.Ma, dC: 'lineWidth', pe: akw }; var aoc = { az: dN.lineColorMenuItem, ee: IPCC.ft.Nf, dC: 'lineColor' }; var aqC = { az: dN.fontMenuItem, ee: IPCC.ft.amx }; var OY = { az: dN.opacityMenuItem, ee: IPCC.ft.Ma, dC: 'opacity', pe: axs }; var awS = { az: dN.moveToBackMenuItem, ee: IPCC.ft.apG }; var atT = { az: dN.moveBackwardMenuItem, ee: IPCC.ft.aqZ }; var ato = { az: dN.moveForwardMenuItem, ee: IPCC.ft.aqn }; var awV = { az: dN.moveToFrontMenuItem, ee: IPCC.ft.aqc }; var xL = { az: dN.deleteMarkMenuItem, ee: IPCC.ft.aiB }; var avq = { ax: 180, ek: [asd, auU, asV, avf, aHK] }; var avx = { az: dN.zoomToFitMenuItem, ee: IPCC.ft.ajx, pe: avq }; var avr = { ax: 200, ek: [azR, azz, axS, axT] }; var awF = { az: dN.orientationMenuItem, pe: avr }; var Qb; if (IPCC.dv) { if (IPCC.jp === false) { Qb = { ax: 180, ek: [Xj, UY, abi, adH, null] }; } else { Qb = { ax: 180, ek: [Xj, UY, abi, adH, null, auw, aqt, arL, apC, arS, asq, auR] }; } } else { Qb = { ax: 180, ek: [Xj, UY, abi, adH] }; } var atJ = { az: dN.mouseToolsMenuItem, ee: IPCC.ft.afl, pe: Qb }; var aBZ = { ax: 150, ek: [KS, Nj, Og, null, OY] }; var atr = { ax: 150, ek: [KS, Nj, Og, null, null] }; var aCy = { ax: 150, az: dN.rectangleMarkPropertiesMenuItem, pe: aBZ }; var ayT = { ax: 150, az: dN.rectangleMarkPropertiesMenuItem, pe: atr }; var aqX = { ax: 150, ek: [aqC, KS, Nj, Og, null, null, null, OY] }; var aqh = { az: dN.textMarkPropertiesMenuItem, pe: aqX }; var aCL = { ax: 150, ek: [KS, Nj, Og, null, OY] }; var aBQ = { az: dN.polygonMarkPropertiesMenuItem, pe: aCL }; var aCz = { ax: 140, ek: [app, aoc, null, OY] }; var aBG = { az: dN.polylineMarkPropertiesMenuItem, pe: aCz }; var arx = { ax: 140, ek: [app, aoc, null, null] }; var asu = { az: dN.lineMarkPropertiesMenuItem, pe: arx }; var arv = { ax: 140, ek: [awV, ato, atT, awS] }; var xn = { az: dN.markOrderingMenuItem, pe: arv }; var aHm = { ax: 150, ek: [KS] }; var ajK = { az: dN.stampMarkPropertiesMenuItem, pe: aHm }; this.avg = { ax: 180, ek: [awz, awY, avx, awF, atJ] }; this.aqF = { ax: 140, ek: [aqh, xn, xL] }; this.aCC = { ax: 140, ek: [aCy, xn, xL] }; this.aIg = { ax: 140, ek: [ajK, xn, xL] }; this.aHA = { ax: 140, ek: [null, xn, xL] }; this.aub = { ax: 140, ek: [ayT, xn, xL] }; this.aCt = { ax: 140, ek: [aBQ, xn, xL] }; this.aBK = { ax: 140, ek: [aBG, xn, xL] }; this.arK = { ax: 140, ek: [asu, xn, xL] }; this.aDy = { ax: 140, ek: [ajK, null, xL] }; }; IPCC.gf.prototype.nR = function (C) { this.C = C; }; IPCC.gf.prototype.ec = function () { this.C = false; }; IPCC.gf.prototype.aV = function () { }; IPCC.gf.prototype.Ok = function (L) { var hX; if (L.mark && this.Ut) { var Nm = L.mark.lh(); switch (L.mark.get_type()) { case IPCC.Web.UI.MarkType.Line: hX = this.arK; break; case IPCC.Web.UI.MarkType.Polyline: hX = this.aBK; break; case IPCC.Web.UI.MarkType.Rectangle: hX = this.aCC; break; case IPCC.Web.UI.MarkType.Ellipse: hX = this.aub; break; case IPCC.Web.UI.MarkType.Polygon: hX = this.aCt; break; case IPCC.Web.UI.MarkType.Text: hX = this.aqF; break; case IPCC.Web.UI.MarkType.Stamp: if (Nm === true) { hX = this.aHA; } else { hX = this.aIg; } break; case IPCC.Web.UI.MarkType.HighlightText: case IPCC.Web.UI.MarkType.Highlight: if (L.mark.kz === 'y') { hX = this.aDy; } break; } } if (!hX) { hX = this.avg; } var xw = document.documentElement.scrollLeft - document.documentElement.clientLeft + document.body.scrollLeft - document.body.clientLeft; var xF = document.documentElement.scrollTop - document.documentElement.clientTop + document.body.scrollTop - document.body.clientTop; var ain = new IPCC.Web.UI.Point(L.domEvent.clientX + xw, L.domEvent.clientY + xF); var K = this; function xm(bJ) { if (uI) { var bk = bJ.target; if (bk && bk === null) { return; } var Dp, anE; while (bk && bk !== document.body && bk.parentNode !== null) { if (bk && bk !== null) { if (bk === uI) { anE = true; } if (!Dp && bk.ImGearCommand) { Dp = bk.ImGearCommand; } bk = bk.parentNode; } } if (!anE || Dp) { IPCC.Web.UI.al.removeHandler(document.body, 'mousedown', xm); IPCC.Web.UI.al.removeHandler(document.body, 'mousemove', alh); document.body.removeChild(uI); uI = null; if (Dp) { Dp.Wb = L; K.avL(Dp); } } } }; function Zc(Jc, DB, CG, Kv) { var ep = false, G, bk; for (G = 0; G < DB.length; G++) { if (Jc === DB[G]) { ep = true; } } if (!ep && Jc.ImGearType === 'menu') { Jc.style.display = 'none'; } else { Jc.style.display = 'block'; } bk = Jc.firstChild; while (bk) { if (bk.ImGearType === 'menuItemHighlight') { if (bk === Kv) { bk.style.display = 'block'; } else { bk.style.display = 'none'; } } if (bk.firstChild) { Zc(bk, DB, CG, Kv); } bk = bk.nextSibling; } }; function alh(bJ) { if (uI) { var bk = bJ.target; if (bk && bk === null) { return; } var DB = [uI], CG, Kv; while (bk && bk !== document.body && bk.parentNode !== null) { if (!CG && bk.ImGearType === 'menuItem') { CG = bk; } if (bk.ImGearType === 'menu') { DB.push(bk); } bk = bk.parentNode; } if (CG) { bk = CG.firstChild; while (bk) { if (bk.ImGearType === 'menuItemHighlight') { Kv = bk; } else if (bk.ImGearType === 'menu') { DB.push(bk); } bk = bk.nextSibling; } } Zc(uI, DB, CG, Kv); } }; var av; if (window.innerWidth) { av = { x: window.pageXOffset, y: window.pageYOffset, width: window.innerWidth, height: window.innerHeight }; } else if (document.documentElement.clientWidth) { av = { x: xw, y: xF, width: document.documentElement.clientWidth, height: document.documentElement.clientHeight }; } else { av = { x: xw, y: xF, width: document.body.clientWidth, height: document.body.clientHeight }; } var uI = this.aqo(hX, false, false, ain, ain, true, av, document.body, L.mark); Zc(uI, [uI], null, null); document.body.appendChild(uI); IPCC.Web.UI.al.addHandler(document.body, 'mousedown', xm); IPCC.Web.UI.al.addHandler(document.body, 'mousemove', alh); }; IPCC.gf.prototype.aqo = function (hX, ee, dC, aca, Xm, FV, av, aDf, R) { var anz = 24, aft = 1; var G, abz = 0; for (G = 0; G < hX.ek.length; G++) { var avu = hX.ek[G]; if (avu) { abz += anz; } else { abz += aft; } } var RD; if (FV) { RD = Xm.x + hX.ax; if (RD > av.x + av.width) { FV = false; } } if (!FV) { RD = aca.x - hX.ax; if (RD < av.x) { FV = true; } } var rr = { x: Xm.x, y: Xm.y }; if (!FV) { rr = { x: aca.x - hX.ax - 2, y: aca.y - 2 }; } var anW = av.y + av.height - abz - 8; if (rr.y > anW) { rr.y = anW; } if (rr.y < av.y + 2) { rr.y = av.y + 2; } function eK(la) { var uO = document.createElement('div'); var G; for (G in la) { if (la.hasOwnProperty(G)) { uO.style[G] = la[G]; } } return uO; }; var PR = eK({ zIndex: 2, width: hX.ax + 'px', left: rr.x + 'px', top: rr.y + 'px', margin: '0px', padding: '0px', border: '1px solid #C0C0C0', position: 'absolute', backgroundColor: '#F0F0F0', color: 'Black', fontSize: '11px', fontFamily: 'Arial, Helvetica, sans-serif', fontWeight: 'bold', boxShadow: '0 2px 3px rgba(0,0,0,.2)' }); PR.ImGearType = 'menu'; for (G = 0; G < hX.ek.length; G++) { var yO = hX.ek[G]; var vH; if (yO) { vH = eK({ position: 'relative', height: '24px' }); vH.ImGearType = 'menuItem'; var DQ = eK({ position: 'absolute', width: '24px', overflow: 'hidden', borderRight: '1px solid #E0E0E0', height: '24px', textAlign: 'center' }); vH.appendChild(DQ); var alR = eK({ textOverflow: 'ellipsis', whiteSpace: 'nowrap', width: hX.ax - 44 + 'px', position: 'absolute', left: '25px', padding: '0 0 0 4px', overflow: 'hidden', borderLeft: '1px solid #FFFFFF', height: '24px', lineHeight: '24px' }); vH.appendChild(alR); var anv = eK({ display: 'none', position: 'absolute', height: '24px', width: hX.ax + 'px', backgroundColor: '#00C0E0', filter: 'progid:DXImageTransform.Microsoft.Alpha(opacity=30)', opacity: '.3' }); anv.ImGearType = 'menuItemHighlight'; vH.appendChild(anv); alR.appendChild(document.createTextNode(yO.az)); var OZ = yO.ee || ee; var Kk = yO.dC || dC; if (Kk) { if (OZ === IPCC.ft.Ma) { var aGS = R['get_' + Kk](); if (aGS === yO.F) { if (this.C.nQ()) { DQ.style.backgroundImage = 'url(\'' + this.C.nQ() + '/MenuIcons.png' + '\')'; } else { DQ.style.backgroundImage = 'url(\'' + '<%=WebResource("IPCC.Web.UI.MenuIcons.png")%>' + '\')'; } DQ.style.backgroundPosition = '0px'; } } else if (OZ === IPCC.ft.alW) { var aHB = R['get_' + Kk](); if (aHB) { if (this.C.nQ()) { DQ.style.backgroundImage = 'url(\'' + this.C.nQ() + '/MenuIcons.png' + '\')'; } else { DQ.style.backgroundImage = 'url(\'' + '<%=WebResource("IPCC.Web.UI.MenuIcons.png")%>' + '\')'; } DQ.style.backgroundPosition = '24px 0px'; } } } if (!yO.pe) { vH.ImGearCommand = { ee: OZ, dC: Kk, F: yO.F }; } else { var aux = { x: av.x - rr.x, y: av.y - rr.y, width: av.width, height: av.height }; this.aqo(yO.pe, OZ, Kk, { x: 0, y: -1 }, { x: hX.ax, y: -1 }, FV, aux, vH, R); } rr.y += anz; } else { vH = eK({ height: '1px', overflow: 'hidden', backgroundColor: '#E0E0E0' }); rr.y += aft; } PR.appendChild(vH); } aDf.appendChild(PR); return PR; }; IPCC.gf.prototype.atX = function (R, cr, C) { var xw = document.documentElement.scrollLeft - document.documentElement.clientLeft + document.body.scrollLeft - document.body.clientLeft; var xF = document.documentElement.scrollTop - document.documentElement.clientTop + document.body.scrollTop - document.body.clientTop; var av; if (window.innerWidth) { av = { x: window.pageXOffset, y: window.pageYOffset, width: window.innerWidth, height: window.innerHeight }; } else if (document.documentElement.clientWidth) { av = { x: xw, y: xF, width: document.documentElement.clientWidth, height: document.documentElement.clientHeight }; } else { av = { x: xw, y: xF, width: document.body.clientWidth, height: document.body.clientHeight }; } var pl = av.x + av.width / 2; var nz = av.y + av.height / 2; var lz = document.createElement('div'); lz.innerHTML = '	<div style="z-index:2;border:1px solid #000000;font-size:12px;font-family:Arial, Helvetica, sans-serif;font-weight:normal;font-variant:normal;' + 'background-color:#F0F0F0;position:absolute;top:' + (nz - 85) + 'px;left:' + (pl - 80) + 'px;width:160px;height:170px;">' + '<div style="padding:4px;background-color:#666666;color:#FFFFFF;font-size:14px;">' + this.dN.selectColor + '</div>' + '<div style="position:relative;">' + '<div style="position:absolute;left:8px;top:10px;width:70px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;line-height:1.7">' + this.dN.red + ':</div>' + '<input id="ImGearColorRed" type="text" style="position:absolute;left:80px;top:8px;width:52px;" />' + '<div style="position:absolute;left:8px;top:40px;width:70px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;line-height:1.7">' + this.dN.green + ':</div>' + '<input id="ImGearColorGreen" style="position:absolute;left:80px;top:38px;width:52px" type="text" />' + '<div style="position:absolute;left:8px;top:70px;width:70px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;line-height:1.7">' + this.dN.blue + ':</div>' + '<input id="ImGearColorBlue" style="position:absolute;left:80px;top:68px;width:52px" type="text" />' + '<button id="ImGearColorOKButton" style="font-size:12px;position:absolute;left:9px;top:108px;width:65px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">' + this.dN.ok + '</button>' + '<button id="ImGearColorCancelButton" style="font-size:12px;position:absolute;left:81px;top:108px;width:71px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">' + this.dN.cancel + '</button>' + '</div>' + '</div>'; document.body.appendChild(lz); var WC = document.getElementById('ImGearColorRed'); var ahB = document.getElementById('ImGearColorGreen'); var anl = document.getElementById('ImGearColorBlue'); var Iz = document.getElementById('ImGearColorOKButton'); var IS = document.getElementById('ImGearColorCancelButton'); var VG = R['get_' + cr](); var PM; if (VG.length === 7 && VG.charAt(0) === '#') { PM = parseInt(VG.slice(1), 16); } WC.value = (PM >> 16); ahB.value = ((PM >> 8) & 255); anl.value = (PM & 255); function Yx(acm) { var F = Math.floor(+(acm.value)); if (!isFinite(F)) { F = 0; } if (F < 0) { F = 0; } if (F > 255) { F = 255; } return F; }; function Eg() { IPCC.Web.UI.al.removeHandler(Iz, 'click', Ja); IPCC.Web.UI.al.removeHandler(IS, 'click', Hv); IPCC.Web.UI.al.removeHandler(document.body, 'mousedown', xm); }; function Ja() { var dU = Yx(WC) * 65536 + Yx(ahB) * 256 + Yx(anl); R['set_' + cr]('#' + (0x1000000 + dU).toString(16).slice(1)); Eg(); document.body.removeChild(lz); lz = null; C.cn(); }; function Hv() { Eg(); document.body.removeChild(lz); lz = null; }; function xm(bJ) { if (lz) { var bk = bJ.target; var Mj; while (bk !== document.body) { if (bk === lz) { Mj = true; } bk = bk.parentNode; } if (!Mj) { Eg(); document.body.removeChild(lz); lz = null; } } }; IPCC.Web.UI.al.addHandler(Iz, 'click', Ja); IPCC.Web.UI.al.addHandler(IS, 'click', Hv); IPCC.Web.UI.al.addHandler(document.body, 'mousedown', xm); WC.focus(); }; IPCC.gf.prototype.auG = function (R, C) { var xw = document.documentElement.scrollLeft - document.documentElement.clientLeft + document.body.scrollLeft - document.body.clientLeft; var xF = document.documentElement.scrollTop - document.documentElement.clientTop + document.body.scrollTop - document.body.clientTop; var av; if (window.innerWidth) { av = { x: window.pageXOffset, y: window.pageYOffset, width: window.innerWidth, height: window.innerHeight }; } else if (document.documentElement.clientWidth) { av = { x: xw, y: xF, width: document.documentElement.clientWidth, height: document.documentElement.clientHeight }; } else { av = { x: xw, y: xF, width: document.body.clientWidth, height: document.body.clientHeight }; } var pl = av.x + av.width / 2; var nz = av.y + av.height / 2; var lz = document.createElement('div'); lz.innerHTML = '<div style="z-index:2;border:1px solid #000000;font-size:12px;font-family:Arial, Helvetica, sans-serif;font-weight:normal;font-variant:normal;' + 'background-color:#F0F0F0;position:absolute;top:' + (nz - 85) + 'px;left:' + (pl - 200) + 'px;width:400px;height:170px;z-index:2">' + '<div style="padding:4px;background-color:#666666;color:#FFFFFF;font-size:14px;">' + this.dN.selectFont + '</div>' + '<div style="position:relative;">' + '<div style="position:absolute;left:8px;top:10px;width:90px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">' + this.dN.font + ':</div>' + '<input id="ImGearFontFamily" style="position:absolute;left:100px;top:8px;width:280px" type="text" />' + '<div style="position:absolute;left:8px;top:40px;width:90px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">' + this.dN.size + ':</div>' + '<input id="ImGearFontSize" style="position:absolute;left:100px;top:38px;width:54px" type="text" />' + '<div style="position:absolute;left:8px;top:70px;"><input id="ImGearFontItalic" type="checkbox" style="float:left"><div style="width:70px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;line-height:1.7;">' + this.dN.italic + '</div></div>' + '<div style="position:absolute;left:100px;top:70px;"><input id="ImGearFontBold" type="checkbox" style="float:left"><div style="width:70px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;line-height:1.7;">' + this.dN.bold + '</div></div>' + '<div style="position:absolute;left:200px;top:70px;"><input id="ImGearFontUnderline" type="checkbox" style="float:left"><div style="width:70px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;line-height:1.7;">' + this.dN.underline + '</div></div>' + '<div style="position:absolute;left:300px;top:70px;"><input id="ImGearFontStrikeout" type="checkbox" style="float:left"><div style="width:70px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;line-height:1.7;">' + this.dN.strikeout + '</div></div>' + '<button id="ImGearFontOKButton" style="font-size:12px;position:absolute;left:240px;top:108px;width:70px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">' + this.dN.ok + '</button>' + '<button id="ImGearFontCancelButton" style="font-size:12px;position:absolute;left:315px;top:108px;width:71px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">' + this.dN.cancel + '</button>' + '</div>' + '</div>'; document.body.appendChild(lz); var abh = document.getElementById('ImGearFontFamily'); var ajZ = document.getElementById('ImGearFontSize'); var akL = document.getElementById('ImGearFontItalic'); var alo = document.getElementById('ImGearFontBold'); var akB = document.getElementById('ImGearFontUnderline'); var akK = document.getElementById('ImGearFontStrikeout'); var Iz = document.getElementById('ImGearFontOKButton'); var IS = document.getElementById('ImGearFontCancelButton'); var axD = R.get_fontName(); var axr = R.get_fontSize(); var tN = R.get_fontStyle(); abh.value = axD; ajZ.value = axr; akL.checked = tN & IPCC.Web.UI.FontStyle.Italic; alo.checked = tN & IPCC.Web.UI.FontStyle.Bold; akB.checked = tN & IPCC.Web.UI.FontStyle.Underline; akK.checked = tN & IPCC.Web.UI.FontStyle.Strikeout; function aBu(acm) { var F = Math.floor(+(acm.value)); if (!isFinite(F)) { F = 12; } if (F < 0.1) { F = 0.1; } if (F > 288) { F = 288; } return F; }; function Eg() { IPCC.Web.UI.al.removeHandler(Iz, 'click', Ja); IPCC.Web.UI.al.removeHandler(IS, 'click', Hv); IPCC.Web.UI.al.removeHandler(document.body, 'mousedown', xm); }; function Ja() { R.set_fontName(abh.value); var cd = aBu(ajZ); R.set_fontSize(cd); var bH = 0; if (akL.checked) { bH |= IPCC.Web.UI.FontStyle.Italic; } if (alo.checked) { bH |= IPCC.Web.UI.FontStyle.Bold; } if (akB.checked) { bH |= IPCC.Web.UI.FontStyle.Underline; } if (akK.checked) { bH |= IPCC.Web.UI.FontStyle.Strikeout; } R.set_fontStyle(bH); Eg(); document.body.removeChild(lz); lz = null; C.cn(); }; function Hv() { Eg(); document.body.removeChild(lz); lz = null; }; function xm(bJ) { if (lz) { var bk = bJ.target; var Mj; while (bk !== document.body) { if (bk === lz) { Mj = true; } bk = bk.parentNode; } if (!Mj) { Eg(); document.body.removeChild(lz); lz = null; } } }; IPCC.Web.UI.al.addHandler(Iz, 'click', Ja); IPCC.Web.UI.al.addHandler(IS, 'click', Hv); IPCC.Web.UI.al.addHandler(document.body, 'mousedown', xm); abh.focus(); }; IPCC.gf.prototype.avL = function (L) { var R = L.Wb.mark; switch (L.ee) { case IPCC.ft.Ma: R['set_' + L.dC](L.F); this.C.cn(); break; case IPCC.ft.Nf: this.atX(R, L.dC, this.C); break; case IPCC.ft.amx: this.auG(R, this.C); break; case IPCC.ft.alW: R['set_' + L.dC](!R['get_' + L.dC]()); this.C.cn(); break; case IPCC.ft.apG: R.moveToBack(); this.C.cn(); break; case IPCC.ft.aqZ: R.moveBackward(); this.C.cn(); break; case IPCC.ft.aqn: R.moveForward(); this.C.cn(); break; case IPCC.ft.aqc: R.moveToFront(); this.C.cn(); break; case IPCC.ft.aiB: R.removeFromPage(); this.C.cn(); break; default: this.C.aBY(L); break; } }; IPCC.dK = function () { this.C = false; this.Mq = 0; this.auI = 1; this.ajV = 2; this.ajH = 3; }; IPCC.dK.prototype.nR = function (C) { this.C = C; this.cV = this.Mq; }; IPCC.dK.prototype.ec = function () { this.C = false; }; IPCC.dK.prototype.aV = function () { this.cV = this.Mq; }; IPCC.dK.prototype.aia = function (L) { var aup = new Date() - this.aws; if (aup < 750) { var eW = this.agC.x - L.windowPoint.x; var fe = this.agC.y - L.windowPoint.y; var jD = eW * eW + fe * fe; if (jD < 2500) { return true; } } return false; }; IPCC.dK.prototype.afT = function (L) { this.aws = new Date(); this.agC = new IPCC.Web.UI.Point(L.windowPoint.x, L.windowPoint.y); }; IPCC.dK.prototype.OS = function (L) { var bJ = L.domEvent.rawEvent; if (bJ.touches.length === 1) { if (this.cV === this.ajV && this.aia(L)) { this.cV = this.ajH; } else { this.cV = this.auI; } this.afT(L); this.C.hH('jO', L); } else { this.cV = this.Mq; this.C.hH('rZ', L); } }; IPCC.dK.prototype.Ps = function (L) { var bJ = L.domEvent.rawEvent; if (bJ.touches.length === 1) { this.C.hH('lp', L); } }; IPCC.dK.prototype.Qd = function (L) { var bJ = L.domEvent.rawEvent; if (bJ.touches.length === 0) { if (this.aia(L)) { if (this.cV === this.ajH) { this.cV = this.Mq; this.C.hH('iB', L); this.C.hH('vS', L); } else { this.afT(L); this.cV = this.ajV; this.C.hH('iB', L); } } else { this.cV = this.Mq; this.C.hH('iB', L); } } }; IPCC.dK.prototype.Ke = function (L) { this.C.hH('rZ', L); }; IPCC.cY = function (aou) { this.aou = aou; this.aby = 0; this.NV = 1; this.MI = 2; this.acl = 3; this.acd = 4; this.cV = this.aby; this.C = false; this.ye = 0; }; IPCC.cY.prototype.nR = function (C) { this.C = C; this.bm = C.bG(); }; IPCC.cY.prototype.ec = function () { this.C = false; }; IPCC.cY.prototype.aV = function () { if (this.cV === this.MI) { this.C.bG().hideMagnifier(); } this.cV = this.aby; }; IPCC.cY.prototype.OS = function (L) { var bJ = L.domEvent.rawEvent; switch (this.cV) { case this.aby: if (bJ.touches.length === 1) { this.axE(L); } else if (bJ.touches.length === 2) { this.agh(L); } else if (bJ.touches.length === 3) { this.aaj(L); } else { this.aV(); } break; case this.NV: if (bJ.touches.length === 2) { this.agh(L); } else if (bJ.touches.length === 3) { this.aaj(L); } else { this.aV(); } break; case this.acd: if (bJ.touches.length !== 3) { this.aV(); } break; case this.MI: this.aV(); break; case this.acl: if (bJ.touches.length === 3) { this.aaj(L); } else if (bJ.touches.length !== 2) { this.aV(); } break; } }; IPCC.cY.prototype.Ps = function (L) { switch (this.cV) { case this.NV: this.ye++; break; case this.MI: this.aeq(L); break; case this.acl: this.aFu(L); break; case this.acd: this.atL(L); break; } }; IPCC.cY.prototype.Qd = function () { this.aV(); }; IPCC.cY.prototype.Ke = function () { this.aV(); }; IPCC.cY.prototype.axE = function (L) { this.cV = this.NV; this.ye++; var avN = this.ye; var K = this; function aBW() { if (K.cV === this.NV && avN === K.ye) { K.axN(L); } }; setTimeout(aBW, 1000); }; IPCC.cY.prototype.axN = function (L) { this.C.hH('rZ', L); this.aeq(L); this.cV = this.MI; }; IPCC.cY.prototype.aaj = function (L) { var bJ = L.domEvent.rawEvent; if (bJ.touches.length !== 3) { this.aV(); return; } var ja = bJ.touches[0]; var fL = { x: ja.screenX, y: ja.screenY }; var ci = this.bm.eV(); ci.Ap(); this.TJ = fL; this.azn = fL; this.acN = ci.transform(fL); this.cV = this.acd; this.aHF = this.bm.eV(); this.aiQ = true; this.aig = true; }; IPCC.cY.prototype.atL = function (L) { var bJ = L.domEvent.rawEvent; if (bJ.touches.length !== 3) { this.aV(); return; } var ja = bJ.touches[0]; var fL = { x: ja.screenX, y: ja.screenY }; var aAz = Math.abs(fL.x - this.TJ.x); var aAg = Math.abs(fL.y - this.TJ.y); if (aAz > 35) { this.aig = false; } if (aAg > 35) { this.aiQ = false; } if (this.aiQ) { fL.y = this.TJ.y; } if (this.aig) { fL.x = this.TJ.x; } this.azn = fL; var bz = this.bm.eV(); var aU = this.C.ff(); var bb = this.C.cX(); bz.Uw(this.acN, fL); bz.kY(bb, aU); this.bm.lv(bz); }; IPCC.cY.prototype.aJK = function () { }; IPCC.cY.prototype.afI = function (L) { var bJ = L.domEvent.rawEvent; if (bJ.touches.length !== 2) { this.aV(); return {}; } var PB = bJ.touches[0]; var Ou = bJ.touches[1]; var eW = PB.screenX - Ou.screenX; var fe = PB.screenY - Ou.screenY; var oE = Math.sqrt(eW * eW + fe * fe); var iQ = Math.atan2(eW, fe) * 180 / Math.PI; var be = { x: (PB.screenX + Ou.screenX) / 2, y: (PB.screenY + Ou.screenY) / 2 }; return { oE: oE, iQ: iQ, ane: be }; }; IPCC.cY.prototype.agh = function (L) { this.cV = this.acl; this.aBk = this.afI(L); this.MD = this.aBk; var ci = this.bm.eV(); ci.Ap(); this.acN = ci.transform(this.MD.ane); this.Kr = this.MD.iQ; }; IPCC.cY.prototype.aeq = function (L) { var bJ = L.domEvent.rawEvent; var ja = bJ.touches[0]; var fL = { x: ja.screenX, y: ja.screenY }; this.bm.showMagnifier(fL); }; IPCC.cY.prototype.aFu = function (L) { var AL = this.afI(L); var bS = AL.oE / this.MD.oE; var bz = this.bm.eV(); var aU = this.C.ff(); var bb = this.C.cX(); bz.scale(bS, bS); var Ha = this.Kr - AL.iQ; var aiH = this.Kr - AL.iQ - 360; var aiE = this.Kr - AL.iQ + 360; if (Math.abs(Ha) > Math.abs(aiH)) { Ha = aiH; } if (Math.abs(Ha) > Math.abs(aiE)) { Ha = aiE; } if (Ha < -40) { bz.rotate(-90); this.Kr = AL.iQ; } else if (Ha > 40) { bz.rotate(90); this.Kr = AL.iQ; } bz.Uw(this.acN, AL.ane); bz.kY(bb, aU); this.bm.lv(bz); this.MD = AL; }; IPCC.cY.prototype.Zi = function (L) { var bz = this.bm.eV(); var aU = this.C.ff(); var bb = this.C.cX(); bz.UB(IPCC.Web.UI.FitType.FullImage, bb, aU); bz.kY(bb, aU); this.bm.lv(bz); }; IPCC.cY.prototype.lY = function () { this.aV(); }; IPCC.oI = function () { this.aR = false; this.C = false; }; IPCC.oI.prototype.nR = function (C) { C.bG().set_cursor(IPCC.bP.Text); this.C = C; }; IPCC.oI.prototype.ec = function () { this.C = false; }; IPCC.oI.prototype.aV = function () { if (this.aR) { this.C.bG().acs(); this.C.bG().set_cursor(this.ia); this.aR = false; } }; IPCC.oI.prototype.rZ = function () { this.aV(); }; IPCC.oI.prototype.jO = function (L) { if (L.domEvent.button === 0) { var bm = this.C.bG(); this.ia = bm.get_cursor(); bm.set_cursor(IPCC.bP.Text); this.aR = true; var cQ = this.C.Ly(L.constrainedImagePoint); this.C.jn = cQ; if (!cQ) { return; } this.C.Cw(cQ); bm.Cw(cQ); bm.vk(undefined); this.C.cn(); } }; IPCC.oI.prototype.lp = function (L) { var C = this.C; C.aAD = true; if (L.domEvent.button !== 0) { this.aV(); } if (this.aR) { var bm = C.bG(); var cQ = C.Ly(L.constrainedImagePoint); var iK = bm.GZ(); if (iK === cQ) { return; } C.vk(cQ); C.cn(); } }; IPCC.oI.prototype.iB = function (L) { if (L.domEvent.button === 0) { this.aR = false; } var C = this.C; var bm = this.C.bG(); var cz = bm.hU.length; if (cz === 0) { this.aV(); return; } var bh = bm.hU[0].cQ; var fF = bm.hU[cz - 1].cQ; if (C.Jb === true) { if (bh > fF) { bh = fF; } var G; var kW = IPCC.FA(); this.R = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.HighlightText); this.R.bh = bh; this.R.cl = C.Gz(); this.R.cg = cz; this.R.set_fillColor(C.rN); this.R.kz = 'y'; this.R.cE = kW; for (G = 0; G < bm.hU.length; G++) { var aC = bm.hU[G]; var Gl = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.Highlight); var BP = aC.R.fD(); Gl.set_fillColor(C.rN); Gl.set_opacity(aC.R.get_opacity()); Gl.set_rectangle(BP); Gl.cE = kW; Gl.kz = 'y'; this.C.eI().addMark(Gl); } bm.hU = []; if (cz > 0) { this.C.eI().addMark(this.R); } C.mK().removeAllMarks(); } cz = bm.hU.length; var ajS = new IPCC.Web.UI.TextSelectedEventArgs(); ajS.text = C.Gz(); C.aM('selectTextMouseToolCompleted', ajS); C.cn(); this.aV(); }; IPCC.oI.prototype.qE = function (L) { var aU = this.C.ff(); if (L.windowPoint.x <= 0 || L.windowPoint.x >= aU.width - 2) { this.aV(); } if (L.windowPoint.y <= 0 || L.windowPoint.y >= aU.height - 2) { this.aV(); } }; IPCC.oI.prototype.lY = function () { this.aV(); }; IPCC.ajb = function (pN) { var bm; var ap; var jR; var aU; var aO = this; var Ek; var FR = ''; var _debug = false; var kx = IPCC.Web.UI.DebugErrorLevel.Production; var nc = []; var bC = new IPCC.Web.UI.fR(); var aX; var eO; var rg = null; var HV = false; var vM = false; var AU; var NR = IPCC.Web.UI.ImGearArtDataServices.None; var HY = false; var lU = ''; var lT; var amS = false; var aka = false; var zG = 0; var wl = true; var lA; var hI; var pA = false; var aqB = true, nu = false; var alN = false; var CN = null; var St; this.SP = 0.0; this.it = function (wL) { if (!_debug) { return false; } return kx >= wL; }; this.iP = function (hb, Kb, as) { IPCC.gG.iP(hb, Kb, as, FR, Ek); }; this.bK = function (fH, hV) { if (!this.it(IPCC.Web.UI.DebugErrorLevel.Production)) { return; } var aw = fH + '() threw an exception (' + hV.name + '), "' + hV.message + '"'; aw = aw.replace(/\n/g, " "); this.iP(aw, IPCC.Web.UI.DebugItemCause.Exception, IPCC.Web.UI.DebugErrorLevel.Production); aO.aM('exceptionThrown', { "function_name": fH, "exception": hV, "pageNumber": aO.aD }); }; this.Lx = function (R) { var fO = this.le().igElements, fT = null; if (R.get_type() === IPCC.Web.UI.MarkType.TextLine) { fT = fO.gD; } else if (R.get_type() === IPCC.Web.UI.MarkType.TextAreaSignature) { fT = fO.dA; } else if (R.get_type() === IPCC.Web.UI.MarkType.Text) { fT = fO.fT; } return fT; }; this.get_debug = function () { return _debug; }; this.set_debug = function (F) { var yQ = ! !F; if (_debug === yQ) { return; } _debug = yQ; this.aL('debug'); }; this.pm = function () { return kx; }; this.uG = function (F) { if (kx === F) { return; } kx = F; this.aL('debugErrorLevel'); }; this.aeT = function (F) { FR = F; }; this.avb = function () { return FR; }; this.act = function (F) { Ek = F; }; this.aEI = function (F) { St = F; }; this.aDJ = function () { return St; }; this.fz = function (awy) { this.sm(false); var G; for (G = nc.length - 1; G >= 0; G--) { if (nc[G] instanceof IPCC.pb) { nc[G].aV(true); } else { nc[G].aV(); } if (nc[G] instanceof IPCC.oB) { nc[G].ec(true); } else { nc[G].ec(); } } nc = awy; bm.set_cursor(IPCC.bP.Default); for (G = 0; G < nc.length; G++) { nc[G].nR(this); } }; this.aJN = function () { var G; for (G = 0; G < nc.length; G++) { nc[G].aV(); } }; this.hH = function (aiI, L) { var G; for (G = 0; G < nc.length; G++) { if (L && L.agM && L.agM()) { return; } if (nc[G][aiI]) { nc[G][aiI](L); } } }; this.aDx = function (ll, dm) { switch (ll) { case 'touchstart': jR.Wy && jR.Wy(dm); break; case 'touchmove': jR.WF && jR.WF(dm); break; case 'touchend': jR.XH && jR.XH(dm); break; case 'doubleTap': jR.ahD && jR.ahD(dm); break; } }; this.lg = function (V) { bC.addHandler('propertyChanged', V); }; this.nt = function (V) { bC.removeHandler('propertyChanged', V); }; this.add_mouseDown = function (V) { bC.addHandler('mouseDown', V); }; this.remove_mouseDown = function (V) { bC.removeHandler('mouseDown', V); }; this.add_mouseMove = function (V) { bC.addHandler('mouseMove', V); }; this.remove_mouseMove = function (V) { bC.removeHandler('mouseMove', V); }; this.add_mouseUp = function (V) { bC.addHandler('mouseUp', V); }; this.remove_mouseUp = function (V) { bC.removeHandler('mouseUp', V); }; this.add_contextMenu = function (V) { bC.addHandler('contextMenu', V); }; this.remove_contextMenu = function (V) { bC.removeHandler('contextMenu', V); }; this.aIs = function (V) { bC.addHandler('contextMenuCommand', V); }; this.aIL = function (V) { bC.removeHandler('contextMenuCommand', V); }; this.add_mouseWheel = function (V) { bC.addHandler('mouseWheel', V); }; this.remove_mouseWheel = function (V) { bC.removeHandler('mouseWheel', V); }; this.add_mouseOut = function (V) { bC.addHandler('mouseOut', V); }; this.remove_mouseOut = function (V) { bC.removeHandler('mouseOut', V); }; this.amw = function (V) { bC.addHandler('resize', V); }; this.aKc = function (V) { bC.removeHandler('resize', V); }; this.asI = function (V) { bC.addHandler('userModifiedViewState', V); }; this.aKu = function (V) { bC.removeHandler('userModifiedViewState', V); }; this.add_scaleChanged = function (V) { bC.addHandler('scaleChanged', V); }; this.remove_scaleChanged = function (V) { bC.removeHandler('scaleChanged', V); }; this.add_markAdded = function (V) { bC.addHandler('markAdded', V); }; this.remove_markAdded = function (V) { bC.removeHandler('markAdded', V); }; this.add_markCreating = function (V) { bC.addHandler('markCreating', V); }; this.remove_markCreating = function (V) { bC.removeHandler('markCreating', V); }; this.add_markChanged = function (V) { bC.addHandler('markChanged', V); }; this.remove_markChanged = function (V) { bC.removeHandler('markChanged', V); }; this.add_inProgressMarkChanged = function (V) { bC.addHandler('inProgressMarkChanged', V); }; this.remove_inProgressMarkChanged = function (V) { bC.removeHandler('inProgressMarkChanged', V); }; this.add_markRemoved = function (V) { bC.addHandler('markRemoved', V); }; this.remove_markRemoved = function (V) { bC.removeHandler('markRemoved', V); }; this.add_markReordered = function (V) { bC.addHandler('markReordered', V); }; this.remove_markReordered = function (V) { bC.removeHandler('markReordered', V); }; this.add_marksLoaded = function (V) { bC.addHandler('marksLoaded', V); }; this.remove_marksLoaded = function (V) { bC.removeHandler('marksLoaded', V); }; this.add_marksSaved = function (V) { bC.addHandler('marksSaved', V); }; this.remove_marksSaved = function (V) { bC.removeHandler('marksSaved', V); }; this.add_markSelectionChanged = function (V) { bC.addHandler('markSelectionChanged', V); }; this.remove_markSelectionChanged = function (V) { bC.removeHandler('markSelectionChanged', V); }; this.add_markTextSelectionChanged = function (V) { bC.addHandler('markTextSelectionChanged', V); }; this.remove_markTextSelectionChanged = function (V) { bC.removeHandler('markTextSelectionChanged', V); }; this.add_pageOpenFailed = function (V) { bC.addHandler('pageOpenFailed', V); }; this.add_pageDisplayed = function (V) { bC.addHandler('pageDisplayed', V); }; this.remove_pageOpenFailed = function (V) { bC.removeHandler('pageOpenFailed', V); }; this.add_textPageReady = function (V) { bC.addHandler('textPageReady', V); }; this.remove_textPageReady = function (V) { bC.removeHandler('textPageReady', V); }; this.add_selectTextMouseToolCompleted = function (V) { bC.addHandler('selectTextMouseToolCompleted', V); }; this.remove_selectTextMouseToolCompleted = function (V) { bC.removeHandler('selectTextMouseToolCompleted', V); }; this.add_exceptionThrown = function (V) { bC.du('exceptionThrown', V); }; this.remove_exceptionThrown = function (V) { bC.dn('exceptionThrown', V); }; this.add_textExtractionFailed = function (V) { bC.du('textExtractionFailed', V); }; this.remove_textExtractionFailed = function (V) { bC.dn('textExtractionFailed', V); }; this.aL = function (cr, zC) { var V = bC.getHandler("propertyChanged"); if (V) { V(this, new IPCC.qP(cr, zC)); } }; this.le = function () { var _parent = document.getElementById(Ek); return _parent; }; this.bG = function () { return bm; }; this.aGZ = function () { return bC; }; function IC(aB, L) { HY = true; L.pageIndex = aO.aD; aO.aM('markAdded', L); aO.hH('ld', L); }; function HW(aB, L) { HY = true; L.pageIndex = aO.aD; aO.aM('markChanged', L); aO.hH('sZ', L); }; function akQ(aB, L) { L = new IPCC.Web.UI.MarkEventArgs(); L.mark = rg; L.pageIndex = aO.aD; aO.aM('inProgressMarkChanged', L); aO.hH('_onInProgressMarkChanged', L); }; function Hi(aB, L) { HY = true; L.pageIndex = aO.aD; aO.aM('markRemoved', L); aO.hH('Ed', L); }; function aCE(aB, L) { aO.aM('textPageReady', L); }; function aCD(aB, L) { aO.aM('textExtractionFailed', L); }; function HF(aB, L) { HY = true; L.pageIndex = aO.aD; aO.aM('markReordered', L); aO.hH('alb', L); }; function Ey(aB, L) { L.pageIndex = aO.aD; aO.aM('marksLoaded', L); aO.hH('alB', L); }; function Ej(aB, L) { L.pageIndex = aO.aD; aO.aM('markSelectionChanged', L); aO.hH('Ev', L); }; function akP(aB, L) { L.pageIndex = aO.aD; aO.aM('markTextSelectionChanged', L); }; this.aBz = function (aB, L) { this.hH('_onTextMarkEditCompleted', L); }; function GU(aB, L) { L.pageIndex = aO.aD; aO.aM('propertyChanged', L); }; this.kc = function (F) { if (F === aX) { return; } if (aX) { aX.remove_markAdded(IC); aX.remove_markChanged(HW); aX.remove_markRemoved(Hi); aX.remove_markReordered(HF); aX.remove_marksLoaded(Ey); aX.remove_markSelectionChanged(Ej); aX.nt(GU); aX.Gf(true); } aX = F; if (aX) { aX.add_markAdded(IC); aX.add_markChanged(HW); aX.add_markRemoved(Hi); aX.add_markReordered(HF); aX.add_marksLoaded(Ey); aX.add_markSelectionChanged(Ej); aX.add_markTextSelectionChanged(akP); aX.lg(GU); } this.aL('artPage'); }; this.eI = function () { return aX; }; this.LE = function (F) { if (F === eO) { return; } if (eO) { eO.remove_markAdded(IC); eO.remove_markChanged(HW); eO.remove_markRemoved(Hi); eO.remove_markReordered(HF); eO.remove_marksLoaded(Ey); eO.remove_markSelectionChanged(Ej); eO.nt(GU); eO.Gf(true); } eO = F; if (eO) { eO.add_markAdded(IC); eO.add_markChanged(HW); eO.add_markRemoved(Hi); eO.add_markReordered(HF); eO.add_marksLoaded(Ey); eO.add_markSelectionChanged(Ej); eO.add_markTextSelectionChanged(akP); eO.lg(GU); } this.aL('documentArtPage'); }; this.Qr = function () { return eO; }; this.mK = function () { return hI; }; this.uD = function (F) { if (F === hI) { return; } if (hI) { hI.remove_markAdded(IC); hI.remove_markChanged(HW); hI.remove_markRemoved(Hi); hI.remove_markReordered(HF); hI.remove_marksLoaded(Ey); hI.remove_markSelectionChanged(Ej); hI.nt(GU); } hI = F; if (hI) { hI.add_markAdded(IC); hI.add_markChanged(HW); hI.add_markRemoved(Hi); hI.add_markReordered(HF); hI.add_marksLoaded(Ey); hI.add_markSelectionChanged(Ej); hI.lg(GU); } this.aL('transientArtPage'); }; var jE; this.zI = function () { if (!jE) { if (IPCC.Web.UI.Mark) { jE = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.Highlight); jE.set_opacity(100); jE.set_fillColor('#3366CC'); jE.set_fillVisible(true); } } return jE; }; this.Av = function (F) { NR = F; this.aL('artServiceOption'); }; this.Ak = function () { return NR; }; this.pW = function (R, pF) { if (rg === R) { return; } if (rg) { rg.remove_propertyChanged(akQ); } if (R && !rg) { var L = new IPCC.Web.UI.MarkEventArgs(); L.mark = pF ? pF : R; L.pageIndex = this.aD; this.aM('markCreating', L); } rg = R; if (rg) { rg.add_propertyChanged(akQ); } this.aL('inProgressMark'); }; this.asP = function () { return rg; }; this.xB = function (F) { if (F === ap) { return; } ap = F; this.Bc = false; bm.ny(); this.aL('image'); }; this.cX = function () { return ap; }; this.afw = function (F) { if (F === HV) { return; } HV = F; this.aL('HV'); }; this.akY = function () { return HV; }; this.KU = function () { var AU = this.MO(); var anu = this.Lx(AU); var aqQ = anu.value; setTimeout(function () { anu.setSelectionRange(0, aqQ.length); }, 1); }; this.xh = function (R) { this.sm(false); jR.asN(R); vM = true; AU = R; this.aL('vM'); }; this.SS = function (bh, cz) { if (this.iw() && this.cv().mw() === true) { var gP = this.cv().gl(); var G = bh; for (; G < bh + cz; G++) { var gw = gP.jN(G); var wG = '#3366CC'; var LO = '#3366CC'; hI.adx(gw.av, LO, wG, false, G); } } }; this.aLj = function (ai) { var G; try { var aZ = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.Highlight); if (!jE) { jE = aO.zI(); } for (G in jE) { if (jE.hasOwnProperty(G)) { aZ[G] = jE[G]; } } aZ.set_rectangle({ x: ai.x, y: ai.y, width: ai.width, height: ai.height }); aO.pW(aZ); hI.addMark(aZ); return aZ; } catch (avk) { var ayX = avk.message; window.console.log(ayX); } }; this.Ly = function (cS) { var IG; var gP; var XZ; IG = aO.cv(); gP = aO.cv().gl(); function aqP(VR) { var xd = VR.wz(); if ((cS.x >= xd.x - 10 && cS.x <= xd.x + xd.width + 1) && (cS.y >= xd.y - 1 && cS.y <= xd.y + xd.height + 1)) { return true; } xd = undefined; }; if (!XZ) { for (var G = 0; G < gP.fb() ; G++) { if (aqP(gP.jN(G))) { XZ = G; break; } } } return XZ; }; this.aAD = false; this.Cw = function (cQ) { if (cQ === undefined) { return; } if (aO.iw() && aO.cv().mw() === true) { var JZ = aO.cv().gl().fb(); IPCC.ad.ps(cQ, 'textIndex', 0, JZ); aO.bG().Cw(cQ); aO.mK().FJ(function (R) { if (R.za !== true) { aO.mK().vA(R); } }); if (aO.CK() === true) { aO.cn(); } } }; this.WE = function () { var Gu = aO.bG().get_transientHighlightMarks(); while (Gu.length > 0) { aO.mK().removeMark(Gu.pop()); } }; this.QD = function (vm, cz) { if (aO.iw() && aO.cv().mw() === true) { var G = vm; var gP = this.cv().gl(); var fF = vm + cz; if (!jE) { jE = aO.zI(); } var Gu = aO.bG().get_transientHighlightMarks(); for (; G < fF; G++) { var gw = gP.jN(G); Gu.push(hI.atK(gw.av, jE, G)); } } }; this.aJR = function (aIY, cz) { var bm = aO.bG(); for (var aj = cz - 1; aj > cz; aj--) { var aC = bm.hU[aj]; hI.removeMark(aC.R); } }; this.vk = function (cQ) { if (cQ === undefined) { return; } var gw; var bm = aO.bG(); var iK = bm.GZ(); var wG = '#3366CC'; var LO = '#3366CC'; var dI = 100; if (!jE) { jE = aO.zI(); } dI = jE.get_opacity(); if (!dI) { dI = 100; } wG = jE.get_fillColor(); if (wG === undefined) { wG = '#3366CC'; } var gP = aO.cv().gl(); if (iK === undefined) { gw = gP.jN(cQ); var R = hI.adx(gw.av, LO, wG, false, dI, cQ); bm.vk(cQ, R, gw.jJ); return; } var aj; function ahr(ak, axa) { for (aj = bm.hU.length - 1; aj >= 0; aj--) { var aC = bm.hU[aj]; if (aC.cQ === ak) { bm.hU.splice(aj, 1); hI.removeMark(aC.R); bm.aIl(axa); bm.aHw(ak); return aj; } } return -1; }; function SZ(ak) { gw = gP.jN(ak); var aoX = hI.adx(gw.av, LO, wG, false, dI, ak); if (bm.vk(ak, aoX, gw.jJ) === false) { hI.removeMark(aoX); } }; var SG = bm.aif(); var G; if (cQ > iK) { for (G = iK; G <= cQ; G++) { if (G === cQ) { if (G < SG) { continue; } SZ(G); } else if (G >= SG) { if (G === iK) { continue; } SZ(G); } else { ahr(G, cQ); } } } else if (cQ < iK) { for (G = iK; G >= cQ; G--) { if (G === cQ) { if (G >= SG) { continue; } SZ(G); } else if (G < SG) { if (G === iK) { continue; } SZ(G); } else { ahr(G, cQ); } } } }; this.Gz = function () { var adW = ""; try { var bm = aO.bG(); if (aO.bG().MR()) { var axi = aO.cv().gl(); if (bm.hU.length > 0) { var Hu = []; for (var G = 0; G < bm.hU.length; G++) { Hu.push(bm.hU[G].cQ); } if (Hu[0] > Hu[1]) { Hu.reverse(); } for (G = 0; G < Hu.length; G++) { adW += axi.jN(Hu[G]).auu(); } } } return adW; } catch (e) { window.console.log(e.message); } }; this.sm = function (azy) { if (vM) { if (azy) { jR.azG(); } vM = false; AU = null; this.aBz(); this.aL('vM'); aO.cn(); } }; this.akS = function () { return vM; }; this.MO = function () { return AU; }; this.Fa = function () { var AU = this.MO(); if (!AU) { return null; } var Us = AU.jd(); if (Us === IPCC.Web.UI.MarkType.TextLine) { return 'singleline'; } else if (Us === IPCC.Web.UI.MarkType.TextAreaSignature) { return 'multiline'; } else if (Us === IPCC.Web.UI.MarkType.Text) { return 'multiline'; } }; this.Qn = function (F) { aka = F; }; this.NC = function () { return aka; }; this.Yo = function (F) { CN = F; }; this.asM = function () { return CN; }; this.zY = function (F) { if (F === zG) { return; } zG = F; this.aL('zG'); }; this.Mk = function () { return zG; }; this.Gf = function (F) { if (aX) { aX.Gf(F); } }; this.Ia = function () { if (aX) { return aX.Ia(); } return true; }; this.aoV = function (aJt) { var aU = jR.akz(this.le()); this.aDb(aU); }; this.aDb = function (F) { if (F === aU) { return; } aU = F; this.aL('windowSpace'); }; this.ff = function () { return aU; }; this.cn = function () { jR.cn(ap, bm, aU); }; this.La = function () { if (this.qp() === false) { var lD = bm.eV(); var C = this; var nS = lD.qC(ap); var bg = C.le(); var en = bg.igElements; var aQ = en.su; var Nb = Math.max(0, -nS.x); var Lc = Math.max(0, -nS.y); var lG = Math.max(0, nS.x); var mp = Math.max(0, nS.y); var cw = bm.eV(); cw.oa(Nb - lG, Lc - mp); jR.amC(aQ, aU, lD, cw); } }; this.uR = function (F) { lT = F; }; this.nQ = function () { return lT; }; this.cv = function () { return lA.cv(); }; var mk = 0; this.lc = function () { return lA; }; this.tO = function (F) { if (F === this.lc()) { return; } lA = F; if (lA) { lA.xq(aCE); lA.Cg(aCD); } }; this.iw = function () { return wl; }; this.zr = function (F) { wl = F; this.aL('textRequired'); }; this.ou = function () { return pA; }; this.tw = function (F) { if (pA === F) { return; } pA = F; this.aL('requireRequestsOptimize'); }; this.CK = function () { return aqB; }; this.Yw = function (F) { aqB = F; this.aL('autoUpdate'); }; var sR = false; this.kU = function () { return sR; }; this.rq = function (F) { if (typeof F !== "boolean") { return; } if (F === sR) { return; } sR = F; if (aX) { var afk = false; aX.forEachMark(function (R) { if (R.get_type() === IPCC.Web.UI.MarkType.RectangleRedaction) { afk = true; } }); if (afk === true) { aX.rq(sR); } } }; this.hT = function () { return mk; }; this.tm = function (F) { if (mk === F) { return; } if (isNaN(F)) { return; } mk = F; this.aL('serviceResponseTimeout'); }; var sD = ''; this.adB = function (hA, bo) { if (hA !== '') { hA = '/' + hA; } bo = bo || ''; if (bo === null || bo === '') { if (hA === '/Attributes') { if (/^[\x00-\x7F]*$/.test(ap.get_identifier())) { return sD + '/Page/q/' + ap.aD.toString() + hA + '?DocumentID=u' + encodeURIComponent(ap.get_identifier()); } else { return sD + '/Page/q/' + ap.aD.toString() + hA + '?DocumentID=e' + ap.get_encodedIdentifier(); } } else { if (/^[\x00-\x7F]*$/.test(ap.get_identifier())) { return sD + '/Page/q/' + ap.aD.toString() + hA + '?DocumentID=u' + encodeURIComponent(ap.get_identifier()) + '&Quality=85&ContentType=jpeg'; } else { return sD + '/Page/q/' + ap.aD.toString() + hA + '?DocumentID=e' + ap.get_encodedIdentifier() + '&Quality=85&ContentType=jpeg'; } } } else { if (/^[\x00-\x7F]*$/.test(ap.get_identifier())) { return sD + '/Page/q/' + ap.aD.toString() + hA + '?DocumentID=u' + encodeURIComponent(ap.get_identifier()) + '&' + bo; } else { return sD + '/Page/q/' + ap.aD.toString() + hA + '?DocumentID=e' + ap.get_encodedIdentifier() + '&' + bo; } } }; this.aDh = function (hA, bo) { hA = hA || 'Art'; bo = bo || ''; if (bo === null || bo === '') { if (hA === 'Art') { return sD + '/Page/q/' + ap.aD.toString() + '/' + hA + '?DocumentID=e' + ap.get_encodedIdentifier(); } } else { return sD + '/Page/q/' + ap.aD.toString() + '/' + hA + '?DocumentID=e' + ap.get_encodedIdentifier() + '&' + bo; } }; this.Du = function (yX) { if (HY === false) { if (yX) { yX(); } return; } IPCC.J.mt.dZ({ method: 'POST', url: this.aDh('Art'), headers: { 'Content-Type': 'application/json' }, body: aX.saveToJson() }).then(function () { if (yX) { yX(); } }); }; this.mz = function () { return sD; }; this.Fi = function (F) { sD = F; this.aL('imageHandlerUrl'); if (!IPCC.Web.rG) { if (IPCC.Web.uN === false) { IPCC.Web.OA(F); } } }; this.qp = function () { return amS; }; this.Qu = function (F) { amS = F; }; this.adt = function () { return alN; }; this.adR = function (F) { alN = F; }; this.gx = function () { return lU; }; this.rc = function (F) { lU = F; lU.tabIndex = -1; }; this.eG = function () { return nu; }; this.iA = function (F) { if (typeof F !== "boolean") { return; } if (F === nu) { return; } nu = F; }; this.aBE = function (L) { if (vM) { this.sm(true); } else { this.aM('mouseDown', L); this.hH('jO', L); } }; this.aCb = function (L) { this.aM('mouseMove', L); this.hH('lp', L); }; this.aAW = function (L) { this.aM('mouseUp', L); this.hH('iB', L); }; this.aBg = function (L) { this.aM('mouseWheel', L); this.hH('lY', L); }; this.aBM = function (L) { this.aM('mouseDoubleClick', L); this.hH('vS', L); }; this.aBD = function (L) { this.aM('contextMenu', L); this.hH('Ok', L); }; this.aBY = function (L) { this.aM('contextMenuCommand', L); }; this.aBt = function (L) { this.aM('mouseOut', L); this.hH('qE', L); }; this.aBO = function (L) { this.aM('touchStart', L); this.hH('jO', L); }; this.aCr = function (L) { this.aM('touchMove', L); this.hH('lp', L); }; this.aBe = function (L) { this.aM('touchEnd', L); this.hH('iB', L); }; this.aBd = function (L) { this.aM('touchCancel', L); this.hH('Ke', L); }; this.aM = function (cA, L) { var V = bC.getHandler(cA); if (V !== null) { V(aO, L); } }; var apj = function (C, pN) { bm = new IPCC.auz(); function qx(aB, L) { aO.aM('propertyChanged', L); }; bm.lg(qx); if (IPCC.yZ.Bv()) { jR = new IPCC.akR(C, pN); } else { jR = new IPCC.Iy(C); } if (IPCC.dv) { jR.sA = new IPCC.dv.bn(C); jR.auk = new IPCC.dv.bn(C); } }; if (pN === false) { apj(this, false); } else { apj(this, true); } return this; }; IPCC.yZ = {
    Bv: function () {
        var yR = IPCC.yZ; if (yR.wf === null) {
            /*@cc_on@if(@_jscript)yR.wf=document.documentMode>8;@else@*/ yR.wf = true;/*@end@*/
        } return yR.wf;
    }, wf: null
}; IPCC.bP = { Default: 0, Arrow: 1, Crosshair: 2, Link: 3, HandOpen: 4, HandClosed: 5, Magnifier: 6, None: 7, RectangleZoom: 8, AddRectangleMark: 9, AddEllipseMark: 10, AddLineMark: 11, AddFreehandLineMark: 12, AddPolygonMark: 13, AddPolylineMark: 14, AddTextMark: 15, Move: 16, ResizeN: 17, ResizeE: 18, ResizeS: 19, ResizeW: 20, ResizeNW: 21, ResizeNE: 22, ResizeSE: 23, ResizeSW: 24, EditMarks: 25, RunMarks: 26, Text: 27, AddStampMark: 28, AddRectangleRedactionMark: 29, AddImageStampMark: 30, fq: function (cP) { switch (cP) { case IPCC.bP.Default: case IPCC.bP.Magnifier: case IPCC.bP.None: case IPCC.bP.RunMarks: return 'auto'; case IPCC.bP.Arrow: case IPCC.bP.EditMarks: return 'default'; case IPCC.bP.Crosshair: case IPCC.bP.RectangleZoom: case IPCC.bP.AddRectangleMark: case IPCC.bP.AddEllipseMark: case IPCC.bP.AddLineMark: case IPCC.bP.AddFreehandLineMark: case IPCC.bP.AddPolygonMark: case IPCC.bP.AddPolylineMark: case IPCC.bP.AddTextMark: case IPCC.bP.AddRectangleRedactionMark: case IPCC.bP.AddImageStampMark: case IPCC.bP.AddStampMark: return 'crosshair'; case IPCC.bP.Link: return 'pointer'; case IPCC.bP.HandOpen: case IPCC.bP.HandClosed: case IPCC.bP.Move: return 'move'; case IPCC.bP.ResizeN: return 'n-resize'; case IPCC.bP.ResizeE: return 'e-resize'; case IPCC.bP.ResizeS: return 's-resize'; case IPCC.bP.ResizeW: return 'w-resize'; case IPCC.bP.ResizeNW: return 'nw-resize'; case IPCC.bP.ResizeNE: return 'ne-resize'; case IPCC.bP.ResizeSE: return 'se-resize'; case IPCC.bP.ResizeSW: return 'sw-resize'; case IPCC.bP.Text: return 'text'; } return 'auto'; } }; IPCC.auz = function () { var ci = new IPCC.ef(); var Gt = false; var vl; var sl; var OO = false; var DZ = new IPCC.EB(200, 150, 96, 96); var wn = { x: 0, y: 0 }; var OQ = 3; var OU = 0, Pv = 0; var gK = 0.2; var wy = IPCC.Web.UI.MarkHandleMode.HideSideHandlesWhenClose; var El = new IPCC.ef(); var Hm = 0; var KJ = 0; var Gj = false; var abQ; this.hU = []; var YW = IPCC.Web.UI.ScrollBars.Auto; var Gu = []; this.get_transientHighlightMarks = function () { return Gu; }; this.get_scrollBars = function () { return YW; }; this.get_overflow = function () { switch (YW) { case IPCC.Web.UI.ScrollBars.None: return 'hidden'; case IPCC.Web.UI.ScrollBars.Both: return 'scroll'; } return 'auto'; }; this.set_scrollBars = function (F) { YW = F; this.aL('scrollBars'); }; var bC = new IPCC.Web.UI.fR(); this.lg = function (V) { bC.addHandler('propertyChanged', V); }; this.nt = function (V) { bC.removeHandler('propertyChanged', V); }; this.aL = function (cr) { var V = bC.getHandler('propertyChanged'); if (V) { V(this, new IPCC.qP(cr)); } }; var onSelectionChanged = function (bm) { var L = {}; L.selectionIsVisible = Gt; L.selectionRectangle = bm.xf(); bm.aL('selection'); }; this.ny = function () { vl = { x: 0, y: 0 }; sl = { x: 0, y: 0 }; if (!Gt) { return; } Gt = false; onSelectionChanged(this); }; this.showSelection = function (eJ) { vl.x = eJ.x; vl.y = eJ.y; sl.x = eJ.x + eJ.width; sl.y = eJ.y + eJ.height; Gt = true; onSelectionChanged(this); }; this.DO = function (cS) { vl.x = cS.x; vl.y = cS.y; sl.x = cS.x; sl.y = cS.y; Gt = true; onSelectionChanged(this); }; this.Ei = function (cS) { sl.x = cS.x; sl.y = cS.y; onSelectionChanged(this); }; this.Cd = function () { return Gt; }; this.xf = function () { var h = new IPCC.Web.UI.Rectangle(Math.min(vl.x, sl.x), Math.min(vl.y, sl.y), 0, 0); h.width = Math.max(vl.x, sl.x) - h.x; h.height = Math.max(vl.y, sl.y) - h.y; return h; }; var IK = function () { if (!OO) { El.aDN(); return; } El.Qi(ci); El.oa(-wn.x, -wn.y); El.scale(OQ, OQ); El.oa(DZ.width / 2, DZ.height / 2); }; this.hideMagnifier = function () { OO = false; IK(); this.aL('magnifierIsVisible'); }; this.showMagnifier = function (fL) { wn.x = fL.x; wn.y = fL.y; OO = true; IK(); this.aL('magnifierWindowPosition'); this.aL('magnifierIsVisible'); }; this.get_magnifierIsVisible = function () { return OO; }; this.get_magnifierWindowPosition = function () { return { x: wn.x, y: wn.y }; }; this.get_magnifierMagnification = function () { return OQ; }; this.set_magnifierMagnification = function (F) { OQ = F; IK(); this.aL('magnifierMagnification'); }; this.RY = function () { return OU; }; this.Yp = function (F) { OU = F; this.aL('magnifierXOffset'); }; this.Sj = function () { return Pv; }; this.YN = function (F) { Pv = F; this.aL('magnifierYOffset'); }; this.vX = function () { return { width: DZ.width, height: DZ.height }; }; this.set_magnifierWindowSize = function (newMagnifierSize) { DZ.width = newMagnifierSize.width; DZ.height = newMagnifierSize.height; IK(); this.aL('magnifierWindowSize'); }; this.aGg = function () { return El.clone(); }; this.eV = function () { return ci.clone(); }; this.adM = function () { return gK; }; this.Za = function (F) { gK = F; this.aL('markHandleSize'); }; this.Cp = function () { return wy; }; this.Mb = function (F) { wy = F; this.aL('markHandleMode'); }; this.lv = function (F) { if (F === ci || F.awl(ci)) { return; } if (!F.ajf()) { throw new IPCC.Web.UI.ImGearInvalidOperationException('The viewing state of the control is invalid.'); } ci.Qi(F); IK(); this.aL('displayedPageRectangle'); }; var anf = '0'; this.get_presentationQuality = function () { return anf; }; this.set_presentationQuality = function (F) { anf = F; this.aL('presentationQuality'); }; var cP = IPCC.bP.Default; this.get_cursor = function () { return cP; }; this.set_cursor = function (F) { if (cP !== F && cP !== -1) { cP = F; this.aL('cursor'); } }; var Pr = IPCC.bP.Default; this.Bk = function () { if (Pr === IPCC.bP.Default) { return cP; } return Pr; }; this.FU = function (F) { if (Pr !== F) { Pr = F; this.aL('markCursor'); } }; this.Cw = function (cQ) { Hm = cQ; Gj = false; KJ = 0; }; this.QD = function (vm, cz) { if (vm !== Hm) { Hm = vm; } KJ = cz; Gj = true; }; this.acs = function () { if (Gj === true) { for (var G = 0; G < this.hU.length; G++) { this.hU[G].R.set_visible(false); } Gj = false; } }; this.MR = function () { return Gj; }; this.vk = function (cQ, R, jJ) { abQ = cQ; if (cQ !== undefined) { if (this.hU.length > 0 && this.hU[this.hU.length - 1].cQ === cQ) { return false; } this.hU.push({ cQ: cQ, R: R, jJ: jJ }); Gj = true; KJ++; } else { this.hU = []; KJ = 0; } return true; }; this.GZ = function () { return abQ; }; this.aIl = function (F) { if (F === undefined) { return; } abQ = F; }; var alC; this.aHE = function () { return alC; }; this.aHw = function (F) { if (F === undefined) { return; } alC = F; }; this.aif = function () { return Hm; }; this.aHb = function () { return Hm + KJ; }; this.Gv = function () { return this.hU.length; }; this.ny(); this.hideMagnifier(); return this; }; IPCC.bn = function () { this.Ss = false; this.ZQ = false; this.EW = true; this.adF = false; this.IB = false; this.Ab = 0; this.zX = 0; return this; }; IPCC.bn.viewerCounter = 0; IPCC.bn.tileCounter = 0; IPCC.bn.imageIDCounter = 0; IPCC.bn.prototype.anO = function (C) { this.yu = IPCC.bn.viewerCounter.toString(); IPCC.bn.viewerCounter++; this.C = C; if (IPCC.dv) { this.sb = new IPCC.Web.UI.MarkCollection(); } var K = this; function azI(aB, L) { K.axn(L); }; function AQ(aB, L) { K.atS(L); }; C.lg(azI); C.add_markAdded(AQ); C.add_markChanged(AQ); C.add_inProgressMarkChanged(AQ); C.add_markRemoved(AQ); C.add_markReordered(AQ); C.add_marksLoaded(AQ); C.add_markSelectionChanged(AQ); C.add_markTextSelectionChanged(AQ); }; IPCC.bn.prototype.abS = function () { var fg = 'igtile' + IPCC.bn.tileCounter.toString(); IPCC.bn.tileCounter++; return fg; }; IPCC.bn.prototype.zv = function () { this.Ss = true; this.EW = this.EW && this.ZQ; var K = this; var aHQ = function () { if (!K.Ss) { return; } K.cn(K.C.cX(), K.C.bG(), K.C.ff()); K.EW = true; }; window.setTimeout(aHQ, 0); }; IPCC.bn.prototype.axn = function (L) { var wa = L.get_propertyName(); switch (wa) { case 'magnifierWindowSize': case 'magnifierWindowPosition': case 'magnifierMagnification': if (!this.C.bG().get_magnifierIsVisible()) { return; } break; case 'cursor': case 'markCursor': this.NA = true; if (this.C.CK() === true) { this.zv(); } return; case 'displayedPageRectangle': if (this.C.Bc === true) { this.zv(); return; } break; case 'redactionDraftMode': this.NA = true; this.zv(); return; } if (this.C.CK() === true) { this.zv(); } }; IPCC.bn.prototype.atS = function (L) { if (L.mark && !this.NA) { this.sb.addMark(L.mark); } else { this.NA = true; } if (this.C.CK() === true) { this.zv(); } }; IPCC.bn.prototype.VS = function () { this.lD = this.cw.clone(); this.lD.oa(this.aic, this.aiD); this.lD.kY(this.C.cX(), this.C.ff()); this.ut = this.lD.clone(); this.ut.Ap(); }; IPCC.bn.prototype.cn = function (ap, bm, aU) { try { this.Ss = false; if (this.QJ === true) { return; } var bg = this.C.le(); if (bg === null) { return; } var en = bg.igElements; try { this.QJ = true; if (this.JI === undefined || ap === undefined || !(this.JI.equals(ap))) { if (this.adF) { if (this.ln) { this.ajs(this.ln); var ew = en.nd; IPCC.Web.UI.al.removeHandler(ew, "mousedown", this.abX); IPCC.Web.UI.al.removeHandler(ew, "mousemove", this.adl); IPCC.Web.UI.al.removeHandler(ew, "mouseup", this.adk); IPCC.Web.UI.al.removeHandler(ew, "contextmenu", this.aag); IPCC.Web.UI.al.removeHandler(en.fT, "blur", this.Nn); IPCC.Web.UI.al.removeHandler(en.gD, "blur", this.VN); IPCC.Web.UI.al.removeHandler(en.dA, "blur", this.Nn); } delete this.ln; this.ajj(en.su); this.ajj(en.Dz); this.adF = false; if (this.Kw !== undefined) { this.Kw.unlockAllItems(); } if (this.NN !== undefined) { this.NN.unlockAllItems(); } this.Kw = undefined; this.NN = undefined; bg.igElements.nI.onscroll = null; bg.igElements.nI.onresize = null; } if (bg.querySelectorAll) { if (bg.querySelectorAll(".pccPageLoadFail").length === 0) { bg.innerHTML = ''; } } this.C.sm(true); if (ap === undefined) { this.QJ = false; this.JI = undefined; this.aeh(); return; } this.JI = ap.clone(); this.Kw = new IPCC.Ac(); this.Kw.createPyramid(this, this.C); this.NN = new IPCC.Ac(); this.NN.createPyramid(this, this.C); this.adF = true; this.asa(this.yu); } this.cw = bm.eV(); var Te = this.cw.qC(ap); this.cw.oa(-Te.x, -Te.y); this.aua = this.cw.clone(); this.aua.Ap(); this.aic = Math.round(Te.x); this.aiD = Math.round(Te.y); this.VS(); this.ayp(ap, bm, aU); if (ap.aD === 0) { this.VS(); } } finally { this.QJ = false; this.NA = false; if (this.sb) { this.sb.removeAllMarks(); } } this.aoS(true); } catch (e) { this.C.bK('display', e); throw e; } }; IPCC.bn.prototype.sQ = function (xE, zf, AO) { if (xE[zf] === AO) { return; } xE[zf] = AO; }; IPCC.bn.prototype.kR = function (xE, zf, AO) { if (xE.getAttribute(zf) === AO) { return; } xE.setAttribute(zf, AO); }; IPCC.bn.prototype.eC = function (xE, zf, AO) { if (xE.style[zf] === AO) { return; } xE.style[zf] = AO; }; IPCC.bn.prototype.aoS = function (axt) { if (this.QJ) { return; } if (this.Ss && !this.EW) { return; } if (!axt) { try { this.ZQ = true; var bg = this.C.le(); if (bg) { this.Ab = bg.igElements.nI.scrollLeft; this.zX = bg.igElements.nI.scrollTop; } this.avc(); this.VS(); this.C.bG().lv(this.lD); this.C.aM('userModifiedViewState', {}); this.C.sm(false); } finally { this.ZQ = false; } } }; IPCC.bn.prototype.aBq = function (qo, cw, auv) { var qn = qo.aAs(cw, auv); if (!this.C.Bc && qn.tilesToRequest.length === 0 && (qn.opaqueTiles.length + qn.translucentTiles.length) > 0) { this.C.Bc = true; this.C.aM('pageDisplayed', { bp: this.C.aD }); } qo.asD(qn); if (this.C.qp() === false) { this.ark(qn.tilesToRequest); this.Zk(qn.opaqueTiles, 1, cw); this.Zk(qn.translucentTiles, qn.opacity, cw); } }; IPCC.bn.prototype.asa = function (yu) { var C = this.C; var bg = C.le(); var bm = C.bG(); var aO = this; function eK(la) { var uO = document.createElement('div'); var G; for (G in la) { if (la.hasOwnProperty(G)) { uO.style[G] = la[G]; } } return uO; }; var en = {}; bg.igElements = en; var lB = eK({ width: '100%', height: '100%', position: 'relative', overflow: bm.get_overflow(), margin: '0px', borderWidth: '0px', '-moz-user-select': 'text', '-webkit-user-select': 'text' }); en.nI = lB; lB.setAttribute('class', 'igViewerScroller'); lB.onscroll = function () { aO.aoS(false); }; lB.onresize = function () { var aU = C.ff(); aU.width = lB.clientWidth; aU.height = lB.clientHeight; C.aM('resize', {}); }; var ew = eK({ width: '2px', height: '2px', position: 'relative', overflow: 'hidden', margin: '0px', left: '0', top: '0', '-ms-touch-action': 'none' }); lB.appendChild(ew); en.nd = ew; ew.setAttribute('class', 'igViewerGraphics'); this.Cl = 2; this.Ca = 2; this.Ab = 0; this.zX = 0; var aQ = {}; aQ.qo = this.Kw; aQ.adg = 'ig' + yu + 'level'; en.su = aQ; this.alx(aQ, ew, eK); aQ.sA = this.sA; var mX; if (C.qp() === false) { mX = eK({ position: 'absolute', display: 'none', width: (bm.vX().width + 4) + 'px', height: (bm.vX().height + 4) + 'px', backgroundColor: '#000000' }); } else { mX = eK({ position: 'absolute', display: 'none', width: (bm.vX().width + 4) + 'px', height: (bm.vX().height + 4) + 'px', backgroundColor: '#cccccc' }); } ew.appendChild(mX); en.mX = mX; mX.setAttribute('class', 'igMagnifierFrame'); var so = eK({ width: '0px', height: '0px', position: 'absolute', overflow: 'hidden', margin: '0px', left: '0', top: '0' }); en.so = so; mX.appendChild(so); aQ = {}; aQ.qo = this.NN; aQ.adg = 'ig' + yu + 'maglevel'; en.Dz = aQ; this.alx(aQ, so, eK); aQ.sA = this.auk; var QK = document.createTextNode(''); en.QK = QK; var fT = document.createElement('textarea'); fT.appendChild(QK); fT.style.position = 'absolute'; fT.style.overflow = 'auto'; fT.style.width = '80px'; fT.style.height = '80px'; fT.style.resize = 'none'; fT.style.display = 'none'; lB.appendChild(fT); en.fT = fT; var UF = document.createTextNode(''); en.UF = UF; var gD = document.createElement('input'); gD.type = "text"; gD.style.position = 'absolute'; gD.style.overflow = 'hidden'; gD.style.width = '80px'; gD.style.height = '80px'; gD.style.resize = 'none'; gD.style.display = 'none'; gD.style.padding = '0px'; gD.style.margin = '0px'; gD.style.lineHeight = 'normal'; gD.className = "no-ms-clear"; var anw = function (ev) { var zR = gD, ax = parseFloat(zR.style['width']), cR = parseFloat(zR.style['height']), kp = zR.style['fontFamily']; var ayb = zR.value.length > zR.placeholder.length ? zR.value : zR.placeholder; var iI = IPCC.J.wZ(ayb, kp, { wJ: 'pre', gC: en.su.Iu }), pH = 12 * ax / (iI.width || 1), pK = 12 * cR / (iI.height || 1), Cn = Math.floor(Math.min(pH, pK)) * 0.9; zR.style.fontSize = Cn + 'px'; }; gD.onkeyup = anw; gD.onfocus = function (ev) { anw(ev); if (gD.setSelectionRange) { var iC = gD.value.length * 2; gD.setSelectionRange(iC, iC); } }; lB.appendChild(gD); en.gD = gD; var sK = document.createTextNode(''); en.sK = sK; var dA = document.createElement('textarea'); dA.appendChild(sK); dA.style.position = 'absolute'; dA.style.overflow = 'hidden'; dA.style.width = '80px'; dA.style.height = '80px'; dA.style.resize = 'none'; dA.style.display = 'none'; dA.style.whiteSpace = 'pre-wrap'; dA.style.border = 0; dA.style.padding = '2px'; dA.style.fontStyle = 'normal'; var axp = function (au) { var asZ = C.MO(); var bS = C.bG().eV().qs(); var jA = asZ.jA * bS; var by = C.lc().iE() * bS; IPCC.J.abt(dA, jA, by); }; dA.onkeyup = axp; lB.appendChild(dA); en.dA = dA; this.ln = {}; this.alX(this.ln); IPCC.Web.UI.al.addHandler(ew, "mousedown", this.abX); IPCC.Web.UI.al.addHandler(ew, "mousemove", this.adl); IPCC.Web.UI.al.addHandler(ew, "mouseup", this.adk); IPCC.Web.UI.al.addHandler(ew, "contextmenu", this.aag); IPCC.Web.UI.al.addHandler(fT, "blur", this.Nn); IPCC.Web.UI.al.addHandler(gD, "blur", this.VN); IPCC.Web.UI.al.addHandler(dA, "blur", this.Nn); bg.appendChild(lB); }; IPCC.bn.prototype.alx = function (aQ, gc, eK) { var tU = eK({ width: '2px', height: '2px', position: 'absolute' }); aQ.gc = gc; gc.appendChild(tU); aQ.VD = tU; tU.setAttribute('class', 'igAnchor'); this.akf(aQ, tU, aQ.qo, aQ.adg); aQ.Ay = eK({ position: 'absolute', width: '10px', height: '10px', left: '0px', top: '0px', overflow: 'visible' }); tU.appendChild(aQ.Ay); var jT = eK({ overflow: 'hidden', display: 'none', position: 'absolute', backgroundColor: '#00C0E0', border: '#006070 2px solid' }); jT.style[this.anq] = this.amO(0.5); tU.appendChild(jT); aQ.jT = jT; }; IPCC.bn.prototype.ajj = function (aQ) { if (aQ && aQ.IB) { aQ.sA.air(); aQ.IB = false; } aQ.gc = null; }; IPCC.bn.prototype.ayp = function (ap, bm, aU) { var C = this.C; var nS = this.lD.qC(ap); var bg = C.le(); var aEj = C.avb(); var CN = C.asM(); var en = bg.igElements; var su = en.su; var Dz = en.Dz; var lB = en.nI; var ew = en.nd; var tU = su.VD; var mX = en.mX; var so = en.so; var aoi = Dz.VD; var Nb = Math.max(0, -nS.x); var Lc = Math.max(0, -nS.y); var aCI = Math.max(nS.width, aU.width); var aCQ = Math.max(nS.height, aU.height); var lG = Math.max(0, nS.x); var mp = Math.max(0, nS.y); var aiT = false; var FW = false; if (bm.Cd()) { FW = bm.xf(); } var azt = this.Cl; this.Cl = Math.floor(aCI - 1); if (this.Cl < 0) { this.Cl = 0; } var azj = this.Ca; this.Ca = Math.floor(aCQ - 1); if (this.Ca < 0) { this.Ca = 0; } if (C.qp() === true) { if (this.Ca === 0) { this.Ca = 2; } if (this.Cl === 0) { this.Cl = 2; } } var azQ = this.Ab; var azS = this.zX; if (!this.EW) { this.Ab = Math.floor(Nb); this.zX = Math.floor(Lc); } if (this.Yg) { this.eC(tU, 'left', lG + 'px'); this.eC(tU, 'top', mp + 'px'); } var cw = bm.eV(); cw.oa(Nb - lG, Lc - mp); this.ahu(su, bm.eV(), cw, ap, aU, FW, lG, mp); this.eC(lB, 'overflow', bm.get_overflow()); if (aU.width !== lB.clientWidth || aU.height !== lB.clientHeight) { aU.width = lB.clientWidth; aU.height = lB.clientHeight; aiT = true; } this.sQ(tU.style, 'visibility', 'visible'); if (bm.get_magnifierIsVisible()) { var wn = bm.get_magnifierWindowPosition(); var EN = bm.vX(); var OU = bm.RY(); var Pv = bm.Sj(); var Ww = bm.aGg(); var asx = Math.round(wn.x - EN.width / 2 + Nb + OU); var ary = Math.round(wn.y - EN.height / 2 + Lc + Pv); var Nk = Ww.qC(ap); var asv = Math.max(0, -Nk.x); var ass = Math.max(0, -Nk.y); this.eC(aoi, 'left', Nk.x + 'px'); this.eC(aoi, 'top', Nk.y + 'px'); var Po = 2; mX.style.width = (EN.width + Po * 2) + 'px'; mX.style.height = (EN.height + Po * 2) + 'px'; so.style.width = EN.width + 'px'; so.style.height = EN.height + 'px'; so.style.left = Po + 'px'; so.style.top = Po + 'px'; mX.style.left = asx + 'px'; mX.style.top = ary + 'px'; var apv = Ww.clone(); apv.oa(asv, ass); this.ahu(Dz, Ww, apv, ap, EN, FW, 0, 0); mX.style.display = 'block'; } else { mX.style.display = 'none'; } if (C.akS()) { var jm = C.MO(); var asA = jm.fD(); var hN = this.lD.ud(asA); var oi = (jm.get_type() === IPCC.Web.UI.MarkType.Text) ? 64 : 0; var ajr = jm.dQ * -1, aef = jm.dQ * -1; if (hN.width < oi) { hN.width = oi; } if (hN.height < oi) { hN.height = oi; } if (hN.width > aU.width) { hN.width = aU.width; } if (hN.height > aU.height) { hN.height = aU.height; } if (hN.x < 0) { hN.x = 0; } if (hN.y < 0) { hN.y = 0; } if (hN.x + hN.width + 1 >= aU.width) { hN.x = aU.width - hN.width; ajr = -8; } if (hN.y + hN.height + 1 >= aU.height) { hN.y = aU.height - hN.height; aef = -8; } var ky = this.Lx(jm); ky.style.left = this.Ab + hN.x + 1 + (jm.dQ / 2) + 'px'; ky.style.top = this.zX + hN.y + 1 + (jm.dQ / 2) + 'px'; ky.style.width = hN.width + ajr - 1 + 'px'; ky.style.height = hN.height + aef - 1 + 'px'; if (ky.style.display !== 'block') { ky.style.display = 'block'; ky.style.whiteSpace = 'pre-wrap'; var tN = jm.de; var vj = ''; if (tN & IPCC.Web.UI.FontStyle.Italic) { ky.style.fontStyle = "italic"; } if (tN & IPCC.Web.UI.FontStyle.Bold) { ky.style.fontWeight = "bold"; } if (tN & IPCC.Web.UI.FontStyle.Underline) { vj += "underline"; } if (tN & IPCC.Web.UI.FontStyle.Strikeout) { if (tN & IPCC.Web.UI.FontStyle.Underline) { vj += " line-through"; } else { vj = "line-through"; } } ky.style.textDecoration = vj; ky.style.color = jm.od; ky.style.backgroundColor = jm.cK; ky.style.fontFamily = jm.gZ; ky.style['z-index'] = 100; var Cn = jm.mA * this.lD.qs(); if (Cn) { ky.style.fontSize = Cn + "px"; } switch (jm.kh) { case IPCC.Web.UI.HorizontalAlignment.Center: ky.style.textAlign = 'center'; break; case IPCC.Web.UI.HorizontalAlignment.Right: ky.style.textAlign = 'right'; break; default: ky.style.textAlign = 'left'; break; } if (jm.gU) { setTimeout(function () { en.fT.maxLength = jm.gU; en.gD.maxLength = jm.gU; en.dA.maxLength = jm.gU; }, 0); } if (jm.iJ) { if (CN) { CN.destroy(); C.Yo(null); } C.Yo(new PCCViewer.acJ(ky, jm.iJ)); } if (jm.jd() === IPCC.Web.UI.MarkType.TextAreaSignature) { var dA = IPCC.J.aeU(); dA.style.width = en.dA.style.width; dA.style.height = en.dA.style.height; dA.style.fontFamily = en.dA.style.fontFamily; dA.style.fontStyle = en.dA.style.fontStyle; dA.style.fontWeight = en.dA.style.fontWeight; var bS = C.bG().eV().qs(); var jA = jm.jA * bS; var by = C.lc().iE() * bS; IPCC.J.ady().nodeValue = jm.az || 'm'; en.dA.style.fontSize = IPCC.J.abt(dA, jA, by) + 'px'; } ky.focus(); } } else { en.fT.style.display = 'none'; en.gD.style.display = 'none'; en.dA.style.display = 'none'; en.fT.removeAttribute('maxlength'); en.gD.removeAttribute('maxlength'); en.dA.removeAttribute('maxlength'); if (CN) { CN.destroy(); C.Yo(null); } if (document.activeElement === en.fT) { en.fT.blur(); } if (document.activeElement === en.gD) { en.gD.blur(); } if (document.activeElement === en.dA) { en.dA.blur(); } } if (bm.get_cursor() !== -1) { var ie = IPCC.bP.fq(bm.get_cursor()); this.sQ(ew.style, 'cursor', ie); } if (aiT) { C.aM('resize', {}); } if (this.Cl !== azt) { this.eC(ew, 'width', '100%'); } if (this.Ca !== azj) { this.eC(ew, 'height', '100%'); } if (this.Ab !== azQ) { lB.scrollLeft = this.Ab; } if (this.zX !== azS) { lB.scrollTop = this.zX; } if (aEj === "PageView" && !this.EW) { bm = C.bG(); var bz = bm.eV(); var yh = (+bz.qs().toFixed(6)); if (C.SP !== yh) { C.SP = yh; setTimeout(function () { C.aM('scaleChanged', { scaleFactor: yh, pageNumber: C.aD }); }, 1); C.aM('scaleChanged', { scaleFactor: yh, pageNumber: C.aD }); } } }; IPCC.bn.prototype.ahu = function (aQ, lD, cw, bb, aU, FW, lG, mp) { var nS = lD.qC(bb); var mq = {}; mq.width = Math.max(nS.width, aU.width); mq.height = Math.max(nS.height, aU.height); this.axf(aQ, lD, cw, bb, aU, lG, mp); this.UN(aQ, cw, mq, bb, lG, mp); if (this.C.qp() === false) { this.amC(aQ, aU, lD, cw); } else { this.arH(aQ); } if (FW) { var FC = cw.ud(FW); if (this.Yg) { aQ.jT.style.left = (FC.x - 2) + 'px'; aQ.jT.style.top = (FC.y - 2) + 'px'; } else { aQ.jT.style.left = (FC.x - 2 + lG) + 'px'; aQ.jT.style.top = (FC.y - 2 + mp) + 'px'; } aQ.jT.style.width = FC.width + 'px'; aQ.jT.style.height = FC.height + 'px'; aQ.jT.style.display = 'block'; } else { aQ.jT.style.display = 'none'; } }; IPCC.bn.prototype.amC = function (aQ, aU, lD, cw) { var alJ = this.C.aDJ(); var Lf = { x: 0, y: 0, width: aU.width, height: aU.height }; if (alJ) { var zQ = alJ.getBoundingClientRect(); var hg = aQ.gc.getBoundingClientRect(); var RJ; if (hg.left < zQ.left) { RJ = zQ.left - hg.left; Lf.x = (RJ / hg.width) * aU.width; } if (hg.right > zQ.right) { Lf.width = zQ.width; } if (hg.top < zQ.top) { RJ = zQ.top - hg.top; Lf.y = (RJ / hg.height) * aU.height; } if (hg.bottom > zQ.bottom) { Lf.height = zQ.height; } } var ut = lD.clone(); ut.Ap(); var auh = ut.ud(Lf); this.aBq(aQ.qo, cw, auh); }; IPCC.bn.prototype.axf = function (aQ, lD, cw, bb, aU, lG, mp) { var aX = this.C.eI(); var hI = this.C.mK(); var eO = this.C.Qr(); var aiK = 0; var K = this; if (aQ.kk) { aiK = aQ.kk.length; } if (!aQ.sA || !aX) { return; } var rg = this.C.asP(); if (aX.get_markCount() <= 0 && hI.get_markCount() <= 0 && eO.get_markCount() <= 0 && aiK <= 0 && !rg) { return; } if (!aQ.IB) { aQ.sA.ame(this.C, aQ, bb); aQ.kk = []; aQ.IB = true; } hI = this.C.mK(); var bN = []; function asz(R) { if ((K.C.iw() && K.C.cv().mw() === true) || R.get_type() !== IPCC.Web.UI.MarkType.Highlight) { bN.push(R); } }; function aex(R) { bN.push(R); }; eO.forEachMark(aex); if (this.C.iw() && this.C.cv().mw() === true) { hI.forEachMark(aex); } aX.forEachMark(asz); if (rg) { bN.push(rg); } var G, kk = aQ.kk; for (G = 0; G < kk.length; G++) { while (G < kk.length && (G >= bN.length || kk[G].R !== bN[G])) { aQ.sA.KG(kk[G]); kk.splice(G, 1); } if (G < kk.length && (this.NA || this.sb.contains(kk[G].R))) { aQ.sA.Rw(kk[G]); } } for (G = kk.length; G < bN.length; G++) { kk[G] = { R: bN[G] }; var T = kk[G]; if (!T) { continue; } aQ.sA.akM(kk[G]); } if (this.Yg) { aQ.sA.age(this.C, aQ, bN, cw, this.C.akY()); } else { var fv = cw.clone(); fv.oa(lG, mp); aQ.sA.age(this.C, aQ, bN, fv, this.C.akY()); } }; IPCC.bn.prototype.UN = function () { }; IPCC.bn.prototype.avc = function () { var bg = this.C.le(); if (bg) { this.aic = bg.igElements.nd.offsetLeft - this.Ab; this.aiD = bg.igElements.nd.offsetTop - this.zX; } }; IPCC.bn.prototype.uF = function (L, cn) { var fO = this.C.le().igElements; var lj = L.domEvent; var ey; if (fO.nd.getBoundingClientRect) { ey = fO.nd.getBoundingClientRect(); } else { var ck = fO.nd; var we = document.documentElement; ey = { left: we.clientLeft - we.scrollLeft, top: we.clientTop - we.scrollTop }; ck = ck.offsetParent; while (ck) { ey.top += ck.offsetTop - ck.scrollTop; ey.left += ck.offsetLeft - ck.scrollLeft; ck = ck.offsetParent; } } if (lj.rawEvent.touches) { if (lj.rawEvent.touches.length > 0) { this.Pk = new IPCC.Web.UI.Point(lj.rawEvent.touches[0].clientX - fO.nI.scrollLeft - ey.left, lj.rawEvent.touches[0].clientY - fO.nI.scrollTop - ey.top); } if (!this.Pk) { this.Pk = new IPCC.Web.UI.Point(0, 0); } L.windowPoint = new IPCC.Web.UI.Point(this.Pk.x, this.Pk.y); lj.button = 0; } else { L.windowPoint = new IPCC.Web.UI.Point(lj.clientX - ey.left - fO.nI.scrollLeft, lj.clientY - ey.top - fO.nI.scrollTop); } var Uh = this.ut.transform(L.windowPoint); L.imagePoint = new IPCC.Web.UI.Point(Uh.x, Uh.y); L.constrainedImagePoint = new IPCC.Web.UI.Point(Uh.x, Uh.y); L.constrainedImagePoint.x = Math.min(Math.max(L.constrainedImagePoint.x, 0), this.JI.width); L.constrainedImagePoint.y = Math.min(Math.max(L.constrainedImagePoint.y, 0), this.JI.height); L.pointLiesWithinImage = (L.constrainedImagePoint.x === L.imagePoint.x && L.constrainedImagePoint.y === L.imagePoint.y); L.mark = null; try { var cD = lj.target; while (!(cD.ImGearMarkRelation) && cD.parentNode && cD !== document.body) { cD = cD.parentNode; } if (cD.ImGearMarkRelation) { L.mark = cD.ImGearMarkRelation.R; } } catch (bJ) { } }; IPCC.bn.prototype.jO = function (bJ) { try { bJ.preventDefault(); var L = new IPCC.Web.UI.MouseEventArgs(); L.domEvent = bJ; this.uF(L); this.C.aBE(L); } catch (ex) { this.C.bK('mouseDown', ex); } }; IPCC.bn.prototype.lp = function (bJ) { try { bJ.preventDefault(); var L = new IPCC.Web.UI.MouseEventArgs(); L.domEvent = bJ; this.uF(L); this.C.aCb(L); } catch (ex) { this.C.bK('mouseMove', ex); } }; IPCC.bn.prototype.lY = function (bJ) { try { var L = new IPCC.Web.UI.MouseEventArgs(); L.domEvent = bJ; this.uF(L); if (!bJ.rawEvent.wheelDelta) { L.wheelDelta = -bJ.rawEvent.detail * 120; } else { L.wheelDelta = bJ.rawEvent.wheelDelta; } this.C.aBg(L); } catch (ex) { this.C.bK('mouseWheel', ex); } }; IPCC.bn.prototype.vS = function (bJ) { try { bJ.preventDefault(); var L = new IPCC.Web.UI.MouseEventArgs(); L.domEvent = bJ; this.uF(L); this.C.aBM(L); } catch (ex) { this.C.bK('mouseDoubleClick', ex); } }; IPCC.bn.prototype.iB = function (bJ) { try { bJ.preventDefault(); var L = new IPCC.Web.UI.MouseEventArgs(); L.domEvent = bJ; this.uF(L); this.C.aAW(L); } catch (ex) { this.C.bK('mouseUp', ex); } }; IPCC.bn.prototype.Ok = function (bJ) { try { bJ.preventDefault(); var L = new IPCC.Web.UI.MouseEventArgs(); L.domEvent = bJ; this.uF(L); this.C.aBD(L); } catch (ex) { this.C.bK('contextMenu', ex); } }; IPCC.bn.prototype.aph = function (bJ) { try { this.C.sm(true); } catch (ex) { this.C.bK('textAreaBlur', ex); } }; IPCC.bn.prototype.anK = function (bJ) { try { this.C.sm(true); } catch (ex) { this.C.bK('textInputBlur', ex); } }; IPCC.bn.prototype.asN = function (R) { var fT = this.Lx(R); fT.value = R.az || ""; }; IPCC.bn.prototype.azG = function () { var C = this.C; var R = C.MO(); if (!R || !C.akS()) { return; } var acV = this.Lx(R); if (document.activeElement === acV) { acV.blur(); } var az = acV.value; az = az.replace(/(\n|\n\r|\r\n|\r)/g, '\n'); R.set_text(az); }; IPCC.bn.prototype.Lx = function (R) { var fO = this.C.le().igElements, fT = null; if (R.get_type() === IPCC.Web.UI.MarkType.TextLine) { fT = fO.gD; } else if (R.get_type() === IPCC.Web.UI.MarkType.TextAreaSignature) { fT = fO.dA; } else if (R.get_type() === IPCC.Web.UI.MarkType.Text) { fT = fO.fT; } return fT; }; IPCC.Ac = function () { this.et = []; return this; }; IPCC.Ac.prototype.aAs = function (ci, eJ) { var bS = ci.qs(); var G, pk, nH; var dI = 1; var Sy; var yw = []; var wW = []; var yi = []; var GS, Qy; nH = this.et.length; for (G = 0; G < this.et.length; G++) { if (this.et[G].bS > bS) { nH = G; break; } } pk = nH - 1; if (pk < 0) { pk = 0; } if (nH >= this.et.length) { nH = this.et.length - 1; } if (pk !== nH) { Sy = (bS - this.et[pk].bS) / (this.et[nH].bS - this.et[pk].bS); dI = Sy * 1.0; if (dI >= 0.15) { dI = 1; pk = nH; } if (dI <= 0.15) { dI = 1; nH = pk; } } wW = this.et[pk].RK(eJ); yi = this.et[nH].RK(eJ); var Ts = function (oV) { var G; for (G = 0; G < oV.length; G++) { oV[G].level.pool.Wo(oV[G]); } }; var aae = function (oV) { var anR = []; var G; for (G = 0; G < oV.length; G++) { if (!oV[G].get_isLockedAndLoaded()) { anR.push(oV[G]); } } return anR; }; var acb = function (oV) { var anQ = []; var G; for (G = 0; G < oV.length; G++) { if (oV[G].get_isLockedAndLoaded()) { anQ.push(oV[G]); } } return anQ; }; if (pk > 0 && pk === nH && this.et[nH].tiles.length > 1) { pk = nH - 1; wW = this.et[pk].RK(eJ); } Ts(wW); yw = aae(wW); if (yw.length > 0) { for (GS = pk - 1; GS >= 0; GS--) { Qy = this.et[GS].RK(eJ); Ts(Qy); if (aae(Qy).length < 1) { break; } } if (GS < 0) { wW = acb(wW); } else { pk = GS; wW = Qy; dI = 1; } } else { Ts(yi); yw = aae(yi); } Ts(yi); yi = acb(yi); if (yw.length > 3) { yw.splice(3, yw.length - 3); } function aye() { var bM; function Vf(GQ) { var bM = '', G, as; if (GQ.length < 1) { return ''; } as = GQ[0].level; bM += 'level ' + as.id.toString() + ' - '; for (G = 0; G < GQ.length; G++) { if (G > 0) { bM += ', '; } bM += '(' + (GQ[G].x / as.ox).toString() + ',' + (GQ[G].y / as.Co).toString() + ')'; if (GQ[G].get_isLockedAndLoaded()) { bM += '*'; } } return bM; }; bM = 'tilesToRequest: ' + Vf(yw) + '<br/>'; bM += 'opaqueTiles: ' + Vf(wW) + '<br/>'; bM += 'translucentTiles: ' + Vf(yi) + '<br/>'; bM += 'opacity: ' + dI.toString() + '<br/>'; bM += 'avd: ' + bS.toString() + '<br/>'; bM += 'ci: ' + ci.toString() + '<br/>'; return bM; }; return { opaqueTiles: wW, translucentTiles: yi, opacity: dI, tilesToRequest: yw, toString: aye, avd: bS, ci: ci.toString() }; }; IPCC.Ac.prototype.asD = function (qn) { var FI = []; var tP = []; var G, j; var as, tile; for (G = 0; G < this.et.length; G++) { as = this.et[G]; for (j = 0; j < as.tiles.length; j++) { tile = as.tiles[j]; if (tile.poolItem !== undefined) { FI.push(tile); } } } var aon = function (abB, anL) { var G, j, aaJ, aai; for (G = 0; G < anL.length; G++) { aaJ = anL[G]; aai = true; for (j = 0; j < abB.length; j++) { if (aaJ === abB[j]) { aai = false; break; } } if (aai) { abB.push(aaJ); } } }; tP = qn.tilesToRequest.concat(); aon(tP, qn.opaqueTiles); aon(tP, qn.translucentTiles); for (G = FI.length - 1; G >= 0; G--) { var aAM = FI[G]; for (j = 0; j < tP.length; j++) { if (tP[j] === aAM) { FI.splice(G, 1); break; } } } for (G = 0; G < FI.length; G++) { FI[G].unlock(); } for (G = 0; G < tP.length; G++) { tP[G].relock(); } for (G = 0; G < tP.length; G++) { if (tP[G].poolItem === undefined) { tP[G].lock(); } } }; IPCC.Ac.prototype.unlockAllItems = function () { var G, j, as; for (G = 0; G < this.et.length; G++) { as = this.et[G]; for (j = 0; j < as.tiles.length; j++) { if (as.tiles[j].poolItem !== undefined) { as.pool.agV(as.tiles[j]); } } } }; IPCC.Ac.prototype.aJn = function () { var G; for (G = 0; G < this.et.length; G++) { this.et[G].pool.awC(); } }; IPCC.Ac.prototype.toString = function () { var bM = '', G, j, as; for (G = 0; G < this.et.length; G++) { as = this.et[G]; bM += 'Level ' + G.toString() + ':   scaleFactor=' + as.bS.toString() + '  image=' + as.width.toString() + 'x' + as.height.toString() + '  tile=' + as.ox.toString() + 'x' + as.Co.toString() + '\n'; for (j = 0; j < as.tiles.length; j++) { if (j > 0) { bM += ', '; } bM += '(' + as.tiles[j].x.toString() + ', ' + as.tiles[j].y.toString() + ')'; } bM += '\n'; } return bM; }; IPCC.Ac.prototype.createPyramid = function (jR, C) { var aqb = 6000000; var anh = 5000; var ox = 1024; var awT = ox * ox * 3 * 150; var ama = 0.5; var ayY = 2; var ap = C.cX(); var CY = ap.width * ap.height * 3; var xR; var as; var bS; var G; var x, y; var tile; var yv, yG; this.et = []; if (ap.sa) { bS = 1.0; xR = CY * bS * bS; while (this.et.length < ayY || xR > anh) { as = new IPCC.SN(); as.bS = bS; this.et.unshift(as); bS *= ama; xR = CY * bS * bS; } } else { if (C.qp() === true) { CY = ap.width * ap.height; } bS = Math.sqrt(anh / CY); var azw = bS * ap.hi; bS = Math.ceil(azw) / ap.hi; xR = CY * bS * bS; if (C.qp() === false) { while (xR < awT) { as = new IPCC.SN(); as.bS = bS; this.et.push(as); bS /= ama; xR = CY * bS * bS; } } else { as = new IPCC.SN(); as.bS = 1; this.et.push(as); } } ap.sV = this.et[this.et.length - 1].bS * 8; for (G = 0; G < this.et.length; G++) { as = this.et[G]; as.Vc = 85; if (G === this.et.length - 1) { as.Vc = 100; } as.pyramid = this; as.id = G; as.pool = new IPCC.aev(); as.pool.uiDirector = jR; xR = CY * as.bS * as.bS; as.width = Math.round(ap.width * as.bS); as.height = Math.round(ap.height * as.bS); as.ox = as.width; as.Co = as.height; if (G > 2 && G > this.et.length - 2) { as.ox = Math.min(ox / 2, as.width); as.Co = Math.min(ox / 2, as.height); } if (xR > aqb) { as.ox = Math.min(ox, as.width); as.Co = Math.min(ox, as.height); } as.tiles = []; yv = as.ox; for (x = 0; x < as.width; x += yv) { yv = as.ox; if (x + yv * 1.25 > as.width) { yv = as.width - x; } yG = as.Co; for (y = 0; y < as.height; y += yG) { yG = as.Co; if (y + yG * 1.25 > as.height) { yG = as.height - y; } tile = new IPCC.Jx(); tile.level = as; tile.x = x; tile.y = y; tile.right = tile.x + yv; if (tile.right < as.width) { tile.right++; } tile.bottom = tile.y + yG; if (tile.bottom < as.height) { tile.bottom++; } if (C.qp() === false) { var OJ = 'jpeg'; if (as.Vc >= 100) { OJ = 'png'; } tile.contentType = OJ; if (yv !== as.width || yG !== as.height) { tile.url = C.adB('Tile/' + x.toString() + '/' + y.toString() + '/' + yv.toString() + '/' + yG.toString(), 'Scale=' + as.bS.toString() + '&Quality=' + as.Vc + '&ContentType=' + OJ); } else { tile.url = C.adB('', 'Scale=' + as.bS.toString() + '&Quality=' + as.Vc + '&ContentType=' + OJ); } } else { tile.url = C.adB('', 'Scale=' + as.bS.toString() + '&ContentType=' + IPCC.J.Yj); tile.aKi = jR.abS(); } as.tiles.push(tile); } } } }; IPCC.SN = function () { this.bS = 1; this.width = 0; this.height = 0; this.ox = 0; this.Co = 0; this.pool = undefined; return this; }; IPCC.SN.prototype.RK = function (eJ) { if (eJ.width < 1 || eJ.height < 1) { return []; } var lN = Math.floor(eJ.x * this.bS); var lK = Math.floor(eJ.y * this.bS); var oW = Math.ceil((eJ.x + eJ.width) * this.bS); var nF = Math.ceil((eJ.y + eJ.height) * this.bS); var oV = []; var G, iU; var dg = this.tiles.length; for (G = 0; G < dg; G++) { iU = this.tiles[G]; if (iU.x <= oW && iU.right >= lN && iU.y <= nF && iU.bottom >= lK) { oV.push(iU); } } return oV; }; IPCC.Jx = function () { this.x = 0; this.y = 0; this.right = 0; this.bottom = 0; this.url = ''; this.poolItem = undefined; this.level = undefined; return this; }; IPCC.Jx.prototype.unlock = function () { this.level.pool.agV(this); }; IPCC.Jx.prototype.lock = function () { this.level.pool.lockTile(this); }; IPCC.Jx.prototype.relock = function () { return this.level.pool.Wo(this); }; IPCC.Jx.prototype.get_isLockedAndLoaded = function () { if (this.poolItem === undefined || !this.poolItem.loaded) { return false; } return true; }; IPCC.aev = function () { this.ek = []; this.parentElementID = ''; this.lockTile = function (iU) { var dk, G, aab, aaO; if (this.Wo(iU)) { return; } aab = 0; for (G = this.ek.length - 1; G >= 0; G--) { if (!(this.ek[G].locked)) { aab++; aaO = G; } } if (aab > 4) { dk = this.ek[aaO]; this.uiDirector.acX(dk); this.ek.splice(aaO, 1); } dk = new IPCC.aBU(); dk.pool = this; this.uiDirector.aqU(dk); this.ek.push(dk); dk.locked = true; dk.tile = iU; iU.poolItem = dk; return; }; this.Wo = function (iU) { var dk, G; if (this.locked) { return true; } for (G = 0; G < this.ek.length; G++) { if (this.ek[G].tile === iU) { dk = this.ek[G]; dk.locked = true; iU.poolItem = dk; return true; } } return false; }; this.agV = function (iU) { var fh, G; fh = iU.poolItem; if (fh !== undefined && fh.locked) { this.uiDirector.adV(fh); fh.locked = false; iU.poolItem = undefined; for (G = 0; G < this.ek.length; G++) { if (this.ek[G] === fh) { this.ek.splice(G, 1); this.ek.push(fh); return; } } } }; return this; }; IPCC.aev.prototype.awC = function () { var G; for (G = 0; G < this.ek.length; G++) { if (!this.ek[G].locked) { this.uiDirector.acX(this.ek[G]); } } }; IPCC.aBU = function () { this.locked = false; this.loaded = false; this.tile = undefined; this.pool = undefined; this.elementID = ''; return this; }; (function (vq) { var J = {}; J.aoL = false; J.asO = (function supportsSVG() { return ! !('createElementNS' in document && document.createElementNS('http://www.w3.org/2000/svg', 'svg').createSVGRect); })(); J.Qj = (function () { var Qj = false; var vd = navigator.userAgent, aar = ((vd.indexOf('Mozilla/5.0') > -1 && vd.indexOf('Android ') > -1 && vd.indexOf('AppleWebKit') > -1) && !(vd.indexOf('Chrome') > -1)), afp = new RegExp(/AppleWebKit\/([\d.]+)/), aCe = afp.exec(vd), aqr = (aCe === null ? null : parseFloat(afp.exec(vd)[1])); Qj = aar && aqr !== null && aqr < 537; return Qj; })(); J.aAY = (function () { var anZ = false; var vd = navigator.userAgent, aar = /Android/i.test(vd), axB = /iPhone|iPad|iPod/i.test(vd), ayJ = /IEMobile/i.test(vd); anZ = (aar || axB || ayJ); return anZ; })(); J.Ni = (function () { var Ni = false; if (document.documentMode === 8 || document.documentMode === 9 || document.documentMode === 10) { Ni = true; } return Ni; })(); J.Yj = (function () { var aiG = navigator.userAgent; if (document.documentMode === 10 || J.Qj) { return 'svg'; } else if (document.documentMode === 9) { return 'svga'; } else if (/Apple Computer/.test(navigator.vendor || '') && /Mac OS X.*?Version\/9\..*?Safari/i.test(aiG) && !J.aAY) { return 'svga'; } else if (/Google Inc/.test(navigator.vendor || '') && /Windows.*?Chrome/i.test(aiG)) { return 'svga'; } else { return 'svgb'; } })(); J.Hd = (function () { if (document.documentMode === 8) { document.namespaces.add('v', 'urn:schemas-microsoft-com:vml'); document.createStyleSheet().addRule("v\\: *", "behavior:url(#default#VML); position:absolute"); document.createStyleSheet().addRule("v\\:roundrect", "behavior:url(#default#VML); position:absolute"); document.createStyleSheet().addRule("v\\:oval", "behavior:url(#default#VML); position:absolute"); document.createStyleSheet().addRule("v\\:roundrect", "behavior:url(#default#VML); position:absolute"); document.createStyleSheet().addRule("v\\:fill", "behavior:url(#default#VML); position:absolute"); document.createStyleSheet().addRule("v\\:line", "behavior:url(#default#VML); position:absolute"); document.createStyleSheet().addRule("v\\:shape", "behavior:url(#default#VML); position:absolute"); document.createStyleSheet().addRule("v\\:polyline", "behavior:url(#default#VML); position:absolute"); document.createStyleSheet().addRule("v\\:stroke", "behavior:url(#default#VML); position:absolute"); return true; } return false; })(); J.DA = (function () { return window.navigator.pointerEnabled || window.navigator.msPointerEnabled; })(); J.Op = J.DA || (function () { return ('ontouchstart' in document.documentElement); })(); J.aAE = (function () { return (navigator.platform) ? ! !navigator.platform.match(/iPad|iPhone|iPod/g) : false; })(); J.acu = function () { return J.aqI.btoa((Math.random().toString(36).slice(-4)) + '_' + J.zO(new Date()) + '_' + (Math.random().toString(36).slice(-6))); }; J.inArray = function (fm, dk) { for (var i = 0, l = fm.length; i < l; i++) { if (fm[i] === dk) { return true; } } return false; }; J.forEach = function (aC, db, ca) { var qL = [].forEach, azA = Object.prototype.hasOwnProperty; if (qL && aC.forEach === qL) { db && aC.forEach(db, ca); } else if (aC.length === +aC.length) { for (var i = 0, length = aC.length; i < length; i++) { db && db.call(ca, aC[i], i, aC); } } else { for (var dC in aC) { if (azA.call(aC, dC)) { db && db.call(ca, aC[dC], dC, aC); } } } }; J.map = function (fm, db, ca) { var qL = [].map, wt = []; if (qL && fm.map === qL) { wt = fm.map(db, ca); } else { J.forEach(fm, function (el, i) { wt.push(db.call(ca, el, i, fm)); }); } return wt; }; J.filter = function (fm, db, ca) { var qL = [].filter, wt = [], amg = false; if (qL && fm.filter === qL) { wt = fm.filter(db, ca); } else { J.forEach(fm, function (bL, i) { amg = db.call(ca, bL, i, fm); if (amg) { wt.push(bL); } }); } return wt; }; J.find = function (obj, cb, context) { var hasProp = Object.prototype.hasOwnProperty; cb = (typeof cb === 'function') ? cb : function () { }; if (obj.length === +obj.length) { for (var i = 0, length = obj.length; i < length; i++) { if (! !cb.call(context, obj[i], i, obj)) { return obj[i]; } } } else { for (var name in obj) { if (hasProp.call(obj, name)) { if (! !cb.call(context, obj[name], name, obj)) { return obj[name]; } } } } return undefined; }; J.remove = function (fm, db, ca) { var XG = []; var awN = J.filter(fm, db, ca); J.forEach(awN, function (dk) { var ak = J.indexOf(fm, dk); if (ak === -1) { return; } XG = XG.concat(fm.splice(ak, 1)); }); return XG; }; J.keys = function (aC) { if (Object && Object.keys) { return Object.keys(aC); } else { var oG = []; for (var G in aC) { if (aC.hasOwnProperty && aC.hasOwnProperty(G)) { oG.push(G); } } return oG; } }; J.indexOf = function (fm, agv, ajO) { if (Array.prototype.indexOf) { return fm.indexOf(agv, ajO); } var k; if (fm == null) { throw new TypeError('"fm" is null or not defined'); } var O = Object(fm); var len = O.length >>> 0; if (len === 0) { return -1; } var n = +ajO || 0; if (Math.abs(n) === Infinity) { n = 0; } if (n >= len) { return -1; } k = Math.max(n >= 0 ? n : len - Math.abs(n), 0); while (k < len) { if (k in O && O[k] === agv) { return k; } k++; } return -1; }; J.reduce = function (fm, db, eb, ca) { var qL = [].reduce; var LZ = (arguments.length === 2) ? undefined : eb; if (qL && typeof qL === 'function' && fm.reduce === qL && ca === undefined) { if (eb !== undefined) { return fm.reduce(db, eb, ca); } return fm.reduce(db); } IPCC.J.forEach(fm, function (bj, dJ) { if (LZ === undefined) { LZ = bj; return; } LZ = db.call(ca, LZ, bj, dJ, fm); }); return LZ; }; J.reduceLeft = function (fm, db, eb, ca) { var wt = fm.reverse(); return J.reduce.call(undefined, wt, db, eb, ca); }; J.contains = function (fm, bj) { var cz = fm.length; while (cz--) { if (fm[cz] === bj) { return true; } } return false; }; J.awW = function (aco, aox) { if (aco.length !== aox.length) { return false; } for (var i = 0, l = aco.length; i < l; i++) { if (aco[i] !== aox[i]) { return false; } } return true; }; J.extend = function (target) { "use strict"; var source; if (!target) { throw new IPCC.Web.UI.ImGearArgumentException("target", "target must be defined."); } else if (typeof target !== 'object') { throw new IPCC.Web.UI.ImGearArgumentException("target", "typeof target must be 'object'"); } else { for (var i = 1; i < arguments.length; i++) { source = arguments[i]; for (var property in source) { if (source.hasOwnProperty(property)) { target[property] = source[property]; } } } } return target; }; J.trim = function (cI) { if (String.prototype.trim) { return cI.trim(); } return cI.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, ''); }; J.ahb = function ahb(Fp, aus, aeZ) { var tE; return function () { var ca = this, dm = arguments; var aFA = function () { tE = undefined; if (!aeZ) { Fp.apply(ca, dm); } }; var aHf = aeZ && !tE; clearTimeout(tE); tE = setTimeout(aFA, aus); if (aHf) { Fp.apply(ca, dm); } }; }; J.ait = function ait(aS, wR) { if (aS.classList) { aS.classList.add(wR); } else { aS.className += ' ' + wR; } }; J.agb = function agb(aS, wR) { if (aS.classList) { aS.classList.remove(wR); } else { aS.className = aS.className.replace(wR, ''); } }; J.ZP = function (jX) { return { width: jX.width || (jX.right - jX.left), height: jX.height || (jX.bottom - jX.top), top: jX.top, bottom: jX.bottom, left: jX.left, right: jX.right }; }; J.tc = function (bF) { if (bF instanceof J.tc) { return bF; } this.hY = J.reduce(bF.headers || {}, function (sp, bj, aq) { aq = aq.toLowerCase(); if (sp[aq]) { sp[aq] += ', ' + bj; } else { sp[aq] = bj; } return sp; }, {}); this.status = bF.status; this.statusText = bF.statusText; this.responseText = bF.responseText; if (typeof bF.responseBody !== 'undefined') { this.responseBody = bF.responseBody; } return this; }; J.tc.prototype.getResponseHeader = function (ZX) { var bF = this.hY[ZX.toLowerCase()]; return bF !== undefined ? bF : null; }; J.mt = (function () { var vq = {}; vq.hY = {}; vq.OM = undefined; function aHt(ahx) { var hY = {}; if (!ahx) { return hY; } var ahv = ahx.split('\u000d\u000a'); for (var G = 0, dg = ahv.length; G < dg; G++) { var Zz = ahv[G]; var ak = Zz.indexOf('\u003a\u0020'); if (ak > 0) { var aq = Zz.substring(0, ak); var bj = Zz.substring(ak + 2); if (hY[aq]) { hY[aq] += ', ' + bj; } else { hY[aq] = bj; } } } return hY; }; vq.dZ = function (aqY) { var Ct = { method: 'GET', url: null, headers: {}, body: null, timeout: null, mimeType: null, }, nJ = PCCViewer.Deferred(), cZ = nJ.getPromise(), Pg; var aH = J.extend({}, Ct, aqY); aH.headers = J.extend({}, vq.hY, aH.headers); if (typeof vq.OM === 'function') { Pg = vq.OM(aH); if (typeof Pg === 'object' && typeof Pg.then === 'function') { Pg.then(function (bM) { nJ.resolve(bM); }, function (bM) { nJ.reject(bM); }); return cZ; } } var kn, tE; try { kn = new XMLHttpRequest(); } catch (e) { nJ.reject(new PCCViewer.Error("Error", e.message)); } if (kn) { kn.open(aH.method, aH.url, true); if (aH.timeout) { tE = window.setTimeout(function () { kn.abort(); nJ.reject({ error: new PCCViewer.Error("Error", "Request timed out") }); }, aH.timeout); } kn.onreadystatechange = function () { var bF, QL = {}; if (kn.readyState === 4) { if (tE) { window.clearTimeout(tE); } QL = { status: kn.status, headers: aHt(kn.getAllResponseHeaders()) }; try { QL.responseText = kn.responseText; } catch (e) { } if (typeof kn.responseBody !== 'undefined') { QL.responseBody = kn.responseBody; } bF = new J.tc(QL); if (kn.status >= 200 && kn.status < 300 || status === 304) { nJ.resolve(bF); } else { nJ.reject({ response: bF, error: new PCCViewer.Error("Error", "An AJAX problem occurred: " + kn.status + " " + kn.statusText) }); } } }; for (var aq in aH.headers) { if (aH.headers.hasOwnProperty(aq)) { kn.setRequestHeader(aq, aH.headers[aq]); } } if (typeof aH.mimeType === 'string' && typeof kn.overrideMimeType === 'function') { kn.overrideMimeType(aH.mimeType); } kn.send(aH.body); } return cZ; }; return vq; })(); J.QF = function (gP, iO, ec) { var gp = [], vg = null, xs = null, aj; var ayP = function (xs, vg) { if (!vg) { return false; } else { return Math.abs(xs.y - vg.y) < 1 && Math.abs(xs.height - vg.height) < 1 && xs.x + xs.width >= vg.x + vg.width; } }; for (aj = iO; aj < ec + 1; aj++) { xs = gP.jN(aj).av; if (ayP(xs, vg)) { vg.union(xs); } else { vg = xs.clone(); gp.push(vg); } } return gp; }; J.addEvent = function addEvent(obj, event, handler) { if (obj.addEventListener) { obj.addEventListener(event, handler, false); } else if (obj.attachEvent) { obj.attachEvent('on' + event, handler); } }; J.removeEvent = function (obj, event, handler) { if (obj.removeEventListener) { obj.removeEventListener(event, handler, false); } else if (obj.detachEvent) { obj.detachEvent('on' + event, handler); } }; J.bspline = (function () { var d3_svg_lineBasisBezier1 = [0, 2 / 3, 1 / 3, 0], d3_svg_lineBasisBezier2 = [0, 1 / 3, 2 / 3, 0], d3_svg_lineBasisBezier3 = [0, 1 / 6, 2 / 3, 1 / 6]; function d3_svg_lineLinear(points) { return points.join("L"); }; function d3_svg_lineDot4(a, b) { return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3]; }; function d3_svg_lineBasisBezier(path, x, y) { path.push("C", d3_svg_lineDot4(d3_svg_lineBasisBezier1, x), ",", d3_svg_lineDot4(d3_svg_lineBasisBezier1, y), ",", d3_svg_lineDot4(d3_svg_lineBasisBezier2, x), ",", d3_svg_lineDot4(d3_svg_lineBasisBezier2, y), ",", d3_svg_lineDot4(d3_svg_lineBasisBezier3, x), ",", d3_svg_lineDot4(d3_svg_lineBasisBezier3, y)); }; function d3_svg_lineBasis(points) { if (points.length < 3) { return d3_svg_lineLinear(points); } var i = 1, n = points.length, pi = points[0], x0 = pi[0], y0 = pi[1], px = [x0, x0, x0, (pi = points[1])[0]], py = [y0, y0, y0, pi[1]], path = [x0, ",", y0, "L", d3_svg_lineDot4(d3_svg_lineBasisBezier3, px), ",", d3_svg_lineDot4(d3_svg_lineBasisBezier3, py)]; points.push(points[n - 1]); while (++i <= n) { pi = points[i]; px.shift(); px.push(pi[0]); py.shift(); py.push(pi[1]); d3_svg_lineBasisBezier(path, px, py); } points.pop(); path.push("L", pi); return path.join(""); }; return function (ag) { var aFJ = J.map(ag, function (bL) { return [bL.x, bL.y]; }); return d3_svg_lineBasis(aFJ); }; })(); J.aJQ = function (cI) { if (cI.match(/[^a-zA-Z0-9\s\,\.]/)) { throw new Error('The path data attribute is not valid. It cannot be parsed.'); } var aBj = J.filter(cI.replace(/[Mm]/g, '|').split('|'), function (g) { return ! !g.length; }); var aGN = J.map(aBj, function (el) { var aDY = el.replace(/[a-zA-Z]/g, '|').split('|'); return J.map(aDY, function (ee) { var agI = ee.split(','); return { x: +agI[0], y: +agI[1] }; }); }); return aGN; }; J.aeA = function (cI, kp, kL, kT, aH) { aH.cd = "12px"; var iI = J.wZ(cI, kp, aH), pH = 12 * kL / (iI.width || 1), pK = 12 * kT / (iI.height || 1), aHH = Math.min(pH, pK); aH.cd = aHH; return J.aeF(cI, kp, kL, kT, aH); }; J.aeF = function (cI, kp, kL, kT, aH, Om) { Om = Om || 1; var js = {}, iI = J.wZ(cI, kp, aH), cd = aH.cd; js.width = iI.width; js.height = iI.height; js.fontSize = cd; if (Om > 3) { return js; } if ((iI.width < kL + 1) && (iI.height < kT + 1)) { return js; } else { var pH = cd * kL / (iI.width || 1), pK = cd * kT / (iI.height || 1), Cn = Math.min(pH, pK); if (Cn >= aH.cd) { return js; } else { aH.cd = Cn; return J.aeF(cI, kp, kL, kT, aH, Om + 1); } } }; J.wZ = function (cI, kp, aH) { aH = aH || {}; if (document.createElementNS) { return J.azi(cI, kp, aH); } else { return J.aeY(cI, kp, aH); } }; J.azi = function (cI, kp, aH) { var svg, ahQ = false; if (aH.gC) { svg = aH.gC; } else { svg = document.createElementNS("http://www.w3.org/2000/svg", "svg"); svg.setAttribute('style', 'border: 1px solid black'); svg.setAttribute('width', '600'); svg.setAttribute('height', '600'); ahQ = true; document.body.appendChild(svg); } var cd = aH.cd || "12px"; if (typeof cd === "number") { cd = cd + "px"; } var da = document.createElementNS("http://www.w3.org/2000/svg", "text"); J.forEach({ x: 0, y: 0, 'font-size': cd, 'stroke': "none", 'fill': "#000000", 'font-family': kp }, function (value, name) { da.setAttribute(name, value); }); if (aH.wJ) { da.setAttribute('style', 'white-space:' + aH.wJ); } var oZ = document.createTextNode(cI); da.appendChild(oZ); svg.appendChild(da); var xJ = da.getBBox(), Ip = xJ.width, Ky = xJ.height; svg.removeChild(da); if (ahQ) { document.body.removeChild(svg); } if (Ip === 0 && Ky === 0 && cI !== "M") { return J.wZ("M", kp, aH); } else { return { width: Ip, height: Ky }; } }; J.aeY = function (cI, kp, aH) { var oZ = document.createTextNode(cI), Dn = document.createElement('div'); var cd = aH.cd || "12px"; if (typeof cd === "number") { cd = cd + "px"; } J.forEach({ position: 'absolute', display: 'inline-block', top: 0, left: 0, visibility: 'hidden', fontSize: cd, fontFamily: kp }, function (value, name) { Dn.style[name] = value; }); if (aH.wJ) { Dn.style.whiteSpace = aH.wJ; } Dn.appendChild(oZ); document.body.appendChild(Dn); var xJ = Dn.getBoundingClientRect(), Ip = xJ.width || xJ.right - xJ.left, Ky = xJ.height || xJ.bottom - xJ.top; document.body.removeChild(Dn); if (Ip === 0 && Ky === 0 && cI !== "M") { return J.aeY("M", kp, cd); } else { return { width: Ip, height: Ky }; } }; J.aay = function (svgPath) { var regexp = /[\s,]*(M)[\s,]*([\d\.]+)[\s,]+([\d\.]+)|[\s,]*(C)[\s,]?([\d\.]+)[\s,]+([\d\.]+)[\s,]+([\d\.]+)[\s,]+([\d\.]+)[\s,]+([\d\.]+)[\s,]+([\d\.]+)|[\s,]*(L)[\s,]*([\d\.]+)[\s,]+([\d\.]+)/g; var match = regexp.exec(svgPath); var xArr = [], yArr = []; function updateBounds(x, y) { xArr.push(Number(x)); yArr.push(Number(y)); }; while (match !== null) { if (match[1]) { updateBounds(match[2], match[3]); } else if (match[4]) { updateBounds(match[5], match[6]); updateBounds(match[7], match[8]); updateBounds(match[9], match[10]); } else if (match[11]) { updateBounds(match[12], match[13]); } match = regexp.exec(svgPath); } return { width: Math.max.apply(Math, xArr), height: Math.max.apply(Math, yArr) }; }; J.yg = (J.asO) ? { SVG: function SVG(VK) { var gC = document.createElementNS("http://www.w3.org/2000/svg", "svg"); gC.setAttribute('viewBox', VK); return gC; }, Path: function Path(sq, fQ) { var cj = document.createElementNS("http://www.w3.org/2000/svg", "path"); cj.style.fill = 'none'; cj.style.stroke = fQ.color || '#000000'; cj.style.strokeWidth = fQ.thickness || 4; if (sq) { cj.setAttribute('d', sq.toString().trim()); } return cj; }, Rect: function Rect(ax, cR, bH) { var ai = document.createElementNS("http://www.w3.org/2000/svg", "rect"); ai.setAttribute('width', ax || 0); ai.setAttribute('height', cR || 0); if (bH) { ai.setAttribute('style', bH); } return ai; } } : { SVG: function (VK, Py) { var aS = document.createElement("div"); aS.style.left = "0px"; aS.style.top = "0px"; aS.style.position = "relative"; aS.baseInit = false; aS.baseX = 0; aS.baseY = 0; var avj = aS.setAttribute; aS.setAttribute = function (aq, F) { if (aq === "width") { this.style.width = F * (+Py || 1); } else if (aq === "height") { this.style.height = F * (+Py || 1); } else if (aq === "x") { this.style.left = F; } else if (aq === "y") { this.style.top = F; } else if (aq === "viewBox") { var sG = F.split(" "); this.style.height = +sG.pop() * (+Py || 1) + 'px'; this.style.width = +sG.pop() * (+Py || 1) + 'px'; } else { avj(aq, F); } }; aS.setAttribute('viewBox', VK); aS.setAttribute('data-pcc-mark', 'signature'); return aS; }, Path: function (sq, fQ) { var aS = document.createElement("v:shape"); aS.style.width = fQ.width * (+fQ.multiplier || 1); aS.style.height = fQ.height * (+fQ.multiplier || 1); aS.coordsize = [fQ.width, fQ.height].join(', '); aS.style.position = "absolute"; aS.setAttribute = function (aq, F) { if (aq === "d") { var Ie = 0; var HX = 0; F = F.replace(/(\d*)((\.*\d*)(e ?-?\d*))/g, "$1"); var Oq = F.match(/([MLHVCSQTAZ].*?)(?=[MLHVCSQTAZ]|$)/gi); var apl = "", gA = []; for (var i = 0; i < Oq.length; i++) { var ee = Oq[i].substring(0, 1); var oC = Oq[i].substring(1, Oq[i].length); oC = oC.split(/[, ]/); for (var j = 0; j < oC.length; j++) { oC[j] = Math.round(oC[j]); } oC = oC.join(); switch (ee) { case "M": ee = "m"; gA = oC.split(/[, ]/); Ie = parseInt(gA[0], 10); HX = parseInt(gA[1], 10); break; case "m": ee = "t"; gA = oC.split(/[, ]/); gA[0] = parseInt(gA[0], 10) + parseInt(Ie, 10); gA[1] = parseInt(gA[1], 10) + parseInt(HX, 10); Ie = parseInt(gA[0], 10); HX = parseInt(gA[1], 10); break; case "A": ee = "ae"; var dm = oC.split(/[, ]+/); dm[0] = parseInt(dm[0], 10); dm[1] = parseInt(dm[1], 10); dm[2] = parseInt(dm[2], 10); dm[3] = parseInt(dm[3], 10); dm[4] = parseInt(dm[4], 10); dm[5] = parseInt(dm[5], 10); oC = dm[4] + " " + dm[5] + " " + dm[2] * 2 + " " + dm[3] * 2 + " 0 360"; break; case "L": ee = "l"; gA = oC.split(/[, ]+/); Ie = parseInt(gA[0], 10); HX = parseInt(gA[1], 10); break; case "l": ee = "r"; gA = oC.split(/[, ]+/); gA[0] = parseInt(gA[0], 10) + parseInt(Ie, 10); gA[1] = parseInt(gA[1], 10) + parseInt(HX, 10); Ie = parseInt(gA[0], 10); HX = parseInt(gA[1], 10); break; case "c": ee = "v"; break; case "z": ee = "xe"; oC = ""; break; default: ee = ee.toLowerCase(); } apl += ee + oC; } this.path = apl; return; } else if (aq === "stroke") { this.stroked = (F === "none" ? 0 : 1); this.strokecolor = F; return; } else if (aq === "stroke-width") { this.strokeweight = parseFloat(F) / 1.2 + "pt"; return; } else if (aq === "fill") { this.filled = (F === "none" ? 0 : 1); this.fillcolor = F; return; } }; if (sq) { aS.setAttribute('d', sq); } aS.setAttribute('stroke-width', fQ.thickness || 4); aS.setAttribute('stroke', fQ.color || '#000000'); aS.filled = 0; aS.fillcolor = 'none'; return aS; }, Rect: function (ax, cR) { var aS = document.createElement("v:roundrect"); aS.rxy = 0; aS.svg2vmlStyle = { fill: { value: "#000000", valueSource: "default" }, stroke: { value: "none", valueSource: "default" }, "stroke-width": { value: "1", valueSource: "default" } }; aS.setAttribute = function (aq, F, aza) { if (this.svg2vmlStyle[aq]) { this.svg2vmlStyle[aq]["value"] = F; this.svg2vmlStyle[aq]["valueSource"] = (aza || "user"); } if (aq === "x") { this.style.left = parseInt(F, 10) + 'px'; return; } else if (aq === "y") { this.style.top = parseInt(F, 10) + 'px'; return; } else if (aq === "stroke") { this.stroked = (F === "none" ? 0 : 1); this.strokecolor = F; return; } else if (aq === "stroke-width") { this.strokeweight = parseFloat(F) / 1.2 + "pt"; return; } else if (aq === "fill") { this.filled = (F === "none" ? 0 : 1); this.fillcolor = F; return; } else if (aq === "width" || aq === "height" || aq === "rx" || aq === "ry") { if (aq === "width") { this.style.width = parseInt(F, 10) + 'px'; } else if (aq === "height") { this.style.height = parseInt(F, 10) + 'px'; } else if (aq === "rx" || aq === "ry") { if (parseInt(F, 10)) { this.rxy = parseInt(F, 10); } } if (this.rxy !== 0) { var Js = parseInt(this.style.width, 10); var SJ = parseInt(this.style.height, 10); if (!Js) { Js = 0; } if (!SJ) { SJ = 0; } if (SJ < Js) { Js = SJ; } var Sy = this.rxy / Js; this.arcsize = Sy; } else { this.arcsize = 0; } return; } }; if (ax) { aS.setAttribute('width', ax); } if (cR) { aS.setAttribute('height', cR); } for (var aq in aS.svg2vmlStyle) { if ((aS.svg2vmlStyle[aq]["value"]) && (aS.svg2vmlStyle[aq]["valueSource"] === "default")) { aS.setAttribute(aq, aS.svg2vmlStyle[aq]["value"], "default"); } } return aS; } }; J.Lp = function Lp(jt) { var regexIso8601 = /^(\d{4}|\+\d{6})(?:-(\d{2})(?:-(\d{2})(?:T(\d{2}):(\d{2}):(\d{2})\.(\d{1,3})(?:Z|([\-+])(\d{2}):(\d{2}))?)?)?)?$/; var m = regexIso8601.exec(jt); if (m) { return Date.UTC(m[1], (m[2] || 1) - 1, m[3] || 1, m[4] - (m[8] ? m[8] + m[9] : 0) || 0, m[5] - (m[8] ? m[8] + m[10] : 0) || 0, m[6] || 0, ((m[7] || 0) + '00').substr(0, 3)); } else { return new Error(jt + ' cannot be parsed as an ISO 8601 date.'); } }; J.zO = function aKB(gb) { if (gb.toISOString && typeof gb.toISOString === 'function') { return gb.toISOString(); } else if (gb instanceof Date) { var pad = function pad(number) { if (number < 10) { return '0' + number; } return number; }; return gb.getUTCFullYear() + '-' + pad(gb.getUTCMonth() + 1) + '-' + pad(gb.getUTCDate()) + 'T' + pad(gb.getUTCHours()) + ':' + pad(gb.getUTCMinutes()) + ':' + pad(gb.getUTCSeconds()) + '.' + (gb.getUTCMilliseconds() / 1000).toFixed(3).slice(2, 5) + 'Z'; } else { return new Error(gb + ' is not a Date object.'); } }; J.yP = function yP(o) { return (!o ? false : typeof Node === "object" ? o instanceof Node : o && typeof o === "object" && typeof o.nodeType === "number" && typeof o.nodeName === "string"); }; J.Sh = function Sh(o) { if (J.yP(o)) { while (o.firstChild) { o.removeChild(o.firstChild); } } }; J.YY = function sync(funcs, done) { var counter = funcs.length; var idx = 0; var next = function (err) { if (err) { done(err); } else if (--counter === 0) { done(); } else { funcs[idx++](next); } }; funcs[idx++](next); }; J.afo = function (bj) { bj = String(bj).replace(/[^0-9a-f]/gi, ""); if (bj.length < 6) { bj = bj[0] + bj[0] + bj[1] + bj[1] + bj[2] + bj[2]; } var UW = function (cI) { return parseInt(cI, 16); }; var r = UW(bj.substring(0, 2)); var g = UW(bj.substring(2, 4)); var b = UW(bj.substring(4, 6)); return { r: r, g: g, b: b }; }; J.aDo = function (bj) { var Rn = ""; var NS = function (n) { while (n.length < 2) { n = '0' + n; } return n; }; var UE = function (n) { return NS(n.toString(16)); }; Rn += UE(Math.floor(bj.r)); Rn += UE(Math.floor(bj.g)); Rn += UE(Math.floor(bj.b)); return '#' + Rn; }; J.aEV = function (atI, aBi, auj) { var Hq = auj, _E = J.afo(atI), re = J.afo(aBi); re.r = (1 - Hq) * re.r + (_E.r * Hq); re.g = (1 - Hq) * re.g + (_E.g * Hq); re.b = (1 - Hq) * re.b + (_E.b * Hq); re.r = Math.floor(re.r); re.g = Math.floor(re.g); re.b = Math.floor(re.b); return J.aDo(re); }; J.alM = function (aBw, yb) { var avT = J.reduceLeft(aBw, function (eb, dU) { if (dU.opacity === undefined) { dU.opacity = 127; } var axm = dU.opacity / 255; return J.aEV(dU.color, eb, axm); }, yb); return avT; }; J.akE = function (hF) { if (hF.length === 0) { return hF; } var eh = hF.slice(0); eh.sort(function (a, b) { return a.startIndex - b.startIndex; }); var WT = null; var md = []; var aaP = 0, QH = []; var G = eh[0].startIndex; while (eh.length > 0) { aaP = 0; QH = null; QH = []; var aj = 0; while (aj < eh.length && eh[aj].startIndex <= G) { if (G <= eh[aj].startIndex + eh[aj].length - 1) { aaP++; QH.push(eh[aj]); aj++; } else { eh.splice(aj, 1); } } if (aaP > 0) { var DV = J.alM(QH, '#ffffff'); if (DV === WT) { md[md.length - 1].endIndex = G; } else { md.push({ startIndex: G, endIndex: G, color: DV }); } WT = DV; G++; } else { if (eh.length > 0) { G = eh[0].startIndex; } WT = null; } } return md; }; J.LM = function (Vl) { return Vl.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;"); }; J.NS = function (hL, cz) { var cI = "" + hL; while (cI.length < cz) { cI = '0' + cI; } return cI; }; J.aKh = function (eY) { var gL = eY.getTimezoneOffset(); gL = ((gL < 0 ? '+' : '-') + J.NS(parseInt(Math.abs(gL / 60), 10), 2) + J.NS(Math.abs(gL % 60), 2)); return gL; }; J.ajm = ['Sun', 'Mon', 'Tue', 'Wed', 'Thurs', 'Fri', 'Sat']; J.adN = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"]; J.ams = function (acn) { var aCH = /^\s*\w+\s+(\w+)\s+(\d+)\s+(\d+):(\d+):(\d+)\s+GMT[+-]?\d+\s+(\d+)\s*$/i, bM = aCH.exec(acn), aoh, HU, ajd, aet, anX, yE, IU; if (!bM) { return null; } else { aoh = bM[1].toLowerCase(); ajd = bM[2]; aet = bM[3]; anX = bM[4]; yE = bM[5]; IU = bM[6]; for (HU = 0; HU < 12; HU++) { if (J.adN[HU].toLowerCase() === aoh) { break; } } if (HU >= 12) { return null; } return new Date(Date.UTC(IU, HU, ajd, aet, anX, yE)); } }; J.aew = function (eY) { return (J.ajm[eY.getUTCDay()] + " " + J.adN[eY.getUTCMonth()] + " " + eY.getUTCDate() + " " + eY.getUTCHours() + ':' + eY.getUTCMinutes() + ':' + eY.getUTCSeconds() + " " + "GMT+0000 " + eY.getUTCFullYear()); }; J.aGK = function (eY) { return (J.ajm[eY.getUTCDay()] + " " + J.adN[eY.getUTCMonth()] + " " + eY.getUTCDate() + " " + eY.getUTCFullYear()); }; J.aGX = function (eY) { return (eY.getUTCHours() + ':' + eY.getUTCMinutes() + ':' + eY.getUTCSeconds() + " " + "GMT+0000"); }; J.rm = function (text) { return text.replace(/[&<>\"\']/g, function (char) { switch (char) { case "&": return "&amp;"; case "<": return "&lt;"; case ">": return "&gt;"; case "\"": return "&quot;"; case "'": return "&apos;"; default: throw new Error("Did not find a replacement character."); } }); }; J.AR = function (text) { return text.replace(/&amp;/g, '&').replace(/&gt;/g, '>').replace(/&lt;/g, '<').replace(/&quot;/g, '"').replace(/&apos;/g, '\''); }; J.aqI = (function (chars) { chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='; function InvalidCharacterError(message) { this.message = message; }; InvalidCharacterError.prototype = new Error; InvalidCharacterError.prototype.name = 'InvalidCharacterError'; function btoa(input) { var str = String(input); for (var block, charCode, idx = 0, map = chars, output = ''; str.charAt(idx | 0) || (map = '=', idx % 1) ; output += map.charAt(63 & block >> 8 - idx % 1 * 8)) { charCode = str.charCodeAt(idx += 3 / 4); if (charCode > 0xFF) { throw new InvalidCharacterError("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range."); } block = block << 8 | charCode; } return output; }; function atob(input) { var str = String(input).replace(/=+$/, ''); if (str.length % 4 == 1) { throw new InvalidCharacterError("'atob' failed: The string to be decoded is not correctly encoded."); } for (var bc = 0, bs, buffer, idx = 0, output = ''; buffer = str.charAt(idx++) ; ~buffer && (bs = bc % 4 ? bs * 64 + buffer : buffer, bc++ % 4) ? output += String.fromCharCode(255 & bs >> (-2 * bc & 6)) : 0) { buffer = chars.indexOf(buffer); } return output; }; return { btoa: btoa, atob: atob }; })(); J.pn = (function () { var pn = ['down', 'enter', 'leave', 'move', 'out', 'over', 'up']; if (window.navigator.pointerEnabled) { var ajY = {}; pn.forEach(function (akd) { ajY[akd] = 'pointer' + akd; }); return ajY; } if (window.navigator.msPointerEnabled) { var apU = {}; for (var G = 0; G < pn.length; G++) { var ZL = pn[G]; var avQ = 'MSPointer' + ZL.charAt(0).toUpperCase() + ZL.slice(1); apU[ZL] = avQ; } return apU; } return {}; })(); J.LK = (function () { return { SY: ! !navigator.userAgent.match('Edge'), aIF: document.documentMode !== undefined, aIt: document.documentMode === 8, aIq: document.documentMode === 9, aHo: document.documentMode === 10, aHu: document.documentMode === 11, aAS: (navigator.userAgent.match(/iPad/i) || navigator.userAgent.match(/iPhone/i)) }; })(); J.NQ = (function (qN) { if (!qN || !IPCC.J.trim(qN)) { return 'regular'; } return IPCC.J.trim(qN).toLowerCase(); }); J.aKo = function (arg, value) { return typeof arg !== 'undefined' ? arg : value; }; J.MA = function (value) { return Number(value.replace(/[a-z]+$/, '')); }; J.PF = function (elem, propertyName) { if (elem.currentStyle) { return elem.currentStyle[propertyName]; } else { return window.getComputedStyle(elem, null).getPropertyValue(propertyName); } }; J.ady = function () { if (this.sK === undefined) { this.sK = document.createTextNode(''); } return this.sK; }; J.aeU = function () { if (this.dA === undefined) { this.dA = document.createElement('textarea'); this.sK = document.createTextNode(''); this.dA.appendChild(J.sK); this.dA.style.position = 'absolute'; this.dA.style.overflow = 'hidden'; this.dA.style.width = '80px'; this.dA.style.height = '80px'; this.dA.style.resize = 'none'; this.dA.style.top = '-9999px'; this.dA.style.left = '-9999px'; this.dA.style.whiteSpace = 'pre-wrap'; this.dA.style.border = 0; this.dA.style.padding = '2px'; document.body.appendChild(this.dA); } return this.dA; }; J.abt = function (dA, Fl, by) { var aak = 0.1; var Oe; if (Fl === 0 || Fl > by) { Fl = by; } while (aak <= Fl) { Oe = (aak + Fl) / 2; dA.style.fontSize = Oe + 'px'; if (dA.scrollHeight <= dA.offsetHeight) { aak = Oe + 0.1; } else { Fl = Oe - 0.1; } } var akN = (Oe - 0.5) * 0.95; dA.style.fontSize = akN + 'px'; return akN; }; vq.J = J; })(IPCC || {}); IPCC.Type.registerNamespace('IPCC.Web.UI'); IPCC.Web.UI.MarkType = function () { }; IPCC.Web.UI.MarkType.registerEnum = IPCC.Web.regEnum; IPCC.Web.UI.MarkType.prototype = { Line: 3, Polyline: 502, Rectangle: 600, Ellipse: 601, Polygon: 604, Text: 605, Highlight: 606, Stamp: 607, HighlightText: 608, SignaturePath: 609, Freehand: 610, SignatureText: 611, SignatureImage: 612, RectangleRedaction: 613, TextSelectionRedaction: 614, ImageStampAnnotation: 615, ImageStampRedaction: 616, TextHyperlinkAnnotation: 617, DocumentHyperlink: 618, TextLine: 619, Strikethrough: 620, TextAreaSignature: 621 }; IPCC.Web.UI.MarkType.registerEnum('IPCC.Web.UI.MarkType', false); IPCC.Web.UI.HighLightType = function () { }; IPCC.Web.UI.HighLightType.registerEnum = IPCC.Web.regEnum; IPCC.Web.UI.HighLightType.prototype = { Tag: 0, InlineHighLight: 1, Link: 2, Redaction: 3, Strikethrough: 4 }; IPCC.Web.UI.HighLightType.registerEnum('IPCC.Web.UI.HighLight', false); IPCC.Web.UI.MarkInteractionMode = function () { }; IPCC.Web.UI.MarkInteractionMode.registerEnum = IPCC.Web.regEnum; IPCC.Web.UI.MarkInteractionMode.prototype = { Full: 0, SelectionDisabled: 1 }; IPCC.Web.UI.MarkInteractionMode.registerEnum('IPCC.Web.UI.MarkInteractionMode', false); IPCC.Web.UI.LineStyle = function () { }; IPCC.Web.UI.LineStyle.registerEnum = IPCC.Web.regEnum; IPCC.Web.UI.LineStyle.prototype = { Solid: 0, Dash: 1, Dot: 2, DashDot: 3, DashDotDot: 4 }; IPCC.Web.UI.LineStyle.registerEnum('IPCC.Web.UI.LineStyle', false); IPCC.Web.UI.LineHeadType = function () { }; IPCC.Web.UI.LineHeadType.registerEnum = IPCC.Web.regEnum; IPCC.Web.UI.LineHeadType.prototype = { Pointer: 0, Solid: 1, Open: 2, PointerSolid: 3, None: 4 }; IPCC.Web.UI.LineHeadType.registerEnum('IPCC.Web.UI.LineHeadType', false); IPCC.Web.UI.CalloutType = function () { }; IPCC.Web.UI.CalloutType.registerEnum = IPCC.Web.regEnum; IPCC.Web.UI.CalloutType.prototype = { Line: 0, Triangle: 1 }; IPCC.Web.UI.CalloutType.registerEnum('IPCC.Web.UI.CalloutType', false); IPCC.Web.UI.FontStyle = function () { }; IPCC.Web.UI.FontStyle.registerEnum = IPCC.Web.regEnum; IPCC.Web.UI.FontStyle.prototype = { Regular: 0, Bold: 1, Italic: 2, Underline: 4, Strikeout: 8 }; IPCC.Web.UI.FontStyle.registerEnum('IPCC.Web.UI.FontStyle', true); IPCC.Web.UI.HorizontalAlignment = function () { }; IPCC.Web.UI.HorizontalAlignment.registerEnum = IPCC.Web.regEnum; IPCC.Web.UI.HorizontalAlignment.prototype = { Left: 0, Center: 16, Right: 32 }; IPCC.Web.UI.HorizontalAlignment.registerEnum('IPCC.Web.UI.HorizontalAlignment', false); IPCC.Web.UI.VerticalAlignment = function () { }; IPCC.Web.UI.VerticalAlignment.registerEnum = IPCC.Web.regEnum; IPCC.Web.UI.VerticalAlignment.prototype = { Top: 0, Center: 1, Bottom: 2 }; IPCC.Web.UI.VerticalAlignment.registerEnum('IPCC.Web.UI.VerticalAlignment', false); IPCC.Web.UI.Orientation = function () { }; IPCC.Web.UI.Orientation.registerEnum = IPCC.Web.regEnum; IPCC.Web.UI.Orientation.prototype = { TopLeft: 1, TopRight: 2, BottomRight: 3, BottomLeft: 4, LeftTop: 5, RightTop: 6, RightBottom: 7, LeftBottom: 8 }; IPCC.Web.UI.Orientation.registerEnum('IPCC.Web.UI.Orientation', false); IPCC.Web.UI.MarkEventArgs = function () { return this; }; IPCC.Web.UI.MarkEventArgs.registerClass = IPCC.Web.regClass; IPCC.Web.UI.MarkEventArgs.prototype = {}; IPCC.Web.UI.MarkEventArgs.registerClass('IPCC.Web.UI.MarkEventArgs'); IPCC.Web.UI.MarkCollection = function () { var bN = []; var bC = new IPCC.Web.UI.fR(); this.MG = function (R) { if (this.Ln(R) === -1) { bN.push(R); var L = new IPCC.Web.UI.MarkEventArgs(); L.mark = R; this.aM('markAdded', L); } }; this.apN = function (Bi) { var L = new IPCC.Web.UI.MarkEventArgs(); L.length = Bi.get_length(); var K = this; function nD(R) { if (K.Ln(R) === -1) { bN.push(R); } }; Bi.forEach(nD, {}); if (L.length > 0) { this.aM('markAdded', L); } }; this.mR = function (kg, ca) { var MW = [].concat(bN); var G; for (G = 0; G < MW.length; G++) { kg.call(ca, MW[G], G, this); } }; this.fb = function () { return bN.length; }; this.vA = function (R) { var G = this.Ln(R); if (G > -1) { bN.splice(G, 1); var L = new IPCC.Web.UI.MarkEventArgs(); L.mark = R; this.aM('markRemoved', L); } }; this.Ln = function (R) { var G; for (G = 0; G < bN.length; G++) { if (bN[G] === R) { return G; } } return -1; }; this.yd = function (V) { bC.addHandler('markAdded', V); }; this.zu = function (V) { bC.removeHandler('markAdded', V); }; this.yp = function (V) { bC.addHandler('markRemoved', V); }; this.zp = function (V) { bC.removeHandler('markRemoved', V); }; this.aM = function (cA, L) { var V = bC.getHandler(cA); if (V !== null) { V(this, L); } }; return this; }; IPCC.Web.UI.MarkCollection.prototype = { toString: function () { return 'MarkCollection with ' + this.get_length() + ' marks'; }, addMark: function (mark) { this.MG(mark); }, addMarks: function (markCollection) { this.apN(markCollection); }, forEach: function (method, context) { this.mR(method, context); }, get_length: function () { return this.fb(); }, contains: function (mark) { return this.Ln(mark) > -1; }, removeMark: function (mark) { this.vA(mark); }, removeAllMarks: function () { this.mR(function (R, ak, Bi) { Bi.vA(R); }); }, add_markAdded: function (handler) { this.yd(handler); }, remove_markAdded: function (handler) { this.zu(handler); }, add_markRemoved: function (handler) { this.yp(handler); }, remove_markRemoved: function (handler) { this.zp(handler); } }; IPCC.Web.UI.MarkCollection.registerClass = IPCC.Web.regClass; IPCC.Web.UI.MarkCollection.registerClass('IPCC.Web.UI.MarkCollection'); IPCC.Web.UI.arU = 1; IPCC.Web.UI.Mark = function (type) { var aa = type; type = undefined; var tL = new Date(); var uh = new Date(); var aX = null; var h; var ag; var df; var dc = new IPCC.Web.UI.Data(); var bC = new IPCC.Web.UI.fR(); var K = this; var lb; this.eH = function (kK, cr) { if ((lb & kK) === 0) { throw new IPCC.Web.UI.ImGearInvalidOperationException(cr + ' is not a valid property for this type of Mark.'); } }; if (aa === IPCC.Web.UI.MarkType.SignatureText) { this.gX = '#000000'; this.ii = IPCC.Web.UI.LineStyle.Solid; this.dQ = 0; } else { this.gX = '#000000'; this.ii = IPCC.Web.UI.LineStyle.Solid; this.dQ = 1; } this.dI = 255; this.qi = IPCC.Web.UI.MarkInteractionMode.Full; var iq = false; switch (aa) { case IPCC.Web.UI.MarkType.Line: iq = true; ag = new IPCC.Web.UI.PointCollection(); ag.addPoint({ x: 0, y: 0 }); ag.addPoint({ x: 0, y: 0 }); lb = 1; this.gX = '#18385F'; this.dQ = 6; break; case IPCC.Web.UI.MarkType.Polyline: iq = true; this.na = false; ag = new IPCC.Web.UI.PointCollection(); lb = 2; this.dQ = 2; break; case IPCC.Web.UI.MarkType.Rectangle: h = new IPCC.Web.UI.Rectangle(0, 0, 0, 0); lb = 4; this.cK = '#FB0404'; this.dQ = 4; break; case IPCC.Web.UI.MarkType.Ellipse: h = new IPCC.Web.UI.Rectangle(0, 0, 0, 0); lb = 8; this.cK = '#FB0404'; this.dQ = 4; break; case IPCC.Web.UI.MarkType.Polygon: ag = new IPCC.Web.UI.PointCollection(); lb = 16; break; case IPCC.Web.UI.MarkType.Text: this.Bo = '#000000'; this.At = false; this.rR = IPCC.Web.UI.LineStyle.Solid; this.CA = 1; this.pj = new IPCC.Web.UI.Point(0, 0); this.GC = IPCC.Web.UI.CalloutType.Triangle; this.zg = false; this.gZ = 'Arial'; this.cd = 12; this.de = IPCC.Web.UI.FontStyle.Regular; this.ii = IPCC.Web.UI.LineStyle.Solid; this.gU = 0; h = new IPCC.Web.UI.Rectangle(0, 0, 0, 0); this.az = ''; this.kh = IPCC.Web.UI.HorizontalAlignment.Left; this.AM = IPCC.Web.UI.VerticalAlignment.Top; this.od = '#000000'; this.rE = 255; this.wC = IPCC.Web.UI.Orientation.TopLeft; this.eh = []; this.dQ = 4; this.dI = 127; this.cK = '#FFFFFF'; lb = 32; break; case IPCC.Web.UI.MarkType.Stamp: h = new IPCC.Web.UI.Rectangle(0, 0, 0, 0); lb = 128; break; case IPCC.Web.UI.MarkType.Highlight: h = new IPCC.Web.UI.Rectangle(0, 0, 0, 0); this.cE = ''; this.kz = 'n'; this.bh = 0; this.cl = ''; this.cg = 0; this.dI = 127; lb = 256; break; case IPCC.Web.UI.MarkType.HighlightText: h = new IPCC.Web.UI.Rectangle(0, 0, 0, 0); this.cE = ''; this.kz = 'n'; this.bh = 0; this.cl = ''; this.cg = 0; this.dI = 127; this.cK = '#FFFF00'; lb = 512; this.eh = []; this.bV = []; break; case IPCC.Web.UI.MarkType.Freehand: h = new IPCC.Web.UI.Rectangle(0, 0, 0, 0); lb = 64; this.dQ = 4; this.gX = '#000000'; this.hv = false; this.Wq = 1; this.Wn = 1; this.rs = 'M0,0'; break; case IPCC.Web.UI.MarkType.SignaturePath: h = new IPCC.Web.UI.Rectangle(0, 0, 0, 0); lb = 1024; this.kh = IPCC.Web.UI.HorizontalAlignment.Center; this.dQ = 4; this.gX = '#000000'; this.hv = false; this.Wq = 1; this.Wn = 1; this.rs = 'M0,0'; break; case IPCC.Web.UI.MarkType.SignatureText: h = new IPCC.Web.UI.Rectangle(0, 0, 0, 0); lb = 2048; this.kh = IPCC.Web.UI.HorizontalAlignment.Center; this.az = 'John Doe'; this.od = '#000000'; this.cK = '#000000'; this.gZ = ""; break; case IPCC.Web.UI.MarkType.RectangleRedaction: h = new IPCC.Web.UI.Rectangle(0, 0, 0, 0); lb = 4096; this.gZ = 'Arial'; this.cd = 8; this.de = IPCC.Web.UI.FontStyle.Regular; this.az = ''; this.kh = IPCC.Web.UI.HorizontalAlignment.Center; this.AM = IPCC.Web.UI.VerticalAlignment.Center; this.cK = '#000000'; this.od = '#FFFFFF'; this.rE = 255; this.wC = IPCC.Web.UI.Orientation.TopLeft; break; case IPCC.Web.UI.MarkType.TextSelectionRedaction: h = new IPCC.Web.UI.Rectangle(0, 0, 0, 0); this.bV = []; this.cE = ''; this.fr = ''; this.az = ''; this.gZ = 'Arial'; this.cd = 8; this.bh = 0; this.cg = 0; lb = 8192; this.eh = []; break; case IPCC.Web.UI.MarkType.TextHyperlinkAnnotation: h = new IPCC.Web.UI.Rectangle(0, 0, 0, 0); this.qY = ''; this.dQ = 2; this.cl = ''; this.cE = ''; this.kz = 'n'; this.bh = 0; this.cg = 0; this.cK = '#3B00FF'; lb = 1 << 14; this.eh = []; this.bV = []; break; case IPCC.Web.UI.MarkType.ImageStampAnnotation: case IPCC.Web.UI.MarkType.ImageStampRedaction: h = new IPCC.Web.UI.Rectangle(0, 0, 0, 0); lb = 16384; this.ap = ''; this.sc = ''; break; case IPCC.Web.UI.MarkType.DocumentHyperlink: h = new IPCC.Web.UI.Rectangle(0, 0, 0, 0); this.qY = ''; this.zy = ''; this.BK = ''; this.Ep = 0; this.Fd = 0; this.oQ = 255; lb = 32768; break; case IPCC.Web.UI.MarkType.TextLine: lb = 65536; h = new IPCC.Web.UI.Rectangle(0, 0, 0, 0); this.kh = IPCC.Web.UI.HorizontalAlignment.Left; this.az = ''; this.od = '#000000'; this.gZ = "Courier New"; this.dQ = 1; this.hv = true; this.gU = 0; this.DY = 0; this.Im = false; var iI = IPCC.J.wZ("M", this.gZ, { wJ: 'pre' }); this.xj = iI.width; this.yq = iI.height; this.iJ = null; break; case IPCC.Web.UI.MarkType.TextAreaSignature: this.Bo = '#000000'; this.At = false; this.rR = IPCC.Web.UI.LineStyle.Solid; this.CA = 1; this.pj = new IPCC.Web.UI.Point(0, 0); this.GC = IPCC.Web.UI.CalloutType.Triangle; this.zg = false; this.gZ = 'Courier New'; this.jA = 0; this.gU = 0; this.cd = 12; this.de = IPCC.Web.UI.FontStyle.Regular; h = new IPCC.Web.UI.Rectangle(0, 0, 0, 0); this.az = ''; this.kh = IPCC.Web.UI.HorizontalAlignment.Left; this.AM = IPCC.Web.UI.VerticalAlignment.Top; this.od = '#000000'; this.rE = 255; this.wC = IPCC.Web.UI.Orientation.TopLeft; this.eh = []; this.dQ = 1; this.hv = false; this.cK = '#FFFFFF'; this.dI = 0; lb = 1 << 18; break; case IPCC.Web.UI.MarkType.Strikethrough: h = new IPCC.Web.UI.Rectangle(0, 0, 0, 0); this.cE = ''; this.gX = '#000000'; this.dQ = 2; this.kz = 'n'; this.bh = 0; this.cl = ''; this.cg = 0; lb = 1 << 17; this.eh = []; this.bV = []; break; default: throw new IPCC.Web.UI.ImGearArgumentOutOfRangeException('type', aa); } if (aa !== IPCC.Web.UI.MarkType.SignaturePath && aa !== IPCC.Web.UI.MarkType.Freehand && aa !== IPCC.Web.UI.MarkType.SignatureText && aa !== IPCC.Web.UI.MarkType.DocumentHyperlink && aa !== IPCC.Web.UI.MarkType.HighlightText && aa !== IPCC.Web.UI.MarkType.Strikethrough && aa !== IPCC.Web.UI.MarkType.TextLine) { if (iq) { this.HC = 15; this.HT = 25; this.mW = IPCC.Web.UI.LineHeadType.None; this.wH = '#000000'; this.ED = 15; this.DP = 25; this.Dr = IPCC.Web.UI.LineHeadType.None; } else { this.zm = true; this.hv = true; if (aa === IPCC.Web.UI.MarkType.Highlight) { this.hv = false; this.dI = 100; } } } this.aaI = IPCC.Web.UI.arU++; this.ep = true; this.bu = {}; this.dO = []; var Nm = false; function ayE(aB, L) { K.aM('commentAdded', L); }; function axo(aB, L) { K.aM('commentRemoved', L); }; function PL(aB, L) { K.aM('commentChanged', L); }; df = new IPCC.Web.UI.Conversation(K); df.add_commentAdded(ayE); df.add_commentChanged(PL); df.add_commentRemoved(axo); this.aM = function (cA, L) { var V = bC.getHandler(cA); if (V !== null) { V(this, L); } }; function ZR(aB, L) { var amj = 'points'; if (aa === IPCC.Web.UI.MarkType.Line) { amj = L.index === 0 ? 'startPoint' : 'endPoint'; } K.aL(amj, L); }; if (ag) { ag.add_pointAdded(ZR); ag.add_pointChanged(ZR); ag.add_pointRemoved(ZR); } this.jd = function () { return aa; }; this.ahY = function () { return tL; }; this.afC = function (F) { tL = F; }; this.ahO = function () { return uh; }; this.ZH = function (F) { uh = F; }; this.eI = function () { return aX; }; this.kc = function (value) { if (aX !== value) { aX = value; this.aL('artPage'); } }; this.lh = function () { return Nm; }; this.mg = function (F) { Nm = F; }; this.akt = function () { var nV = new IPCC.Web.UI.Rectangle(0, 0, 0, 0); switch (aa) { case IPCC.Web.UI.MarkType.Line: case IPCC.Web.UI.MarkType.Polyline: case IPCC.Web.UI.MarkType.Polygon: return ag.wz(); case IPCC.Web.UI.MarkType.Rectangle: case IPCC.Web.UI.MarkType.RectangleRedaction: case IPCC.Web.UI.MarkType.Ellipse: case IPCC.Web.UI.MarkType.Stamp: case IPCC.Web.UI.MarkType.Highlight: case IPCC.Web.UI.MarkType.HighlightText: case IPCC.Web.UI.MarkType.TextSelectionRedaction: case IPCC.Web.UI.MarkType.TextHyperlinkAnnotation: case IPCC.Web.UI.MarkType.DocumentHyperlink: case IPCC.Web.UI.MarkType.SignaturePath: case IPCC.Web.UI.MarkType.SignatureText: case IPCC.Web.UI.MarkType.TextLine: case IPCC.Web.UI.MarkType.TextAreaSignature: case IPCC.Web.UI.MarkType.Freehand: case IPCC.Web.UI.MarkType.ImageStampAnnotation: case IPCC.Web.UI.MarkType.ImageStampRedaction: case IPCC.Web.UI.MarkType.Strikethrough: return h.clone(); case IPCC.Web.UI.MarkType.Text: var iG = h.x + h.width, jY = h.y + h.height; var aoE = h.x + this.pj.x, anV = h.y + this.pj.y; nV.x = Math.min(h.x, Math.min(iG, aoE)); nV.y = Math.min(h.y, Math.min(jY, anV)); nV.width = Math.max(h.x, Math.max(iG, aoE)) - nV.x; nV.height = Math.max(h.y, Math.max(jY, anV)) - nV.y; break; } return nV; }; this.fD = function () { return h.clone(); }; this.xB = function (F) { this.DU(16384, 'image', 'ap', F); }; this.cX = function () { return this.ap; }; this.pu = function () { return ag; }; this.asw = function () { return df; }; this.yF = function () { return dc; }; this.Gn = function (F) { var mv; if (!h.equals(F)) { h = new IPCC.Web.UI.Rectangle(F.x, F.y, F.width, F.height); if (aa === IPCC.Web.UI.MarkType.Stamp || aa === IPCC.Web.UI.MarkType.SignatureText || aa === IPCC.Web.UI.MarkType.TextLine) { if (document.documentMode < 9) { mv = 0; if (h.width >= h.height) { mv = (h.width / 14) / 2; } else { mv = h.width / 15; } if (mv * 15 >= h.width) { mv = (h.width / 15) / 2; } this.stampSize = Math.round(mv); } else { var textFontSize = (h.width / 6); if (textFontSize > h.height) { textFontSize = (h.height - (h.height / 6)); } var nM = this.get_text(); if (!nM) { nM = (aa === IPCC.Web.UI.MarkType.Stamp) ? 'APPROVED' : ''; } mv = nM.length * textFontSize; if (mv > h.width) { textFontSize = ((h.width / nM.length)); } var DY = Math.round(textFontSize); this.stampSize = DY.toString(); } } this.aL('rectangle'); } }; this.jf = function () { return this.aaI; }; this.HK = function (eW, fe) { if (eW !== 0 || fe !== 0) { switch (aa) { case IPCC.Web.UI.MarkType.Line: case IPCC.Web.UI.MarkType.Polyline: case IPCC.Web.UI.MarkType.Polygon: ag.amA(eW, fe); break; case IPCC.Web.UI.MarkType.Rectangle: case IPCC.Web.UI.MarkType.RectangleRedaction: case IPCC.Web.UI.MarkType.Ellipse: case IPCC.Web.UI.MarkType.Text: case IPCC.Web.UI.MarkType.Stamp: case IPCC.Web.UI.MarkType.SignaturePath: case IPCC.Web.UI.MarkType.SignatureText: case IPCC.Web.UI.MarkType.TextLine: case IPCC.Web.UI.MarkType.TextAreaSignature: case IPCC.Web.UI.MarkType.Freehand: case IPCC.Web.UI.MarkType.ImageStampAnnotation: case IPCC.Web.UI.MarkType.ImageStampRedaction: case IPCC.Web.UI.MarkType.Freehand: if (aa === IPCC.Web.UI.MarkType.RectangleRedaction && this.cE !== undefined) { break; } h.x += eW; h.y += fe; this.aL('rectangle'); break; case IPCC.Web.UI.MarkType.HighlightText: case IPCC.Web.UI.MarkType.Highlight: case IPCC.Web.UI.MarkType.TextSelectionRedaction: case IPCC.Web.UI.MarkType.TextHyperlinkAnnotation: case IPCC.Web.UI.MarkType.Strikethrough: break; } } }; this.ZA = function (Vw) { if (this.eh && Vw !== this.eh) { while (this.eh.length > 0) { this.eh.pop(); } if (Vw) { this.eh = Vw.slice(0); } this.aM('markTextSelectionChanged', {}); } }; this.JU = function (V) { if (this.eh) { bC.addHandler('markTextSelectionChanged', V); } }; this.Ig = function (V) { if (this.eh) { bC.removeHandler('markTextSelectionChanged', V); } }; this.xy = function (V) { bC.addHandler('commentAdded', V); }; this.FN = function (V) { bC.removeHandler('commentAdded', V); }; this.xP = function (V) { bC.addHandler('commentRemoved', V); }; this.DM = function (V) { bC.removeHandler('commentRemoved', V); }; this.vW = function (V) { bC.addHandler('commentChanged', V); }; this.vp = function (V) { bC.removeHandler('commentChanged', V); }; this.lg = function (V) { bC.addHandler('propertyChanged', V); }; this.nt = function (V) { bC.removeHandler('propertyChanged', V); }; this.aL = function (cr) { var V = bC.getHandler('propertyChanged'); if (V) { V(this, new IPCC.qP(cr)); } }; this.lg(function (R) { R.ZH(new Date()); }); return this; }; IPCC.Web.UI.Mark.prototype = { toString: function () { switch (this.get_type()) { case IPCC.Web.UI.MarkType.Line: return 'Line Mark from ' + this.pu().getPoint(0) + ' to ' + this.pu().getPoint(1); case IPCC.Web.UI.MarkType.Polyline: return 'Polyline Mark with ' + this.pu().fb() + ' vertices'; case IPCC.Web.UI.MarkType.Rectangle: return 'Rectangle Mark at ' + this.fD(); case IPCC.Web.UI.MarkType.RectangleRedaction: return 'Rectangle Redaction Mark at ' + this.fD(); case IPCC.Web.UI.MarkType.Ellipse: return 'Ellipse Mark at ' + this.fD(); case IPCC.Web.UI.MarkType.Polygon: return 'Polygon Mark with ' + this.pu().fb() + ' vertices'; case IPCC.Web.UI.MarkType.Text: return 'Text Mark, "' + this.az + '", at ' + this.fD(); case IPCC.Web.UI.MarkType.Stamp: return 'Stamp Mark at ' + this.fD(); case IPCC.Web.UI.MarkType.Highlight: return 'Rectangle Mark at ' + this.fD(); case IPCC.Web.UI.MarkType.HighlightText: return 'Highlight Mark at ' + this.fD(); case IPCC.Web.UI.MarkType.TextSelectionRedaction: return 'Text Selection Redaction at ' + this.fD(); case IPCC.Web.UI.MarkType.TextSelectionRedaction: return 'Text Hyperlink Annotation at ' + this.fD(); case IPCC.Web.UI.MarkType.TextSelectionRedaction: return 'Document Hyperlink at ' + this.fD(); case IPCC.Web.UI.MarkType.SignaturePath: return 'Signature Path Mark, "' + this.rs + '", at ' + this.fD(); case IPCC.Web.UI.MarkType.Freehand: return 'Freehand Mark, "' + this.rs + '", at ' + this.fD(); case IPCC.Web.UI.MarkType.SignatureText: return 'Signature Text Mark at ' + this.fD(); case IPCC.Web.UI.MarkType.TextLine: return 'Text Line Mark at ' + this.fD(); case IPCC.Web.UI.MarkType.TextAreaSignature: return 'Text Area Signature Mark at ' + this.fD(); case IPCC.Web.UI.MarkType.ImageStampAnnotation: return 'ImageStamp Mark at ' + this.fD(); case IPCC.Web.UI.MarkType.ImageStampRedaction: return 'ImageStamp Redaction Mark at ' + this.fD(); case IPCC.Web.UI.MarkType.Strikethrough: return 'Strikethrough Mark at ' + this.fD(); } return 'Mark'; }, initializeDates: function (tL, uh) { IPCC.ad.gb(tL, "dateCreated"); IPCC.ad.gb(uh, "dateModified"); this.afC(tL); this.ZH(uh); }, get_dateCreated: function () { return this.ahY(); }, get_dateModified: function () { return this.ahO(); }, nk: function (kK, cr, mi, F) { this.eH(kK, cr); if (this[mi] !== F) { this[mi] = F; this.aL(cr); } }, MP: function (kK, cr, mi, F) { IPCC.ad.abc(F, cr); this.nk(kK, cr, mi, F); }, AF: function (kK, cr, mi, F) { IPCC.ad.hL(F, cr); this.nk(kK, cr, mi, F); }, BY: function (kK, cr, mi, F, yC, AK) { IPCC.ad.mL(F, cr, yC, AK); this.nk(kK, cr, mi, F); }, YF: function (kK, cr, mi, F, yC, AK) { IPCC.ad.ps(F, cr, yC, AK); this.nk(kK, cr, mi, F); }, DU: function (kK, cr, mi, F) { IPCC.ad.aa(F, cr, 'string'); this.nk(kK, cr, mi, F); }, vL: function (kK, cr, mi, F, lm) { IPCC.ad.lm(F, cr, lm); this.nk(kK, cr, mi, F); }, aCU: function (kK, cr, mi, F, lm) { IPCC.ad.lm(F, cr, lm, true); this.nk(kK, cr, mi, F); }, aFV: function (kK, cr, mi, F) { IPCC.ad.be(F, cr); this.nk(kK, cr, mi, F); }, get_artPage: function () { return this.eI(); }, get_boundingRectangle: function () { return this.akt(); }, get_selected: function () { var aX = this.eI(); if (!aX) { return false; } var fE = aX.Bl(); return fE.contains(this); }, set_selected: function (value) { var aX = this.eI(); if (aX) { if (this.qi !== IPCC.Web.UI.MarkInteractionMode.SelectionDisabled || !value) { var fE = aX.Bl(); if (value !== fE.contains(this)) { if (value) { fE.MG(this); } else { fE.vA(this); } this.aL('selected'); } } } else { if (value) { throw new IPCC.Web.UI.ImGearInvalidOperationException('A Mark cannot be selected unless it is associated with an ArtPage.'); } } }, get_calloutLineColor: function () { this.eH(32, 'calloutLineColor'); return this.Bo; }, set_calloutLineColor: function (value) { this.MP(32, 'calloutLineColor', 'Bo', value); }, get_calloutLineIsDistinct: function () { this.eH(32, 'calloutLineIsDistinct'); return this.At; }, set_calloutLineIsDistinct: function (value) { this.nk(32, 'calloutLineIsDistinct', 'At', value); }, get_calloutLineStyle: function () { this.eH(32, 'calloutLineStyle'); return this.rR; }, set_calloutLineStyle: function (value) { this.vL(32, 'calloutLineStyle', 'rR', value, IPCC.Web.UI.LineStyle); }, get_calloutLineWidth: function () { this.eH(32, 'calloutLineWidth'); return this.CA; }, set_calloutLineWidth: function (value) { this.BY(32, 'calloutLineWidth', 'CA', value, 0, 50); }, get_calloutPoint: function () { this.eH(32, 'calloutPoint'); return this.pj; }, set_calloutPoint: function (value) { this.aFV(32, 'calloutPoint', 'pj', value); }, get_calloutType: function () { this.eH(32, 'calloutType'); return this.GC; }, set_calloutType: function (value) { this.vL(32, 'calloutType', 'GC', value, IPCC.Web.UI.CalloutType); }, get_calloutVisible: function () { this.eH(32, 'calloutVisible'); return this.zg; }, set_calloutVisible: function (value) { if (!this.zg && value && this.jd() === IPCC.Web.UI.MarkType.Text) { if (this.pj.x === 0 && this.pj.y === 0) { var h = this.fD(); this.set_calloutPoint({ x: h.width, y: h.height * 1.5 }); } } this.nk(32, 'calloutVisible', 'zg', value); }, get_endHeadAngle: function () { this.eH(3, 'endHeadAngle'); return this.HC; }, set_endHeadAngle: function (value) { this.BY(3, 'endHeadAngle', 'HC', value, 0, 180); }, get_endHeadLength: function () { this.eH(3, 'endHeadLength'); return this.HT; }, set_endHeadLength: function (value) { this.BY(3, 'endHeadLength', 'HT', value, 0, 100); }, get_endHeadType: function () { this.eH(3, 'endHeadType'); return this.mW; }, set_endHeadType: function (value) { this.vL(3, 'endHeadType', 'mW', value, IPCC.Web.UI.LineHeadType); }, get_href: function () { this.eH(1 << 14 | 1 << 15, 'href'); return this.qY; }, set_href: function (value) { this.DU(1 << 14 | 1 << 15, 'href', 'qY', value); }, get_mask: function () { this.eH(65536, 'mask'); return this.iJ; }, set_mask: function (value) { this.nk(65536, 'mask', 'iJ', value); }, get_borderType: function () { this.eH(32768, 'borderType'); return this.zy; }, set_borderType: function (value) { this.DU(32768, 'borderType', 'zy', value); }, get_borderHorizontalRadius: function () { this.eH(32768, 'borderHorizontalRadius'); return this.Ep; }, set_borderHorizontalRadius: function (value) { this.AF(32768, 'borderHorizontalRadius', 'Ep', value); }, get_borderVerticalRadius: function () { this.eH(1 << 15, 'borderVerticalRadius'); return this.Fd; }, set_borderVerticalRadius: function (value) { this.AF(32768, 'borderVerticalRadius', 'Fd', value); }, get_borderOpacity: function () { this.eH(32768, 'oQ'); return this.oQ; }, set_borderOpacity: function (value) { this.YF(32768, 'oQ', 'oQ', value, 0, 255); }, get_borderPattern: function () { this.eH(32768, 'BK'); return this.BK; }, set_borderPattern: function (value) { this.nk(32768, 'BK', 'BK', value, 0, 255); }, get_fillColor: function () { this.eH(16380 + (1 << 14), 'fillColor'); return this.cK; }, set_fillColor: function (value) { this.MP(16380 + (1 << 14), 'fillColor', 'cK', value); }, get_fillVisible: function () { this.eH(16380, 'fillVisible'); return this.zm; }, set_fillVisible: function (value) { this.nk(16380, 'fillVisible', 'zm', value); }, get_fontName: function () { this.eH(6176 + 8192 + 65536 + (1 << 18), 'fontName'); return this.gZ; }, set_fontName: function (value) { this.DU(6176 + 8192 + 65536 + (1 << 18), 'fontName', 'gZ', value); if (this.jd() === IPCC.Web.UI.MarkType.SignatureText || this.jd() === IPCC.Web.UI.MarkType.TextLine) { var aH = (this.jd() === IPCC.Web.UI.MarkType.TextLine) ? { wJ: 'pre' } : {}; var iI = IPCC.J.wZ(this.az, this.gZ, aH); this.xj = iI.width; this.yq = iI.height; } if (this.jd() === IPCC.Web.UI.MarkType.TextLine) { this.Im = false; } }, get_fontSize: function () { this.eH(32 + 2048 + 4096 + 8192, 'fontSize'); return this.cd; }, set_fontSize: function (value) { this.BY(32 + 2048 + 4096 + 8192, 'fontSize', 'cd', value, 0.1, 288); }, get_fontStyle: function () { this.eH(6176 + (1 << 18), 'fontStyle'); return this.de; }, set_fontStyle: function (value) { this.aCU(6176 + (1 << 18), 'fontStyle', 'de', value, IPCC.Web.UI.FontStyle); }, get_headFillColor: function () { this.eH(3, 'headFillColor'); return this.wH; }, set_headFillColor: function (value) { this.MP(3, 'headFillColor', 'wH', value); }, get_interactionMode: function () { this.eH(~0, 'interactionMode'); return this.qi; }, set_interactionMode: function (value) { this.vL(~0, 'interactionMode', 'qi', value, IPCC.Web.UI.MarkInteractionMode); if (value === IPCC.Web.UI.MarkInteractionMode.SelectionDisabled) { this.set_selected(false); } }, get_maxLength: function () { this.eH(32 + 65536 + (1 << 18), 'maxLength'); return this.gU; }, set_maxLength: function (value) { this.AF(32 + 65536 + (1 << 18), 'maxLength', 'gU', value); }, get_maxFontSize: function () { this.eH(1 << 18, 'maxFontSize'); return this.jA; }, set_maxFontSize: function (value) { this.AF(1 << 18, 'maxFontSize', 'jA', value); }, get_isClosed: function () { this.eH(2, 'isClosed'); return this.na; }, set_isClosed: function (value) { this.nk(2, 'isClosed', 'na', value); }, get_lineColor: function () { return this.gX; }, set_lineColor: function (value) { this.MP(13567 + 32768 + (1 << 17), 'lineColor', 'gX', value); }, get_lineStyle: function () { return this.ii; }, set_lineStyle: function (value) { this.vL(63 + 32768, 'lineStyle', 'ii', value, IPCC.Web.UI.LineStyle); }, get_lineWidth: function () { return this.dQ; }, set_lineWidth: function (value) { this.BY(13567 + 32768 + (1 << 17), 'lineWidth', 'dQ', value, 0, 50); }, get_lineVisible: function () { this.eH(172 + 65536, 'lineVisible'); return this.hv; }, set_lineVisible: function (value) { this.nk(172 + 65536, 'lineVisible', 'hv', value); }, get_opacity: function () { return this.dI; }, set_opacity: function (value) { this.YF(895 + 2048 + 1024, 'opacity', 'dI', value, 0, 255); }, get_points: function () { this.eH(19, 'points'); return this.pu(); }, get_conversation: function () { return this.asw(); }, get_data: function () { return this.yF(); }, get_image: function () { this.eH(16384, 'image'); return this.cX(); }, set_image: function (value) { this.eH(16384, 'image'); this.xB(value); }, get_rectangle: function () { this.eH((1 << 18) + (1 << 17) + 65536 + 32768 + 16384 + 8192 + 4096 + 2048 + 1024 + 512 + 256 + 128 + 64 + 32 + 8 + 4, 'rectangle'); return this.fD(); }, set_rectangle: function (value) { this.eH((1 << 18) + (1 << 17) + 65536 + 32768 + 16384 + 8192 + 4096 + 2048 + 1024 + 512 + 256 + 128 + 64 + 32 + 8 + 4, 'rectangle'); IPCC.ad.h(value, 'rectangle'); this.Gn(value); if (this.jd() === IPCC.Web.UI.MarkType.TextLine) { this.Im = false; } }, get_startHeadAngle: function () { this.eH(3, 'startHeadAngle'); return this.ED; }, set_startHeadAngle: function (value) { this.BY(3, 'startHeadAngle', 'ED', value, 0, 180); }, get_startHeadLength: function () { this.eH(3, 'startHeadLength'); return this.DP; }, set_startHeadLength: function (value) { this.BY(3, 'startHeadLength', 'DP', value, 0, 100); }, get_startHeadType: function () { this.eH(3, 'startHeadType'); return this.Dr; }, set_startHeadType: function (value) { this.vL(3, 'startHeadType', 'Dr', value, IPCC.Web.UI.LineHeadType); }, get_text: function () { this.eH(14496 + 65536 + (1 << 17) + (1 << 18), 'text'); return this.az; }, set_text: function (value) { if (this.az === value) { return; } this.DU(14496 + 65536 + (1 << 17) + (1 << 18), 'text', 'az', value); if (this.jd() === IPCC.Web.UI.MarkType.SignatureText || this.jd() === IPCC.Web.UI.MarkType.TextLine) { var aH = (this.jd() === IPCC.Web.UI.MarkType.TextLine) ? { wJ: 'pre' } : {}; var iI = IPCC.J.wZ(this.az, this.gZ, aH); this.xj = iI.width; this.yq = iI.height; } if (this.eh) { while (this.eh.length > 0) { this.eh.pop(); } } }, get_textHorizontalAlignment: function () { this.eH(32 + 1024 + 2048 + 65536 + (1 << 18), 'textHorizontalAlignment'); return this.kh; }, set_textHorizontalAlignment: function (value) { this.vL(32 + 1024 + 2048 + 65536 + (1 << 18), 'textHorizontalAlignment', 'kh', value, IPCC.Web.UI.HorizontalAlignment); }, get_textVerticalAlignment: function () { this.eH(32, 'textVerticalAlignment'); return this.AM; }, set_textVerticalAlignment: function (value) { this.vL(32, 'textVerticalAlignment', 'AM', value, IPCC.Web.UI.VerticalAlignment); }, get_textColor: function () { this.eH(6176 + 65536 + (1 << 18), 'textColor'); return this.od; }, set_textColor: function (value) { this.MP(6176 + 65536 + (1 << 18), 'textColor', 'od', value); }, get_textOpacity: function () { this.eH(32, 'textOpacity'); return this.rE; }, set_textOpacity: function (value) { this.YF(32, 'textOpacity', 'rE', value, 0, 255); }, get_textOrientation: function () { this.eH(32, 'textOrientation'); return this.wC; }, set_textOrientation: function (value) { this.vL(32, 'textOrientation', 'wC', value, IPCC.Web.UI.Orientation); }, get_type: function () { return this.jd(); }, get_visible: function () { return this.ep; }, set_visible: function (value) { this.nk((1 << 17) + 65536 + 32768 + 16384 + 8192 + 4096 + 2048 + 1024 + 512 + 256 + 128 + 64 + 63, 'visible', 'ep', value); }, get_markID: function () { return this.jf(); }, get_pathString: function () { return this.rs; }, set_pathString: function (value) { var rs = this.get_pathString(); if (rs !== value) { this.OW = true; } this.DU(1088, 'pathString', 'rs', value); }, get_pathWidth: function () { return this.Wq; }, set_pathWidth: function (value) { this.AF(1088, 'pathWidth', 'Wq', value); }, get_pathHeight: function () { return this.Wn; }, set_pathHeight: function (value) { this.AF(1088, 'pathHeight', 'Wn', value); }, get_startIndex: function () { this.eH((1 << 17) + (1 << 14) + 8192 + 512, 'startIndex'); return this.bh; }, set_startIndex: function (value) { this.AF((1 << 17) + (1 << 14) + 8192 + 512, 'startIndex', 'bh', value); }, get_textLength: function () { this.eH((1 << 17) + (1 << 14) + 8192 + 512, 'textLength'); return this.cg; }, set_textLength: function (value) { this.AF((1 << 17) + (1 << 14) + 8192 + 512, 'textLength', 'cg', value); }, add_propertyChanged: function (handler) { this.lg(handler); }, remove_propertyChanged: function (handler) { this.nt(handler); }, add_markTextSelectionChanged: function (handler) { this.JU(handler); }, remove_markTextSelectionChanged: function (handler) { this.Ig(handler); }, move: function (deltaX, deltaY) { IPCC.ad.hL(deltaX, 'deltaX'); IPCC.ad.hL(deltaY, 'deltaY'); this.HK(deltaX, deltaY); }, moveBackward: function () { if (this.eI()) { var index = this.eI().qW(this); var cF = this.eI().alk(); if (index > cF) { this.eI().reorderMark(this, index - 1); } } else { throw new IPCC.Web.UI.ImGearInvalidOperationException('A Mark cannot be reordered unless it is associated with an ArtPage.'); } }, moveForward: function () { if (this.eI()) { var index = this.eI().qW(this); if (index < this.eI().acE() - 1) { this.eI().reorderMark(this, index + 1); } } else { throw new IPCC.Web.UI.ImGearInvalidOperationException('A Mark cannot be reordered unless it is associated with an ArtPage.'); } }, moveToBack: function () { if (this.eI()) { var cF = 0; cF = this.eI().alk(); this.eI().reorderMark(this, cF); } else { throw new IPCC.Web.UI.ImGearInvalidOperationException('A Mark cannot be reordered unless it is associated with an ArtPage.'); } }, moveToFront: function () { if (this.eI()) { this.eI().reorderMark(this, this.eI().acE() - 1); } else { throw new IPCC.Web.UI.ImGearInvalidOperationException('A Mark cannot be reordered unless it is associated with an ArtPage.'); } }, removeFromPage: function () { if (this.eI()) { this.eI().removeMark(this); } }, selectText: function (textRanges) { this.ZA(textRanges); }, azd: function () { var fM = {}; var K = this; var ag, YI, be, h, G; function dj(cr, OB) { fM[OB] = K[cr]; }; var iq = false; var kP = false; var ym = false; switch (this.get_type()) { case IPCC.Web.UI.MarkType.Line: iq = true; ym = true; fM.__type = 'LineMark:#IPCC.Web'; break; case IPCC.Web.UI.MarkType.Polyline: iq = true; ym = true; fM.__type = 'PolyLineMark:#IPCC.Web'; dj('na', 'ic'); break; case IPCC.Web.UI.MarkType.Rectangle: kP = true; fM.__type = 'RectangleMark:#IPCC.Web'; break; case IPCC.Web.UI.MarkType.RectangleRedaction: kP = true; fM.__type = 'RectangleRedactionMark:#IPCC.Web'; break; case IPCC.Web.UI.MarkType.Ellipse: kP = true; fM.__type = 'EllipseMark:#IPCC.Web'; break; case IPCC.Web.UI.MarkType.Polygon: ym = true; fM.__type = 'PolygonMark:#IPCC.Web'; break; case IPCC.Web.UI.MarkType.Text: kP = true; fM.__type = 'TextMark:#IPCC.Web'; dj('Bo', 'clc'); dj('At', 'clid'); dj('rR', 'cls'); dj('CA', 'clw'); dj('GC', 'ct'); dj('zg', 'cv'); dj('gZ', 'fn'); dj('cd', 'fs'); dj('de', 'fst'); dj('ii', 'ls'); dj('az', 'te'); dj('kh', 'tha'); dj('AM', 'tva'); dj('od', 'tc'); dj('rE', 'to'); dj('wC', 'tor'); be = this.pj; if (be.x !== 0 || be.y !== 0) { fM.cp = { x: be.x, y: be.y }; } break; case IPCC.Web.UI.MarkType.Stamp: kP = true; fM.__type = 'StampMark:#IPCC.Web'; break; case IPCC.Web.UI.MarkType.Highlight: case IPCC.Web.UI.MarkType.HighlightText: kP = true; fM.__type = 'HighlightText:#IPCC.Web'; break; } if (iq) { dj('HC', 'eha'); dj('HT', 'ehl'); dj('mW', 'eht'); dj('wH', 'hfc'); dj('ED', 'sha'); dj('DP', 'shl'); dj('Dr', 'sht'); } else { dj('cK', 'fc'); dj('zm', 'fv'); dj('hv', 'lv'); } if (kP) { h = this.get_rectangle(); fM.r = { x: h.x, y: h.y, width: h.width, height: h.height }; } fM.t = this.get_type(); dj('gX', 'lc'); dj('ii', 'ls'); dj('dQ', 'lw'); dj('dI', 'o'); dj('ep', 'v'); if (ym) { ag = this.pu(); YI = []; for (G = 0; G < ag.get_length() ; G++) { be = ag.getPoint(G); YI.push({ x: be.x, y: be.y }); } fM.p = YI; } return fM; }, arT: function (fM) { var K = this; var ag, G; function dj(cr, OB) { if (fM.hasOwnProperty(OB)) { K[cr] = fM[OB]; } }; var iq = false; var kP = false; var ym = false; switch (this.get_type()) { case IPCC.Web.UI.MarkType.Line: iq = true; if (fM.p && fM.p.length === 2) { ag = this.pu(); ag.setPoint(0, new IPCC.Web.UI.Point(fM.p[0].x, fM.p[0].y)); ag.setPoint(1, new IPCC.Web.UI.Point(fM.p[1].x, fM.p[1].y)); } break; case IPCC.Web.UI.MarkType.Polyline: iq = true; ym = true; dj('na', 'ic'); break; case IPCC.Web.UI.MarkType.Rectangle: kP = true; break; case IPCC.Web.UI.MarkType.RectangleRedaction: kP = true; break; case IPCC.Web.UI.MarkType.Ellipse: kP = true; break; case IPCC.Web.UI.MarkType.Polygon: ym = true; break; case IPCC.Web.UI.MarkType.Text: kP = true; dj('Bo', 'clc'); dj('At', 'clid'); dj('rR', 'cls'); dj('CA', 'clw'); dj('GC', 'ct'); dj('zg', 'cv'); dj('gZ', 'fn'); dj('cd', 'fs'); dj('de', 'fst'); dj('ii', 'ls'); dj('az', 'te'); dj('kh', 'tha'); dj('AM', 'tva'); dj('od', 'tc'); dj('rE', 'to'); dj('wC', 'tor'); if (fM.cp) { this.pj = new IPCC.Web.UI.Point(fM.cp.x, fM.cp.y); } break; case IPCC.Web.UI.MarkType.Stamp: kP = true; break; case IPCC.web.UI.MarkType.Highlight: case IPCC.web.UI.MarkType.HighlightText: case IPCC.web.UI.MarkType.Strikethrough: kP = true; break; } if (iq) { dj('HC', 'eha'); dj('HT', 'ehl'); dj('mW', 'eht'); dj('wH', 'hfc'); dj('ED', 'sha'); dj('DP', 'shl'); dj('Dr', 'sht'); } else { dj('cK', 'fc'); dj('zm', 'fv'); dj('hv', 'lv'); } if (kP) { if (fM.r) { this.set_rectangle(new IPCC.Web.UI.Rectangle(fM.r.x, fM.r.y, fM.r.width, fM.r.height)); } } fM.t = this.get_type(); dj('gX', 'lc'); dj('ii', 'ls'); dj('dQ', 'lw'); dj('dI', 'o'); dj('ep', 'v'); if (fM.p && ym) { ag = this.pu(); for (G = 0; G < fM.p.length; G++) { ag.addPoint(new IPCC.Web.UI.Point(fM.p[G].x, fM.p[G].y)); } } return fM; } }; IPCC.Web.UI.Mark.registerClass = IPCC.Web.regClass; IPCC.Web.UI.Mark.registerClass('IPCC.Web.UI.Mark'); IPCC.Web.UI.ArtPage = function () { var bN = []; var bC = new IPCC.Web.UI.fR(); var fE = new IPCC.Web.UI.MarkCollection(); var K = this; var HQ = true; this.aDR = []; function onMarkSelectionChanged(aB, L) { var R = L.mark; if (R.bV && R.bV[0] && R.bV[0].ep === false) { return; } var fu; var pZ = L.mark.get_selected(); if (R.get_type() === IPCC.Web.UI.MarkType.RectangleRedaction && R.cE !== undefined) { fE.remove_markAdded(onMarkSelectionChanged); fE.remove_markRemoved(onMarkSelectionChanged); for (var G = 0; G < bN.length; G++) { if (bN[G].cE === R.cE) { if (bN[G].get_type() === IPCC.Web.UI.MarkType.TextSelectionRedaction) { fu = bN[G]; } else { bN[G].set_selected(L.mark.get_selected()); } } } fE.add_markAdded(onMarkSelectionChanged); fE.add_markRemoved(onMarkSelectionChanged); if (fu) { fu.set_selected(pZ); } return; } else if (R.get_type() === IPCC.Web.UI.MarkType.TextSelectionRedaction) { fE.remove_markAdded(onMarkSelectionChanged); fE.remove_markRemoved(onMarkSelectionChanged); for (var ar = 0; ar < R.bV.length; ar++) { R.bV[ar].set_selected(L.mark.get_selected()); } fE.add_markAdded(onMarkSelectionChanged); fE.add_markRemoved(onMarkSelectionChanged); } var gN = new IPCC.Web.UI.MarkEventArgs(); gN.mark = R; gN.zIndex = K.qW(R); gN.length = 1; K.aM('markSelectionChanged', gN); }; fE.add_markAdded(onMarkSelectionChanged); fE.add_markRemoved(onMarkSelectionChanged); var avm = fE.addMark; fE.addMark = function (R) { if (K.qW(R) < 0) { throw new IPCC.Web.UI.ImGearInvalidOperationException('You cannot select a Mark that is not associated with the ArtPage.'); } if (!fE.contains(R)) { avm.call(fE, R); R.aL('selected'); } }; var awO = fE.addMarks; fE.addMarks = function (Bi) { var sb = []; function Vs(R) { if (K.qW(R) < 0) { throw new IPCC.Web.UI.ImGearInvalidOperationException('You cannot select a Mark that is not associated with the ArtPage.'); } if (!fE.contains(R)) { sb.push(R); } }; Bi.forEach(Vs, {}); awO.call(fE, Bi); var G; for (G = 0; G < sb.length; G++) { sb[G].aL('selected'); } }; var avX = fE.removeMark; fE.removeMark = function (R) { if (fE.contains(R)) { avX.call(fE, R); R.aL('selected'); } }; var axl = fE.removeAllMarks; fE.removeAllMarks = function () { var sb = []; function Vs(R) { if (fE.contains(R)) { sb.push(R); } }; fE.forEach(Vs, {}); axl.call(fE); var G; for (G = 0; G < sb.length; G++) { sb[G].aL('selected'); } }; function ano(nq) { IPCC.ad.ps(nq, 'zIndex', 0, bN.length - 1); }; this.acE = function () { return bN.length; }; this.alk = function () { var G = 0; for (; G < bN.length; G++) { if (bN[G].get_type() !== IPCC.Web.UI.MarkType.HighlightText && bN[G].get_type() !== IPCC.Web.UI.MarkType.Highlight && !(bN[G].get_type() === IPCC.Web.UI.MarkType.RectangleRedaction && bN[G].cE !== undefined)) { break; } } return G; }; this.Bl = function () { return fE; }; this.Gf = function (F) { if (F === HQ) { return; } HQ = F; this.aL('HQ'); }; this.Ia = function () { return HQ; }; var sR = false; this.kU = function () { return sR; }; this.rq = function (F) { if (typeof F !== "boolean") { return; } sR = F; this.aL('redactionDraftMode'); }; function sZ(aB, L) { if (L.get_propertyName() === 'selected') { return; } var gN = new IPCC.Web.UI.MarkEventArgs(); gN.mark = aB; gN.zIndex = K.qW(aB); gN.propertyName = L.cr; gN.length = 1; if (gN.mark.get_type() === IPCC.Web.UI.MarkType.TextSelectionRedaction || (gN.mark.get_type() === IPCC.Web.UI.MarkType.RectangleRedaction && gN.mark.cE !== 'undefined')) { K.ayS(aB); } K.aM('markChanged', gN); }; function zK(aB) { var gN = new IPCC.Web.UI.MarkEventArgs(); gN.mark = aB; gN.zIndex = K.qW(aB); gN.length = 1; K.aM('markTextSelectionChanged', gN); }; function Tu(aB, L) { var gN = new IPCC.Web.UI.CommentEventArgs(); gN.mark = aB; gN.comment = L.comment; gN.index = L.index; K.aM('commentAdded', gN); }; function Uc(aB, L) { var gN = new IPCC.Web.UI.CommentEventArgs(); gN.mark = aB; gN.comment = L.comment; gN.index = L.index; K.aM('commentRemoved', gN); }; function Sx(aB, L) { var gN = new IPCC.Web.UI.CommentEventArgs(); gN.mark = aB; gN.comment = L.comment; gN.index = L.index; K.aM('commentChanged', gN); }; this.MG = function (R, rd) { rd = rd || {}; var nq = this.qW(R); if (nq >= 0) { throw new IPCC.Web.UI.ImGearInvalidOperationException('You cannot add a Mark to an ArtPage if the mark is already associated with the ArtPage.'); } if (R.eI()) { throw new IPCC.Web.UI.ImGearInvalidOperationExceptionException('You cannot add a Mark to an ArtPage if the mark is already associated with a different ArtPage.'); } bN.push(R); R.kc(this); R.add_propertyChanged(sZ); R.add_markTextSelectionChanged(zK); R.xy(Tu); R.xP(Uc); R.vW(Sx); var L = new IPCC.Web.UI.MarkEventArgs(); L.mark = R; if (R.get_type() === IPCC.Web.UI.MarkType.Highlight || R.get_type() === IPCC.Web.UI.MarkType.HighlightText || R.get_type() === IPCC.Web.UI.MarkType.TextHyperlinkAnnotation || R.get_type() === IPCC.Web.UI.MarkType.DocumentHyperlink || R.get_type() === IPCC.Web.UI.MarkType.Strikethrough || (R.get_type() === IPCC.Web.UI.MarkType.RectangleRedaction && R.cE !== undefined)) { this.aeM(R, 0); } else { L.zIndex = bN.length - 1; } L.clientX = rd.clientX; L.clientY = rd.clientY; L.length = 1; K.aM('markAdded', L); }; this.FJ = function (kg, ca) { var MW = [].concat(bN); var G; for (G = 0; G < MW.length; G++) { kg.call(ca, MW[G], G, this); } }; this.Rj = function (nq) { ano(nq); return bN[nq]; }; this.qW = function (R) { var G; for (G = 0; G < bN.length; G++) { if (bN[G] === R) { return G; } } return -1; }; this.asT = function (ei) { var fM; if (typeof JSON !== 'undefined') { fM = JSON.parse(ei); } else { fM = IPCC.ct.pG(ei, true); } this.WD(); var JQ = []; var G; var PD = fM.m; if (PD) { for (G = 0; G < PD.length; G++) { var aZ = new IPCC.Web.UI.Mark(PD[G].t); aZ.arT(PD[G]); aZ.kc(this); aZ.add_propertyChanged(sZ); aZ.add_markTextSelectionChanged(zK); JQ.push(aZ); } } bN = JQ; K.aM('marksLoaded', {}); }; var ALPHA_CHAR_CODES = [48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 65, 66, 67, 68, 69, 70]; this.apX = function () { var mD = new Array(36); var ak = 0; var G; var aj; for (G = 0; G < 8; G++) { mD[ak++] = ALPHA_CHAR_CODES[Math.floor(Math.random() * 16)]; } for (G = 0; G < 3; G++) { mD[ak++] = 45; for (aj = 0; aj < 4; aj++) { mD[ak++] = ALPHA_CHAR_CODES[Math.floor(Math.random() * 16)]; } } mD[ak++] = 45; var axL = new Date().getTime(); var axJ = ("0000000" + axL.toString(16).toUpperCase()).substr(-8); for (G = 0; G < 8; G++) { mD[ak++] = axJ.charCodeAt(G); } for (G = 0; G < 4; G++) { mD[ak++] = ALPHA_CHAR_CODES[Math.floor(Math.random() * 16)]; } return String.fromCharCode.apply(null, mD); }; function Vg(jQ) { var aY = jQ.firstChild; while (aY.nodeType !== 1) { aY = aY.nextSibling; } return aY; }; function PO(yJ, aos, ayL) { var aFP = parseFloat(yJ.getAttribute(aos)); var aHM = parseFloat(yJ.getAttribute(aos + 'WA')); return ayL / (aFP / aHM); }; function axK(Np, aJ, by) { if (aJ <= 0 && by <= 0) { return 1; } var aqm = Np.getAttribute('pageWidth'); var aqu = Np.getAttribute('pageHeight'); var PS, Vv, ab, yJ, G; if (aqm && aqu) { PS = parseFloat(aqm); Vv = parseFloat(aqu); if (isFinite(PS) && isFinite(Vv) && PS > 0 && Vv > 0) { return aJ / PS; } } for (G = 0; G < Np.childNodes.length; G++) { yJ = Np.childNodes[G]; if (yJ.nodeName !== 'annotation') { continue; } ab = PO(yJ, 'width', aJ); if (isFinite(ab) && ab > 0) { return ab; } ab = PO(yJ, 'height', by); if (isFinite(ab) && ab > 0) { return ab; } ab = PO(yJ, 'x', aJ); if (isFinite(ab) && ab > 0) { return ab; } ab = PO(yJ, 'y', by); if (isFinite(ab) && ab > 0) { return ab; } } return 1; }; this.ask = function (lL, bp, aJ, by, aci, stampImages, yS, wD) { var K = this; if (yS !== true) { this.WD(); } if (lL) { var jL; if (IPCC.yZ.Bv()) { jL = lL.firstChild; } else { var UC = lL.firstChild.nodeName; if (UC.toLowerCase() === 'xml') { jL = lL.firstChild.nextSibling; } else { jL = lL.firstChild; } } var dP = Vg(jL); if (dP.nodeName !== 'pages') { throw 'ERROR: pages'; } if (dP.hasChildNodes()) { var G; for (G = 0; G < dP.childNodes.length; G++) { var bI = dP.childNodes[G]; if (bI.nodeName !== 'page') { continue; } var Dy = bI.getAttribute('id'); var nm = false; var vv; var uZ = ''; var Na = []; var km; var pV, ar = 0; var cg, cl, bh; if (aci) { var aiN = bI.getAttribute('pageWidth'), aiJ = bI.getAttribute('pageHeight'); if (aiN) { aci.aek(aiN); } if (aiJ) { aci.afv(aiJ); } } var oK = [], Rq = {}, bV; if ((Dy && parseInt(Dy, 10)) === (bp + 1)) { nm = true; var JQ = []; var aj; var aZ; var kP, gy, qr, tL, uh, gU; var oz = 1; var agJ = axK(bI, aJ, by); if (agJ > 0) { oz = agJ; } for (aj = 0; aj < bI.childNodes.length; aj++) { var aF = bI.childNodes[aj]; if (aF.nodeName !== 'annotation') { continue; } var im = parseFloat(aF.getAttribute('width')) * oz; var hW = parseFloat(aF.getAttribute('height')) * oz; var hh = parseFloat(aF.getAttribute('x')) * oz; var fP = parseFloat(aF.getAttribute('y')) * oz; var XJ = aF.getAttribute('fillColor'), Wl, sg, XE = aF.getAttribute('lineColor'), anU, jz, anM = aF.getAttribute('fontColor'), aoa, zs; if (XJ === 'transparent') { Wl = sg = XJ; } else { Wl = parseInt(XJ || 0, 10); sg = parseInt(Wl, 10).toString(16); while (sg.length < 6) { sg = '0' + sg; } sg = '#' + sg; } if (XE === 'transparent') { jz = XE; } else { anU = parseInt(XE || 0, 10); jz = parseInt(anU, 10).toString(16); while (jz.length < 6) { jz = '0' + jz; } jz = '#' + jz; } if (anM) { aoa = parseInt(anM || 0, 10); zs = parseInt(aoa, 10).toString(16); while (zs.length < 6) { zs = '0' + zs; } zs = '#' + zs; } var avl = aF.getAttribute('stampSize'); var NK = aF.getAttribute('dragDirection'); var IJ = parseInt(aF.getAttribute('opacity'), 10); if (isNaN(IJ)) { IJ = 255; } if (aF.nodeName === 'annotation') { var apt = aF.getAttribute('label'); if (!apt) { apt = ''; } var kj = aF.getAttribute('drawType'); var jM; switch (kj) { case 'imagestamp': case 'imagestamp_redact': var sc = aF.getAttribute('imageStampId'); var bi = (kj === 'imagestamp') ? IPCC.Web.UI.MarkType.ImageStampAnnotation : IPCC.Web.UI.MarkType.ImageStampRedaction; aZ = new IPCC.Web.UI.Mark(bi); aZ.set_rectangle({ x: hh, y: fP, width: im, height: hW }); aZ.set_image(stampImages[sc].base64format); aZ.sc = sc; kP = true; if (kj === 'imagestamp_redact') { aZ.mg(true); } break; case 'circle': aZ = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.Ellipse); aZ.set_rectangle({ x: hh, y: fP, width: im, height: hW }); kP = true; aZ.set_lineColor(jz); aZ.set_fillVisible(false); aZ.set_lineWidth(parseFloat(aF.getAttribute('lineWidth'))); break; case 'circle_filled': case 'circle_trans': aZ = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.Ellipse); aZ.set_rectangle({ x: hh, y: fP, width: im, height: hW }); kP = true; aZ.set_fillColor(sg); aZ.set_lineColor(jz); aZ.set_fillVisible(true); aZ.set_lineWidth(parseFloat(aF.getAttribute('lineWidth'))); break; case 'text': case 'text_redact': aZ = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.Text); aZ.set_rectangle({ x: hh, y: fP, width: im, height: hW }); aZ.set_fontName('verdana'); aZ.set_fontSize(10); aZ.set_opacity(0); vv = undefined; aZ.set_fillColor('#000000'); if (kj === 'text_redact') { aZ.mg(true); } if (kj === 'text') { aZ.set_fillColor(sg); aZ.set_lineColor(jz); aZ.set_lineWidth(parseFloat(aF.getAttribute('lineWidth'))); aZ.set_fillVisible(true); aZ.set_opacity(IJ); } gU = parseInt(aF.getAttribute('maxLength')); if (!isNaN(gU)) { aZ.set_maxLength(gU); } oK = []; gy = aF.firstChild; while ((gy) && (gy.nodeType !== 4)) { gy = gy.nextSibling; } if ((gy) && (gy.nodeType === 4)) { jM = gy.innerText || gy.textContent || gy.data; aZ.bu.az = jM; pV = jM.split("</TEXTFORMAT>"); uZ = ''; Na = []; for (ar = 0; ar < pV.length; ar++) { if (pV[ar].match(/<TEXTFORMAT/)) { pV[ar] = pV[ar] + "</TEXTFORMAT>"; oK.push(pV[ar]); } } for (ar = 0; ar < oK.length; ar++) { if (oK[ar].match(/<P/)) { vv = this.acv(oK[ar]); Na.push(vv); uZ += vv + " "; if (ar === 0) { km = this.acf(oK[ar]); afz(km, aZ); } } uZ = uZ.replace(/\s+$/g, ""); aZ.set_text(uZ); var KI = this.ach(oK[ar]); switch (KI) { case 'CENTER': aZ.set_textHorizontalAlignment(IPCC.Web.UI.HorizontalAlignment.Center); break; case 'RIGHT': aZ.set_textHorizontalAlignment(IPCC.Web.UI.HorizontalAlignment.Right); break; default: aZ.set_textHorizontalAlignment(IPCC.Web.UI.HorizontalAlignment.Left); break; } } } break; case 'line': case 'arrow': aZ = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.Line); var ag = aZ.pu(); if (NK === 'br') { ag.setPoint(1, new IPCC.Web.UI.Point(hh + im, fP + hW)); ag.setPoint(0, new IPCC.Web.UI.Point(hh, fP)); } else if (NK === 'bl') { ag.setPoint(1, new IPCC.Web.UI.Point(hh, fP + hW)); ag.setPoint(0, new IPCC.Web.UI.Point(hh + im, fP)); } else if (NK === 'tr') { ag.setPoint(1, new IPCC.Web.UI.Point(hh + im, fP)); ag.setPoint(0, new IPCC.Web.UI.Point(hh, fP + hW)); } else if (NK === 'tl') { ag.setPoint(1, new IPCC.Web.UI.Point(hh, fP)); ag.setPoint(0, new IPCC.Web.UI.Point(hh + im, fP + hW)); } aZ.set_lineColor(jz); aZ.set_lineWidth(parseFloat(aF.getAttribute('lineWidth'))); if (kj === 'arrow') { aZ.set_headFillColor(jz); aZ.set_endHeadType(IPCC.Web.UI.LineHeadType.Solid); aZ.set_startHeadAngle(30); aZ.set_startHeadLength(35); aZ.set_lineWidth(parseFloat(aF.getAttribute('lineWidth'))); } break; case 'stamp': case 'stamp_redact': aZ = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.Stamp); aZ.set_rectangle({ x: hh, y: fP, width: im, height: hW }); aZ.set_fillColor(jz); if (kj === 'stamp_redact') { aZ.mg(true); aZ.set_fillColor('#000000'); } gy = aF.firstChild; while ((gy) && (gy.nodeType !== 4)) { gy = gy.nextSibling; } if ((gy) && (gy.nodeType === 4)) { jM = gy.innerText || gy.textContent || gy.data; aZ.bu.az = jM; aZ.set_text(jM); } break; case 'highlightText': aZ = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.HighlightText); aZ.set_rectangle({ x: hh, y: fP, width: im, height: hW }); aZ.set_fillColor(jz); aZ.cE = aF.getAttribute('highlightGroupID'); if (aF.getAttribute('textLength')) { aZ.cg = parseInt(aF.getAttribute('textLength'), 10); } aZ.cl = aF.getAttribute('selectedText'); if (aF.getAttribute('startIndex')) { aZ.bh = parseInt(aF.getAttribute('startIndex'), 10); } aZ.kz = aF.getAttribute('isHighlight'); aZ.set_opacity(127); bV = YD(aF, oz); if (bV) { aZ.bV = bV; } break; case 'rectangle_filled_redact': aZ = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.RectangleRedaction); aZ.set_rectangle({ x: hh, y: fP, width: im, height: hW }); aZ.set_fillColor(sg || '#000000'); aZ.set_lineColor(jz); aZ.set_lineWidth(parseFloat(aF.getAttribute('lineWidth'))); aZ.set_textColor(zs || '#ffffff'); aZ.set_fillVisible(true); aZ.mg(true); qr = aF.getAttribute('highlightGroupID'); aZ.set_text(IPCC.J.AR(aF.getAttribute('meta'))); if (qr) { aZ.set_lineWidth(0); aZ.cE = qr; var fu = Rq[qr]; if (!fu) { fu = Rq[qr] = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.TextSelectionRedaction); fu.cE = qr; fu.set_rectangle(aZ.get_rectangle()); fu.mg(true); fu.set_text(IPCC.J.AR(aF.getAttribute('meta'))); } else { var MN = false; var sJ = fu.get_rectangle(); var ip = sJ.x, iG = sJ.x + sJ.width, _top = sJ.y, jY = sJ.y + sJ.height; if (sJ.x > hh) { MN = true; ip = hh; } if (sJ.y > fP) { MN = true; _top = fP; } if (sJ.x + sJ.width < hh + im) { MN = true; iG = hh + im; } if (sJ.y + sJ.height < fP + hW) { MN = true; jY = fP + hW; } if (MN === true) { fu.set_rectangle({ x: ip, y: _top, width: iG - ip, height: jY - _top }); } } } break; case 'text_selection_redaction': qr = aF.getAttribute('highlightGroupID'); aZ = Rq[qr]; if (!aZ) { aZ = Rq[qr] = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.TextSelectionRedaction); aZ.cE = qr; aZ.set_rectangle({ x: 0, y: 0, width: 0, height: 0 }); aZ.mg(true); aZ.set_text(aF.getAttribute('meta')); } cg = aF.getAttribute('textLength'); if (cg) { aZ.cg = parseInt(cg, 10); } cl = aF.getAttribute('selectedText'); if (cl) { aZ.cl = cl; } bh = aF.getAttribute('startIndex'); if (bh) { aZ.bh = parseInt(bh, 10); } break; case 'text_hyperlink_annotation': aZ = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.TextHyperlinkAnnotation); aZ.set_fillColor(jz); qr = aF.getAttribute('highlightGroupID'); aZ.cE = qr; var qY = aF.getAttribute('href'); if (qY) { aZ.set_href(IPCC.J.AR(qY)); } cg = aF.getAttribute('textLength'); if (cg) { aZ.cg = parseInt(cg, 10); } cl = aF.getAttribute('selectedText'); if (cl) { aZ.cl = cl; } bh = aF.getAttribute('startIndex'); if (bh) { aZ.bh = parseInt(bh, 10); } var kz = aF.getAttribute('isHighlight'); aZ.kz = kz ? kz : 'n'; aZ.bV = YD(aF, oz); aZ.set_rectangle({ x: hh, y: fP, width: im, height: hW }); break; case 'rectangle': aZ = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.Rectangle); aZ.set_rectangle({ x: hh, y: fP, width: im, height: hW }); aZ.set_lineVisible(true); aZ.set_lineColor(jz); aZ.set_fillVisible(false); aZ.set_lineWidth(parseFloat(aF.getAttribute('lineWidth'))); break; case 'rectangle_filled': aZ = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.Rectangle); aZ.set_rectangle({ x: hh, y: fP, width: im, height: hW }); aZ.set_fillColor(sg); aZ.set_lineColor(jz); aZ.set_fillVisible(true); aZ.set_lineWidth(parseFloat(aF.getAttribute('lineWidth'))); break; case 'rectangle_trans': case 'rectangle_trans_redact': aZ = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.Rectangle); aZ.set_rectangle({ x: hh, y: fP, width: im, height: hW }); aZ.set_fillColor(sg); aZ.set_lineColor(jz); aZ.set_fillVisible(true); if (kj === 'rectangle_trans_redact') { aZ.mg(true); } aZ.set_lineWidth(parseFloat(aF.getAttribute('lineWidth'))); break; case 'freehand': case 'signature_path': if (kj === 'freehand') { aZ = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.Freehand); } else { aZ = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.SignaturePath); switch (aF.getAttribute('align').toUpperCase()) { case 'LEFT': aZ.set_textHorizontalAlignment(IPCC.Web.UI.HorizontalAlignment.Left); break; case 'RIGHT': aZ.set_textHorizontalAlignment(IPCC.Web.UI.HorizontalAlignment.Right); break; default: aZ.set_textHorizontalAlignment(IPCC.Web.UI.HorizontalAlignment.Center); break; } } aZ.set_rectangle({ x: hh, y: fP, width: im, height: hW }); aZ.set_pathWidth(parseFloat(aF.getAttribute('pathWidth'))); aZ.set_pathHeight(parseFloat(aF.getAttribute('pathHeight'))); aZ.set_lineWidth(parseFloat(aF.getAttribute('lineWidth'))); aZ.set_lineColor(jz); var xc = aF.firstChild; while ((xc) && (xc.nodeType !== 4)) { xc = xc.nextSibling; } if ((xc) && (xc.nodeType === 4)) { jM = xc.innerText || xc.textContent || xc.data; aZ.bu.az = jM; aZ.set_pathString(jM); } break; case 'signature_text': aZ = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.SignatureText); aZ.set_rectangle({ x: hh, y: fP, width: im, height: hW }); aZ.set_fontSize(10); aZ.set_lineWidth = 0; aZ.set_fillVisible(true); aZ.set_opacity(1); gy = aF.firstChild; this.WM(gy, aZ); aZ.xj = parseFloat(aF.getAttribute('fontWidth')); aZ.yq = parseFloat(aF.getAttribute('fontHeight')); break; case 'text_area_signature': aZ = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.TextAreaSignature); aZ.set_rectangle({ x: hh, y: fP, width: im, height: hW }); aZ.set_fontName('verdana'); vv = undefined; gU = parseInt(aF.getAttribute('maxLength')); if (!isNaN(gU)) { aZ.set_maxLength(gU); } var jA = parseInt(aF.getAttribute('maxFontSize')); if (!isNaN(jA)) { aZ.set_maxFontSize(jA); } gy = aF.firstChild; this.WM(gy, aZ); break; case 'text_input_signature': aZ = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.TextLine); aZ.set_rectangle({ x: hh, y: fP, width: im, height: hW }); gy = aF.firstChild; this.WM(gy, aZ); aZ.xj = parseFloat(aF.getAttribute('fontWidth')); aZ.yq = parseFloat(aF.getAttribute('fontHeight')); aZ.set_lineVisible(false); gU = parseInt(aF.getAttribute('maxLength')); if (!isNaN(gU)) { aZ.set_maxLength(gU); } ath(aF, aZ); break; case 'polyline': aZ = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.Polyline); aZ.set_lineWidth(parseFloat(aF.getAttribute('lineWidth'))); aZ.set_lineColor(jz); var wu = aF.firstChild; while ((wu) && (wu.nodeType !== 4)) { wu = wu.nextSibling; } var Gd; if ((wu) && (wu.nodeType === 4)) { jM = wu.innerText || wu.textContent || wu.data; if (jM && jM !== 'undefined') { if (typeof JSON !== 'undefined') { Gd = JSON.parse(jM); } else { Gd = IPCC.ct.pG(jM, true); } ag = aZ.pu(); if (Gd) { for (G = 0; G < Gd.length; G++) { ag.addPoint(new IPCC.Web.UI.Point(Gd[G].x * oz, Gd[G].y * oz)); } } } } break; case 'strikethrough': aZ = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.Strikethrough); aZ.set_rectangle({ x: hh, y: fP, width: im, height: hW }); aZ.set_lineWidth(parseFloat(aF.getAttribute('lineWidth'))); aZ.set_lineColor(jz); aZ.cE = aF.getAttribute('highlightGroupID'); var textLength = aF.getAttribute('textLength'); if (textLength) { aZ.cg = parseInt(textLength, 10); } aZ.cl = aF.getAttribute('selectedText'); var startIndex = aF.getAttribute('startIndex'); if (startIndex) { aZ.bh = parseInt(startIndex, 10); } aZ.kz = aF.getAttribute('isHighlight'); bV = YD(aF, oz); if (bV) { aZ.bV = bV; } break; default: } if (aZ) { aZ.bu.kf = aF.getAttribute('nodeId'); if (IJ >= 0 && (kj === 'rectangle_trans_redact' || !aZ.lh()) && kj !== 'stamp' && kj !== 'imagestamp' && kj !== 'imagestamp_redact' && kj !== 'text_hyperlink_annotation' && kj !== 'text_input_signature' && kj !== 'text_area_signature' && kj !== 'strikethrough') { aZ.set_opacity(IJ); } aZ.bu.DY = avl; aZ.bu.aJs = kj; aZ.bu.dQ = aF.getAttribute('lineWidth'); aZ.bu.cK = aF.getAttribute('fillColor'); aZ.bu.gX = aF.getAttribute('lineColor'); aZ.bu.aJm = aF.getAttribute('dragDirection'); aZ.bu.Dy = Dy; aZ.bu.aY = aF.getAttribute('x'); aZ.bu.fJ = aF.getAttribute('y'); aZ.bu.cR = aF.getAttribute('height'); aZ.bu.ax = aF.getAttribute('width'); aZ.bu.aJM = aF.getAttribute('x_percent'); aZ.bu.aIr = aF.getAttribute('y_percent'); aZ.bu.aLa = aF.getAttribute('height_percent'); aZ.bu.aJZ = aF.getAttribute('width_percent'); aZ.bu.aJO = aF.getAttribute('formUser'); aZ.bu.aHL = aF.getAttribute('created'); aZ.bu.aKw = aF.getAttribute('modified'); aZ.bu.aJr = aF.getAttribute('saveDate'); aZ.bu.aKx = aF.getAttribute('saveTime'); aZ.bu.fQ = aF.getAttribute('meta'); var CB = aF.firstChild; while ((CB) && (CB.nodeType !== 4)) { CB = CB.nextSibling; } if ((CB) && (CB.nodeType === 4)) { aZ.dO.push(CB.data); } else { aZ.dO.push(''); } var qi = parseInt(aF.getAttribute('interactionMode')) || IPCC.Web.UI.MarkInteractionMode.Full; aZ.set_interactionMode(qi); aZ.kc(this); aZ.add_propertyChanged(sZ); aZ.add_markTextSelectionChanged(zK); aZ.xy(Tu); aZ.xP(Uc); aZ.vW(Sx); JQ.push(aZ); asc(aF, aZ); tL = IPCC.J.ams(aF.getAttribute('created')); uh = IPCC.J.ams(aF.getAttribute('modified')); tL = tL || new Date(); uh = uh || new Date(); aZ.initializeDates(tL, uh); if (wD) { aZ.set_visible(false); } } } } bN = bN.concat(JQ); K.aM('marksLoaded', {}); } if (nm) { apO(lL, bp); break; } } } } }; this.WM = function (yD, aZ) { var G, jM, pV, uZ, Na, vv, oK = [], CJ = aZ.get_type() === IPCC.Web.UI.MarkType.SignatureText, awG = CJ ? IPCC.Web.UI.HorizontalAlignment.Center : IPCC.Web.UI.HorizontalAlignment.Left, km; while ((yD) && (yD.nodeType !== 4)) { yD = yD.nextSibling; } if ((yD) && (yD.nodeType === 4)) { jM = yD.innerText || yD.textContent || yD.data; aZ.bu.az = jM; pV = jM.split("</TEXTFORMAT>"); for (G = 0; G < pV.length; G++) { if (pV[G].match(/<TEXTFORMAT/)) { pV[G] = pV[G] + "</TEXTFORMAT>"; oK.push(pV[G]); } } uZ = ''; Na = []; for (G = 0; G < oK.length; G++) { if (oK[G].match(/<P/)) { vv = this.acv(oK[G]); Na.push(vv); uZ += vv + " "; if (G === 0) { km = this.acf(oK[G]); afz(km, aZ); } } uZ = uZ.replace(/\s+$/g, ""); aZ.set_text(uZ); var KI = this.ach(oK[G]); switch (KI) { case 'LEFT': aZ.set_textHorizontalAlignment(IPCC.Web.UI.HorizontalAlignment.Left); break; case 'CENTER': aZ.set_textHorizontalAlignment(IPCC.Web.UI.HorizontalAlignment.Center); break; case 'RIGHT': aZ.set_textHorizontalAlignment(IPCC.Web.UI.HorizontalAlignment.Right); break; default: aZ.set_textHorizontalAlignment(awG); break; } } } }; function YL(agw, dc) { for (var i = 0; i < agw.childNodes.length; i++) { var aap = agw.childNodes[i]; if (aap.nodeName === 'kvp') { var aq = aap.getAttribute("key"); var F = aap.getAttribute("value"); dc.set_data(aq, F); } } }; function atE(Rx, df) { var cC = new IPCC.Web.UI.Comment(IPCC.J.AR(Rx.getAttribute("text"))); cC.set_creationTime(Rx.getAttribute("created")); df.addComment(cC); for (var i = 0; i < Rx.childNodes.length; i++) { var agK = Rx.childNodes[i]; if (agK.nodeName === 'data') { YL(agK, cC.get_data()); } } }; function atP(acG, df) { for (var i = 0; i < acG.childNodes.length; i++) { var PA = acG.childNodes[i]; if (PA.nodeName === 'comments') { var hd = PA; for (var j = 0; j < hd.childNodes.length; j++) { var ags = hd.childNodes[j]; if (ags.nodeName === 'comment') { atE(ags, df); } } } else if (PA.nodeName === 'data') { YL(PA, df.get_data()); } } }; function asc(IM, R) { for (var i = 0; i < IM.childNodes.length; i++) { var xr = IM.childNodes[i]; if (xr.nodeName === 'conversation') { atP(xr, R.get_conversation()); } else if (xr.nodeName === 'data') { YL(xr, R.get_data()); } } }; function ath(IM, R) { var F = null, Od = {}; for (var i = 0; i < IM.childNodes.length; i++) { var xr = IM.childNodes[i]; if (xr.nodeName === 'inputMask') { F = IPCC.J.AR(xr.getAttribute('value')); for (var j = 0; j < xr.childNodes.length; j++) { var adz = xr.childNodes[j]; if (adz.nodeName === 'translation') { Od[IPCC.J.AR(adz.getAttribute('key'))] = new RegExp(IPCC.J.AR(adz.getAttribute('value').replace(/(^\/|\/$)/g, ''))); } } break; } } if (F !== null) { R.set_mask({ value: F, translations: Od }); } }; function YD(tK, zo) { var gp = null, jZ; for (var i = 0; i < tK.childNodes.length; i++) { jZ = tK.childNodes[i]; if (jZ.nodeName === 'line-rectangles') { if (!gp) { gp = asj(jZ, zo); } else { throw new Error("An XML annotation node cannot have more than one line-rectangles child node."); } } } return gp; }; function asj(tK, zo) { var gp = [], jZ; for (var i = 0; i < tK.childNodes.length; i++) { jZ = tK.childNodes[i]; if (jZ.nodeName === 'rectangle') { gp.push(arR(jZ, zo)); } } return gp; }; function arR(tK, zo) { var aY = parseFloat(tK.getAttribute("x")) * zo; var fJ = parseFloat(tK.getAttribute("y")) * zo; var ax = parseFloat(tK.getAttribute("width")) * zo; var cR = parseFloat(tK.getAttribute("height")) * zo; return new IPCC.Web.UI.Rectangle(aY, fJ, ax, cR); }; this.adx = function (ai, LO, wG, hv, dI, ak) { var aZ = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.Highlight); aZ.set_rectangle({ x: ai.x, y: ai.y, width: ai.width, height: ai.height }); aZ.set_fillColor(wG); aZ.set_fillVisible(true); aZ.bh = ak; aZ.cg = 1; if (dI) { aZ.set_opacity(dI); } else { aZ.set_opacity(127); } K.addMark(aZ); return aZ; }; this.atK = function (ai, abn, ak) { var aZ = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.Highlight); aZ.set_rectangle({ x: ai.x, y: ai.y, width: ai.width, height: ai.height }); aZ.set_fillColor(abn.get_fillColor()); aZ.set_fillVisible(true); aZ.bh = ak; aZ.cg = 1; if (abn.get_opacity()) { aZ.set_opacity(abn.get_opacity()); } else { aZ.set_opacity(127); } K.addMark(aZ); return aZ; }; function afz(km, aZ) { for (var dh = 0; dh < km.length; dh++) { var ek = km[dh].attribs; var nm = false; if (km[dh].attribs.length > 1 && !nm && km[dh].Ll === 'font') { nm = true; for (var aj = 0; aj < ek.length; aj++) { if (ek[aj].dC === "FACE") { aZ.set_fontName(ek[aj].F); } else if (ek[aj].dC === "SIZE" && aZ.get_type() !== IPCC.Web.UI.MarkType.TextLine && aZ.get_type() !== IPCC.Web.UI.MarkType.TextAreaSignature) { var uc = parseFloat(ek[aj].F); aZ.set_fontSize(uc); } else if (ek[aj].dC === "COLOR") { var afL = ek[aj].F; if (aZ.get_type() === IPCC.Web.UI.MarkType.SignatureText) { aZ.set_fillColor(afL); } else { aZ.set_textColor(afL); } } } var mI = false; if (km[dh + 1] && aZ.get_type() !== IPCC.Web.UI.MarkType.TextLine) { if (km[dh + 1].tagName === 'font') { break; } else { var AE = km[dh + 1].Ll; if (AE === 'b' || AE === 'i' || AE === 'u' || AE === 's') { if (AE === 'b') { aZ.set_fontStyle(IPCC.Web.UI.FontStyle.Bold); } else if (AE === 'i') { aZ.set_fontStyle(IPCC.Web.UI.FontStyle.Italic); } else if (AE === 'u') { aZ.set_fontStyle(IPCC.Web.UI.FontStyle.Underline); } else if (AE === 's') { aZ.set_fontStyle(IPCC.Web.UI.FontStyle.Strikeout); } mI = true; } } if (km[dh + 2]) { var asU = km[dh + 2].Ll; mI = XS(aZ, mI, asU); } if (km[dh + 3]) { var asY = km[dh + 3].Ll; mI = XS(aZ, mI, asY); } if (km[dh + 4]) { var ash = km[dh + 4].Ll; mI = XS(aZ, mI, ash); } if (nm) { break; } } } } }; function XS(R, amI, zh) { var mI = amI; var aZ = R; if (amI) { if (zh === 'b') { aZ.set_fontStyle(aZ.get_fontStyle() | IPCC.Web.UI.FontStyle.Bold); mI = true; } else if (zh === 'i') { aZ.set_fontStyle(aZ.get_fontStyle() | IPCC.Web.UI.FontStyle.Italic); mI = true; } else if (zh === 'u') { aZ.set_fontStyle(aZ.get_fontStyle() | IPCC.Web.UI.FontStyle.Underline); mI = true; } else if (zh === 's') { aZ.set_fontStyle(aZ.get_fontStyle() | IPCC.Web.UI.FontStyle.Strikeout); mI = true; } } else { if (zh === 'b') { aZ.set_fontStyle(IPCC.Web.UI.FontStyle.Bold); mI = true; } else if (zh === 'i') { aZ.set_fontStyle(IPCC.Web.UI.FontStyle.Italic); mI = true; } else if (zh === 'u') { aZ.set_fontStyle(IPCC.Web.UI.FontStyle.Underline); mI = true; } else if (zh === 's') { aZ.set_fontStyle(IPCC.Web.UI.FontStyle.Strikeout); mI = true; } } return mI; }; function Hc(str) { var obj = {}, items = str.split(","); for (var i = 0; i < items.length; i++) { obj[items[i]] = true; } return obj; }; var ajJ = /^<([\-A-Za-z0-9_]+)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/, afZ = /^<\/([\-A-Za\-z0-9_]+)[^>]*>/, aql = /([\-A-Za\-z0-9_]+)(?:\s*=\s*(?:(?:"((?:\\[\w\W]|[^"])*)")|(?:'((?:\\[\w\W]|[^'])*)')|([^>\s]+)))?/g; var ayF = Hc("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed"); var Nh = Hc("address,applet,blockquote,button,center,dd,del,dir,div,dl,dt,fieldset,form,frameset,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,p,pre,script,table,tbody,td,tfoot,th,thead,tr,ul"); var aEK = Hc("a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"); var aEA = Hc("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"); var ayr = Hc("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"); var aDF = Hc("script,style"); this.adS = function (html, handler) { var ak, As, wq, op = [], jc = html; function parseEndTag(tag, tagName) { var iC; if (!tagName) { iC = 0; } else { for (iC = op.length - 1; iC >= 0; iC--) { if (op[iC] === tagName) { break; } } } if (iC >= 0) { for (var i = op.length - 1; i >= iC; i--) { if (handler.end) { handler.end(op[i]); } } op.length = iC; } }; function parseStartTag(tag, tagName, rest, unary) { tagName = tagName.toLowerCase(); if (Nh[tagName]) { while (op.last() && aEK[op.last()]) { parseEndTag("", op.last()); } } if (aEA[tagName] && op.last() === tagName) { parseEndTag("", tagName); } unary = ayF[tagName] || ! !unary; if (!unary) { op.push(tagName); } if (handler.start) { var attrs = []; rest.replace(aql, function (wq, name) { var value = arguments[2] ? arguments[2] : arguments[3] ? arguments[3] : arguments[4] ? arguments[4] : ayr[name] ? name : ""; attrs.push({ name: name, value: value, escaped: value.replace(/(^|[^\\])"/g, '$1\\\"') }); }); if (handler.start) { handler.start(tagName, attrs, unary); } } }; op.last = function () { return this[this.length - 1]; }; function aAv(all, text) { text = text.replace(/<!--([\w\W]*?)-->/g, "$1").replace(/<!\[CDATA\[([\w\W]*?)\]\]\]>/g, "$1"); if (handler.chars) { handler.chars(text); } return ""; }; while (html) { As = true; if (!op.last() || !aDF[op.last()]) { if (html.indexOf("<!--") === 0) { ak = html.indexOf("-->"); if (ak >= 0) { if (handler.comment) { handler.comment(html.substring(4, ak)); } html = html.substring(ak + 3); As = false; } } else if (html.indexOf("</") === 0) { wq = html.match(afZ); if (wq) { html = html.substring(wq[0].length); wq[0].replace(afZ, parseEndTag); As = false; } } else if (html.indexOf("<") === 0) { wq = html.match(ajJ); if (wq) { html = html.substring(wq[0].length); wq[0].replace(ajJ, parseStartTag); As = false; } } if (As) { ak = html.indexOf("<"); var text = ak < 0 ? html : html.substring(0, ak); text = IPCC.J.AR(text); html = ak < 0 ? "" : html.substring(ak); if (handler.chars) { handler.chars(text); } } } else { html = html.replace(new RegExp("(.*)<\/" + op.last() + "[^>]*>"), aAv); parseEndTag("", op.last()); } if (html === jc) { throw " Parse Error in annotation Html Text: " + html; } jc = html; } parseEndTag(); }; this.acv = function (html) { var results = ""; this.adS(html, { start: function () { }, end: function () { }, chars: function (text) { results += text; }, comment: function () { } }); return results; }; this.acf = function (html) { var fc = []; this.adS(html, { start: function (tag, attrs) { var fp; fp = tag; if (tag === 'font' || tag === 'b' || tag === 'i' || tag === 'u' || tag === 's') { var xv = {}; xv.Ll = tag; xv.attribs = []; if (tag === 'b') { xv.aHq = true; } else if (tag === 'i') { xv.aIc = true; } else if (tag === 'u') { xv.aJF = true; } else if (tag === 's') { xv.aIy = true; } else { for (var i = 0; i < attrs.length; i++) { var CQ = {}; CQ.dC = attrs[i].name; CQ.F = attrs[i].value; xv.attribs.push(CQ); } } fc.push(xv); } }, end: function () { }, chars: function () { }, comment: function () { } }); return fc; }; this.ach = function (html) { var parts = html.toUpperCase().split('ALIGN="'); var alignment = parts[1].split('"')[0]; return alignment; }; function apO(lL, asX) { var mO = lL.getElementsByTagName("highlights")[0]; if (mO.hasChildNodes()) { var lx; var cO; for (var G = 0; G < mO.childNodes.length; G++) { lx = mO.childNodes[G]; if (lx.nodeType === 1) { cO = lx.getAttribute('page'); if (cO && parseInt(cO, 10) === asX + 1) { var iu = new IPCC.Web.UI.aDk(); iu.aEd = lx.nodeName; switch (iu.aEd) { case 'tag': iu.JD = IPCC.Web.UI.HighLightType.Tag; break; case 'highlight': iu.JD = IPCC.Web.UI.HighLightType.InlineHighLight; break; case 'link': iu.JD = IPCC.Web.UI.HighLightType.Link; break; case 'redaction': iu.JD = IPCC.Web.UI.HighLightType.Redaction; break; case 'strikethrough': iu.JD = IPCC.Web.UI.HighLightType.Strikethrough; break; default: iu.JD = undefined; } if (lx.childNodes[0].data) { iu.dO.push(lx.childNodes[0].data); } iu.bu.fg = lx.getAttribute('id'); iu.bu.aKY = lx.getAttribute('userid'); iu.bu.aJX = lx.getAttribute('mode'); iu.bu.dU = lx.getAttribute('color'); iu.bu.aJY = lx.getAttribute('occurence'); iu.bu.aF = lx.getAttribute('annotation'); iu.bu.bI = lx.getAttribute('page'); iu.bu.aIM = lx.getAttribute('documentname'); iu.bu.aJA = lx.getAttribute('tooltip'); iu.bu.aJI = lx.getAttribute('allowdelete'); iu.bu.iO = lx.getAttribute('start'); iu.bu.aID = lx.getAttribute('end'); K.aDR.push(iu); } } } } }; this.WD = function () { var L; if (bN.length < 1) { return; } fE.removeAllMarks(); var G; for (G = bN.length - 1; G >= 0; G--) { bN[G].remove_propertyChanged(sZ); bN[G].remove_markTextSelectionChanged(zK); bN[G].kc(null); L = new IPCC.Web.UI.MarkEventArgs(); L.length = bN.length; L.zIndex = 0; L.mark = bN.pop(); K.aM('markRemoved', L); } L = new IPCC.Web.UI.MarkEventArgs(); L.length = bN.length; L.zIndex = 0; K.aM('markRemoved', L); }; this.vA = function (R) { var nq = this.qW(R); var wj = R.cE; if (nq >= 0) { R.remove_propertyChanged(sZ); R.remove_markTextSelectionChanged(zK); R.kc(null); bN.splice(nq, 1); fE.removeMark(R); var L = new IPCC.Web.UI.MarkEventArgs(); L.mark = R; L.zIndex = nq; L.length = 1; K.aM('markRemoved', L); if (wj) { this.awE(wj); } } }; this.aIT = function (qU) { var vY = bN.length; var wj = qU.cE; while (vY--) { var R = bN[vY]; if (R.cE === wj) { R.set_fillColor(qU.get_fillColor()); } } }; this.ayS = function (qU) { var vY = bN.length; var wj = qU.cE; if (!wj) { qU.set_text(qU.get_text()); return; } while (vY--) { var R = bN[vY]; if (R.cE === wj) { if (R.get_text() !== qU.get_text()) { R.set_text(qU.get_text()); } if (R.get_fontName() !== qU.get_fontName()) { R.set_fontName(qU.get_fontName()); } if (R.get_fontSize() !== qU.get_fontSize()) { R.set_fontSize(qU.get_fontSize()); } } } }; this.awE = function (wj) { var vY = bN.length; while (vY--) { var R = bN[vY]; if (R.cE === wj) { var nq = this.qW(R); fE.removeMark(R); bN.splice(vY, 1); var L = new IPCC.Web.UI.MarkEventArgs(); L.mark = R; L.zIndex = nq; L.length = 1; } } }; this.aeM = function (R, nq) { var PQ = this.qW(R); if (PQ < 0) { throw new IPCC.Web.UI.ImGearInvalidOperationException('You cannot reorder a Mark unless it is currently associated with the ArtPage.'); } if (PQ === nq) { return; } ano(nq); bN.splice(PQ, 1); bN.splice(nq, 0, R); if (R.get_type() === IPCC.Web.UI.MarkType.Highlight || R.get_type() === IPCC.Web.UI.MarkType.HighlightText || R.get_type() === IPCC.Web.UI.MarkType.TextHyperlinkAnnotation || R.get_type() === IPCC.Web.UI.MarkType.DocumentHyperlink || R.get_type() === IPCC.Web.UI.MarkType.Strikethrough || (R.get_type() === IPCC.Web.UI.MarkType.RectangleRedaction && R.cE !== undefined)) { return; } var L = new IPCC.Web.UI.MarkEventArgs(); L.mark = R; L.zIndex = nq; L.oldZIndex = PQ; L.length = 1; K.aM('markReordered', L); }; function Yn(gp, di, cB) { if (!gp) { return undefined; } var kI = { fZ: 'line-rectangles', dO: [], bu: {} }; IPCC.J.forEach(gp, function (h) { kI.dO.push({ fZ: 'rectangle', dO: [], bu: { x: h.x, y: h.y, height: h.height, width: h.width } }); }); return kI; }; function aHZ(iJ) { if (!iJ) { return undefined; } var kI = { fZ: 'inputMask', dO: [], bu: { value: IPCC.J.rm(iJ.value) } }; IPCC.J.forEach(iJ.translations, function (F, aq) { kI.dO.push({ fZ: 'translation', dO: [], bu: { key: IPCC.J.rm(aq), value: IPCC.J.rm(F.toString()) } }); }); return kI; }; function VB(dc) { if (!dc) { return undefined; } var oG = dc.get_dataKeys(); if (oG.length === 0) { return undefined; } var kI = { fZ: 'data', dO: [], bu: {} }; IPCC.J.forEach(oG, function (aq) { var F = dc.get_data(aq); kI.dO.push({ fZ: 'kvp', dO: [], bu: { key: aq, value: F } }); }); return kI; }; function axF(cC) { if (!cC) { return undefined; } var Bu = { fZ: 'comment', dO: [], bu: {} }; Bu.bu.text = IPCC.J.rm(cC.get_text()); Bu.bu.created = cC.get_creationTime(); var kI = VB(cC.get_data()); if (kI) { Bu.dO.push(kI); } return Bu; }; function ayu(df) { if (!df || df.get_length() === 0) { return undefined; } var UQ = { fZ: 'conversation', dO: [], bu: {} }; var ajE = { fZ: 'comments', dO: [], bu: {} }; UQ.dO.push(ajE); df.forEach(function (cC) { var Bu = axF(cC); if (Bu) { ajE.dO.push(Bu); } }); var kI = VB(df.get_data()); if (kI) { UQ.dO.push(kI); } return UQ; }; this.aFR = function (R, di, cB, wd) { var bi = R.get_type(); var iq = false; var kE; var hG; var akk; var aaC; var iF, tC, sL, az; var aN = { fZ: 'annotation', dO: [], bu: {} }; if (!R.bu.kf) { aN.bu.nodeId = K.apX(); } else { aN.bu.nodeId = R.bu.kf; } var LT, EG = "", qV = ""; if (R.get_lineColor()) { var XF = R.get_lineColor(); if (XF === 'transparent') { aN.bu.lineColor = XF; } else { LT = XF.replace(/#/, ""); EG = parseInt(LT, 16); qV = EG.toString(); aN.bu.lineColor = qV; } } aN.bu.interactionMode = R.get_interactionMode(); aN.bu.stampSize = '122'; var MF = {}; MF[IPCC.Web.UI.MarkType.Stamp] = true; MF[IPCC.Web.UI.MarkType.ImageStampAnnotation] = true; MF[IPCC.Web.UI.MarkType.ImageStampRedaction] = true; if ((bi === IPCC.Web.UI.MarkType.Rectangle && R.get_opacity() < 255 || !R.lh()) && MF[bi] !== true) { aN.bu.opacity = R.get_opacity(); } if (R.get_conversation().get_length() > 0) { aN.dO.push(ayu(R.get_conversation())); } var kI = VB(R.get_data()); if (kI) { aN.dO.push(kI); } iq = false; switch (bi) { case IPCC.Web.UI.MarkType.Rectangle: case IPCC.Web.UI.MarkType.Ellipse: hG = R.get_fillColor(); if (hG === 'transparent') { aN.bu.fillColor = hG; } else if (hG) { kE = hG.replace(/#/, ""); aN.bu.fillColor = parseInt(kE, 16).toString(); } else { aN.bu.fillColor = qV; } if (R.get_fillVisible()) { if (R.get_type() === IPCC.Web.UI.MarkType.Rectangle) { if (R.get_opacity() === 255) { if (R.lh() === true) { aN.bu.drawType = 'rectangle_filled_redact'; if (R.cE) { aN.bu.highlightGroupID = R.cE; } } else { aN.bu.drawType = 'rectangle_filled'; } } else { if (R.lh() === true) { aN.bu.drawType = 'rectangle_trans_redact'; } else { aN.bu.drawType = 'rectangle_trans'; } } } else { if (R.get_opacity() === 255) { aN.bu.drawType = 'circle_filled'; if (R.lh()) { aN.bu.drawType = 'circle_filled_redact'; } } else { aN.bu.drawType = 'circle_trans'; if (R.lh()) { aN.bu.drawType = 'circle_trans_redact'; } } } } else { if (R.get_type() === IPCC.Web.UI.MarkType.Rectangle) { aN.bu.drawType = 'rectangle'; aN.bu.fillColor = qV; } else { aN.bu.drawType = 'circle'; aN.bu.fillColor = qV; } } aN.bu.dragDirection = 'br'; var h = R.get_rectangle(); aN.bu.x = h.x; aN.bu.y = h.y; aN.bu.x_percent = h.x / di; aN.bu.y_percent = h.y / cB; aN.bu.height_percent = h.height / cB; aN.bu.width_percent = h.width / di; aN.bu.height = h.height; aN.bu.width = h.width; break; case IPCC.Web.UI.MarkType.Line: case IPCC.Web.UI.MarkType.Polyline: aN.bu.lineWidth = R.get_lineWidth(); iq = true; break; case IPCC.Web.UI.MarkType.TextSelectionRedaction: aN.bu.highlightGroupID = R.cE; aN.bu.drawType = 'text_selection_redaction'; if (R.cl && R.cl.length > 0) { aN.bu.startIndex = R.bh; aN.bu.selectedText = R.cl; aN.bu.textLength = R.cg; } break; case IPCC.Web.UI.MarkType.Text: var mu = R.get_rectangle(); aN.bu.x = mu.x; aN.bu.y = mu.y; aN.bu.x_percent = mu.x / di; aN.bu.y_percent = mu.y / cB; aN.bu.height_percent = mu.height / cB; aN.bu.width_percent = mu.width / di; aN.bu.height = mu.height; aN.bu.width = mu.width; aN.bu.maxLength = R.get_maxLength(); hG = R.get_fillColor(); if (R.lh() === true) { aN.bu.drawType = 'text_redact'; } else { aN.bu.drawType = 'text'; aN.bu.opacity = R.get_opacity(); } if (hG === 'transparent') { aN.bu.fillColor = hG; } else if (hG) { kE = hG.replace(/#/, ""); aN.bu.fillColor = parseInt(kE, 16).toString(); } else { aN.bu.fillColor = '16776960'; } var bU = ''; bU = "<TEXTFORMAT LEADING=\"2\">"; switch (R.get_textHorizontalAlignment()) { case IPCC.Web.UI.HorizontalAlignment.Center: bU += "<P ALIGN=\"center\" "; break; case IPCC.Web.UI.HorizontalAlignment.Left: bU += "<P ALIGN=\"left\" "; break; case IPCC.Web.UI.HorizontalAlignment.Right: bU += "<P ALIGN=\"right\" "; break; } bU += ">"; bU += "<FONT "; tC = R.get_fontName(); bU += "FACE=" + "\"" + tC + "\" "; sL = R.get_fontSize().toString(); bU += "SIZE= \"" + sL + "\" "; iF = "\"" + R.get_textColor() + "\" "; bU += "COLOR=" + iF + " "; bU += "LETTERSPACING=\"0\" "; bU += "KERNING=\"0\" "; bU += ">"; var de = R.get_fontStyle(); if (de & IPCC.Web.UI.FontStyle.Bold) { bU += "<B>"; } if (de & IPCC.Web.UI.FontStyle.Italic) { bU += "<I>"; } if (de & IPCC.Web.UI.FontStyle.Underline) { bU += "<U>"; } if (de & IPCC.Web.UI.FontStyle.Strikeout) { bU += "<S>"; } az = R.get_text(); az = IPCC.J.rm(az); bU += az; if (de & IPCC.Web.UI.FontStyle.Strikeout) { bU += "</S>"; } if (de & IPCC.Web.UI.FontStyle.Underline) { bU += "</U>"; } if (de & IPCC.Web.UI.FontStyle.Italic) { bU += "</I>"; } if (de & IPCC.Web.UI.FontStyle.Bold) { bU += "</B>"; } bU += "</FONT>"; bU += "</P>"; bU += "</TEXTFORMAT>"; break; case IPCC.Web.UI.MarkType.Highlight: h = R.get_rectangle(); aN.bu.x = h.x; aN.bu.y = h.y; aN.bu.x_percent = h.x / di; aN.bu.y_percent = h.y / cB; aN.bu.height_percent = h.height / cB; aN.bu.width_percent = h.width / di; aN.bu.height = h.height; aN.bu.width = h.width; aN.bu.drawType = 'highlight'; aN.bu.highlightGroupID = R.cE; aN.bu.isHighlight = R.kz; hG = R.get_fillColor(); if (hG) { kE = hG.replace(/#/, ""); aN.bu.fillColor = parseInt(kE, 16).toString(); aN.bu.lineColor = parseInt(kE, 16).toString(); } else { aN.bu.fillColor = qV; } break; case IPCC.Web.UI.MarkType.TextHyperlinkAnnotation: h = R.get_rectangle(); aN.bu.x = h.x; aN.bu.y = h.y; aN.bu.height = h.height; aN.bu.width = h.width; aN.bu.drawType = 'text_hyperlink_annotation'; aN.bu.href = IPCC.J.rm(R.qY); aN.bu.startIndex = R.bh; aN.bu.selectedText = R.cl; aN.bu.textLength = R.cg; aN.bu.highlightGroupID = R.cE; aN.bu.isHighlight = R.kz; hG = R.get_fillColor(); if (hG) { kE = hG.replace(/#/, ""); aN.bu.fillColor = parseInt(kE, 16).toString(); aN.bu.lineColor = parseInt(kE, 16).toString(); } else { aN.bu.fillColor = qV; } aN.dO.push(Yn(R.bV, di, cB)); break; case IPCC.Web.UI.MarkType.HighlightText: h = R.get_rectangle(); aN.bu.x = h.x; aN.bu.y = h.y; aN.bu.x_percent = h.x / di; aN.bu.y_percent = h.y / cB; aN.bu.height_percent = h.height / cB; aN.bu.width_percent = h.width / di; aN.bu.height = h.height; aN.bu.width = h.width; aN.bu.drawType = 'highlightText'; aN.bu.startIndex = R.bh; aN.bu.selectedText = R.cl; aN.bu.textLength = R.cg; aN.bu.highlightGroupID = R.cE; aN.bu.isHighlight = R.kz; hG = R.get_fillColor(); if (hG) { kE = hG.replace(/#/, ""); aN.bu.fillColor = parseInt(kE, 16).toString(); aN.bu.lineColor = parseInt(kE, 16).toString(); } else { aN.bu.fillColor = qV; } aN.dO.push(Yn(R.bV, di, cB)); break; case IPCC.Web.UI.MarkType.RectangleRedaction: h = R.get_rectangle(); aN.bu.drawType = 'rectangle_filled_redact'; aN.bu.x = h.x; aN.bu.y = h.y; aN.bu.x_percent = h.x / di; aN.bu.y_percent = h.y / cB; aN.bu.height_percent = h.height / cB; aN.bu.width_percent = h.width / di; aN.bu.height = h.height; aN.bu.width = h.width; aN.bu.meta = IPCC.J.rm(R.get_text()); aN.bu.stampSize = R.get_fontSize(); aN.bu.lineWidth = R.get_lineWidth(); hG = R.get_fillColor(); if (hG) { kE = hG.replace(/#/, ""); aN.bu.fillColor = parseInt(kE, 16).toString(); } else { aN.bu.fillColor = qV; } LT = R.get_lineColor(); if (LT) { EG = LT.replace(/#/, ""); aN.bu.lineColor = parseInt(EG, 16).toString(); } else { aN.bu.lineColor = qV; } aaC = R.get_textColor(); if (aaC) { akk = aaC.replace(/#/, ""); aN.bu.fontColor = parseInt(akk, 16).toString(); } else { aN.bu.fontColor = qV; } if (R.cE) { aN.bu.highlightGroupID = R.cE; } break; case IPCC.Web.UI.MarkType.Stamp: hG = R.get_fillColor(); if (hG) { kE = hG.replace(/#/, ""); aN.bu.fillColor = parseInt(kE, 16).toString(); aN.bu.lineColor = parseInt(kE, 16).toString(); } else { aN.bu.fillColor = qV; } h = R.get_rectangle(); aN.bu.x = h.x; aN.bu.y = h.y; aN.bu.x_percent = h.x / di; aN.bu.y_percent = h.y / cB; aN.bu.height_percent = h.height / cB; aN.bu.width_percent = h.width / di; aN.bu.height = h.height; aN.bu.width = h.width; if (R.lh() === true) { aN.bu.drawType = 'stamp_redact'; } else { aN.bu.drawType = 'stamp'; } az = R.get_text(); aN.bu.stampSize = R.stampSize; aN.dO.push('<![CDATA[' + az + ']]>'); break; case IPCC.Web.UI.MarkType.Freehand: case IPCC.Web.UI.MarkType.SignaturePath: if (R.get_type() === IPCC.Web.UI.MarkType.Freehand) { aN.bu.drawType = 'freehand'; } else { aN.bu.drawType = 'signature_path'; switch (R.get_textHorizontalAlignment()) { case IPCC.Web.UI.HorizontalAlignment.Center: aN.bu.align = 'center'; break; case IPCC.Web.UI.HorizontalAlignment.Left: aN.bu.align = 'left'; break; case IPCC.Web.UI.HorizontalAlignment.Right: aN.bu.align = 'right'; break; } } bU = R.get_pathString(); aN.bu.pathWidth = R.get_pathWidth(); aN.bu.pathHeight = R.get_pathHeight(); h = R.get_rectangle(); aN.bu.x = h.x; aN.bu.y = h.y; aN.bu.x_percent = h.x / di; aN.bu.y_percent = h.y / cB; aN.bu.height_percent = h.height / cB; aN.bu.width_percent = h.width / di; aN.bu.height = h.height; aN.bu.width = h.width; break; case IPCC.Web.UI.MarkType.SignatureText: hG = R.get_fillColor(); var cK; if (hG) { kE = hG.replace(/#/, ""); aN.bu.fillColor = ""; aN.bu.lineColor = ""; cK = parseInt(kE, 16).toString(); } else { aN.bu.fillColor = ""; cK = qV; } h = R.get_rectangle(); aN.bu.x = h.x; aN.bu.y = h.y; aN.bu.x_percent = h.x / di; aN.bu.y_percent = h.y / cB; aN.bu.height_percent = h.height / cB; aN.bu.width_percent = h.width / di; aN.bu.height = h.height; aN.bu.width = h.width; aN.bu.opacity = 0; aN.bu.drawType = 'signature_text'; aN.bu.stampSize = R.stampSize; aN.bu.fontWidth = R.xj; aN.bu.fontHeight = R.yq; bU = ''; bU = "<TEXTFORMAT LEADING=\"2\">"; switch (R.get_textHorizontalAlignment()) { case IPCC.Web.UI.HorizontalAlignment.Center: bU += "<P ALIGN=\"center\" "; break; case IPCC.Web.UI.HorizontalAlignment.Left: bU += "<P ALIGN=\"left\" "; break; case IPCC.Web.UI.HorizontalAlignment.Right: bU += "<P ALIGN=\"right\" "; break; } bU += ">"; bU += "<FONT "; tC = R.get_fontName(); bU += "FACE=" + "\"" + tC + "\" "; sL = R.stampSize.toString(); bU += "SIZE= \"" + sL + "\" "; iF = "\"" + R.get_fillColor() + "\" "; bU += "COLOR=" + iF + " "; bU += "LETTERSPACING=\"0\" "; bU += "KERNING=\"0\" "; bU += ">"; az = IPCC.J.rm(R.get_text()); bU += az; bU += "</FONT>"; bU += "</P>"; bU += "</TEXTFORMAT>"; break; case IPCC.Web.UI.MarkType.TextAreaSignature: mu = R.get_rectangle(); aN.bu.x = mu.x; aN.bu.y = mu.y; aN.bu.x_percent = mu.x / di; aN.bu.y_percent = mu.y / cB; aN.bu.height_percent = mu.height / cB; aN.bu.width_percent = mu.width / di; aN.bu.height = mu.height; aN.bu.width = mu.width; aN.bu.maxLength = R.gU; aN.bu.maxFontSize = R.jA; if (wd) { aN.bu.drawType = 'text'; } else { aN.bu.drawType = 'text_area_signature'; } aN.bu.fillColor = 'transparent'; bU = ''; bU = "<TEXTFORMAT LEADING=\"2\">"; switch (R.get_textHorizontalAlignment()) { case IPCC.Web.UI.HorizontalAlignment.Center: bU += "<P ALIGN=\"center\" "; break; case IPCC.Web.UI.HorizontalAlignment.Left: bU += "<P ALIGN=\"left\" "; break; case IPCC.Web.UI.HorizontalAlignment.Right: bU += "<P ALIGN=\"right\" "; break; } bU += ">"; bU += "<FONT "; tC = R.get_fontName(); bU += "FACE=" + "\"" + tC + "\" "; sL = R.cd.toString(); bU += "SIZE= \"" + sL + "\" "; iF = "\"" + R.get_textColor() + "\" "; bU += "COLOR=" + iF + " "; bU += "LETTERSPACING=\"0\" "; bU += "KERNING=\"0\" "; bU += ">"; de = R.get_fontStyle(); if (de & IPCC.Web.UI.FontStyle.Bold) { bU += "<B>"; } if (de & IPCC.Web.UI.FontStyle.Italic) { bU += "<I>"; } if (de & IPCC.Web.UI.FontStyle.Underline) { bU += "<U>"; } if (de & IPCC.Web.UI.FontStyle.Strikeout) { bU += "<S>"; } az = R.get_text(); az = IPCC.J.rm(az); bU += az; if (de & IPCC.Web.UI.FontStyle.Strikeout) { bU += "</S>"; } if (de & IPCC.Web.UI.FontStyle.Underline) { bU += "</U>"; } if (de & IPCC.Web.UI.FontStyle.Italic) { bU += "</I>"; } if (de & IPCC.Web.UI.FontStyle.Bold) { bU += "</B>"; } bU += "</FONT>"; bU += "</P>"; bU += "</TEXTFORMAT>"; break; case IPCC.Web.UI.MarkType.TextLine: if (!wd) { h = R.get_rectangle(); aN.bu.x = h.x; aN.bu.y = h.y; aN.bu.x_percent = h.x / di; aN.bu.y_percent = h.y / cB; aN.bu.height_percent = h.height / cB; aN.bu.maxLength = R.get_maxLength(); aN.bu.width_percent = h.width / di; aN.bu.height = h.height; aN.bu.width = h.width; aN.bu.opacity = 0; aN.bu.drawType = 'text_input_signature'; aN.bu.stampSize = R.stampSize; aN.bu.fontWidth = R.xj; aN.bu.fontHeight = R.yq; bU = ''; bU = "<TEXTFORMAT LEADING=\"2\">"; switch (R.get_textHorizontalAlignment()) { case IPCC.Web.UI.HorizontalAlignment.Center: bU += "<P ALIGN=\"center\" "; break; case IPCC.Web.UI.HorizontalAlignment.Left: bU += "<P ALIGN=\"left\" "; break; case IPCC.Web.UI.HorizontalAlignment.Right: bU += "<P ALIGN=\"right\" "; break; } bU += ">"; bU += "<FONT "; tC = R.get_fontName(); bU += "FACE=" + "\"" + tC + "\" "; sL = R.stampSize.toString(); bU += "SIZE= \"" + sL + "\" "; iF = "\"" + R.get_textColor() + "\" "; bU += "COLOR=" + iF + " "; bU += "LETTERSPACING=\"0\" "; bU += "KERNING=\"0\" "; bU += ">"; az = IPCC.J.rm(R.get_text()); bU += az; bU += "</FONT>"; bU += "</P>"; bU += "</TEXTFORMAT>"; var ajD = aHZ(R.get_mask()); if (ajD) { aN.dO.push(ajD); } } else { h = R.get_rectangle(); var FY = R.stampSize; var ql; if (!R.Im || !R.ql) { var apL = IPCC.J.aeA(R.get_text(), R.get_fontName(), h.width, h.height, { wJ: "pre", cd: FY + "px" }); ql = apL; R.Im = true; R.ql = ql; } else { ql = R.ql; } FY = ql.fontSize; var ij = ql.width / h.width, bS = 1.0, MIN_BUFFER = 0.85; if (/mono/i.test(R.get_fontName())) { MIN_BUFFER = 0.75; } if (ij > MIN_BUFFER) { bS = MIN_BUFFER * h.width / ql.width; FY = FY * bS; } var aoC = h.width, avs = ql.height * bS, aoR = h.height - (h.height - avs) / 2, aoj = h.x, aof = h.y + (h.height - ql.height) / 2 + (ql.height * (1 - bS)); aN.bu.x = aoj; aN.bu.y = aof; aN.bu.x_percent = aoj / di; aN.bu.y_percent = aof / cB; aN.bu.height_percent = aoR / cB; aN.bu.width_percent = aoC / di; aN.bu.height = aoR; aN.bu.width = aoC; aN.bu.opacity = 0; aN.bu.drawType = 'text_redact'; bU = ''; bU = "<TEXTFORMAT>"; switch (R.get_textHorizontalAlignment()) { case IPCC.Web.UI.HorizontalAlignment.Center: bU += "<P ALIGN=\"center\" "; break; case IPCC.Web.UI.HorizontalAlignment.Left: bU += "<P ALIGN=\"left\" "; break; case IPCC.Web.UI.HorizontalAlignment.Right: bU += "<P ALIGN=\"right\" "; break; } bU += ">"; bU += "<FONT "; tC = R.get_fontName(); bU += "FACE=" + "\"" + tC + "\" "; if (R.alw) { sL = (FY / R.alw).toString(); } else { sL = FY.toString(); } bU += "SIZE= \"" + sL + "\" "; iF = "\"" + R.get_textColor() + "\" "; bU += "COLOR=" + iF + " "; bU += "LETTERSPACING=\"0\" "; bU += "KERNING=\"0\" "; bU += ">"; az = IPCC.J.rm(R.get_text()); bU += az; bU += "</FONT>"; bU += "</P>"; bU += "</TEXTFORMAT>"; } break; case IPCC.Web.UI.MarkType.ImageStampAnnotation: case IPCC.Web.UI.MarkType.ImageStampRedaction: aN.bu.drawType = (bi === IPCC.Web.UI.MarkType.ImageStampRedaction) ? 'imagestamp_redact' : 'imagestamp'; h = R.get_rectangle(); aN.bu.x = h.x; aN.bu.y = h.y; aN.bu.height = h.height; aN.bu.width = h.width; aN.bu.lineWidth = R.get_lineWidth(); aN.bu.x_percent = h.x / di; aN.bu.y_percent = h.y / cB; aN.bu.height_percent = h.height / cB; aN.bu.width_percent = h.width / di; aN.bu.imageStampId = R.sc; break; case IPCC.Web.UI.MarkType.Strikethrough: h = R.get_rectangle(); aN.bu.x = h.x; aN.bu.y = h.y; aN.bu.height = h.height; aN.bu.width = h.width; aN.bu.drawType = 'strikethrough'; aN.bu.startIndex = R.bh; aN.bu.selectedText = R.cl; aN.bu.textLength = R.cg; aN.bu.highlightGroupID = R.cE; aN.bu.isHighlight = R.kz; aN.dO.push(Yn(R.bV, di, cB)); break; } if (iq) { aN.bu.lineWidth = R.get_lineWidth(); var ai = R.get_boundingRectangle(); aN.bu.x = ai.x; aN.bu.y = ai.y; aN.bu.x_percent = ai.x / di; aN.bu.y_percent = ai.y / cB; aN.bu.height_percent = ai.height / cB; aN.bu.width_percent = ai.width / di; aN.bu.height = ai.height; aN.bu.width = ai.width; if (bi === IPCC.Web.UI.MarkType.Line) { if (R.get_endHeadType() === IPCC.Web.UI.LineHeadType.None) { aN.bu.drawType = 'line'; } else { aN.bu.drawType = 'arrow'; } } else { aN.bu.drawType = 'polyline'; } aN.bu.lineWidth = R.get_lineWidth(); var ag = R.get_points(); if (bi === IPCC.Web.UI.MarkType.Line) { if ((ag.getPoint(0).x < ag.getPoint(1).x) && (ag.getPoint(0).y > ag.getPoint(1).y)) { aN.bu.dragDirection = 'tr'; } else if ((ag.getPoint(0).x > ag.getPoint(1).x) && (ag.getPoint(0).y > ag.getPoint(1).y)) { aN.bu.dragDirection = 'tl'; } else if ((ag.getPoint(0).x > ag.getPoint(1).x) && (ag.getPoint(0).y < ag.getPoint(1).y)) { aN.bu.dragDirection = 'bl'; } else if ((ag.getPoint(0).x < ag.getPoint(1).x) && (ag.getPoint(0).y < ag.getPoint(1).y)) { aN.bu.dragDirection = 'br'; } else { aN.bu.dragDirection = 'br'; } } else { var Aa = []; var dg = ag.get_length(), be; if (dg > 1) { for (var aj = 0; aj < ag.get_length() ; aj++) { be = ag.getPoint(aj); Aa.push({ x: be.x, y: be.y }); } bU = IPCC.ct.YU(Aa); } } if (EG) { aN.bu.fillColor = EG; } else { aN.bu.fillColor = ""; } } else { aN.bu.lineWidth = R.get_lineWidth(); aN.bu.dragDirection = 'br'; } if (R.get_type() !== IPCC.Web.UI.MarkType.RectangleRedaction) { aN.bu.meta = ''; } aN.bu.label = ''; var eY = new Date(); aN.bu.saveDate = IPCC.J.aGK(eY); aN.bu.saveTime = IPCC.J.aGX(eY); aN.bu.uuid = ''; aN.bu.formUser = ''; aN.bu.created = IPCC.J.aew(R.get_dateCreated()); aN.bu.modified = IPCC.J.aew(R.get_dateModified()); if (R.get_type() === IPCC.Web.UI.MarkType.Text || R.get_type() === IPCC.Web.UI.MarkType.Freehand || R.get_type() === IPCC.Web.UI.MarkType.SignaturePath || R.get_type() === IPCC.Web.UI.MarkType.SignatureText || R.get_type() === IPCC.Web.UI.MarkType.Polyline || R.get_type() === IPCC.Web.UI.MarkType.TextAreaSignature || R.get_type() === IPCC.Web.UI.MarkType.TextLine) { aN.dO.push('<![CDATA[' + bU + ']]>'); } else { aN.dO.push(''); } return aN; }; this.azJ = function (bp, di, cB, aH) { var jL = { fZ: 'documentAnnotations', dO: [], bu: {} }; var dP = { fZ: 'pages', dO: [], bu: {} }; jL.dO.push(dP); var mO = { fZ: 'highlights', dO: [], bu: {} }; jL.dO.push(mO); var vC = {}, tk = []; var bI = { fZ: 'page', dO: [], bu: { id: (bp + 1).toString(), pageWidth: di, pageHeight: cB } }; dP.dO.push(bI); aH = aH || {}; var afF = (aH.includeAnnotations !== undefined) ? ! !aH.includeAnnotations : true, afj = (aH.includeRedactions !== undefined) ? ! !aH.includeRedactions : true, aeg = (aH.includeSignatures !== undefined) ? ! !aH.includeSignatures : false, wd = (aH.wd !== undefined) ? ! !aH.wd : false, WJ = (aH.Dh !== undefined) ? aH.Dh : false, avJ = ! !wd, amo = WJ ? WJ : bN; for (var G = 0; G < amo.length; G++) { var R = amo[G]; var bi = R.get_type(); if (R.get_type() === IPCC.Web.UI.MarkType.Highlight) { continue; } if (avJ && !R.get_visible()) { continue; } if (!WJ) { if (afF === false && afj === false && aeg === false) { break; } if (afF === false) { if (bi === IPCC.Web.UI.MarkType.Rectangle || bi === IPCC.Web.UI.MarkType.Ellipse || bi === IPCC.Web.UI.MarkType.Line || bi === IPCC.Web.UI.MarkType.Text || bi === IPCC.Web.UI.MarkType.Stamp || bi === IPCC.Web.UI.MarkType.Highlight || bi === IPCC.Web.UI.MarkType.Strikethrough || bi === IPCC.Web.UI.MarkType.HighlightText || bi === IPCC.Web.UI.MarkType.TextHyperlinkAnnotation || bi === IPCC.Web.UI.MarkType.Freehand || bi === IPCC.Web.UI.MarkType.ImageStampAnnotation || bi === IPCC.Web.UI.MarkType.Polyline) { if (R.lh() === false) { continue; } } } if (afj === false) { if (R.lh() === true) { continue; } if (bi === IPCC.Web.UI.MarkType.RectangleRedaction || bi === IPCC.Web.UI.MarkType.TextSelectionRedaction || bi === IPCC.Web.UI.MarkType.ImageStampRedaction) { continue; } } if (aeg === false) { if (bi === IPCC.Web.UI.MarkType.SignaturePath || bi === IPCC.Web.UI.MarkType.SignatureText || bi === IPCC.Web.UI.MarkType.SignatureImage || bi === IPCC.Web.UI.MarkType.TextAreaSignature || bi === IPCC.Web.UI.MarkType.TextLine) { continue; } } } switch (bi) { case IPCC.Web.UI.MarkType.ImageStampAnnotation: case IPCC.Web.UI.MarkType.ImageStampRedaction: vC[R.sc] = { fZ: 'stampImage', dO: [], bu: { imageStampId: R.sc, base64format: R.cX() } }; break; } bI.dO.push(this.aFR(R, di, cB, wd)); } for (var Hh in vC) { if (vC.hasOwnProperty(Hh)) { tk.push(vC[Hh]); } } return { jL: jL, tk: tk }; }; this.azg = function () { var fM = { m: [] }; var G; for (G = 0; G < bN.length; G++) { fM.m.push(bN[G].azd()); } K.aM('marksSaved', {}); var aoW = ""; aoW = IPCC.ct.YU(fM); return aoW; }; this.yd = function (V) { bC.addHandler('markAdded', V); }; this.zu = function (V) { bC.removeHandler('markAdded', V); }; this.Fb = function (V) { bC.addHandler('markChanged', V); }; this.Gb = function (V) { bC.removeHandler('markChanged', V); }; this.yp = function (V) { bC.addHandler('markRemoved', V); }; this.zp = function (V) { bC.removeHandler('markRemoved', V); }; this.EY = function (V) { bC.addHandler('markReordered', V); }; this.Fu = function (V) { bC.removeHandler('markReordered', V); }; this.Qf = function (V) { bC.addHandler('marksLoaded', V); }; this.TW = function (V) { bC.removeHandler('marksLoaded', V); }; this.aGe = function (V) { bC.addHandler('marksSaved', V); }; this.aCu = function (V) { bC.removeHandler('marksSaved', V); }; this.EJ = function (V) { bC.addHandler('markSelectionChanged', V); }; this.EO = function (V) { bC.removeHandler('markSelectionChanged', V); }; this.JU = function (V) { bC.addHandler('markTextSelectionChanged', V); }; this.Ig = function (V) { bC.removeHandler('markTextSelectionChanged', V); }; this.xy = function (V) { bC.addHandler('commentAdded', V); }; this.FN = function (V) { bC.removeHandler('commentAdded', V); }; this.xP = function (V) { bC.addHandler('commentRemoved', V); }; this.DM = function (V) { bC.removeHandler('commentRemoved', V); }; this.vW = function (V) { bC.addHandler('commentChanged', V); }; this.vp = function (V) { bC.removeHandler('commentChanged', V); }; this.lg = function (V) { bC.addHandler('propertyChanged', V); }; this.nt = function (V) { bC.removeHandler('propertyChanged', V); }; this.aM = function (cA, L) { var V = bC.getHandler(cA); if (V !== null) { V(this, L); } }; this.aL = function (cr) { var V = bC.getHandler("propertyChanged"); if (V) { V(this, new IPCC.qP(cr)); } }; return this; }; IPCC.Web.UI.ArtPage.prototype = { get_markCount: function () { return this.acE(); }, get_selectedMarks: function () { return this.Bl(); }, toString: function () { return 'ArtPage with ' + this.get_markCount() + ' marks'; }, addMark: function (mark, mouseLocation) { this.MG(mark, mouseLocation); }, forEachMark: function (method, context) { this.FJ(method, context); }, getMark: function (zIndex) { return this.Rj(zIndex); }, getZIndexOfMark: function (mark) { return this.qW(mark); }, loadFromJson: function (json) { this.asT(json); }, removeAllMarks: function () { this.WD(); }, removeMark: function (mark) { this.vA(mark); }, reorderMark: function (mark, zIndex) { this.aeM(mark, zIndex); }, saveToJson: function () { return this.azg(); }, add_markAdded: function (handler) { this.yd(handler); }, remove_markAdded: function (handler) { this.zu(handler); }, add_markChanged: function (handler) { this.Fb(handler); }, remove_markChanged: function (handler) { this.Gb(handler); }, add_markRemoved: function (handler) { this.yp(handler); }, remove_markRemoved: function (handler) { this.zp(handler); }, add_markReordered: function (handler) { this.EY(handler); }, remove_markReordered: function (handler) { this.Fu(handler); }, add_marksLoaded: function (handler) { this.Qf(handler); }, remove_marksLoaded: function (handler) { this.TW(handler); }, add_markSelectionChanged: function (handler) { this.EJ(handler); }, remove_markSelectionChanged: function (handler) { this.EO(handler); }, add_markTextSelectionChanged: function (handler) { this.JU(handler); }, remove_markTextSelectionChanged: function (handler) { this.Ig(handler); }, add_commentAdded: function (handler) { this.xy(handler); }, remove_commentAdded: function (handler) { this.FN(handler); }, add_commentRemoved: function (handler) { this.xP(handler); }, remove_commentRemoved: function (handler) { this.DM(handler); }, add_commentChanged: function (handler) { this.vW(handler); }, remove_commentChanged: function (handler) { this.vp(handler); } }; IPCC.Web.UI.ArtPage.registerClass = IPCC.Web.regClass; IPCC.Web.UI.ArtPage.registerClass('IPCC.Web.UI.ArtPage'); IPCC.Web.UI.aDk = function () { this.fZ = undefined; this.dO = []; this.bu = {}; }; IPCC.Oa = function () { }; IPCC.Oa.prototype.nR = function (C) { this.C = C; this.bm = C.bG(); this.ia = this.bm.get_cursor(); this.bm.set_cursor(IPCC.bP.RunMarks); this.bm.FU(IPCC.bP.Link); }; IPCC.Oa.prototype.ec = function () { this.bm.set_cursor(this.ia); this.bm.FU(IPCC.bP.Default); this.C = false; }; IPCC.Oa.prototype.aV = function () { }; IPCC.oB = function () { this.aR = false; this.C = false; }; IPCC.oB.prototype.nR = function (C) { this.C = C; this.C.afw(true); this.bm = C.bG(); this.ia = this.bm.get_cursor(); this.bm.set_cursor(IPCC.bP.EditMarks); this.bm.FU(IPCC.bP.Move); }; IPCC.oB.prototype.ec = function () { this.bm.set_cursor(this.ia); this.bm.FU(IPCC.bP.Default); if (arguments[0]) { if (arguments[0] === true) { this.C = false; return; } } this.C.afw(false); this.C = false; }; IPCC.oB.prototype.aV = function () { if (this.aR) { this.bm.set_cursor(IPCC.bP.EditMarks); this.bm.FU(IPCC.bP.Move); this.C.Gf(true); this.bm.ny(); this.aR = false; this.C.cn(); } }; IPCC.oB.prototype.vS = function (L) { this.aV(); var R = L.mark; if (R && R.jd() === IPCC.Web.UI.MarkType.Text) { this.C.xh(R); this.C.cn(); } }; IPCC.oB.prototype.jO = function (L) { this.aV(); var lj = L.domEvent; if (lj.button === 0) { var cD = lj.target; this.cG = cD.ImGearMarkHandle; if (this.cG) { this.wM = this.cG.aa; this.oH = this.cG.ak; } else { this.wM = null; this.oH = null; } while (!(cD.ImGearMarkRelation) && cD.parentNode && cD !== document.body) { cD = cD.parentNode; } this.T = cD.ImGearMarkRelation; if (this.T) { this.R = this.T.R; } else { this.R = null; } this.aR = true; this.Ta = L.imagePoint; this.Df = L.imagePoint; var R = this.R; if (!R || R.get_interactionMode() === IPCC.Web.UI.MarkInteractionMode.SelectionDisabled) { if (!lj.shiftKey) { this.C.eI().Bl().removeAllMarks(); } this.bm.DO(L.imagePoint); } else { var gj, h; switch (this.wM) { case IPCC.dv.bn.prototype.XU: this.iL = R.fD(); this.acY = Math.abs(this.iL.width); this.JH = Math.abs(this.iL.height); gj = { x: this.iL.x, y: this.iL.y }; this.TC = { x: this.iL.x + this.iL.width, y: this.iL.y + this.iL.height }; if (this.oH > 0 && this.oH < 3) { gj.x += this.iL.width; this.TC.x -= this.iL.width; } if (this.oH > 1) { gj.y += this.iL.height; this.TC.y -= this.iL.height; } this.aHS = gj; break; case IPCC.dv.bn.prototype.Xw: h = R.fD(); this.iL = h; gj = { x: h.x + h.width / 2, y: h.y + h.height / 2 }; switch (this.oH) { case 0: this.Dk = h.y + h.height; gj.y = h.y; break; case 1: this.Dk = h.x; gj.x = h.x + h.width; break; case 2: this.Dk = h.y; gj.y = h.y + h.height; break; case 3: this.Dk = h.x + h.width; gj.x = h.x; break; } break; case IPCC.dv.bn.prototype.Kc: this.ag = R.pu(); if (this.oH < 0 || this.oH > this.ag.fb()) { this.aV(); } gj = this.ag.getPoint(this.oH); break; case IPCC.dv.bn.prototype.Hl: break; case IPCC.dv.bn.prototype.abq: h = R.fD(); gj = { x: h.x + R.pj.x, y: h.y + R.pj.y }; break; default: var yc = R.get_selected(); if (lj.ctrlKey || lj.shiftKey) { yc = !yc; R.set_selected(yc); } else { if (!yc) { yc = true; this.C.eI().Bl().removeAllMarks(); if (R.get_type() === IPCC.Web.UI.MarkType.Highlight) { for (var G = 0; G < this.C.eI().get_markCount() ; G++) { var Wt = this.C.eI().getMark(G); if (Wt.jd() === 608 && Wt.cE === R.cE) { Wt.set_selected(yc); } } } else { R.set_selected(yc); } } } if (!yc) { this.aV(); } break; } if (this.aR && gj) { this.avV = gj.x - this.Ta.x; this.avS = gj.y - this.Ta.y; if (this.cG) { this.bm.set_cursor(this.cG.cP); this.bm.FU(this.cG.cP); } } } if (this.aR) { this.C.Gf(false); } } this.C.cn(); }; IPCC.oB.prototype.lp = function (L) { var lj = L.domEvent; var Df; function aEa(azC) { azC.HK(L.imagePoint.x - Df.x, L.imagePoint.y - Df.y); }; if (lj.button !== 0) { this.aV(); } if (this.aR) { var R = this.R; if (!R || R.get_interactionMode() === IPCC.Web.UI.MarkInteractionMode.SelectionDisabled) { this.bm.Ei(L.imagePoint); } else { var gj = { x: L.imagePoint.x + this.avV, y: L.imagePoint.y + this.avS }; var h; switch (this.wM) { case IPCC.dv.bn.prototype.XU: var rW = { x: gj.x, y: gj.y }; var ng = { x: this.TC.x, y: this.TC.y }; if (lj.ctrlKey) { ng.x = this.iL.x + this.iL.width / 2; ng.y = this.iL.y + this.iL.height / 2; } if (lj.shiftKey) { var uT = Math.abs(rW.x - ng.x); var ve = Math.abs(rW.y - ng.y); if (uT * this.JH < ve * this.acY) { if (this.JH > 0.001) { uT = ve * this.acY / this.JH; } } else { if (this.JH > 0.001) { ve = uT * this.JH / this.acY; } } if (rW.x < ng.x) { uT = -uT; } if (rW.y < ng.y) { ve = -ve; } rW.x = ng.x + uT; rW.y = ng.y + ve; } if (lj.ctrlKey) { ng = { x: ng.x - (rW.x - ng.x), y: ng.y - (rW.y - ng.y) }; } h = {}; h.x = Math.min(ng.x, rW.x); h.width = Math.max(ng.x, rW.x) - h.x; h.y = Math.min(ng.y, rW.y); h.height = Math.max(ng.y, rW.y) - h.y; R.set_rectangle(h); break; case IPCC.dv.bn.prototype.Xw: h = R.fD(); var Dm; if (this.oH & 1) { if (lj.ctrlKey) { Dm = this.iL.x + this.iL.width / 2; h.width = Math.abs(gj.x - Dm) * 2; h.x = Dm - h.width / 2; } else { h.x = Math.min(gj.x, this.Dk); h.width = Math.max(gj.x, this.Dk) - h.x; } } else { if (lj.ctrlKey) { Dm = this.iL.y + this.iL.height / 2; h.height = Math.abs(gj.y - Dm) * 2; h.y = Dm - h.height / 2; } else { h.y = Math.min(gj.y, this.Dk); h.height = Math.max(gj.y, this.Dk) - h.y; } } R.set_rectangle(h); break; case IPCC.dv.bn.prototype.Kc: this.ag = R.pu(); gj = this.ag.setPoint(this.oH, gj); break; case IPCC.dv.bn.prototype.Hl: break; case IPCC.dv.bn.prototype.abq: h = R.fD(); R.set_calloutPoint({ x: gj.x - h.x, y: gj.y - h.y }); break; default: Df = this.Df; this.Df = L.imagePoint; this.C.eI().Bl().mR(aEa); break; } } this.C.cn(); } }; IPCC.oB.prototype.iB = function () { function azB(R) { var KZ = R.akt(); if (adG.contains(KZ) && adG.contains({ x: KZ.x + KZ.width, y: KZ.y + KZ.height })) { R.set_selected(true); } }; if (this.aR) { if (!this.R) { var adG = this.bm.xf(); this.C.eI().FJ(azB); this.bm.ny(); } this.aV(); } }; IPCC.oB.prototype.qE = function (L) { var aU = this.C.ff(); if (L.windowPoint.x <= 0 || L.windowPoint.x >= aU.width - 2) { this.aV(); } if (L.windowPoint.y <= 0 || L.windowPoint.y >= aU.height - 2) { this.aV(); } }; IPCC.oB.prototype.lY = function () { this.aV(); }; IPCC.Web.UI.Comment = function (text) { var bC = new IPCC.Web.UI.fR(); var dc = new IPCC.Web.UI.Data(); this.abN = IPCC.J.zO(new Date()); this.az = text; this.aFY = function (az) { if (az === this.az) { return; } this.az = az; var L = new IPCC.Web.UI.CommentEventArgs(); L.comment = this; L.length = 1; this.aM('commentChanged', L); }; this.aGD = function () { return this.az; }; this.aGT = function (azo) { this.abN = azo; }; this.arO = function () { return this.abN; }; this.vW = function (V) { bC.addHandler('commentChanged', V); }; this.vp = function (V) { bC.removeHandler('commentChanged', V); }; this.aM = function (cA, L) { var V = bC.getHandler(cA); if (V !== null) { V(this, L); } }; this.yF = function () { return dc; }; return this; }; IPCC.Web.UI.Comment.prototype = { toString: function () { return 'Comment(' + this.creationTime + ', ' + this.text + ')'; }, add_commentChanged: function (handler) { this.vW(handler); }, remove_commentChanged: function (handler) { this.vp(handler); }, get_text: function () { return this.aGD(); }, set_text: function (text) { this.aFY(text); }, get_creationTime: function () { return this.arO(); }, set_creationTime: function (isoTimeString) { this.aGT(isoTimeString); }, get_data: function () { return this.yF(); } }; IPCC.Web.UI.Comment.registerClass = IPCC.Web.regClass; IPCC.Web.UI.Comment.registerClass('IPCC.Web.UI.Comment'); IPCC.Web.UI.Conversation = function (awo) { var hd = []; var bC = new IPCC.Web.UI.fR(); var dc = new IPCC.Web.UI.Data(); var R = awo; var K = this; function PL(aB, L) { K.aM('commentChanged', L); }; this.Ju = function (cC) { cC.add_commentChanged(PL); hd.push(cC); var L = new IPCC.Web.UI.CommentEventArgs(); L.comment = cC; L.length = 1; L.index = hd.length - 1; this.aM('commentAdded', L); }; this.aEM = function (cC) { var ZW = -1; IPCC.J.forEach(hd, function (el, idx) { if (el === cC) { ZW = idx; } }); if (ZW === -1) { throw new IPCC.Web.UI.ImGearArgumentException('comment', "The provided comment was not found in the conversation."); } var aeP = hd.splice(ZW, 1)[0]; aeP.vp(PL); var L = new IPCC.Web.UI.CommentEventArgs(); L.comment = aeP; L.length = 1; this.aM('commentRemoved', L); }; this.mR = function (kg, ca) { var G; for (G = 0; G < hd.length; G++) { kg.call(ca, hd[G], G, this); } }; this.fb = function () { return hd.length; }; this.xy = function (V) { bC.addHandler('commentAdded', V); }; this.FN = function (V) { bC.removeHandler('commentAdded', V); }; this.vW = function (V) { bC.addHandler('commentChanged', V); }; this.vp = function (V) { bC.removeHandler('commentChanged', V); }; this.xP = function (V) { bC.addHandler('commentRemoved', V); }; this.DM = function (V) { bC.removeHandler('commentRemoved', V); }; this.yF = function () { return dc; }; this.Ry = function () { return R; }; this.aM = function (cA, L) { var V = bC.getHandler(cA); if (V !== null) { V(this, L); } }; return this; }; IPCC.Web.UI.Conversation.prototype = { toString: function () { return 'Conversation with ' + this.get_length() + ' comments'; }, addComment: function (comment) { this.Ju(comment); }, removeCommentInstance: function (comment) { this.aEM(comment); }, forEach: function (method, context) { this.mR(method, context); }, get_length: function () { return this.fb(); }, add_commentAdded: function (handler) { this.xy(handler); }, remove_commentAdded: function (handler) { this.FN(handler); }, add_commentChanged: function (handler) { this.vW(handler); }, remove_commentChanged: function (handler) { this.vp(handler); }, add_commentRemoved: function (handler) { this.xP(handler); }, remove_commentRemoved: function (handler) { this.DM(handler); }, get_data: function () { return this.yF(); }, get_mark: function () { return this.Ry(); } }; IPCC.Web.UI.Conversation.registerClass = IPCC.Web.regClass; IPCC.Web.UI.Conversation.registerClass('IPCC.Web.UI.Conversation'); IPCC.Web.UI.Data = function () { this.dc = {}; this.yF = function (key) { if (typeof key === 'undefined') { return IPCC.J.extend({}, this.dc); } else if (typeof key === 'string') { return this.dc[key]; } else { throw new IPCC.Web.UI.ImGearArgumentException("key", "The argument must be a string."); } }; this.aFf = function (key, value) { if (typeof key !== 'string') { throw new IPCC.Web.UI.ImGearArgumentException("key", "The argument must be a string."); } if (typeof value === 'string') { this.dc[key] = value; } else if (typeof value === 'undefined') { delete this.dc[key]; } else { throw new IPCC.Web.UI.ImGearArgumentException("value", "The argument must be a string."); } return this; }; this.arC = function () { var keys = []; IPCC.J.forEach(this.dc, function (value, key) { keys.push(key); }); return keys; }; return this; }; IPCC.Web.UI.Data.prototype = { toString: function () { return 'Data(' + this.creationTime + ', ' + this.text + ')'; }, get_data: function (key) { return this.yF(key); }, set_data: function (key, value) { return this.aFf(key, value); }, get_dataKeys: function () { return this.arC(); } }; IPCC.Web.UI.Data.registerClass = IPCC.Web.regClass; IPCC.Web.UI.Data.registerClass('IPCC.Web.UI.Data'); IPCC.dv = {}; IPCC.Iy = function (C) { var aO = this; this.anq = 'filter'; this.amO = function (dI) { return 'progid:DXImageTransform.Microsoft.Alpha(opacity=' + Math.round(dI * 100) + ');'; }; this.Yg = true; this.UN = function (aQ, cw, mq, bb, lG, mp) { if (aQ.IB) { aQ.sA.afD(cw, mq, bb, aQ.kk); } }; this.aeh = function () { }; this.anO(C); this.akz = function (aW) { return new IPCC.EB(aW.clientWidth, aW.clientHeight, window.screen.deviceXDPI, window.screen.deviceYDPI); }; this.abX = function (bJ) { aO.jO(bJ); }; this.amv = function (bJ) { aO.vS(bJ); }; this.adl = function (bJ) { aO.lp(bJ); }; this.GW = function (bJ) { aO.lY(bJ); }; this.adk = function (bJ) { aO.iB(bJ); }; this.Wy = function (bJ) { bJ.returnValue = false; aO.jO(bJ); }; this.WF = function (bJ) { bJ.returnValue = false; aO.lp(bJ); }; this.XH = function (bJ) { bJ.returnValue = false; aO.iB(bJ); }; this.aag = function (bJ) { aO.Ok(bJ); }; this.Nn = function (bJ) { if (bJ.target !== document.activeElement) { aO.aph(bJ); } }; this.VN = function (bJ) { if (bJ.target !== document.activeElement) { aO.anK(bJ); } }; this.alX = function () { var ew = C.le().igElements.nd; IPCC.Web.UI.al.addHandler(ew, "mousewheel", this.GW); IPCC.Web.UI.al.addHandler(ew, "dblclick", this.amv); }; this.ajs = function () { var ew = C.le().igElements.nd; IPCC.Web.UI.al.removeHandler(ew, "mousewheel", this.GW); IPCC.Web.UI.al.removeHandler(ew, "dblclick", this.amv); }; this.akf = function (aQ, gc, qo, yu) { var G, as, aW; for (G = 0; G < qo.et.length; G++) { as = qo.et[G]; aW = document.createElement('div'); as.pool.parentElementID = yu + G.toString(); aW.id = as.pool.parentElementID; aW.style.width = '0px'; aW.style.height = '0px'; aW.setAttribute('tabindex', '-1'); gc.appendChild(aW); } }; this.aqU = function (fh) { var QZ = this.abS(); var Gm = fh.pool; var gc = document.getElementById(Gm.parentElementID); var aW; aW = document.createElement('img'); aW.id = QZ; if (C.bG().get_presentationQuality() > 49) { aW.style.msInterpolationMode = 'bicubic'; } else { aW.style.msInterpolationMode = 'nearest-neighbor'; } aW.style.position = 'absolute'; aW.style.display = 'none'; aW.setAttribute('tabindex', '-1'); aW.setAttribute('hidefocus', 'true'); gc.appendChild(aW); fh.elementID = QZ; aW.poolItem = fh; }; this.adV = function (fh) { var aW = document.getElementById(fh.elementID); this.sQ(aW.style, 'display', 'none'); }; this.acX = function (fh) { var aW = document.getElementById(fh.elementID); if (aW === null) { fh.elementID = ''; return; } aW.src = ''; aW.parentElement.removeChild(aW); fh.elementID = ''; }; var Ic = function (bJ) { try { IPCC.Web.UI.al.removeHandler(bJ.target, 'load', Ic); bJ.target.onabort = null; bJ.target.onerror = null; var fh = bJ.target.poolItem; fh.loaded = true; aO.zv(); } catch (ex) { C.bK('downloadImage', ex); var dz = new IPCC.Web.UI.ImGearPageOpenFailedEventArgs(); dz.exception = ex; dz.pageNumber = C.aD; C.aM('pageOpenFailed', dz); } }; var auF = function () { try { var bJ = window.event; IPCC.Web.UI.al.removeHandler(bJ.srcElement, 'load', Ic); bJ.srcElement.onabort = null; bJ.srcElement.onerror = null; var fh = bJ.srcElement.poolItem; fh.loaded = false; var bX = 'An image download was aborted by the user'; if (typeof (C.le) === 'function') { bX += 'Div Id = ' + C.le().id; } throw new IPCC.Web.UI.ImGearException(bX, { name: 'IPCC.Web.UI.ImGearHttpException' }); } catch (ex) { C.bK('downloadImage', ex); var dz = new IPCC.Web.UI.ImGearPageOpenFailedEventArgs(); dz.exception = ex; dz.pageNumber = C.aD; C.aM('pageOpenFailed', dz); } }; var auK = function () { try { var bJ = window.event; IPCC.Web.UI.al.removeHandler(bJ.srcElement, 'load', Ic); bJ.srcElement.onabort = null; bJ.srcElement.onerror = null; var fh = bJ.srcElement.poolItem; fh.loaded = false; var bX = 'An image failed to load. Error status '; if (typeof (C.le) === 'function') { bX += 'Div Id = ' + C.le().id; } throw new IPCC.Web.UI.ImGearException(bX, { name: 'IPCC.Web.UI.ImGearHttpException' }); } catch (ex) { C.bK('downloadImage', ex); var dz = new IPCC.Web.UI.ImGearPageOpenFailedEventArgs(); dz.exception = ex; dz.pageNumber = C.aD; C.aM('pageOpenFailed', dz); } }; this.Ui = function (aW, am, sB) { var pq = true; var mn = 0; if (C.hT() === 0) { pq = false; } function fa(bF) { var dz; try { var bM, cT; if (bF.status === 200) { bM = null; try { var lV = bF.getResponseHeader("Accusoft-Data-Encrypted"); if (lV === 'true') { var sf = IPCC.Web.hm.nC.te(bF.getResponseHeader("Accusoft-Data-SK")); var aq = IPCC.Web.Hw(sf, hw); var fw = IPCC.Web.Hg(bF); var vb = IPCC.Web.AB(fw, aq, hw); var Mg = IPCC.Web.hm.nC.nh(vb, 0, 0); aW.setAttribute('src', 'data:' + sB + ';base64,' + Mg); } else { aW.setAttribute('src', am); } } catch (ex) { cT = "Image error, Error message = " + ex.message; dz = new IPCC.Web.UI.ImGearPageOpenFailedEventArgs(); dz.exception = ex; dz.pageNumber = C.aD; C.aM('pageOpenFailed', dz); throw new IPCC.Web.UI.ImGearArgumentException(null, cT); } } } catch (e) { C.bK('openPage', e); if (typeof (C.aM) === 'function') { dz = new IPCC.Web.UI.ImGearPageOpenFailedEventArgs(); dz.exception = e; dz.pageNumber = C.aD; C.aM('pageOpenFailed', dz); } } }; function eZ(bM) { var fS = bM.response.status, ly, kA, cT, dz; try { if (!bM.response) { throw new IPCC.Web.UI.ImGearHttpException(fS, "Client Image load timeout"); } if (fS === 403) { mn++; if (bM.response.statusText && bM.response.statusText !== "") { cT = "Expired viewer session ID, error message from the server: " + bM.response.statusText; } else { cT = "Expired viewer session ID. No error text message was received from the server:"; } throw new IPCC.Web.UI.ImGearHttpException(fS, cT); } ly = bM.response.getResponseHeader('Accusoft-Status-Message'); if (ly) { var pr; kA = bM.response.getResponseHeader('Accusoft-Status-Number'); if (IPCC.Web.vo(kA)) { pr = parseInt(kA, 10); } throw new IPCC.Web.UI.ImGearHttpException(fS, ly, pr); } else { if (bM.response.statusText && bM.response.statusText !== "") { cT = bM.response.statusText; } else { cT = "HTTP Error was received from the image server but the server did not provide any error description."; } throw new IPCC.Web.UI.ImGearHttpException(fS, cT); } } catch (e) { C.bK('openPage', e); if (typeof (C.aM) === 'function') { dz = new IPCC.Web.UI.ImGearPageOpenFailedEventArgs(); dz.exception = e; dz.pageNumber = C.aD; C.aM('pageOpenFailed', dz); } } }; var hc = { method: 'GET' }; if (C.adt() && C.eG() === true) { var hw = IPCC.Web.qS.Ow(4); var nK = IPCC.Web.hm.Fr.nh(hw); var abI = am + '&iv=' + nK; hc.url = abI; } else { hc.url = am; } if (pq === true) { hc.timeout = C.hT(); } IPCC.J.mt.dZ(hc).then(fa, eZ); }; this.ark = function (kG) { var G; for (G = 0; G < kG.length; G++) { var aW = document.getElementById(kG[G].poolItem.elementID); aW.style.visibility = 'hidden'; IPCC.Web.UI.al.addHandler(aW, 'load', Ic); aW.onabort = auF; aW.onerror = auK; if (C.adt() && C.eG() === true) { this.Ui(aW, kG[G].url, 'image/png'); } else { aW.setAttribute('src', kG[G].url); } } }; this.Zn = function (hu, awr, Xz, vO) { var mQ = document.getElementById(hu.poolItem.elementID); if (Xz) { this.sQ(mQ, 'width', Math.round(vO.height)); this.sQ(mQ, 'height', Math.round(vO.width)); } else { this.sQ(mQ, 'width', Math.round(vO.width)); this.sQ(mQ, 'height', Math.round(vO.height)); } this.sQ(mQ.style, 'left', vO.x.toString()); this.sQ(mQ.style, 'top', vO.y.toString()); this.sQ(mQ.style, 'filter', awr); this.sQ(mQ.style, 'visibility', 'visible'); this.sQ(mQ.style, 'display', 'block'); }; this.Zk = function (kG, dI, cw) { var G; if (kG.length < 1) { return; } var EV = ''; if (dI < 1) { EV = 'progid:DXImageTransform.Microsoft.Alpha(opacity=' + Math.round(dI * 100).toString() + ')'; } var fv = cw.clone(); var BN = 1 / kG[0].level.bS; var GT = IPCC.ef(BN, 0, 0, BN, 0, 0); fv.BZ(GT); var nN = fv.Ki(); if (nN) { GT = new IPCC.ef(-1, 0, 0, 1, 0, 0); fv.append(GT); } var tQ = Math.round(fv.Ew() / 90); GT = new IPCC.ef(1, 0, 0, 1, 0, 0); GT.rotate(tQ * 90); fv.BZ(GT); var ahA = ''; if (nN || tQ !== 0) { ahA += 'progid:DXImageTransform.Microsoft.BasicImage(mirror=' + (nN ? '1' : '0') + ', rotation=' + tQ.toString() + ')'; } var Xz = (tQ === 1 || tQ === 3); var iU, FD, vO; for (G = 0; G < kG.length; G++) { iU = kG[G]; BN = 1 / iU.level.bS; FD = { x: iU.x * BN, y: iU.y * BN }; FD.width = iU.right * BN - FD.x; FD.height = iU.bottom * BN - FD.y; vO = cw.ud(FD); this.Zn(kG[G], EV + ahA, Xz, vO); } }; }; IPCC.Iy.prototype = new IPCC.bn(); IPCC.dv.Iy = function () { }; IPCC.dv.Iy.prototype = { ame: function (C, aQ, bb) { this.C = C; this.bm = C.bG(); this.aQ = aQ; this.di = bb.width; this.cB = bb.height; this.vU = bb.hi; this.aCK = bb.hk; if (!document.namespaces.igvml) { document.namespaces.add('igvml', 'urn:schemas-microsoft-com:vml'); var style = document.createStyleSheet(); style.addRule('igvml\\:group', 'behavior: url(#default#VML); display:inline-block;position:absolute;'); style.addRule('igvml\\:oval', 'behavior: url(#default#VML); display:inline-block;position:absolute;'); style.addRule('igvml\\:rect', 'behavior: url(#default#VML); display:inline-block;'); style.addRule('igvml\\:fill', 'behavior: url(#default#VML); display:inline-block;'); style.addRule('igvml\\:polyline', 'behavior: url(#default#VML); display:inline-block;'); style.addRule('igvml\\:shape', 'behavior: url(#default#VML); display:inline-block;'); style.addRule('igvml\\:skew', 'behavior: url(#default#VML); display:inline-block;'); style.addRule('igvml\\:stroke', 'behavior: url(#default#VML); display:inline-block;'); style.addRule('igvml\\:fill', 'behavior: url(#default#VML); display:inline-block;'); style.addRule('igvml\\:textpath', 'behavior: url(#default#VML); display:inline-block;'); style.addRule('igvml\\:roundrect', 'behavior: url(#default#VML); display:inline-block;'); style.addRule('igvml\\:textbox', 'behavior: url(#default#VML); display:inline-block;'); } aQ.nA = document.createElement('div'); aQ.VD.insertBefore(aQ.nA, aQ.Ay); }, LQ: function (T) { var cN = 'vmltextmark-' + T.R.jf(); var om = document.createElement('div'); om.style.position = 'absolute'; om.style.top = om.style.left = '0'; om.style.width = om.style.height = '100%'; om.style.background = 'blue'; om.style['filter'] = "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)"; om.setAttribute('data-pcc-mark', cN); return om; }, akM: function (T) { T.oR = []; T.jv = []; var cN = 'vmlmark-' + T.R.jf(), K = this, uJ, oq, iV, eu, Sb; switch (T.R.get_type()) { case IPCC.Web.UI.MarkType.Rectangle: T.aG = this.aK('rect'); T.kJ = this.aK('fill'); T.aG.appendChild(T.kJ); if (T.R.lh() && T.R.get_opacity() === 255) { IPCC.Web.UI.al.addHandler(T.aG, "mouseover", function () { T.aG.style.filter = 'progid:DXImageTransform.Microsoft.Alpha(opacity=' + Math.round(127 / 2.55) + ')'; }); IPCC.Web.UI.al.addHandler(T.aG, "mouseout", function () { T.aG.style.filter = ''; }); } break; case IPCC.Web.UI.MarkType.HighlightText: cN = "highlighttextannotation-" + T.R.jf(); T.aG = this.aK('group'); T.aG.setAttribute('data-pcc-mark', cN); this.eC(T.aG, { width: this.di * 100 + 'px', height: this.cB * 100 + 'px' }); T.dS = this.aK('group'); T.aG.appendChild(T.dS); this.eC(T.dS, { width: this.di * 100 + 'px', height: this.cB * 100 + 'px' }); T.nf = this.aK('shape'); T.oR.push(T.nf); T.qc = this.aK('stroke'); this.ae(T.qc, { on: 'true' }); T.nf.appendChild(T.qc); T.qc.imgearUnstyled = true; T.aG.appendChild(T.nf); break; case IPCC.Web.UI.MarkType.TextHyperlinkAnnotation: cN = "texthyperlinkannotation-" + T.R.jf(); T.aG = this.aK('group'); T.aG.setAttribute('data-pcc-mark', cN); this.eC(T.aG, { width: this.di * 100 + 'px', height: this.cB * 100 + 'px' }); T.dS = this.aK('group'); T.aG.appendChild(T.dS); this.eC(T.dS, { width: this.di * 100 + 'px', height: this.cB * 100 + 'px' }); T.nf = this.aK('shape'); T.oR.push(T.nf); this.eC(T.nf, { cursor: IPCC.bP.fq(IPCC.bP.Link) }); T.qc = this.aK('stroke'); this.ae(T.qc, { on: 'true' }); T.nf.appendChild(T.qc); T.qc.imgearUnstyled = true; T.aG.appendChild(T.nf); T.wI = this.aK('shape'); T.oR.push(T.wI); this.eC(T.wI, { cursor: IPCC.bP.fq(IPCC.bP.Link) }); T.Kf = this.aK('stroke'); T.jv.push(T.Kf); this.ae(T.Kf, { on: 'true' }); T.wI.appendChild(T.Kf); T.Kf.imgearUnstyled = true; T.aG.appendChild(T.wI); IPCC.Web.UI.al.addHandler(T.aG, "mouseover", function () { T.wI.style.filter = "progid:DXImageTransform.Microsoft.Alpha(Opacity=" + IPCC.dv.bn.xz(true, T.R.get_selected()) * 100 + ")"; }); IPCC.Web.UI.al.addHandler(T.aG, "mouseout", function () { T.wI.style.filter = "progid:DXImageTransform.Microsoft.Alpha(Opacity=" + IPCC.dv.bn.xz(false, T.R.get_selected()) * 100 + ")"; }); break; case IPCC.Web.UI.MarkType.DocumentHyperlink: cN = "documenthyperlink-" + T.R.jf(); T.aG = this.aK('group'); T.aG.setAttribute('data-pcc-mark', cN); T.h = this.aK('roundrect'); T.Wk = this.aK('fill'); T.uH = this.aK('stroke'); T.h.appendChild(T.Wk); T.h.appendChild(T.uH); T.aG.appendChild(T.h); this.eC(T.h, { cursor: IPCC.bP.fq(IPCC.bP.Link) }); if (T.R.zy === 'Underline' && T.R.dQ > 0) { T.kZ = this.aK('rect'); T.afO = this.aK('stroke'); T.Xo = this.aK('fill'); T.kZ.appendChild(T.afO); T.kZ.appendChild(T.Xo); T.aG.appendChild(T.kZ); } break; case IPCC.Web.UI.MarkType.ImageStampAnnotation: case IPCC.Web.UI.MarkType.ImageStampRedaction: T.aG = this.aK('shape'); T.gi = document.createElement('img'); T.gi.setAttribute('data-pcc-mark', cN); T.gi.setAttribute("src", T.R.get_image()); T.gi.setAttribute("class", 'pcc-image-stamp-img'); T.gi.removeAttribute('height'); T.gi.removeAttribute('width'); var om = this.LQ(T); om.setAttribute('data-pcc-mark', cN); T.aG.appendChild(T.gi); T.aG.appendChild(om); break; case IPCC.Web.UI.MarkType.RectangleRedaction: T.aG = this.aK('group'); this.eC(T.aG, { width: this.di * 100 + 'px', height: this.cB * 100 + 'px' }); T.hf = this.aK('rect'); T.aG.appendChild(T.hf); this.eC(T.hf, { width: this.di * 100 + 'px', height: this.cB * 100 + 'px' }); T.kJ = this.aK('fill'); T.hf.appendChild(T.kJ); T.mr = this.aK('stroke'); T.hf.appendChild(T.mr); T.jv.push(T.mr); T.vf = document.createTextNode(''); T.Ty = document.createElement('div'); T.Ty.setAttribute('class', 'pcc-valign-mid'); T.wB = document.createElement('div'); T.wB.setAttribute('class', 'pcc-cell-content'); T.wB.style.height = '1px'; T.wB.style.width = '1px'; T.dE = document.createElement('div'); T.dE.style.position = 'absolute'; T.dE.style.overflow = 'hidden'; T.dE.style.display = 'table'; if (document.documentMode >= 8) { T.dE.style.whiteSpace = 'pre-wrap'; } T.wB.appendChild(T.vf); T.dE.appendChild(T.Ty); T.Ty.appendChild(T.wB); cN = 'vmltextmark-' + T.R.jf(); T.kJ.setAttribute('data-pcc-mark', cN); T.hf.setAttribute('data-pcc-mark', cN); T.mr.setAttribute('data-pcc-mark', cN); T.dE.setAttribute('data-pcc-mark', cN); T.Ty.setAttribute('data-pcc-mark', cN); T.wB.setAttribute('data-pcc-mark', cN); IPCC.Web.UI.al.addHandler(T.dE, "mouseover", function () { if (K.C.kU() === false && T.R.get_selected() === false) { T.kJ.opacity = 0.5; T.mr.opacity = 0.5; T.dE.style.filter = 'progid:DXImageTransform.Microsoft.Alpha(opacity=0);'; } }); IPCC.Web.UI.al.addHandler(T.dE, "mouseout", function () { if (K.C.kU() === false && T.R.get_selected() === false) { T.kJ.opacity = 1; T.mr.opacity = 1; T.dE.style.filter = 'progid:DXImageTransform.Microsoft.Alpha(opacity=100);'; } }); break; case IPCC.Web.UI.MarkType.Ellipse: T.aG = this.aK('oval'); T.kJ = this.aK('fill'); T.aG.appendChild(T.kJ); break; case IPCC.Web.UI.MarkType.Line: case IPCC.Web.UI.MarkType.Polyline: T.aG = this.aK('group'); this.eC(T.aG, { width: this.di * 100 + 'px', height: this.cB * 100 + 'px' }); T.aG.setAttribute('data-pcc-mark', cN); T.hZ = this.aK('shape'); this.ae(T.hZ, { filled: 'f' }); T.oR.push(T.hZ); T.tq = this.aK('stroke'); T.jv.push(T.tq); this.ae(T.tq, { on: 'true' }); T.hZ.appendChild(T.tq); T.tq.setAttribute('joinstyle', 'miter'); T.tq.setAttribute('miterlimit', '4'); T.tq.setAttribute('endcap', 'flat'); T.yL = this.aK('shape'); T.oR.push(T.yL); T.Jp = this.aK('stroke'); T.jv.push(T.Jp); this.ae(T.Jp, { on: 'true' }); T.yL.appendChild(T.Jp); T.Jp.imgearUnstyled = true; T.xg = this.aK('shape'); T.oR.push(T.xg); T.IW = this.aK('stroke'); T.jv.push(T.IW); this.ae(T.IW, { on: 'true' }); T.xg.appendChild(T.IW); T.IW.imgearUnstyled = true; T.aG.appendChild(T.hZ); T.aG.appendChild(T.yL); T.aG.appendChild(T.xg); break; case IPCC.Web.UI.MarkType.Polygon: T.aG = this.aK('shape'); T.oR.push(T.aG); break; case IPCC.Web.UI.MarkType.Text: T.aG = this.aK('group'); this.eC(T.aG, { width: this.di * 100 + 'px', height: this.cB * 100 + 'px' }); T.sn = this.aK('shape'); T.oR.push(T.sn); T.Mu = this.aK('stroke'); T.jv.push(T.Mu); T.sn.appendChild(T.Mu); T.aG.appendChild(T.sn); T.Mu.imgearUnstyled = true; T.kJ = this.aK('fill'); T.sn.appendChild(T.kJ); T.hZ = this.aK('shape'); this.ae(T.hZ, { filled: 'f' }); T.oR.push(T.hZ); T.tq = this.aK('stroke'); T.jv.push(T.tq); this.ae(T.tq, { on: 'true' }); T.hZ.appendChild(T.tq); T.aG.appendChild(T.hZ); T.rH = this.aK('shape'); this.ae(T.rH, { filled: 'f' }); T.oR.push(T.rH); T.zt = this.aK('stroke'); T.jv.push(T.zt); this.ae(T.zt, { on: 'true' }); T.rH.appendChild(T.zt); T.aG.appendChild(T.rH); T.zt.imgearUnstyled = true; T.vf = document.createTextNode(''); T.dE = document.createElement('div'); T.dE.style.position = 'absolute'; T.dE.style.overflow = 'hidden'; if (document.documentMode >= 8) { T.dE.style.whiteSpace = 'pre-wrap'; } T.dE.appendChild(T.vf); cN = 'vmltextmark-' + T.R.jf(); T.sn.setAttribute('data-pcc-mark', cN); T.Mu.setAttribute('data-pcc-mark', cN); T.hZ.setAttribute('data-pcc-mark', cN); T.rH.setAttribute('data-pcc-mark', cN); T.zt.setAttribute('data-pcc-mark', cN); T.dE.setAttribute('data-pcc-mark', cN); break; case IPCC.Web.UI.MarkType.Highlight: T.aG = this.aK('rect'); break; case IPCC.Web.UI.MarkType.TextSelectionRedaction: T.aG = this.aK('group'); T.dS = T.aG; this.eC(T.aG, { width: this.di * 100 + 'px', height: this.cB * 100 + 'px' }); break; case IPCC.Web.UI.MarkType.Stamp: T.aG = this.aK('roundrect'); T.vG = document.createTextNode(''); T.er = document.createElement('div'); iV = T.R.az; T.R.zm = false; T.R.gX = T.R.cK; eu = {}; eu.color = T.R.cK; eu.fontFamily = "Arial"; this.eC(T.er, eu); if (!iV) { iV = T.R.dO[0]; T.R.az = iV; if (!iV) { iV = "APPROVED"; } } om = this.LQ(T); om.setAttribute('data-pcc-mark', cN); T.vG.data = iV; T.er.appendChild(T.vG); T.aG.appendChild(T.er); T.aG.appendChild(om); break; case IPCC.Web.UI.MarkType.SignaturePath: case IPCC.Web.UI.MarkType.Freehand: var R = T.R; var tA = R.get_pathWidth(); var vh = R.get_pathHeight(); var rs = R.get_pathString(); var cj = IPCC.J.yg.Path(rs, { width: tA, height: vh, multiplier: 100, thickness: (R.Ka > 0) ? R.Ka : R.get_lineWidth(), color: R.get_lineColor() }); T.aG = cj; var aFx = this.LQ(T); T.aG.appendChild(aFx); break; case IPCC.Web.UI.MarkType.SignatureText: T.aG = this.aK('rect'); T.vG = document.createTextNode(''); T.er = document.createElement('div'); T.er.setAttribute('data-pcc-mark', cN); uJ = T.R.az; T.R.zm = false; T.R.gX = "none"; T.R.dI = 255; oq = {}; oq.color = T.R.cK; oq.fontFamily = T.R.get_fontName(); oq.textAlign = "center"; this.eC(T.er, oq); if (oq.fontFamily) { T.er.style.fontFamily = '"' + oq.fontFamily + '", cursive'; } if (!uJ) { uJ = T.R.dO[0]; T.R.az = uJ; } Sb = this.LQ(T); T.vG.data = uJ; T.er.appendChild(T.vG); T.aG.appendChild(T.er); T.aG.appendChild(Sb); break; case IPCC.Web.UI.MarkType.TextLine: T.aG = this.aK('rect'); T.vG = document.createTextNode(''); T.er = document.createElement('div'); T.er.setAttribute('data-pcc-mark', cN); uJ = T.R.az; oq = {}; oq.color = T.R.cK; oq.fontFamily = T.R.get_fontName(); oq.whiteSpace = "pre"; oq.textAlign = "left"; this.eC(T.er, oq); if (oq.fontFamily) { T.er.style.fontFamily = '"' + oq.fontFamily + '", cursive'; } if (!uJ) { uJ = T.R.dO[0]; T.R.az = uJ; } Sb = this.LQ(T); T.vG.data = uJ; T.er.appendChild(T.vG); T.aG.appendChild(T.er); T.aG.appendChild(Sb); break; case IPCC.Web.UI.MarkType.Strikethrough: cN = "strikethroughannotation-" + T.R.jf(); T.aG = this.aK('group'); T.aG.setAttribute('data-pcc-mark', cN); this.eC(T.aG, { width: this.di * 100 + 'px', height: this.cB * 100 + 'px' }); T.dS = this.aK('group'); T.aG.appendChild(T.dS); this.eC(T.dS, { width: this.di * 100 + 'px', height: this.cB * 100 + 'px' }); T.nf = this.aK('shape'); T.oR.push(T.nf); T.qc = this.aK('stroke'); this.ae(T.qc, { on: 'true' }); T.nf.appendChild(T.qc); T.qc.imgearUnstyled = true; T.aG.appendChild(T.nf); T.Io = this.aK('shape'); T.oR.push(T.Io); T.GL = this.aK('stroke'); T.jv.push(T.GL); this.ae(T.GL, { on: 'true' }); T.Io.appendChild(T.GL); T.GL.imgearUnstyled = true; T.aG.appendChild(T.Io); break; } if (!T.kJ && T.aG) { T.kJ = T.aG; } if (T.aG && T.aG.tagName !== 'group') { T.mr = this.aK('stroke'); T.jv.push(T.mr); this.ae(T.mr, { on: 'true' }); T.aG.appendChild(T.mr); } var aj; for (aj = 0; aj < T.oR.length; aj++) { this.ae(T.oR[aj], { coordorigin: '0,0', coordsize: this.di * 100 + ',' + this.cB * 100 }); this.eC(T.oR[aj], { width: this.di * 100 + 'px', height: this.cB * 100 + 'px' }); } for (aj = 0; aj < T.jv.length; aj++) { this.ae(T.jv[aj], { joinstyle: 'miter' }); } T.ru = this.aK('group'); this.Rw(T); this.eC(T.ru, { left: '0px', top: '0px', width: '300px', height: '300px', position: 'absolute' }); this.ae(T.ru, { coordorigin: '0,0', coordsize: this.di * 100 + ',' + this.cB * 100 }); T.ru.ImGearMarkRelation = T; T.ru.setAttribute('data-pcc-mark', 'vmlmark-' + T.R.jf()); if (T.aG) { T.ru.appendChild(T.aG); } this.aQ.nA.appendChild(T.ru); if (T.dE) { T.dE.ImGearMarkRelation = T; this.aQ.nA.appendChild(T.dE); } }, nb: function (aFI, jI, na) { var cj = this.RU(jI, na); this.ae(aFI, { path: cj }); }, RU: function (jI, na) { var cj = 'm'; if (jI.length < 1) { cj = ''; } else { cj = 'm' + Math.round(jI[0].x * 100) + ',' + Math.round(jI[0].y * 100); var G; for (G = 1; G < jI.length; G++) { if (G > 1) { cj += ','; } else { cj += 'l'; } cj += Math.round(jI[G].x * 100) + ',' + Math.round(jI[G].y * 100); } if (na && jI.length > 2) { cj += 'x'; } cj += 'e'; } return cj; }, aFr: function (gp, rQ) { var cj = ''; IPCC.J.forEach(gp, function (h) { var kt = this.aGc(h, rQ); cj = cj + this.RU(kt, false) + ", "; }, this); return cj; }, aEW: function (gp, rQ) { var cj = ''; IPCC.J.forEach(gp, function (h) { var kt = this.aEe(h, rQ); cj = cj + this.RU(kt, false) + ", "; }, this); return cj; }, aGI: function (gp) { var cj = ''; IPCC.J.forEach(gp, function (h) { var kt = this.aFh(h); cj = cj + this.RU(kt, true) + ", "; }, this); return cj; }, aFh: function (h) { var kt = []; kt.push({ x: h.x, y: h.y }); kt.push({ x: h.x + h.width, y: h.y }); kt.push({ x: h.x + h.width, y: h.y + h.height }); kt.push({ x: h.x, y: h.y + h.height }); return kt; }, aGc: function (h, rQ) { rQ = rQ || 0; var kt = []; kt.push({ x: h.x, y: h.y + h.height + rQ }); kt.push({ x: h.x + h.width, y: h.y + h.height + rQ }); return kt; }, aEe: function (h, rQ) { rQ = rQ || 0; var kt = []; var strikethroughY = h.y + (h.height / 2); kt.push({ x: h.x, y: strikethroughY }); kt.push({ x: h.x + h.width, y: strikethroughY }); return kt; }, Jj: function (fk, lu, vx, qI, sj, EI, qO, aDM) { var cF = this.ahm(fk, lu, vx, qI, sj); var bH = { display: 'block' }, bu = { fillcolor: EI, filled: false }, oA = { color: EI }; switch (sj) { case IPCC.Web.UI.LineHeadType.None: bH.display = 'none'; break; case IPCC.Web.UI.LineHeadType.Pointer: this.nb(qO, [cF.tM, fk, cF.tY], false); break; case IPCC.Web.UI.LineHeadType.Solid: this.nb(qO, [cF.tM, fk, cF.tY], true); bu.filled = true; break; case IPCC.Web.UI.LineHeadType.Open: this.nb(qO, [cF.tM, fk, cF.tY], true); break; case IPCC.Web.UI.LineHeadType.PointerSolid: bu.filled = true; this.nb(qO, [cF.tM, fk, cF.tY, cF.yr], true); break; } if (sj !== IPCC.Web.UI.LineHeadType.None) { this.eC(qO, bH); this.ae(qO, bu); this.ae(aDM, oA); } return cF; }, Uy: function (T) { var R = T.R; var fd, Me, Jv, qa; fd = this.KW(R); if (fd.length < 2 || R.na) { this.eC(T.yL, { display: 'none' }); this.eC(T.xg, { display: 'none' }); } else { R.wH = R.gX; qa = this.Tq(fd, true); Me = this.Jj(qa.fk, qa.lu, R.ED, R.DP, R.Dr, R.wH, T.yL, T.Jp); qa = this.Tq(fd, false); Jv = this.Jj(qa.fk, qa.lu, R.HC, R.HT, R.mW, R.wH, T.xg, T.IW); fd[0] = Me.yr; fd[fd.length - 1] = Jv.yr; } this.nb(T.hZ, fd, R.na); }, Qx: function (T) { var ra = this.afU(T); this.nb(T.sn, ra.aaA, true); var GK = {}, EP = {}; var R = T.R; if (ra.SO || R.gX === 'transparent') { EP.on = false; } else { EP.color = R.gX; EP.dashstyle = this.AV(R.ii); EP.on = true; EP.opacity = R.dI / 255; } if (ra.Mi) { this.nb(T.hZ, ra.Mi, false); T.hZ.style.visibility = 'visible'; } else { T.hZ.style.visibility = 'hidden'; } if (ra.GA) { this.nb(T.rH, ra.GA, false); T.rH.style.visibility = 'visible'; } else { T.rH.style.visibility = 'hidden'; } if (R.At) { GK.color = R.Bo; GK.dashstyle = this.AV(R.rR); T.zt.imgearCalloutSized = true; } else { GK.color = R.gX; GK.dashstyle = this.AV(R.ii); T.zt.imgearCalloutSized = false; } this.ae(T.zt, GK); this.ae(T.Mu, EP); }, ayU: function (T, cw, bS) { var R = T.R; var h = R.fD(); var jo = 1; if (R.hv) { jo += R.dQ / 2; } h.width -= 2 * jo; h.height -= 2 * jo; h.x += jo; h.y += jo; h = cw.ud(h); var Zp = h.x, Yz = h.y; var fv = new IPCC.ef(1, 0, 0, 1, 0, 0); switch (R.wC) { case IPCC.Web.UI.Orientation.TopLeft: break; case IPCC.Web.UI.Orientation.TopRight: fv.scale(-1, 1); break; case IPCC.Web.UI.Orientation.BottomRight: fv.rotate(180); break; case IPCC.Web.UI.Orientation.BottomLeft: fv.rotate(180); fv.scale(-1, 1); break; case IPCC.Web.UI.Orientation.LeftTop: fv.scale(-1, 1); fv.rotate(270); break; case IPCC.Web.UI.Orientation.RightTop: fv.rotate(90); break; case IPCC.Web.UI.Orientation.RightBottom: fv.scale(-1, 1); fv.rotate(90); break; case IPCC.Web.UI.Orientation.LeftBottom: fv.rotate(270); break; } fv.append(cw); var eu = {}; var mA; if (R.get_type() === IPCC.Web.UI.MarkType.TextLine) { mA = R.cd * bS; } else { mA = R.cd * this.vU / 72 * bS; } eu.fontSize = Math.round(mA) + 'px'; var nN = fv.Ki(); var ce = fv.Ew(); if (nN) { ce = (360 - ce) % 360; } var tQ = Math.round(ce / 90); var Aw = ''; if (nN || tQ) { Aw = 'progid:DXImageTransform.Microsoft.BasicImage(mirror=' + (nN ? '1' : '0') + ', rotation=' + tQ.toString() + ');'; } if (R.rE < 255) { Aw += 'progid:DXImageTransform.Microsoft.Alpha(opacity=' + Math.round(R.rE / 255 * 100) + ');'; } T.er.style.filter = Aw; var fp; if ((ce > 45 && ce < 135) || (ce > 225 && ce < 315)) { fp = h.width; h.width = h.height; h.height = fp; } eu.left = Zp + 'px'; eu.top = Yz + 'px'; eu.width = h.width + 'px'; eu.height = h.height + 'px'; T.er.style.width = h.width + 'px'; T.er.style.height = h.height + 'px'; T.er.style.lineHeight = T.er.style.height; T.er.style.fontSize = Math.round(mA) + 'px'; }, ayk: function (T, cw, bS) { var R = T.R; var h = R.fD(); var jo = 1; if (R.hv) { jo += R.dQ / 2; } h.width -= 2 * jo; h.height -= 2 * jo; h.x += jo; h.y += jo; h = cw.ud(h); var Zp = h.x, Yz = h.y; var fv = new IPCC.ef(1, 0, 0, 1, 0, 0); switch (R.wC) { case IPCC.Web.UI.Orientation.TopLeft: break; case IPCC.Web.UI.Orientation.TopRight: fv.scale(-1, 1); break; case IPCC.Web.UI.Orientation.BottomRight: fv.rotate(180); break; case IPCC.Web.UI.Orientation.BottomLeft: fv.rotate(180); fv.scale(-1, 1); break; case IPCC.Web.UI.Orientation.LeftTop: fv.scale(-1, 1); fv.rotate(270); break; case IPCC.Web.UI.Orientation.RightTop: fv.rotate(90); break; case IPCC.Web.UI.Orientation.RightBottom: fv.scale(-1, 1); fv.rotate(90); break; case IPCC.Web.UI.Orientation.LeftBottom: fv.rotate(270); break; } fv.append(cw); var eu = {}; var mA = R.cd * this.vU / 72 * bS; R.mA = mA; eu.fontSize = Math.round(mA) + 'px'; var nN = fv.Ki(); var ce = fv.Ew(); if (nN) { ce = (360 - ce) % 360; } var tQ = Math.round(ce / 90); var Aw = ''; if (nN || tQ) { Aw = 'progid:DXImageTransform.Microsoft.BasicImage(mirror=' + (nN ? '1' : '0') + ', rotation=' + tQ.toString() + ');'; } if (this.C.kU() === true) { T.kJ.opacity = 0.5; T.mr.opacity = 0.5; Aw += ' progid:DXImageTransform.Microsoft.Alpha(opacity=0);'; } else if (R.rE < 255) { Aw += ' progid:DXImageTransform.Microsoft.Alpha(opacity=' + Math.round(R.rE / 255 * 100) + ');'; } T.dE.style.filter = Aw; var fp; if ((ce > 45 && ce < 135) || (ce > 225 && ce < 315)) { fp = h.width; h.width = h.height; h.height = fp; } eu.left = Zp + 'px'; eu.top = Yz + 'px'; eu.width = h.width + 'px'; eu.height = h.height + 'px'; this.eC(T.dE, eu); if (T.wB !== undefined) { T.wB.style.width = h.width + 'px'; } }, HM: function (T) { var R = T.R; var ati = {}, eu = {}; eu.lineHeight = 1; eu.backgroundColor = 'transparent'; eu.color = R.od; eu.fontFamily = R.gZ; if (R.de & IPCC.Web.UI.FontStyle.Italic) { eu.fontStyle = 'italic'; } else { eu.fontStyle = ''; } if (R.de & IPCC.Web.UI.FontStyle.Bold) { eu.fontWeight = 'bold'; } else { eu.fontWeight = ''; } if ((R.de & IPCC.Web.UI.FontStyle.Underline) && (R.de & IPCC.Web.UI.FontStyle.Strikeout)) { eu.textDecoration = 'underline line-through'; } else if (R.de & IPCC.Web.UI.FontStyle.Underline) { eu.textDecoration = 'underline'; } else if (R.de & IPCC.Web.UI.FontStyle.Strikeout) { eu.textDecoration = 'line-through'; } else { eu.textDecoration = ''; } switch (R.kh) { case IPCC.Web.UI.HorizontalAlignment.Center: eu.textAlign = 'center'; break; case IPCC.Web.UI.HorizontalAlignment.Right: eu.textAlign = 'right'; break; default: eu.textAlign = 'left'; break; } if (document.documentMode < 8) { var axb = R.az.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\n/g, '<br/>'); T.dE.innerHTML = axb; } else { this.ahz(T); } this.ae(T.dE, ati); this.eC(T.dE, eu); if (T.R.get_type() !== IPCC.Web.UI.MarkType.RectangleRedaction) { if (R.cK === "#000000") { R.cK = '#ffffff'; } if (R.lh() === true) { R.cK = 'white'; } else { R.set_opacity(R.dI); } } }, Rw: function (T) { var R = T.R, K = this; if (!R) { return; } var aG = T.aG; var G, h, fd, bH = {}, bu = {}, oy = {}, oA = {}, hv = true, GF, BG, aoP, aah, Sr, II, iV, Rz, pH, pK, xD, eu; var iq = false; switch (R.get_type()) { case IPCC.Web.UI.MarkType.Line: case IPCC.Web.UI.MarkType.Polyline: iq = true; this.Uy(T); break; case IPCC.Web.UI.MarkType.Rectangle: case IPCC.Web.UI.MarkType.Highlight: h = R.get_rectangle(); if (h.x === 0 && h.y === 0) { var gP = this.C.cv().gl(); if (gP.fb() > 0) { var gw = gP.jN(R.bh); h = gw.av; } R.kz = 'y'; } bH.left = h.x * 100 + 'px'; bH.top = h.y * 100 + 'px'; bH.width = h.width * 100 + 'px'; bH.height = h.height * 100 + 'px'; break; case IPCC.Web.UI.MarkType.HighlightText: this.En(T); bH = { display: (R.get_visible()) ? 'block' : 'none', filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=" + Math.round(R.dI / 2.55) + ")", color: R.cK }; bu = { fillcolor: R.cK, filled: true }; oA = { color: R.cK }; this.eC(T.nf, bH); this.ae(T.nf, bu); this.ae(T.qc, oA); this.yA(T); break; case IPCC.Web.UI.MarkType.TextHyperlinkAnnotation: this.En(T); bH = { display: (R.get_visible()) ? 'block' : 'none', filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=" + IPCC.dv.bn.KB(false, T.R.get_selected()) * 100 + ")", color: R.cK }; bu = { fillcolor: R.cK, filled: true }; oA = { color: R.cK }; var ahN = { filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=" + IPCC.dv.bn.xz(false, T.R.get_selected()) * 100 + ")", weight: 0 }; this.eC(T.nf, bH); this.ae(T.nf, bu); this.ae(T.qc, oA); this.eC(T.wI, ahN); this.ae(T.Kf, oA); this.yA(T); break; case IPCC.Web.UI.MarkType.DocumentHyperlink: h = R.get_rectangle(); bH.left = h.x * 100 + 'px'; bH.top = h.y * 100 + 'px'; bH.width = h.width * 100 + 'px'; bH.height = h.height * 100 + 'px'; T.h.style.width = '100%'; T.h.style.height = '100%'; var apo = 0; if (T.R.zy !== 'Underline' && (T.R.Ep > 0 || T.R.Fd > 0)) { apo = 0.4; } T.h.setAttribute('arcsize', apo); if (T.kZ) { T.kZ.style.width = '100%'; T.kZ.style.top = '100%'; T.kZ.style.height = '10000px'; T.kZ.setAttribute('fill', true); T.kZ.setAttribute('fillcolor', T.R.gX); T.afO.setAttribute('on', false); T.Xo.setAttribute('type', 'solid'); T.Xo.setAttribute('opacity', T.R.oQ / 255); } T.Wk.setAttribute('type', 'solid'); T.Wk.setAttribute('opacity', IPCC.dv.bn.KB()); if (T.R.zy === 'Underline' || T.R.dQ === 0) { T.uH.setAttribute('on', false); } else if (T.R.zy === 'Dashed') { T.uH.setAttribute('dashstyle', 'dash'); T.uH.setAttribute('color', T.R.gX); T.uH.setAttribute('weight', T.R.dQ + 'px'); T.uH.setAttribute('opacity', T.R.oQ / 255); } else { T.uH.setAttribute('on', true); T.uH.setAttribute('color', T.R.gX); T.uH.setAttribute('weight', T.R.dQ + 'px'); T.uH.setAttribute('opacity', T.R.oQ / 255); } break; case IPCC.Web.UI.MarkType.ImageStampAnnotation: case IPCC.Web.UI.MarkType.ImageStampRedaction: h = R.get_rectangle(); bH.left = h.x * 100 + 'px'; bH.top = h.y * 100 + 'px'; bH.width = h.width * 100 + 'px'; bH.height = h.height * 100 + 'px'; T.gi.src = T.R.ap; var Kz = T.aG.getBoundingClientRect(); var hg = T.gi.getBoundingClientRect(); if (hg.bottom !== undefined && Kz.bottom !== undefined) { var Km = Kz.bottom - Kz.top; var atF = Kz.right - Kz.left; var cB = hg.bottom - hg.top; var di = hg.right - hg.left; T.gi.style['position'] = 'relative'; if (Km === cB && atF === di) { T.gi.style['max-height'] = '100%'; T.gi.style['height'] = 'auto'; T.gi.style['max-width'] = '100%'; T.gi.style['width'] = 'auto'; T.gi.style['top'] = '0'; } else if (Km <= cB) { T.gi.style['max-height'] = '100%'; T.gi.style['height'] = '100%'; T.gi.style['max-width'] = 'available'; T.gi.style['width'] = 'auto'; T.gi.style['top'] = '0'; } else { T.gi.style['max-height'] = 'available'; T.gi.style['height'] = 'auto'; T.gi.style['max-width'] = '100%'; T.gi.style['width'] = '100%'; T.gi.style['top'] = ''; } if (Km > cB) { var ayO = 100 * ((Km / 2 - cB / 2) / Km); T.gi.style.top = ayO + '%'; } } break; case IPCC.Web.UI.MarkType.RectangleRedaction: h = R.get_rectangle(); bH.left = h.x * 100 + 'px'; bH.top = h.y * 100 + 'px'; bH.width = h.width * 100 + 'px'; bH.height = h.height * 100 + 'px'; if (K.C.kU() === true) { T.kJ.opacity = 0.5; T.mr.opacity = 0.5; T.dE.style.filter = 'progid:DXImageTransform.Microsoft.Alpha(opacity=0);'; } else { T.kJ.opacity = 1; T.mr.opacity = 1; T.dE.style.filter = 'progid:DXImageTransform.Microsoft.Alpha(opacity=100);'; } this.HM(T); setTimeout(function () { GF = T.dE.cloneNode(true); GF.style.visibility = 'hidden'; document.body.appendChild(GF); BG = GF.getElementsByTagName('div'); aoP = BG[0]; aah = BG[1]; aah.style.height = 'inherit'; Sr = aah.getBoundingClientRect(); II = aoP.getBoundingClientRect(); if (Sr.top !== 0) { if (Sr.top === II.top && Sr.bottom === II.bottom && T.dE.style.height !== '') { T.wB.style.height = T.dE.style.height; } else { T.wB.style.height = 'inherit'; } } document.body.removeChild(GF); GF = undefined; }, 0); break; case IPCC.Web.UI.MarkType.TextSelectionRedaction: this.yA(T); return; case IPCC.Web.UI.MarkType.Ellipse: h = R.get_rectangle(); bH.left = h.x * 100 + 'px'; bH.top = h.y * 100 + 'px'; bH.width = h.width * 100 + 'px'; bH.height = h.height * 100 + 'px'; break; case IPCC.Web.UI.MarkType.Polygon: fd = this.KW(R); this.nb(aG, fd, true); break; case IPCC.Web.UI.MarkType.Text: this.Qx(T); this.HM(T); break; case IPCC.Web.UI.MarkType.Stamp: case IPCC.Web.UI.MarkType.SignatureText: h = R.get_rectangle(); bH.left = h.x * 100 + 'px'; bH.top = h.y * 100 + 'px'; bH.width = h.width * 100 + 'px'; bH.height = h.height * 100 + 'px'; iV = R.get_text(); if (!iV) { if (R.get_type() === IPCC.Web.UI.MarkType.Stamp) { iV = "APPROVED"; } else { iV = ""; } } T.vG.data = iV; Rz = this.azD(h.width, h.height); T.er.style.textAlign = 'center'; T.er.style.fontSize = Rz + 'px'; if (R.get_type() === IPCC.Web.UI.MarkType.SignatureText) { pH = 12 * h.width / (R.xj || 1); pK = 12 * h.height / (R.yq || 1); xD = Math.min(pH, pK) / 2; if (R.get_visible()) { T.aG.style.display = 'block'; } else { T.aG.style.display = 'none'; } } R.cd = xD || Rz; R.stampSize = Math.floor(xD || Rz); T.er.style.width = h.width / 3.25; T.er.style.height = h.height / 3.25; T.er.style.lineHeight = T.er.style.height; if (T.R.get_type() === IPCC.Web.UI.MarkType.SignatureText) { T.er.style.fontFamily = T.R.get_fontName() + ', cursive'; } if (R.get_type() === IPCC.Web.UI.MarkType.Stamp) { T.R.gX = T.R.cK; } else { R.hv = false; } eu = {}; eu.color = T.R.cK; this.eC(T.er, eu); break; case IPCC.Web.UI.MarkType.TextLine: h = R.get_rectangle(); bH.left = h.x * 100 + 'px'; bH.top = h.y * 100 + 'px'; bH.width = h.width * 100 + 'px'; bH.height = h.height * 100 + 'px'; iV = R.get_text() || ""; T.vG.data = iV; pH = 12 * h.width / (R.xj || 1); pK = 12 * h.height / (R.yq || 1); xD = Math.min(pH, pK); var bS = 0.9; xD *= bS; R.cd = xD; R.mA = xD; R.alw = this.vU / 72; R.stampSize = xD; T.er.style.width = h.width; T.er.style.height = h.height; T.er.style.lineHeight = T.er.style.height; T.er.style.fontFamily = T.R.get_fontName() + ', sans-serif'; eu = {}; eu.color = T.R.od; this.eC(T.er, eu); break; case IPCC.Web.UI.MarkType.SignaturePath: case IPCC.Web.UI.MarkType.Freehand: try { aG.setAttribute('stroke', R.get_lineColor()); if (R.OW === true) { R.OW = false; aG.setAttribute("d", R.get_pathString()); var tA = R.get_pathWidth(); var vh = R.get_pathHeight(); aG.setAttribute('width', tA * 100); aG.setAttribute('height', vh * 100); aG.coordsize = [tA, vh].join(', '); } if (R.get_visible() === false) { aG.style.display = 'none'; } else { aG.style.display = ''; } var Jl; var JY; var abw; var aan; var Zm = R.get_pathWidth() / R.get_pathHeight(); h = R.get_rectangle(); var aBB = h.width / h.height; if (aBB > Zm) { JY = h.height; Jl = h.height * Zm; abw = h.x - (Jl - h.width) / 2; aan = h.y; R.Ka = R.dQ * Jl / R.get_pathWidth(); } else { Jl = h.width; JY = h.width / Zm; aan = h.y - (JY - h.height) / 2; abw = h.x; R.Ka = R.dQ * JY / R.get_pathHeight(); } bH.left = abw * 100 + 'px'; bH.top = aan * 100 + 'px'; bH.width = Jl * 100 + 'px'; bH.height = JY * 100 + 'px'; } catch (e) { } break; case IPCC.Web.UI.MarkType.Strikethrough: this.En(T); bH = { display: (R.get_visible()) ? 'block' : 'none', filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=" + IPCC.dv.bn.KB(false, T.R.get_selected()) * 100 + ")", color: R.gX }; bu = { fillcolor: R.gX, filled: true }; oA = { color: R.gX }; this.eC(T.Io, ahN); this.ae(T.GL, oA); this.yA(T); break; default: throw new IPCC.Web.UI.ImGearArgumentOutOfRangeException('type', R.get_type()); } if (R.get_type() !== IPCC.Web.UI.MarkType.SignaturePath && R.get_type() !== IPCC.Web.UI.MarkType.Freehand && R.get_type() !== IPCC.Web.UI.MarkType.HighlightText && R.get_type() !== IPCC.Web.UI.MarkType.Strikethrough && R.get_type() !== IPCC.Web.UI.MarkType.TextHyperlinkAnnotation) { if (iq) { oy.filled = false; } else { if (R.zm && R.cK !== 'transparent') { if (T.kJ.tagName === 'fill') { oy.on = true; oy.opacity = R.dI / 255; oy.color = R.cK; } else { oy.filled = true; oy.fillColor = R.cK; } } else { if (T.kJ.tagName === 'fill') { oy.on = true; oy.opacity = 0.01; oy.color = 'white'; } else { oy.filled = false; } } hv = R.hv; } if (hv && R.get_lineColor() !== 'transparent') { oA.color = R.get_lineColor(); oA.dashstyle = this.AV(R.ii); oA.on = true; } else { oA.on = false; } } var EV = ''; switch (R.jd()) { case IPCC.Web.UI.MarkType.TextHyperlinkAnnotation: break; default: var RV = {}; RV[IPCC.Web.UI.MarkType.Rectangle] = true; RV[IPCC.Web.UI.MarkType.Ellipse] = true; RV[IPCC.Web.UI.MarkType.Text] = true; if (RV[R.jd()] === true) { oA.opacity = R.dI / 255; } else { if (R.dI < 255) { EV = 'progid:DXImageTransform.Microsoft.Alpha(opacity=' + Math.round(R.dI / 2.55) + ')'; } var vD = aG.firstChild; if (vD && vD.nodeName === 'shape') { while (vD) { vD.style.filter = EV; vD = vD.nextSibling; } } else { aG.style.filter = EV; } } break; } if (R.get_type() !== IPCC.Web.UI.MarkType.SignaturePath && R.get_type() !== IPCC.Web.UI.MarkType.Freehand) { if (R.get_type() !== IPCC.Web.UI.MarkType.HighlightText && R.get_type() !== IPCC.Web.UI.MarkType.Strikethrough && R.get_type() !== IPCC.Web.UI.MarkType.TextHyperlinkAnnotation) { if (R.ep) { bH.visibility = 'visible'; if (T.dE) { T.dE.style.visibility = 'visible'; } } else { bH.visibility = 'hidden'; if (T.dE) { T.dE.style.visibility = 'hidden'; } } } bH.cursor = IPCC.bP.fq(this.bm.Bk()); if (T.dE) { T.dE.style.cursor = IPCC.bP.fq(this.bm.Bk()); } this.eC(aG, bH); this.ae(T.kJ, oy); this.ae(aG, bu); for (G = 0; G < T.jv.length; G++) { if (!T.jv[G].imgearUnstyled) { this.ae(T.jv[G], oA); } } } else { this.eC(aG, bH); } }, yA: function (T) { var R = T.R, G, bH = {}, oy = {}; var dS = T.dS; while (dS.firstChild) { dS.removeChild(dS.firstChild); } var hs; for (G = 0; G < R.eh.length; G++) { for (var aj = 0; aj < R.eh[G].length; aj++) { var Jo = this.C.cv().gl(); if (Jo.fb() > 0) { var acI = Jo.jN(R.eh[G].startIndex + aj); hs = acI.av; } var ai = this.aK('rect'); bH.left = hs.x * 100 + 'px'; bH.top = hs.y * 100 + 'px'; bH.width = hs.width * 100 + 'px'; bH.height = hs.height * 100 + 'px'; bH.filter = 'progid:DXImageTransform.Microsoft.Alpha(opacity=' + Math.round(R.eh[G].opacity / 2.55) + ')'; this.eC(ai, bH); oy.fillColor = R.eh[G].color; oy.filled = true; this.ae(ai, oy); var mr = this.aK('stroke'); this.ae(mr, { on: 'f' }); ai.appendChild(mr); dS.appendChild(ai); } } }, En: function (T) { var R = T.R; if (R.bV === null || R.bV === undefined) { return; } if (R.bV.length === 0 && R.cg > 0 && this.C.cv().mw()) { R.bV = IPCC.J.QF(this.C.cv().gl(), R.bh, R.bh + R.cg - 1); } if (!T.bh || !T.cg || T.bh !== R.bh || R.ep === false || R.ep === true || T.cg !== R.cg) { var cj, drawRectangles = true; if (T.wI) { cj = this.aFr(R.bV, R.dQ / -2); this.ae(T.wI, { path: cj }); } if (T.Io) { drawRectangles = false; cj = this.aEW(R.bV, R.dQ); this.ae(T.Io, { path: cj }); } if (drawRectangles) { cj = this.aGI(R.bV); this.ae(T.nf, { path: cj }); } T.bh = R.bh; T.cg = R.cg; } }, azD: function (IX, aBs) { var mv = 0; if (IX >= aBs) { mv = (IX / 14) / 2; } else { mv = IX / 15; } if (mv * 15 >= IX) { mv = (IX / 15) / 2; } return mv; }, AV: function (ii) { switch (ii) { case IPCC.Web.UI.LineStyle.Dash: return 'dash'; case IPCC.Web.UI.LineStyle.Dot: return 'dot'; case IPCC.Web.UI.LineStyle.DashDot: return 'dashdot'; case IPCC.Web.UI.LineStyle.DashDotDot: return 'shortdashdotdot'; default: break; } return 'solid'; }, KG: function (T) { var aau = IPCC.J.find(this.aQ.nA.children, function (vD) { return vD === T.ru; }); if (aau) { this.aQ.nA.removeChild(T.ru); if (T.dE) { aau = IPCC.J.find(this.aQ.nA.children, function (vD) { return vD === T.dE; }); if (aau) { this.aQ.nA.removeChild(T.dE); } } } delete T.ru; }, afD: function (cw, mq, bb, kk) { var oP = cw.transform({ x: 0, y: 0 }); var jV = cw.transform({ x: 1, y: 0 }); var oS = oP.x - jV.x; var LG = oS * oS; oS = oP.y - jV.y; LG += oS * oS; var bS = Math.sqrt(LG); var Bm = { width: bb.width * bS + 'px', height: bb.height * bS + 'px' }; var nN = cw.Ki(); if (nN) { Bm.flip = 'x'; } else { Bm.flip = ''; } var ce = cw.Ew(); if ((ce > 45 && ce < 135) || (ce > 225 && ce < 315)) { Bm.left = (bb.height - bb.width) * bS / 2 + 'px'; Bm.top = (bb.width - bb.height) * bS / 2 + 'px'; } else { Bm.left = '0px'; Bm.top = '0px'; } var G, aj, T; for (G = 0; G < kk.length; G++) { T = kk[G]; this.ae(T.ru, { rotation: nN ? -ce : ce }); this.eC(T.ru, Bm); if (T.jv && T.jv.length) { for (aj = 0; aj < T.jv.length; aj++) { if (T.jv[aj].imgearCalloutSized) { this.ae(T.jv[aj], { weight: T.R.CA * bS }); } else { if (T.R.get_type() !== IPCC.Web.UI.MarkType.SignaturePath) { this.ae(T.jv[aj], { weight: T.R.dQ * bS }); } else { this.ae(T.jv[aj], { weight: (T.R.Ka > 0) ? T.R.Ka : T.R.dQ * bS }); } } } } if (T.dE) { this.ayk(T, cw, bS); } if (T.er) { this.ayU(T, cw, bS); } } }, air: function () { this.aQ = undefined; }, aK: function (aa) { return document.createElement('igvml:' + aa); }, eC: function (aG, la) { if (!aG || !la) { return; } var G; for (G in la) { if (la.hasOwnProperty(G)) { if (aG.style[G] !== la[G]) { aG.style[G] = la[G]; } } } }, ae: function (aG, bu) { if (!aG || !bu) { return; } var G, bj; if (document.documentMode === 8) { for (G in bu) { if (bu.hasOwnProperty(G)) { bj = bu[G]; if (bj === undefined || bj === null) { continue; } var str = bj.toString(); if (aG[G] !== str) { aG[G] = str; } } } } else { for (G in bu) { if (bu.hasOwnProperty(G)) { bj = bu[G]; if (bj === undefined || bj === null) { continue; } aG.setAttribute(G, bu[G].toString()); } } } } }; IPCC.akR = function (C, pN) { var aO = this; this.anq = 'opacity'; this.amO = function (dI) { return dI.toString(); }; var amn = function amn(aQ, cw, mq, bb, lG, mp) { var kv; if (this.C.qp() === true) { aQ.Iu.setAttribute('width', mq.width); aQ.Iu.setAttribute('height', mq.height); aQ.yb.setAttribute('width', mq.width); aQ.yb.setAttribute('height', mq.height); kv = cw.qy().toString() + ',' + cw.qk().toString() + ',' + cw.sC().toString() + ',' + cw.vV().toString() + ',' + (cw.yB() + lG).toString() + ',' + (cw.zT() + mp).toString(); this.kR(aQ.Lw, 'transform', 'matrix(' + kv + ')'); } else { aQ.Iu.setAttribute('width', mq.width); aQ.Iu.setAttribute('height', mq.height); aQ.yb.setAttribute('width', mq.width); aQ.yb.setAttribute('height', mq.height); kv = cw.qy().toString() + ',' + cw.qk().toString() + ',' + cw.sC().toString() + ',' + cw.vV().toString() + ',' + (cw.yB() + lG).toString() + ',' + (cw.zT() + mp).toString(); this.kR(aQ.Lw, 'transform', 'matrix(' + kv + ')'); } }; var adJ, acL; this.UN = function (aQ, cw, mq, bb, lG, mp) { if (aQ.adg.match('maglevel')) { amn.apply(this, arguments); return; } var av = aQ.gc.parentElement.getBoundingClientRect(); var lk = av.width / bb.width; var aqD = function (val) { return Math.abs(val) < 1.0e-14; }; var eP = 0, gr = 0; var azN = function () { var qg = cw.qk(); if (aqD(qg)) { qg = 0; } var sy = cw.sC(); if (aqD(sy)) { sy = 0; } var aqk = cw.qy(); var ce = (qg >= 0 && sy < 0) ? 90 : (qg < 0 && sy >= 0) ? 270 : (aqk < 0) ? 180 : (qg >= 0 && sy >= 0) ? 0 : 0; switch (ce) { case 90: eP = av.width; break; case 180: eP = av.width; gr = av.height; break; case 270: gr = av.height; break; } return ce * (Math.PI / 180); }; var ce = azN(); if (parseInt(ce, 10) === 1 || parseInt(ce, 10) === 4) { lk = av.height / bb.width; } if (lk === adJ && ce === acL) { return; } else { adJ = lk; acL = ce; } var he = 1, jq = 0; if (ce !== 0) { he = Math.cos(ce); jq = Math.sin(ce); } var bz = { lk: he * lk, rw: he * lk, qg: jq * lk, sy: jq * -1 * lk, eP: eP, gr: gr }; var aCs = new IPCC.ef(bz.lk, bz.qg, bz.sy, bz.rw, bz.eP, bz.gr); cw.Qi(aCs); C.bG().lv(cw); var kv = 'matrix({scaleX},{skewX},{skewY},{scaleY},{moveX},{moveY})'; kv = kv.replace('{scaleX}', bz.lk).replace('{scaleY}', bz.rw).replace('{skewX}', bz.qg).replace('{skewY}', bz.sy).replace('{moveX}', bz.eP).replace('{moveY}', bz.gr); this.kR(aQ.Lw, 'transform', kv); }; this.aeh = function () { adJ = undefined; acL = undefined; }; this.anO(C); this.akz = function (aW) { var aU = new IPCC.EB(aW.clientWidth, aW.clientHeight, 96, 96); return aU; }; this.Wy = function (bJ) { bJ.preventDefault(); aO.jO(bJ); }; this.WF = function (bJ) { bJ.preventDefault(); aO.lp(bJ); }; this.XH = function (bJ) { bJ.preventDefault(); aO.iB(bJ); }; this.abX = function (bJ) { aO.jO(bJ); }; this.ahD = function (bJ) { aO.vS(bJ); }; this.adl = function (bJ) { aO.lp(bJ); }; this.GW = function (bJ) { aO.lY(bJ); }; this.PV = 0; this.adk = function (bJ) { if (bJ.rawEvent.detail > 1) { if (window.navigator.msPointerEnabled) { var acz = false; if (! !(navigator.userAgent.match('6.1')) && document.documentMode === 11) { acz = true; } if (!this.PV) { if (bJ.target instanceof SVGPolylineElement && acz === true) { aO.vS(bJ); } else { aO.iB(bJ); } this.PV = bJ.rawEvent.timeStamp; return; } var aor = 500; if (acz) { aor = 8000; } if (bJ.rawEvent.timeStamp - this.PV > aor) { aO.iB(bJ); } else { aO.vS(bJ); } this.PV = bJ.rawEvent.timeStamp; } else { aO.vS(bJ); } } else { aO.iB(bJ); } }; this.aag = function (bJ) { aO.Ok(bJ); }; this.Nn = function (bJ) { if (bJ.target !== document.activeElement) { aO.aph(bJ); } }; this.VN = function (bJ) { if (bJ.target !== document.activeElement) { aO.anK(bJ); } }; this.qE = function (bJ) { try { bJ.preventDefault(); var L = new IPCC.Web.UI.MouseEventArgs(); L.domEvent = bJ; aO.uF(L); C.aBt(L); } catch (ex) { C.bK('mouseOut', ex); } }; this.OS = function (bJ) { try { bJ.preventDefault(); var L = new IPCC.Web.UI.MouseEventArgs(); L.domEvent = bJ; aO.uF(L); C.aBO(L); } catch (ex) { C.bK('touchStart', ex); } }; this.Ps = function (bJ) { try { bJ.preventDefault(); var L = new IPCC.Web.UI.MouseEventArgs(); L.domEvent = bJ; aO.uF(L); C.aCr(L); } catch (ex) { C.bK('touchMove', ex); } }; this.Qd = function (bJ) { try { bJ.preventDefault(); var L = new IPCC.Web.UI.MouseEventArgs(); L.domEvent = bJ; aO.uF(L); C.aBe(L); } catch (ex) { C.bK('touchEnd', ex); } }; this.Ke = function (bJ) { try { bJ.preventDefault(); var L = new IPCC.Web.UI.MouseEventArgs(); L.domEvent = bJ; aO.uF(L); C.aBd(L); } catch (ex) { C.bK('touchCancel', ex); } }; this.ann = function (bJ) { try { bJ.preventDefault(); } catch (ex) { C.bK('dragStart', ex); } }; this.alX = function () { var ew = C.le().igElements.nd; IPCC.Web.UI.al.addHandler(ew, "mousewheel", this.GW); IPCC.Web.UI.al.addHandler(ew, "DOMMouseScroll", this.GW); if (pN) { IPCC.Web.UI.al.addHandler(ew, "touchstart", this.OS); IPCC.Web.UI.al.addHandler(ew, "touchmove", this.Ps); IPCC.Web.UI.al.addHandler(ew, "touchend", this.Qd); IPCC.Web.UI.al.addHandler(ew, "touchcancel", this.Ke); } IPCC.Web.UI.al.addHandler(ew, "mouseout", this.qE); IPCC.Web.UI.al.addHandler(ew, "dragstart", this.ann); }; this.ajs = function () { var ew = C.le().igElements.nd; IPCC.Web.UI.al.removeHandler(ew, "DOMMouseScroll", this.GW); IPCC.Web.UI.al.removeHandler(ew, "mouseout", this.qE); if (pN) { IPCC.Web.UI.al.removeHandler(ew, "touchstart", this.OS); IPCC.Web.UI.al.removeHandler(ew, "touchmove", this.Ps); IPCC.Web.UI.al.removeHandler(ew, "touchend", this.Qd); IPCC.Web.UI.al.removeHandler(ew, "touchcancel", this.Ke); } IPCC.Web.UI.al.removeHandler(ew, "dragstart", this.ann); }; this.akf = function (aQ, gc, qo, yu) { var G, as, aW, aaw; var Rc = function (aa, fg, bu) { var aW = document.createElementNS('http://www.w3.org/2000/svg', aa); var G; if (fg) { aW.setAttribute('id', fg); } for (G in bu) { if (bu.hasOwnProperty(G)) { aW.setAttribute(G, bu[G]); } } return aW; }; var gC = Rc('svg', null, { xmlns: 'http://www.w3.org/2000/svg', version: '1.1', xlink: 'http://www.w3.org/1999/xlink', 'image-rendering': 'optimizeQuality' }); aQ.yb = Rc('rect', null, { x: 0, y: 0, 'fill-opacity': '0.005', fill: '#808080' }); gC.appendChild(aQ.yb); var XL = Rc('g', null, {}); aQ.Lw = XL; gC.appendChild(XL); var dg; if (C.qp() === false) { dg = qo.et.length; } else { dg = 1; } for (G = 0; G < dg; G++) { as = qo.et[G]; as.pool.parentElementID = yu + G.toString(); aaw = 1 / as.bS; aW = Rc('g', as.pool.parentElementID, { transform: 'matrix(' + aaw.toString() + ',0,0,' + aaw.toString() + ',0,0)' }); XL.appendChild(aW); } aQ.Iu = gC; gc.appendChild(gC); }; this.aqU = function (fh) { var QZ = this.abS(); fh.elementID = QZ; }; this.adV = function (fh) { var aW = document.getElementById(fh.elementID); this.kR(aW, 'display', 'none'); }; this.acX = function (fh) { var aW = document.getElementById(fh.elementID); if (aW === null) { fh.elementID = ''; return; } aW.setAttributeNS('http://www.w3.org/1999/xlink', 'href', ''); aW.parentNode.removeChild(aW); fh.elementID = ''; }; var Ic = function (bJ) { try { bJ.target.onload = undefined; bJ.target.onerror = undefined; bJ.target.onabort = undefined; var fh = bJ.target.poolItem; fh.loaded = true; aO.zv(); } catch (ex) { C.bK('downloadImage', ex); } }; var alS = function (bJ) { try { bJ.target.onload = undefined; bJ.target.onerror = undefined; bJ.target.onabort = undefined; bJ.target.setAttributeNS('http://www.w3.org/1999/xlink', 'href', ''); bJ.target.setAttribute('display', 'none'); throw new IPCC.Web.UI.ImGearException('An image failed to download or the user cancelled it', { name: 'IPCC.Web.UI.ImGearHttpException' }); } catch (ex) { C.bK('downloadImage', ex); var dz = new IPCC.Web.UI.ImGearPageOpenFailedEventArgs(); dz.exception = ex; dz.pageNumber = C.aD; C.aM('pageOpenFailed', dz); } }; this.ark = function (kG) { var G; var dg = kG.length; if (C.qp() === false) { dg = kG.length; } else { dg = 1; } for (G = 0; G < dg; G++) { var hu = kG[G]; var aW = document.getElementById(hu.poolItem.elementID); if (aW === null) { var fh = hu.poolItem; var Gm = fh.pool; var gc = document.getElementById(Gm.parentElementID); aW = document.createElementNS('http://www.w3.org/2000/svg', 'image'); this.kR(aW, 'id', fh.elementID); this.kR(aW, 'externalResourcesRequired', 'true'); aW.poolItem = fh; aW.onload = Ic; aW.onerror = alS; aW.onabort = alS; if (document.documentMode > 8 || IPCC.J.LK.SY) { fh.loaded = true; } aW.setAttributeNS('http://www.w3.org/1999/xlink', 'href', 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7'); this.Ui(aW, hu.url, 'image/' + hu.contentType); gc.appendChild(aW); this.kR(aW, 'display', 'block'); var ax = hu.right - hu.x; var cR = hu.bottom - hu.y; this.kR(aW, 'x', hu.x); this.kR(aW, 'y', hu.y); this.kR(aW, 'width', ax); this.kR(aW, 'height', cR); } this.kR(aW, 'display', 'block'); } if ((document.documentMode > 8 || IPCC.J.LK.SY) && kG.length > 0) { aO.zv(); } }; this.Ui = function (aW, am, sB) { var pq = true; var mn = 0; if (C.hT() === 0) { pq = false; } function fa(bF) { var cT, dz; try { var fw = IPCC.Web.Hg(bF), Mg; var lV = bF.getResponseHeader("Accusoft-Data-Encrypted"); if (lV === 'true' && C.eG() === true) { var sf = IPCC.Web.hm.nC.te(bF.getResponseHeader("Accusoft-Data-SK")); var aq = IPCC.Web.Hw(sf, hw); var vb = IPCC.Web.AB(fw, aq, hw); Mg = IPCC.Web.hm.nC.nh(vb, 0, 0); } else { Mg = IPCC.Web.hm.nC.nh(fw, 0, 0); } aW.setAttributeNS('http://www.w3.org/1999/xlink', 'href', 'data:' + sB + ';base64,' + Mg); } catch (ex) { cT = "Image error, Error message = " + ex.message; dz = new IPCC.Web.UI.ImGearPageOpenFailedEventArgs(); dz.exception = ex; dz.pageNumber = C.aD; C.aM('pageOpenFailed', dz); throw new IPCC.Web.UI.ImGearArgumentException(null, cT); } }; function eZ(bM) { var fS = bM.response.status, cT, ly, kA; if (!bM.response) { throw new IPCC.Web.UI.ImGearHttpException(fS, "Client Image load timeout"); } if (fS === 403) { mn++; if (bM.response.statusText && bM.response.statusText !== "") { cT = "Expired viewer session ID, error message from the server: " + bM.response.statusText; } else { cT = "Expired viewer session ID. No error text message was received from the server:"; } throw new IPCC.Web.UI.ImGearHttpException(fS, cT); } ly = bM.response.getResponseHeader('Accusoft-Status-Message'); if (ly) { var pr; kA = bM.response.getResponseHeader('Accusoft-Status-Number'); if (IPCC.Web.vo(kA)) { pr = parseInt(kA, 10); } throw new IPCC.Web.UI.ImGearHttpException(fS, ly, pr); } else { if (bM.response.statusText && bM.response.statusText !== "") { cT = bM.response.statusText; } else { cT = "HTTP Error was received from the image server but the server did not provide any error description."; } throw new IPCC.Web.UI.ImGearHttpException(fS, cT); } }; var hc = { method: 'GET' }; if (pq === true) { hc.timeout = C.hT(); } if (C.adt() && C.eG() === true) { var hw = IPCC.Web.qS.Ow(4); var nK = IPCC.Web.hm.Fr.nh(hw); var abI = am + '&iv=' + nK; hc.url = abI; } else { hc.mimeType = 'text/plain; charset=x-user-defined'; hc.url = am; } IPCC.J.mt.dZ(hc).then(fa, eZ); }; this.arH = function (aQ) { if (aQ.WU) { return; } var mn = 0; var hu = aQ.qo.et[0].tiles[0]; if (!hu) { return; } var Gm = hu.level.pool; var gc = document.getElementById(Gm.parentElementID); var pq = true; if (C.hT() === 0) { pq = false; } var zG = C.Mk(); if (aQ.LC) { if (zG === 2) { delete aQ.LC; if (gc.childNodes.length > 0) { gc.removeChild(gc.childNodes[0]); } } else if (zG === 1) { if (gc.childNodes.length > 0) { gc.removeChild(gc.childNodes[0]); } } else { if (gc.childNodes.length === 0) { gc.appendChild(aQ.asL); } } C.Bc = true; return; } if (zG > 0) { return; } function fa(bF) { var dz, cT; aQ.WU = false; try { try { var ty; var lV = bF.getResponseHeader("Accusoft-Data-Encrypted"); if (lV === 'true' && C.eG() === true) { var sf = IPCC.Web.hm.nC.te(bF.getResponseHeader("Accusoft-Data-SK")); var aq = IPCC.Web.Hw(sf, hw); var fw = IPCC.Web.Hg(bF); var vb = IPCC.Web.AB(fw, aq, hw); ty = IPCC.Web.hm.GR.nh(vb); } else { ty = bF.responseText; } aAI(ty); } catch (ex) { cT = "SVG image error, Error message = " + ex.message; dz = new IPCC.Web.UI.ImGearPageOpenFailedEventArgs(); dz.exception = ex; dz.pageNumber = C.aD; C.aM('pageOpenFailed', dz); throw new IPCC.Web.UI.ImGearArgumentException(null, cT); } } catch (e) { C.bK('openPage', e); if (typeof (C.aM) === 'function') { dz = new IPCC.Web.UI.ImGearPageOpenFailedEventArgs(); dz.exception = e; dz.pageNumber = C.aD; C.aM('pageOpenFailed', dz); } } }; function eZ(bM) { var dz, cT, ly, kA; aQ.WU = false; try { if (!bM.response) { throw new IPCC.Web.UI.ImGearHttpException(0, "Client SVG load timeout"); } var fS = bM.response.status; if (fS === 480) { mn++; if (bM.response.statusText && bM.response.statusText !== "") { cT = cT = "PDF file password required, error message from the server: " + bM.response.statusText; } else { cT = "PDF file password required."; } throw new IPCC.Web.UI.ImGearHttpException(fS, cT); } if (fS === 403) { mn++; if (bM.response.statusText && bM.response.statusText !== "") { cT = "Expired viewer session ID, error message from the server: " + bM.response.statusText; } else { cT = "Expired viewer session ID. No error text message was received from the server:"; } throw new IPCC.Web.UI.ImGearHttpException(fS, cT); } ly = bM.response.getResponseHeader('Accusoft-Status-Message'); if (ly) { var pr; kA = bM.response.getResponseHeader('Accusoft-Status-Number'); if (IPCC.Web.vo(kA)) { pr = parseInt(kA, 10); } throw new IPCC.Web.UI.ImGearHttpException(fS, ly, pr); } else { if (bM.response.statusText && bM.response.statusText !== "") { cT = bM.response.statusText; } else { cT = "HTTP Error was received from the image server but the server did not provide any error description."; } throw new IPCC.Web.UI.ImGearHttpException(fS, cT); } } catch (e) { C.bK('openPage', e); if (typeof (C.aM) === 'function') { dz = new IPCC.Web.UI.ImGearPageOpenFailedEventArgs(); dz.exception = e; dz.pageNumber = C.aD; C.aM('pageOpenFailed', dz); } } }; var axM = function () { C.Bc = true; C.aM('pageDisplayed', { bp: C.aD }); }; var aAI = function (gM) { var ye = Gm.parentElementID.toString(); var Lj = (IPCC.J.Ni || IPCC.J.aoL) ? '' : window.location.href.replace(window.location.hash, '').replace(/#$/, ''); var aDG = Lj.replace(/"/g, '\\$&'); var ajX = Lj.replace(/[()]/g, '\\$&'); gM = gM.replace(/href="#/g, 'href="' + aDG + '#' + ye); gM = gM.replace(/="url\(#/g, '="url(' + ajX + '#' + ye); gM = gM.replace(/fill:url\(#/g, 'fill:url(' + ajX + '#' + ye); gM = gM.replace(/ id="/g, ' id="' + ye); gM = gM.replace(/<use([^>]+)\/>/g, ' <use$1></use>'); var Yc = document.createElement('div'); Yc.innerHTML = gM; var qh = Yc.querySelectorAll('style'); IPCC.J.forEach(qh, function (bL) { var akq = (bL.styleSheet) ? bL.styleSheet.cssText : bL.textContent; if (bL.styleSheet) { bL.styleSheet.cssText = akq; } else { bL.appendChild(document.createTextNode(akq)); } }); var jQ = null; var Oc = Yc.firstChild; while (Oc !== null) { if (Oc.nodeName === 'svg') { jQ = Oc; break; } Oc = Oc.nextSibling; } if (jQ === null) { throw new IPCC.Web.UI.ImGearInvalidOperationException('Unable to process SVG image data.'); } if (!aQ.LC) { aQ.asL = jQ; gc.appendChild(jQ); aQ.LC = true; if (!C.Bc && aQ.LC) { setTimeout(axM, 1); } } }; var am; var hw, nK; C.Bc = false; if (C.eG() === true) { hw = IPCC.Web.qS.abx(4, IPCC.Web.PE()); nK = IPCC.Web.hm.Fr.nh(hw); am = hu.url + '&iv=' + nK; } else { am = hu.url; } var hc = { method: 'GET', url: am }; if (pq === true) { hc.timeout = C.hT(); } aQ.WU = true; IPCC.J.mt.dZ(hc).then(fa, eZ); }; this.Zn = function (hu, dI) { if (!hu) { return; } var mQ = document.getElementById(hu.poolItem.elementID); this.kR(mQ, 'x', hu.x); this.kR(mQ, 'y', hu.y); this.kR(mQ, 'width', hu.right - hu.x); this.kR(mQ, 'height', hu.bottom - hu.y); this.kR(mQ, 'opacity', dI); this.kR(mQ, 'display', 'block'); }; this.Zk = function (kG, dI, cw) { var G; if (C.qp() === false) { for (G = 0; G < kG.length; G++) { this.Zn(kG[G], dI); } } }; return this; }; IPCC.akR.prototype = new IPCC.bn(); IPCC.dv.akv = function () { }; IPCC.dv.Fw = 1; IPCC.dv.akv.prototype = { ame: function (C, aQ, bb) { this.C = C; this.bm = C.bG(); this.aQ = aQ; this.di = bb.width; this.cB = bb.height; this.vU = bb.hi; this.aCK = bb.hk; aQ.nA = this.aK('g'); this.ae(aQ.nA, { 'fill-opacity': 1 }); aQ.Lw.appendChild(aQ.nA); }, akM: function (T) { var cN = '', h, K = this; switch (T.R.get_type()) { case IPCC.Web.UI.MarkType.Rectangle: T.aG = this.aK('rect'); if (T.R.lh() && T.R.get_opacity() === 255) { T.aG.addEventListener("mouseover", function (L) { if (T.R.get_selected() === false && T.aG && (L.which === 0 || L.buttons === 0)) { T.aG.style.opacity = 127 / 255; } }, false); T.aG.addEventListener("mouseout", function (L) { if (T.aG && (L.which === 0 || L.buttons === 0)) { T.aG.style.opacity = T.R.get_opacity() / 255; } }, false); } break; case IPCC.Web.UI.MarkType.HighlightText: cN = "highlighttextannotation-" + T.R.jf(); T.aG = this.aK('g'); T.dS = this.aK('g'); T.aG.appendChild(T.dS); T.mx = this.aK('g'); T.mx.setAttribute('data-pcc-mark', cN); T.aG.appendChild(T.mx); break; case IPCC.Web.UI.MarkType.TextHyperlinkAnnotation: cN = "texthyperlinkannotation-" + T.R.jf(); T.aG = this.aK('g'); T.aG.style.cursor = IPCC.bP.fq(IPCC.bP.Link); T.dS = this.aK('g'); T.aG.appendChild(T.dS); T.mx = this.aK('g'); T.mx.style.opacity = IPCC.dv.bn.KB(); T.mx.style.fill = "blue"; T.mx.setAttribute('data-pcc-mark', cN); T.aG.appendChild(T.mx); T.lZ = this.aK('g'); T.lZ.style.stroke = "blue"; T.lZ.style.opacity = IPCC.dv.bn.xz(false); T.lZ.setAttribute('data-pcc-mark', cN); T.aG.appendChild(T.lZ); T.aG.addEventListener("mouseover", function (L) { if (T.lZ) { T.lZ.style.opacity = IPCC.dv.bn.xz(true, T.R.get_selected()); } }, false); T.aG.addEventListener("mouseout", function (L) { if (T.lZ) { T.lZ.style.opacity = IPCC.dv.bn.xz(false, T.R.get_selected()); } }, false); break; case IPCC.Web.UI.MarkType.DocumentHyperlink: cN = "documenthyperlink-" + T.R.jf(); T.aG = this.aK('g'); T.aG.style.cursor = IPCC.bP.fq(IPCC.bP.Link); T.h = this.aK('rect'); T.h.style['fill-opacity'] = IPCC.dv.bn.KB(); if (T.R.zy !== 'Underline') { T.h.style.stroke = T.R.gX; T.h.style['stroke-width'] = T.R.dQ + 'px'; T.h.style['stroke-opacity'] = (T.R.dQ === 0) ? 0 : T.R.oQ / 255; if (T.R.zy === 'Dashed') { T.h.style['stroke-dasharray'] = T.R.BK.join(', '); } T.h.setAttribute('rx', T.R.Ep); T.h.setAttribute('ry', T.R.Fd); } else { T.kZ = this.aK('line'); T.kZ.style.stroke = T.R.gX; T.kZ.style['stroke-opacity'] = T.R.oQ / 255; T.kZ.style['stroke-width'] = T.R.dQ + 'px'; T.aG.appendChild(T.kZ); } T.h.style.fill = 'transparent'; T.h.setAttribute('data-pcc-mark', cN); T.aG.appendChild(T.h); break; case IPCC.Web.UI.MarkType.RectangleRedaction: cN = "textmark-" + T.R.jf(); T.aG = this.aK('g'); T.hf = this.aK('rect'); T.hB = this.aK('g'); T.hB.setAttribute('data-pcc-mark', cN); if (IPCC.J.LK.aAS) { T.hB.style.cursor = 'pointer'; } T.vf = document.createTextNode(''); if (document.documentMode > 8) { T.da = this.aK('text'); T.da.setAttribute('data-pcc-mark', cN); T.da.appendChild(T.vf); T.Cj = this.aK('clipPath'); T.Gy = this.aK('rect'); T.hB.appendChild(T.Cj); T.Cj.appendChild(T.Gy); T.hB.appendChild(T.da); T.LH = "PCC" + IPCC.dv.Fw; IPCC.dv.Fw++; this.ae(T.Cj, { id: T.LH, clipPathUnits: "userSpaceOnUse" }); h = T.R.get_rectangle(); this.ae(T.Gy, { x: 0, y: 0, width: h.width, height: h.height, "data-pcc-mark": cN }); var agl = function (L) { if (T.R.get_selected() === false && T.hf && (L.which === 0 || L.buttons === 0)) { if (K.C.kU() === false) { T.aG.style.opacity = 0.5; T.da.style.opacity = 0; } } }; T.aG.addEventListener("mouseover", function (L) { agl(L); }, false); T.hB.addEventListener("mouseover", function (L) { agl(L); }, false); T.hB.addEventListener("mouseout", function (L) { if (T.hf && (L.which === 0 || L.buttons === 0)) { if (K.C.kU() === false) { T.aG.style.opacity = 1; T.da.style.opacity = 1; } } }, false); T.aG.addEventListener("mouseout", function (L) { if (T.hf && (L.which === 0 || L.buttons === 0)) { if (K.C.kU() === false) { T.aG.style.opacity = 1; T.da.style.opacity = 1; } } }, false); } else { T.dE = document.createElement('div'); this.ae(T.dE, { "data-pcc-mark": cN }); T.dE.appendChild(T.vf); T.RZ = document.createElement('div'); this.ae(T.RZ, { "data-pcc-mark": cN }); T.RZ.appendChild(T.dE); T.uk = document.createElement('body'); this.ae(T.uk, { xmlns: 'http://www.w3.org/1999/xhtml', style: 'margin:0;overflow:hidden;background-color:transparent;white-space:pre-wrap;', "data-pcc-mark": cN }); T.uk.appendChild(T.RZ); T.GI = this.aK('foreignObject'); T.GI.appendChild(T.uk); T.hB.appendChild(T.GI); T.uk.addEventListener("mouseover", function (L) { if (T.R.get_selected() === false && T.hf && (L.which === 0 || L.buttons === 0)) { T.hf.style.opacity = 0.5; T.dE.style.opacity = 0; } }, false); T.uk.addEventListener("mouseout", function (L) { if (T.hf && (L.which === 0 || L.buttons === 0)) { if (K.C.kU() === false) { T.hf.style.opacity = 1; T.dE.style.opacity = 1; } } }, false); } T.aG.appendChild(T.hf); break; case IPCC.Web.UI.MarkType.Ellipse: T.aG = this.aK('ellipse'); break; case IPCC.Web.UI.MarkType.Highlight: T.aG = this.aK('rect'); break; case IPCC.Web.UI.MarkType.TextSelectionRedaction: T.aG = this.aK('g'); T.dS = T.aG; break; case IPCC.Web.UI.MarkType.Line: case IPCC.Web.UI.MarkType.Polyline: T.aG = this.aK('g'); T.hZ = this.aK('polyline'); T.yL = this.aK('path'); T.xg = this.aK('path'); T.aG.appendChild(T.hZ); T.aG.appendChild(T.yL); T.aG.appendChild(T.xg); T.hZ.setAttribute('stroke-linejoin', 'miter'); T.hZ.setAttribute('stroke-linecap', 'butt'); T.hZ.setAttribute('stroke-miterlimit', '4'); break; case IPCC.Web.UI.MarkType.Polygon: T.aG = this.aK('polygon'); break; case IPCC.Web.UI.MarkType.Text: case IPCC.Web.UI.MarkType.TextAreaSignature: cN = "textmark-" + T.R.jf(); T.aG = this.aK('g'); T.sn = this.aK('polygon'); T.hZ = this.aK('path'); T.rH = this.aK('path'); T.hB = this.aK('g'); T.aG.appendChild(T.sn); T.aG.appendChild(T.hZ); T.aG.appendChild(T.rH); this.ae(T.sn, { style: 'stroke:none;' }); T.hB.setAttribute('data-pcc-mark', cN); T.vf = document.createTextNode(''); if (document.documentMode > 8) { T.da = this.aK('text'); T.da.setAttribute('data-pcc-mark', cN); T.da.appendChild(T.vf); T.Cj = this.aK('clipPath'); T.Gy = this.aK('rect'); T.hB.appendChild(T.Cj); T.Cj.appendChild(T.Gy); T.anG = this.aK('g'); T.hB.appendChild(T.anG); T.hB.appendChild(T.da); T.LH = "PCC" + IPCC.dv.Fw; IPCC.dv.Fw++; this.ae(T.Cj, { id: T.LH, clipPathUnits: "userSpaceOnUse" }); h = T.R.get_rectangle(); this.ae(T.Gy, { x: 0, y: 0, width: h.width, height: h.height, "data-pcc-mark": cN }); } else { T.dE = document.createElement('div'); T.dE.appendChild(T.vf); T.uk = document.createElement('body'); this.ae(T.uk, { xmlns: 'http://www.w3.org/1999/xhtml', style: 'margin:0;overflow:hidden;background-color:transparent;white-space:pre-wrap;', "data-pcc-mark": cN }); T.uk.appendChild(T.dE); T.GI = this.aK('foreignObject'); T.GI.appendChild(T.uk); T.hB.appendChild(T.GI); } T.sn.setAttribute('data-pcc-mark', cN); break; case IPCC.Web.UI.MarkType.Stamp: T.aG = this.aK('g'); T.vt = this.aK('rect'); T.vt.style = 'fill:rgba(255, 255, 255, 0);stroke:none;'; T.hf = this.aK('rect'); T.MK = this.aaT(T); T.aG.appendChild(T.vt); T.aG.appendChild(T.hf); T.aG.appendChild(T.MK); break; case IPCC.Web.UI.MarkType.ImageStampAnnotation: case IPCC.Web.UI.MarkType.ImageStampRedaction: T.aG = this.aK('g'); T.vt = this.aK('rect'); T.vt.style = 'fill:rgba(255, 255, 255, 0);stroke:none;'; T.hf = this.aK('rect'); T.aes = this.auC(T); T.aes.setAttribute('data-pcc-mark', "mark-" + T.R.jf()); T.aG.appendChild(T.vt); T.aG.appendChild(T.hf); T.aG.appendChild(T.aes); break; case IPCC.Web.UI.MarkType.SignaturePath: case IPCC.Web.UI.MarkType.Freehand: var R = T.R; var ajU = R.fD(); var ax = ajU.width; var cR = ajU.height; var tA = R.get_pathWidth(); var vh = R.get_pathHeight(); var rs = R.get_pathString(); var cj = IPCC.J.yg.Path(rs, { width: ax, height: cR, multiplier: 100, thickness: R.get_lineWidth(), color: R.get_lineColor() }); var gC = IPCC.J.yg.SVG('0 0 ' + tA + ' ' + vh, 100); var ai = IPCC.J.yg.Rect(tA, vh, 'fill:rgba(255, 255, 255, 0);stroke:none;'); gC.appendChild(ai); gC.appendChild(cj); T.aG = gC; T.aGG = cj; T.aeS = ai; this.adq(T.aG, R.kh); break; case IPCC.Web.UI.MarkType.SignatureText: T.aG = this.aK('g'); T.hf = this.aK('rect'); T.hf.style = 'fill:rgba(255, 255, 255, 0);stroke:none;'; T.MK = this.aaT(T); T.aG.appendChild(T.hf); T.aG.appendChild(T.MK); T.R.hv = false; break; case IPCC.Web.UI.MarkType.TextLine: T.aG = this.aK('g'); T.hf = this.aK('rect'); T.hf.style = 'fill:rgba(255, 255, 255, 0);stroke:none;'; T.MK = this.aaT(T); T.aG.appendChild(T.hf); T.aG.appendChild(T.MK); break; case IPCC.Web.UI.MarkType.Strikethrough: cN = "strikethroughannotation-" + T.R.jf(); T.aG = this.aK('g'); T.dS = this.aK('g'); T.aG.appendChild(T.dS); T.mx = this.aK('g'); T.mx.setAttribute('data-pcc-mark', cN); T.aG.appendChild(T.mx); T.zP = this.aK('g'); T.zP.setAttribute('data-pcc-mark', cN); T.aG.appendChild(T.zP); break; } T.aG.ImGearMarkRelation = T; T.aG.setAttribute('data-pcc-mark', "mark-" + T.R.jf()); this.aQ.nA.appendChild(T.aG); if (T.hB) { T.hB.ImGearMarkRelation = T; this.aQ.nA.appendChild(T.hB); } this.Rw(T); }, aaT: function (T) { var R = T.R; var iV = R.az; if (!iV) { iV = R.dO[0]; if (!iV) { if (R.get_type() === IPCC.Web.UI.MarkType.Stamp) { iV = "APPROVED"; } else { iV = ""; } } } var h = R.fD(); T.da = this.aK('text'); T.LH = "PCC" + IPCC.dv.Fw; IPCC.dv.Fw++; var oZ = document.createTextNode(iV); T.da.setAttribute("font-size", "22px"); if (R.get_type() === IPCC.Web.UI.MarkType.TextLine) { T.da.setAttribute("style", 'white-space:pre;'); } switch (T.R.kh) { case IPCC.Web.UI.HorizontalAlignment.Left: T.da.setAttribute('text-anchor', 'start'); T.da.setAttribute('x', h.x); break; case IPCC.Web.UI.HorizontalAlignment.Right: T.da.setAttribute('text-anchor', 'end'); T.da.setAttribute("x", h.x + h.width); break; default: T.da.setAttribute('text-anchor', 'middle'); T.da.setAttribute("x", h.x + (h.width / 2)); break; } T.da.setAttribute('y', h.y + (h.height / 2)); T.da.appendChild(oZ); return T.da; }, auC: function (T) { var R = T.R; T.gi = document.createElementNS('http://www.w3.org/2000/svg', 'svg'); T.zd = document.createElementNS('http://www.w3.org/2000/svg', 'image'); T.zd.setAttribute('id', 'childimg'); T.zd.setAttributeNS('http://www.w3.org/1999/xlink', 'href', R.get_image()); T.gi.appendChild(T.zd); return T.gi; }, aqK: function (T, kh) { var R = T.R; var h = R.fD(); var az = R.az; var LN = az.split('\n'); var da = T.da; var abF = 0; var abv = 0; var acB = 0; var AD = 0; var aoI = 0; var aiZ = this.vU / 72; var ais = R.cd * aiZ; var zJ = []; var aGm = /(.*\s)(.*)/; var oZ, kd, Lb, GP, _parent, ahZ, Je, JX, ala, Cc, aoo, Fe; ahZ = da.childNodes.length; if (ahZ >= 1) { _parent = da.parentNode; Je = this.aK('text'); Je.setAttribute('data-pcc-mark', T.hB.getAttribute('data-pcc-mark')); Je.setAttribute('width', T.hB.getAttribute('width') - T.R.dQ); _parent.replaceChild(Je, da); T.da = Je; T.da.appendChild(T.vf); T.hB.appendChild(T.da); da = {}; da = T.da; } da.style.fontSize = R.cd * this.vU / 72 + 'px'; da.style.fontFamily = R.gZ; da.width -= 4; JX = (R.dQ / 2); if (kh) { switch (kh) { case IPCC.Web.UI.HorizontalAlignment.Center: JX = (h.width / 2) - (R.dQ / 2); break; case IPCC.Web.UI.HorizontalAlignment.Right: JX = h.width - R.dQ; break; } } for (var G = 0; G < LN.length; G++) { Cc = ''; aoo = 1; if (LN[G].length > 0) { Lb = LN[G].split(''); kd = this.aK('tspan'); kd.setAttributeNS(null, "x", JX); if (G > 0) { kd.setAttributeNS(null, "dy", ais * (acB + 1)); } oZ = window.document.createTextNode(Lb[0]); kd.appendChild(oZ); da.appendChild(kd); for (var aj = 1; aj < Lb.length; aj++) { aoI = kd.firstChild.data.length; GP = Lb[aj]; kd.firstChild.data += Lb[aj]; Cc += GP; ala = Cc.length * (R.cd * aiZ); abF = kd.getComputedTextLength(); if (abF === 0) { abv = ala; } else { abv = abF; } if (abv >= (h.width - R.dQ - 2)) { aoo++; Cc = ''; Fe = kd.firstChild.data.match(aGm); if (Fe) { GP = Fe[2]; } if (Fe && Fe[1].length > 0) { kd.firstChild.data = Fe[1]; Cc += GP; } else { kd.firstChild.data = kd.firstChild.data.slice(0, aoI); Cc += GP; } if (Cc.length >= 1) { zJ.push({ bh: AD, ajB: kd }); kd = this.aK('tspan'); kd.setAttributeNS(null, "x", JX); kd.setAttributeNS(null, "dy", ais); oZ = window.document.createTextNode(GP); kd.appendChild(oZ); da.appendChild(kd); } } } if (kd.firstChild.data.length > 0) { zJ.push({ bh: AD, ajB: kd }); } AD += kd.firstChild.data.length + 1; acB = 0; } else { acB++; } } return zJ; }, aEq: function (md, aik, dS, AD) { if (md.length > 0) { var apg = aik.getNumberOfChars(); if (md[0].bh > AD + apg) { return; } for (var G = Math.max(md[0].bh - AD, 0) ; G < apg; G++) { var h = aik.getExtentOfChar(G); var ai = this.aK('rect'); this.ae(ai, { x: h.x, y: h.y, width: h.width, height: h.height, fill: md[0].DV }); dS.appendChild(ai); if (md[0].fF === G + AD) { md.shift(); if (md.length === 0) { return; } G = md[0].bh - AD - 1; } } } }, nb: function (aW, jI, na) { var cj = 'M', G; for (G = 0; G < jI.length; G++) { if (G > 0) { cj += ' L'; } cj += jI[G].x + ',' + jI[G].y; } if (na) { cj += 'Z'; } this.ae(aW, { d: cj }); }, ZJ: function (aW, jI, na) { var MT = '', G; for (G = 0; G < jI.length; G++) { if (G > 0) { MT += ' '; } MT += jI[G].x + ',' + jI[G].y; } if (na && jI.length > 2) { MT += ' ' + jI[0].x + ',' + jI[0].y; } this.ae(aW, { points: MT }); }, Jj: function (fk, lu, vx, qI, sj, EI, qO) { var cF = this.ahm(fk, lu, vx, qI, sj); var bH = ''; bH += 'stroke:' + EI + ';'; switch (sj) { case IPCC.Web.UI.LineHeadType.None: bH = 'display:none;'; break; case IPCC.Web.UI.LineHeadType.Pointer: this.nb(qO, [cF.tM, fk, cF.tY], false); break; case IPCC.Web.UI.LineHeadType.Solid: this.nb(qO, [cF.tM, fk, cF.tY], true); bH += 'fill:' + EI + ';'; break; case IPCC.Web.UI.LineHeadType.Open: this.nb(qO, [cF.tM, fk, cF.tY], true); break; case IPCC.Web.UI.LineHeadType.PointerSolid: this.nb(qO, [cF.tM, fk, cF.tY, cF.yr], true); bH += 'fill:' + EI + ';'; break; } this.ae(qO, { style: bH }); return cF; }, Uy: function (T) { var R = T.R; var ag, fd, G, Me, Jv, ii = '', qa; ag = R.get_points(); fd = []; for (G = 0; G < ag.get_length() ; G++) { fd.push(ag.getPoint(G)); } if (fd.length < 2 || R.na) { this.ae(T.yL, { style: 'display:none;' }); this.ae(T.xg, { style: 'display:none;' }); } else { R.wH = R.gX; qa = this.Tq(fd, true); Me = this.Jj(qa.fk, qa.lu, R.ED, R.DP, R.Dr, R.wH, T.yL); qa = this.Tq(fd, false); Jv = this.Jj(qa.fk, qa.lu, R.HC, R.HT, R.mW, R.wH, T.xg); fd[0] = Me.yr; fd[fd.length - 1] = Jv.yr; } this.ZJ(T.hZ, fd, R.na); var Ag = this.AV(R.ii); if (Ag !== '') { ii += 'stroke-dasharray:' + Ag + ';'; } this.ae(T.hZ, { style: ii }); }, Qx: function (T) { var ra = this.afU(T); this.ZJ(T.sn, ra.aaA, false); var amK = '', ii = 'fill:none;', rR = 'fill:none;'; if (ra.SO) { amK = 'stroke:none;'; } if (ra.Mi) { this.nb(T.hZ, ra.Mi, false); } else { ii += 'display:none;'; } if (ra.GA) { this.nb(T.rH, ra.GA, false); } else { rR += 'display:none;'; } var R = T.R; if (R.At) { rR += 'stroke:' + R.Bo + ';stroke-width:' + R.CA + ';'; var Ag = this.AV(R.rR); if (Ag !== '') { rR += 'stroke-dasharray:' + Ag + ';'; } } this.ae(T.hZ, { style: ii }); this.ae(T.rH, { style: rR }); this.ae(T.sn, { style: amK }); }, HM: function (T) { var R = T.R, Ih; if (!R) { return; } var h = R.fD(); var mA = R.cd * this.vU / 72; R.mA = mA; var uC = h.width, qf = h.height, Le = false, fp; var kv, eW = 0, fe = 0; var jo = 1; if (R.hv) { jo += R.dQ / 2; } switch (R.wC) { case IPCC.Web.UI.Orientation.TopLeft: kv = '1,0,0,1'; break; case IPCC.Web.UI.Orientation.TopRight: kv = '-1,0,0,1'; eW = uC - jo; break; case IPCC.Web.UI.Orientation.BottomRight: kv = '-1,0,0,-1'; eW = uC - jo; fe = qf - jo; break; case IPCC.Web.UI.Orientation.BottomLeft: kv = '1,0,0,-1'; fe = qf - jo; break; case IPCC.Web.UI.Orientation.LeftTop: kv = '0,1,1,0'; Le = true; break; case IPCC.Web.UI.Orientation.RightTop: kv = '0,1,-1,0'; eW = uC - jo; Le = true; break; case IPCC.Web.UI.Orientation.RightBottom: kv = '0,-1,-1,0'; eW = uC - jo; fe = qf - jo; Le = true; break; case IPCC.Web.UI.Orientation.LeftBottom: kv = '0,-1,1,0'; fe = qf - jo; Le = true; break; } if (R.cK === "#c0c0c0") { R.cK = '#ffffff'; } if (R.get_type() === IPCC.Web.UI.MarkType.Text) { if (R.lh() === true) { R.cK = '#ffffff'; } else { R.set_opacity(R.dI); } } if (Le) { fp = uC; uC = qf; qf = fp; } if (uC < 0) { uC = 0; } if (qf < 0) { qf = 0; } var abJ = 'normal'; var de = 'normal'; var og = ''; var vj; og += 'word-wrap:break-word;background-color:transparent;line-height:1;'; var Be = 0; if (R.od.length === 7 && R.od.charAt(0) === '#') { Be = parseInt(R.od.slice(1), 16); } var dI = Math.min(1, Math.max(0, R.rE / 255)); if (document.documentMode > 8) { de = 'normal'; if (R.de & IPCC.Web.UI.FontStyle.Italic) { de = 'italic'; } abJ = 'normal'; if (R.de & IPCC.Web.UI.FontStyle.Bold) { abJ = 'bold'; } vj = 'none'; if ((R.de & IPCC.Web.UI.FontStyle.Underline) && (R.de & IPCC.Web.UI.FontStyle.Strikeout)) { vj = 'underline line-through'; } else if (R.de & IPCC.Web.UI.FontStyle.Underline) { vj = 'underline'; } else if (R.de & IPCC.Web.UI.FontStyle.Strikeout) { vj = 'line-through'; } } else { og += 'color:rgba(' + (Be >> 16) + ',' + ((Be >> 8) & 255) + ',' + (Be & 255) + ',' + dI + ');'; og += 'font-family:' + R.gZ + ';'; og += 'font-size:' + mA + 'px;'; if (R.de & IPCC.Web.UI.FontStyle.Italic) { og += 'font-style:italic;'; } if (R.de & IPCC.Web.UI.FontStyle.Bold) { og += 'font-weight:bold;'; } if ((R.de & IPCC.Web.UI.FontStyle.Underline) && (R.de & IPCC.Web.UI.FontStyle.Strikeout)) { og += 'text-decoration:underline line-through;'; } else if (R.de & IPCC.Web.UI.FontStyle.Underline) { og += 'text-decoration:underline;'; } else if (R.de & IPCC.Web.UI.FontStyle.Strikeout) { og += 'text-decoration:line-through;'; } } var IE = { x: 2, anchor: 'start' }; switch (R.kh) { case IPCC.Web.UI.HorizontalAlignment.Left: og += 'text-align:left;'; break; case IPCC.Web.UI.HorizontalAlignment.Center: og += 'text-align:center;'; IE.x = (h.width / 2) - 3; IE.anchor = 'middle'; break; case IPCC.Web.UI.HorizontalAlignment.Right: og += 'text-align:right;'; IE.x = h.width - 8; IE.anchor = 'end'; break; default: break; } if (typeof document.documentMode === 'undefined') { switch (R.AM) { case IPCC.Web.UI.VerticalAlignment.Center: if (R.get_type() === IPCC.Web.UI.MarkType.RectangleRedaction) { this.ae(T.RZ, { style: 'display:table; width: 100%;' }); og += 'display: table-cell; white-space: normal; vertical-align: middle; height:' + qf + 'px;'; } break; case IPCC.Web.UI.VerticalAlignment.Bottom: break; default: break; } this.ae(T.dE, { style: og + 'padding:2px;' }); this.ae(T.hB, { transform: 'matrix(' + kv + ',' + (eW + h.x + (R.dQ / 2)) + ',' + (fe + h.y + (R.dQ / 2)) + ')', }); this.ae(T.GI, { x: 0, y: 0, width: uC > R.dQ ? uC - R.dQ : uC, height: qf > R.dQ ? qf - R.dQ : qf, }); this.ahz(T); } else { var zJ = this.aqK(T, R.kh); var aow = zJ.length; switch (R.AM) { case IPCC.Web.UI.VerticalAlignment.Center: if (R.get_type() === IPCC.Web.UI.MarkType.RectangleRedaction) { Ih = (h.height / 2) + (R.cd / 4); if (aow > 1) { Ih -= (aow - 1) * (R.cd / 2); } if (Ih < 0) { Ih = R.cd; } } break; case IPCC.Web.UI.VerticalAlignment.Bottom: break; default: break; } this.ae(T.Gy, { x: 0, y: 0, width: h.width - R.dQ, height: h.height - R.dQ }); var aBC = "url(#" + T.LH + ")"; var Uo = { x: IE.x, y: (this.vU / 72) * R.cd, width: h.width - R.dQ, height: h.height - R.dQ, 'font-family': R.gZ, 'font-size': mA, fill: 'rgba(' + (Be >> 16) + ', ' + ((Be >> 8) & 255) + ', ' + (Be & 255) + ', ' + dI + ')', 'font-weight': abJ, 'font-style': de, 'text-decoration': vj, 'text-anchor': IE.anchor }; if (typeof Ih !== 'undefined') { delete Uo.y; Uo.dy = Ih; } this.ae(T.da, Uo); T.da.style.opacity = dI; this.ae(T.hB, { transform: 'matrix(' + kv + ',' + (eW + h.x + (R.dQ / 2)) + ',' + (fe + h.y + (R.dQ / 2)) + ')', 'clip-path': aBC }); var dS = T.anG; while (dS && dS.firstChild) { dS.removeChild(dS.firstChild); } if (R.eh) { var md = this.ajT(R.eh); for (var G = 0; G < zJ.length; G++) { this.aEq(md, zJ[G].ajB, dS, zJ[G].bh); } } } }, En: function (T) { var R = T.R; if (R.bV === null || R.bV === undefined) { return; } if (R.bV.length === 0 && R.cg > 0 && this.C.cv().mw()) { R.bV = IPCC.J.QF(this.C.cv().gl(), R.bh, R.bh + R.cg - 1); } if (!T.bh || !T.cg || T.bh !== R.bh || T.cg !== R.cg || R.ep === false || R.ep === true) { while (T.mx.firstChild) { T.mx.removeChild(T.mx.firstChild); } if (T.lZ) { while (T.lZ.firstChild) { T.lZ.removeChild(T.lZ.firstChild); } } if (T.zP) { while (T.zP.firstChild) { T.zP.removeChild(T.zP.firstChild); } } if (R.ep === false) { return; } IPCC.J.forEach(T.R.bV, function (gR) { var YM = this.aK('rect'); T.mx.appendChild(YM); this.ae(YM, { x: gR.x, y: gR.y, width: gR.width, height: gR.height }); if (T.lZ) { var kZ = this.aK('line'); this.ae(kZ, { x1: gR.x, y1: gR.y + gR.height - 1, x2: gR.x + gR.width, y2: gR.y + gR.height - 1, "stroke-width": 2 }); T.lZ.appendChild(kZ); } if (T.zP) { YM.setAttribute('fill', 'transparent'); var aim = this.aK('line'); var strikethroughY = gR.y + (gR.height / 2); this.ae(aim, { x1: gR.x, y1: strikethroughY, x2: gR.x + gR.width, y2: strikethroughY, stroke: T.R.gX, "stroke-width": T.R.dQ }); T.zP.appendChild(aim); } }, this); T.bh = R.bh; T.cg = R.cg; } }, Rw: function (T) { var R = T.R; if (!R) { return; } var aG = T.aG; var h, bH = '', ag, hv = true, nM, pH, pK, YJ, xT, DY; var iq = false; switch (R.get_type()) { case IPCC.Web.UI.MarkType.Line: case IPCC.Web.UI.MarkType.Polyline: iq = true; this.Uy(T); break; case IPCC.Web.UI.MarkType.Rectangle: h = R.get_rectangle(); this.ae(aG, { x: h.x, y: h.y, width: h.width, height: h.height }); break; case IPCC.Web.UI.MarkType.HighlightText: this.En(T); T.mx.style.fill = R.cK; T.mx.style.opacity = (R.dI / 255); this.yA(T); break; case IPCC.Web.UI.MarkType.TextHyperlinkAnnotation: this.En(T); T.mx.style.fill = R.cK; T.lZ.style.stroke = R.cK; if (T.R.get_selected()) { T.lZ.style.opacity = IPCC.dv.bn.xz(false, T.R.get_selected()); } else { T.lZ.style.opacity = IPCC.dv.bn.xz(false, T.R.get_selected()); } this.yA(T); break; case IPCC.Web.UI.MarkType.DocumentHyperlink: h = R.get_rectangle(); this.ae(T.h, { x: h.x, y: h.y, width: h.width, height: h.height }); if (T.kZ) { this.ae(T.kZ, { x1: h.x, y1: h.y + h.height, x2: h.x + h.width, y2: h.y + h.height }); } break; case IPCC.Web.UI.MarkType.RectangleRedaction: if (typeof T.hf !== 'undefined') { if (this.C.kU() === true) { T.hf.style.opacity = 0.5; if (typeof T.dE !== 'undefined') { T.dE.style.opacity = 0; } else { T.da.style.opacity = 0; } } else { T.hf.style.opacity = 1; if (typeof T.dE !== 'undefined') { T.dE.style.opacity = 1; } } } h = R.get_rectangle(); this.ae(aG, { x: h.x, y: h.y, width: h.width, height: h.height }); this.ae(T.hf, { x: h.x, y: h.y, width: h.width, height: h.height }); if (this.C.kU() === false) { this.HM(T); } break; case IPCC.Web.UI.MarkType.Ellipse: h = R.get_rectangle(); this.ae(aG, { cx: h.x + h.width / 2, cy: h.y + h.height / 2, rx: h.width / 2, ry: h.height / 2 }); break; case IPCC.Web.UI.MarkType.Polygon: ag = this.KW(R); this.ZJ(aG, ag, false); bH += 'fill-rule:evenodd;'; break; case IPCC.Web.UI.MarkType.Text: this.Qx(T); this.HM(T); if (typeof document.documentMode === 'undefined') { T.uk.style.cursor = IPCC.bP.fq(this.bm.Bk()); } break; case IPCC.Web.UI.MarkType.TextAreaSignature: var dA = IPCC.J.aeU(); var sK = IPCC.J.ady(); sK.nodeValue = R.get_text(); var jA = R.jA; var by = this.C.lc().iE(); h = R.get_rectangle(); dA.style.width = (h.width - R.dQ / 2) + 'px'; dA.style.height = (h.height - R.dQ / 2) + 'px'; dA.style.fontFamily = R.gZ; dA.style.padding = '2px'; dA.style.fontStyle = R.de; R.cd = IPCC.J.abt(dA, jA, by) * 72 / this.vU; this.Qx(T); this.HM(T); if (typeof document.documentMode === 'undefined') { T.uk.style.cursor = IPCC.bP.fq(this.bm.Bk()); } break; case IPCC.Web.UI.MarkType.Stamp: h = R.get_rectangle(); this.ae(aG, { x: h.x, y: h.y, width: h.width, height: h.height }); this.ae(T.vt, { x: h.x, y: h.y, width: h.width, height: h.height, 'stroke': 'none', 'fill': 'rgba(255, 255, 255, 0)' }); T.vt.style.opacity = 1; this.ae(T.hf, { x: h.x, y: h.y, width: h.width, height: h.height, 'stroke': R.cK, 'stroke-width': '5', 'fill': 'none', 'rx': 10, 'ry': 10 }); var textFontSize = (h.width / 6); if (textFontSize > h.height) { textFontSize = (h.height - (h.height / 6)); } nM = T.R.get_text(); if (!nM) { nM = 'APPROVED'; } T.da.childNodes[0].data = nM; var mv = nM.length * textFontSize; if (mv > h.width) { textFontSize = ((h.width / nM.length)); } DY = Math.round(textFontSize); R.stampSize = DY.toString(); this.ae(T.da, { x: h.x + (h.width / 2), y: h.y + (h.height / 2 + (textFontSize / 3)), 'font-size': textFontSize, 'stroke': R.cK, 'font-family': "Arial" }); break; case IPCC.Web.UI.MarkType.ImageStampAnnotation: case IPCC.Web.UI.MarkType.ImageStampRedaction: h = R.get_rectangle(); this.ae(aG, { x: h.x, y: h.y, width: h.width, height: h.height }); this.ae(T.vt, { x: h.x, y: h.y, width: h.width, height: h.height, 'stroke': 'none', 'fill': 'rgba(255, 255, 255, 0)' }); T.vt.style.opacity = 1; this.ae(T.hf, { x: h.x, y: h.y, width: h.width, height: h.height, 'stroke': R.cK, 'stroke-width': '0', 'fill': 'none' }); T.zd.setAttribute('height', h.height); T.zd.setAttribute('width', h.width); T.zd.setAttribute('x', h.x); T.zd.setAttribute('y', h.y); T.zd.setAttributeNS('http://www.w3.org/1999/xlink', 'href', R.get_image()); break; case IPCC.Web.UI.MarkType.TextSelectionRedaction: this.yA(T); break; case IPCC.Web.UI.MarkType.Highlight: h = R.get_rectangle(); if (h.x === 0 && h.y === 0) { var gP = this.C.cv().gl(); if (gP.fb() > 0) { var gw = gP.jN(R.bh); h = gw.av; } R.kz = 'y'; } this.ae(aG, { x: h.x, y: h.y, width: h.width, height: h.height }); break; case IPCC.Web.UI.MarkType.SignaturePath: case IPCC.Web.UI.MarkType.Freehand: h = R.get_rectangle(); this.ae(aG, { x: h.x, y: h.y, width: h.width, height: h.height }); var Oy = T.aGG; if (R.OW === true) { R.OW = false; Oy.setAttribute("d", R.get_pathString()); var tA = R.get_pathWidth(); var vh = R.get_pathHeight(); aG.setAttribute('viewBox', '0 0 ' + tA + ' ' + vh); T.aeS.setAttribute('width', tA); T.aeS.setAttribute('height', vh); } if (R.get_visible()) { T.aG.style.display = 'block'; } else { T.aG.style.display = 'none'; } this.adq(T.aG, R.kh); Oy.style.stroke = R.get_lineColor(); Oy.style.strokeWidth = R.get_lineWidth() + 'px'; Oy.style.opacity = R.get_opacity() / 255; break; case IPCC.Web.UI.MarkType.SignatureText: h = R.get_rectangle(); this.ae(aG, { x: h.x, y: h.y, width: h.width, height: h.height }); this.ae(T.hf, { x: h.x, y: h.y, width: h.width, height: h.height, 'stroke': 'none', 'fill': 'rgba(255, 255, 255, 0)' }); T.hf.style.opacity = 1; var auL = T.R.get_text() || ""; T.da.childNodes[0].data = auL; pH = 12 * h.width / (R.xj || 1); pK = 12 * h.height / (R.yq || 1); xT = Math.min(pH, pK); var aFB = Math.floor(xT); R.stampSize = aFB.toString(); switch (R.kh) { case IPCC.Web.UI.HorizontalAlignment.Left: T.da.setAttribute('text-anchor', 'start'); T.da.setAttribute('x', h.x); break; case IPCC.Web.UI.HorizontalAlignment.Right: T.da.setAttribute('text-anchor', 'end'); T.da.setAttribute("x", h.x + h.width); break; default: T.da.setAttribute('text-anchor', 'middle'); T.da.setAttribute("x", h.x + (h.width / 2)); break; } this.ae(T.da, { y: h.y + (h.height / 2 + (xT / 3)), 'font-size': xT, 'stroke': "none", 'fill': R.get_fillColor(), 'font-family': R.get_fontName() }); if (R.get_visible()) { T.aG.style.display = 'block'; } else { T.aG.style.display = 'none'; } break; case IPCC.Web.UI.MarkType.TextLine: this.ae(aG, { style: 'fill:none;opacity:1;' + R.ep ? 'display:block;' : 'display:none;' }); h = R.get_rectangle(); this.ae(aG, { x: h.x, y: h.y, width: h.width, height: h.height }); bH = 'stroke:' + (R.hv ? 'black' : 'none') + ';stroke-width:1;'; this.ae(T.hf, { x: h.x, y: h.y, width: h.width, height: h.height, 'stroke': R.hv ? 'black' : 'none', 'fill': 'rgba(255, 255, 255, 0)', 'style': bH }); T.da.style.opacity = 1; nM = T.R.get_text() || ""; T.da.childNodes[0].data = nM; YJ = IPCC.J.aeA(nM, R.get_fontName(), h.width, h.height, { wJ: "pre", gC: T.aG }); xT = YJ.fontSize; R.mA = xT; R.stampSize = xT; R.Im = true; R.ql = YJ; switch (R.kh) { case IPCC.Web.UI.HorizontalAlignment.Center: T.da.setAttribute('text-anchor', 'middle'); T.da.setAttribute("x", h.x + (h.width / 2)); break; case IPCC.Web.UI.HorizontalAlignment.Right: T.da.setAttribute('text-anchor', 'end'); T.da.setAttribute("x", h.x + h.width); break; default: T.da.setAttribute('text-anchor', 'start'); T.da.setAttribute('x', h.x); break; } this.ae(T.da, { y: h.y + (h.height / 2 + (xT / 3)), 'font-size': xT, 'stroke': "none", 'fill': R.get_textColor(), 'font-family': R.get_fontName(), 'white-space': 'pre' }); break; case IPCC.Web.UI.MarkType.Strikethrough: this.En(T); this.yA(T); break; default: throw new IPCC.Web.UI.ImGearArgumentOutOfRangeException('type', R.get_type()); } if (R.get_type() !== IPCC.Web.UI.MarkType.SignaturePath && R.get_type() !== IPCC.Web.UI.MarkType.Freehand && R.get_type() !== IPCC.Web.UI.MarkType.SignatureText && R.get_type() !== IPCC.Web.UI.MarkType.HighlightText && R.get_type() !== IPCC.Web.UI.MarkType.TextHyperlinkAnnotation && R.get_type() !== IPCC.Web.UI.MarkType.DocumentHyperlink && R.get_type() !== IPCC.Web.UI.MarkType.Strikethrough && R.get_type() !== IPCC.Web.UI.MarkType.TextSelectionRedaction) { if (iq) { bH += 'fill:none;'; } else { if (R.zm) { bH += 'fill:' + R.cK + ';'; } else { bH += 'fill:none;'; } hv = R.hv; var Ag = this.AV(R.ii); if (Ag !== '') { bH += 'stroke-dasharray:' + Ag + ';'; } } if (hv) { bH += 'stroke:' + R.get_lineColor() + ';'; bH += 'stroke-width:' + R.dQ + ';'; } else { bH += 'stroke:none;'; } if (R.get_type() === IPCC.Web.UI.MarkType.SignatureText) { bH += 'opacity:' + 1 + ';'; } else { bH += 'opacity:' + (R.dI / 255) + ';'; } if (!R.ep) { bH += 'display:none;'; if (T.hB) { T.hB.style.display = 'none'; } } else { if (T.hB) { T.hB.style.display = 'block'; } } bH += 'cursor:' + IPCC.bP.fq(this.bm.Bk()) + ';'; this.ae(aG, { style: bH }); } if (R.get_type() === IPCC.Web.UI.MarkType.Freehand) { if (!R.ep) { bH += 'display:none;'; } else { bH += 'display:block;'; } bH += 'cursor:' + IPCC.bP.fq(this.bm.Bk()) + ';'; this.ae(aG, { style: bH }); } }, adq: function (aG, KI) { switch (KI) { case IPCC.Web.UI.HorizontalAlignment.Left: aG.setAttribute('preserveAspectRatio', 'xMinYMid'); break; case IPCC.Web.UI.HorizontalAlignment.Center: aG.setAttribute('preserveAspectRatio', 'xMidYMid'); break; case IPCC.Web.UI.HorizontalAlignment.Right: aG.setAttribute('preserveAspectRatio', 'xMaxYMid'); break; } }, yA: function (T) { var R = T.R, azH = R.get_visible(); var h = R.get_rectangle(); if (h.x === 0 && h.y === 0) { return; } var dS = T.dS; while (dS.firstChild) { dS.removeChild(dS.firstChild); } var hs; for (var G = 0; G < R.eh.length; G++) { for (var aj = 0; aj < R.eh[G].length; aj++) { var Jo = this.C.cv().gl(); if (Jo.fb() > 0) { var acI = Jo.jN(R.eh[G].startIndex + aj); hs = acI.av; } var ai = this.aK('rect'); this.ae(ai, { x: hs.x, y: hs.y, width: hs.width, height: hs.height, fill: R.eh[G].color, display: (azH) ? 'block' : 'none' }); ai.style.opacity = (R.eh[G].opacity) ? (R.eh[G].opacity) / 255.0 : 0.5; dS.appendChild(ai); } } }, AV: function (ii) { switch (ii) { case IPCC.Web.UI.LineStyle.Dash: return '7,7'; case IPCC.Web.UI.LineStyle.Dot: return '1,7'; case IPCC.Web.UI.LineStyle.DashDot: return '7,7,1,7'; case IPCC.Web.UI.LineStyle.DashDotDot: return '7,7,1,7,1,7'; default: break; } return ''; }, KG: function (T) { if (T.aG) { this.aQ.nA.removeChild(T.aG); } if (T.hB) { this.aQ.nA.removeChild(T.hB); } delete T.aG; }, afD: function () { }, air: function () { this.aQ = undefined; }, aK: function (aa) { return document.createElementNS('http://www.w3.org/2000/svg', aa); }, ae: function (aG, bu) { var G; for (G in bu) { if (bu.hasOwnProperty(G)) { var attr = bu[G]; aG.setAttribute(G, attr !== undefined && attr !== null ? attr.toString() : ''); } } } }; IPCC.dv.yZ = {
    Bv: function () {
        var yR = IPCC.dv.yZ; if (yR.wf === null) {
            /*@cc_on@if(@_jscript)yR.wf=document.documentMode>8;@else@*/ yR.wf = true;/*@end@*/
        } return yR.wf;
    }, wf: null
}; if (IPCC.yZ.Bv()) { IPCC.dv.bn = IPCC.dv.akv; } else { IPCC.dv.bn = IPCC.dv.Iy; } IPCC.dv.bn.xz = function (isMouseOver, isSelected) { return (isSelected ? 127 : (isMouseOver ? 127 : 63)) / 255; }; IPCC.dv.bn.KB = function () { return 39 / 255; }; IPCC.dv.bn.aKz = function (isSelected) { return isSelected ? "purple" : "blue"; }; IPCC.dv.bn.prototype.ahm = function (fk, lu, vx, qI, sj) { var cF = { fk: fk, lu: lu, vx: vx, qI: qI, sj: sj }; if (fk.x === lu.x && fk.y === lu.y) { cF.sj = IPCC.Web.UI.LineHeadType.None; } var PJ = Math.atan2(fk.x - lu.x, -(fk.y - lu.y)) + Math.PI / 2; vx *= Math.PI / 180; var iQ = PJ + vx; cF.tM = { x: fk.x + Math.cos(iQ) * qI, y: fk.y + Math.sin(iQ) * qI }; iQ = PJ - vx; cF.tY = { x: fk.x + Math.cos(iQ) * qI, y: fk.y + Math.sin(iQ) * qI }; switch (cF.sj) { case IPCC.Web.UI.LineHeadType.Solid: case IPCC.Web.UI.LineHeadType.Open: cF.yr = { x: (cF.tM.x + cF.tY.x) / 2, y: (cF.tM.y + cF.tY.y) / 2 }; break; case IPCC.Web.UI.LineHeadType.PointerSolid: cF.yr = { x: fk.x + Math.cos(PJ) * qI / 2, y: fk.y + Math.sin(PJ) * qI / 2 }; break; default: cF.yr = fk; break; } return cF; }; IPCC.dv.bn.prototype.afU = function (T) { var R = T.R; var h = R.get_rectangle(); var Mh = { x: R.pj.x + h.x + 0.00001, y: R.pj.y + h.y + 0.00001 }; var bM = {}; var gQ = [{ x: h.x, y: h.y }, { x: h.x + h.width, y: h.y }, { x: h.x + h.width, y: h.y + h.height }, { x: h.x, y: h.y + h.height }]; if (!R.zg) { bM.aaA = gQ; bM.SO = !R.hv; return bM; } var G, aer = []; for (G = 0; G < 4; G++) { aer.push({ x: (gQ[G].x + gQ[(G + 3) % 4].x) / 2, y: (gQ[G].y + gQ[(G + 3) % 4].y) / 2, aBR: true }); } for (G = 3; G >= 0; G--) { gQ.splice(G, 0, aer[G]); } function aei(Re) { var oS, LG; oS = (Mh.x - (gQ[Re].x + gQ[(Re + 1) % 8].x) / 2) * h.height; LG = oS * oS; oS = (Mh.y - (gQ[Re].y + gQ[(Re + 1) % 8].y) / 2) * h.width; return LG + oS * oS; }; var ack = 0, aoK = aei(0), jD; for (G = 1; G < 8; G++) { jD = aei(G); if (jD < aoK) { aoK = jD; ack = G; } } gQ = gQ.slice(ack + 1).concat(gQ.slice(0, ack + 1)); var FK = gQ[0], FT = gQ[7]; for (G = gQ.length - 1; G >= 0; G--) { if (gQ[G].aBR) { gQ.splice(G, 1); } } switch (R.GC) { case IPCC.Web.UI.CalloutType.Triangle: gQ.splice(0, 0, { x: (FK.x * 3 + FT.x) / 4, y: (FK.y * 3 + FT.y) / 4 }); gQ.push({ x: (FK.x + FT.x * 3) / 4, y: (FK.y + FT.y * 3) / 4 }); if (R.At) { bM.SO = true; bM.Mi = [].concat(gQ); bM.GA = [gQ[0], Mh, gQ[gQ.length - 1]]; } gQ.push(Mh); break; default: case IPCC.Web.UI.CalloutType.Line: bM.GA = [{ x: (FK.x + FT.x) / 2, y: (FK.y + FT.y) / 2 }, Mh]; break; } bM.aaA = gQ; if (!R.hv) { bM.SO = true; delete bM.Mi; delete bM.GA; } return bM; }; IPCC.dv.bn.prototype.KW = function (R) { var ag = R.get_points(); var fd = [], G; for (G = 0; G < ag.get_length() ; G++) { fd.push(ag.getPoint(G)); } return fd; }; IPCC.dv.bn.prototype.Tq = function (fd, azp) { var ak = 0, UJ = 1, aeI = fd.length - 2, fk, lu; if (!azp) { ak = fd.length - 1; UJ = -1; } fk = fd[ak]; ak += UJ; lu = fd[ak]; ak += UJ; while (fk.x === lu.x && fk.y === lu.y && aeI > 0) { lu = fd[ak]; ak += UJ; aeI--; } return { fk: fk, lu: lu }; }; IPCC.dv.bn.prototype.age = function (C, aQ, bN, mj) { if (!aQ.oT) { aQ.oT = []; } var oT = aQ.oT; if (bN.length < 1 && oT.length < 1) { if (aQ.Ay.firstChild) { aQ.Ay.innerHTML = ''; } return; } var aX = C.eI(); var fE = aX.Bl(); if (this.gK === undefined) { this.gK = 40; var Cu = document.createElement("div"); Cu.className = 'pccMarkHandleTopLeft'; Cu.visibility = 'hidden'; document.body.appendChild(Cu); if (Cu.currentStyle) { this.gK = parseInt(Cu.currentStyle.width, 10) || 0; } else if (document.defaultView && document.defaultView.getComputedStyle) { var ayC = document.defaultView.getComputedStyle(Cu); this.gK = parseInt(ayC.width, 10) || 0; } document.body.removeChild(Cu); } var G, KC = []; for (G = 0; G < bN.length; G++) { if (bN[G].get_visible() === true) { if (fE.Ln(bN[G]) >= 0 || (bN[G].get_selected() === true && (bN[G].kr === true || bN[G].lF === true)) || bN[G].za === true) { KC.push(bN[G]); } } } for (G = 0; G < oT.length; G++) { while (G < oT.length && (G >= KC.length || oT[G].R !== KC[G])) { aQ.Ay.removeChild(oT[G].il); oT.splice(G, 1); } if (G < oT.length) { this.aha(oT[G], mj); } } for (G = oT.length; G < KC.length; G++) { oT[G] = { R: KC[G] }; this.arW(aQ.Ay, oT[G]); this.aha(oT[G], mj); } }; IPCC.dv.bn.prototype.yk = function (il, ars, Ef, wM, avM, cP, fg) { var dM = [], G, cG; if (fg === undefined) { fg = 'handle'; } for (G = 0; G < ars; G++) { cG = { aG: document.createElement('div') }; cG.aG.ImGearMarkHandle = cG; cG.cP = cP; cG.aa = wM; cG.ak = avM + G; il.appendChild(cG.aG); cG.aG.setAttribute('data-pcc-mark', fg + '-' + il.ImGearMarkRelation.R.jf()); dM.push(cG); } return dM; }; IPCC.dv.bn.prototype.axW = function (cU) { if (cU.dM === undefined) { return; } var G; for (G = 0; G < cU.dM.length; G++) { var cG = cU.dM[G]; cG.aG.style.cursor = IPCC.bP.fq(cG.cP); } }; IPCC.dv.bn.prototype.arW = function (Ay, cU) { cU.il = document.createElement('div'); cU.il.style.width = '0px'; cU.il.style.height = '0px'; cU.il.style.left = '0px'; cU.il.style.top = '0px'; cU.il.style.zIndex = '1'; var G, R = cU.R, cG; cU.il.ImGearMarkRelation = cU; switch (R.get_type()) { case IPCC.Web.UI.MarkType.Line: case IPCC.Web.UI.MarkType.Polyline: cU.dM = this.yk(cU.il, 2, this.gK, this.Hl, 0, IPCC.bP.Move); cU.dM = cU.dM.concat(this.yk(cU.il, 2, this.gK, this.Kc, 0, IPCC.bP.Move)); break; case IPCC.Web.UI.MarkType.Polygon: cU.dM = []; break; case IPCC.Web.UI.MarkType.Freehand: cU.dM = []; cU.kB = document.createElement('div'); cU.kB.style.border = '1px solid gray'; cU.kB.style.position = 'absolute'; cU.il.appendChild(cU.kB); break; case IPCC.Web.UI.MarkType.Text: case IPCC.Web.UI.MarkType.SignaturePath: case IPCC.Web.UI.MarkType.SignatureText: case IPCC.Web.UI.MarkType.TextLine: case IPCC.Web.UI.MarkType.TextAreaSignature: case IPCC.Web.UI.MarkType.Rectangle: case IPCC.Web.UI.MarkType.RectangleRedaction: case IPCC.Web.UI.MarkType.Ellipse: case IPCC.Web.UI.MarkType.Highlight: case IPCC.Web.UI.MarkType.Stamp: case IPCC.Web.UI.MarkType.ImageStampAnnotation: case IPCC.Web.UI.MarkType.ImageStampRedaction: if (R.get_type() === IPCC.Web.UI.MarkType.RectangleRedaction && R.cE !== undefined) { break; } cU.kB = document.createElement('div'); cU.kB.style.border = '1px solid gray'; cU.kB.style.position = 'absolute'; cU.il.appendChild(cU.kB); cU.dM = this.yk(cU.il, 4, this.gK, this.XU, 0, -1); cU.dM = cU.dM.concat(this.yk(cU.il, 4, this.gK, this.Xw, 0, -1)); for (G = 4; G < 8; G++) { cG = cU.dM[G]; cG.aHT = cU.dM[G - 4]; cG.asJ = cU.dM[(G + 1) % 4]; } if (R.get_type() === IPCC.Web.UI.MarkType.Text) { cU.dM = cU.dM.concat(this.yk(cU.il, 1, this.gK, this.abq, 0, IPCC.bP.Move)); } break; case IPCC.Web.UI.MarkType.TextHyperlinkAnnotation: case IPCC.Web.UI.MarkType.HighlightText: case IPCC.Web.UI.MarkType.TextSelectionRedaction: case IPCC.Web.UI.MarkType.Strikethrough: cU.dM = this.yk(cU.il, 1, this.gK, this.Hl, 0, IPCC.bP.Move, 'texthandlestart'); cU.dM = cU.dM.concat(this.yk(cU.il, 1, this.gK, this.Hl, 1, IPCC.bP.Move, 'texthandleend')); break; } if (R.jd() === IPCC.Web.UI.MarkType.Text || R.jd() === IPCC.Web.UI.MarkType.TextLine || R.jd() === IPCC.Web.UI.MarkType.TextAreaSignature) { var qm = document.createElement('div'); qm.className = 'pccEditMarkButton'; qm.setAttribute('data-pcc-mark', 'edit-' + R.jf()); qm.onclick = function (au) { au = au || {}; au.stopPropagation ? au.stopPropagation() : au.cancelBubble = true; au.preventDefault ? au.preventDefault() : au.returnValue = false; var qG; var jW = cU.il; while (jW && (jW.parentNode || jW.ownerSVGElement)) { if (jW.parentNode.id && jW.parentNode.id.indexOf("__pViewId") !== -1) { qG = jW.parentNode; } jW = jW.ownerSVGElement || jW.parentNode; } qG && qG.bB.aEc(au, R); }; cU.il.appendChild(qm); var aFv = { aG: qm }; cU.dM.push(aFv); } Ay.appendChild(cU.il); }; IPCC.dv.bn.mG = { TopLeft: 0, TopRight: 1, BottomLeft: 2, BottomRight: 3, TopCenter: 4, MidRight: 5, BottomCenter: 6, MidLeft: 7, Point: 8, TextSelectionStart: 9, TextSelectionEnd: 10, Callout: 11 }; IPCC.dv.bn.prototype.XU = 0; IPCC.dv.bn.prototype.Xw = 1; IPCC.dv.bn.prototype.Kc = 2; IPCC.dv.bn.prototype.Hl = 3; IPCC.dv.bn.prototype.abq = 4; IPCC.dv.bn.prototype.afa = function (cG, aAl) { switch (aAl) { case IPCC.dv.bn.mG.TopLeft: cG.aG.className = 'pccMarkHandleTopLeft'; break; case IPCC.dv.bn.mG.TopCenter: cG.aG.className = 'pccMarkHandleTopCenter'; break; case IPCC.dv.bn.mG.TopRight: cG.aG.className = 'pccMarkHandleTopRight'; break; case IPCC.dv.bn.mG.MidLeft: cG.aG.className = 'pccMarkHandleMidLeft'; break; case IPCC.dv.bn.mG.MidRight: cG.aG.className = 'pccMarkHandleMidRight'; break; case IPCC.dv.bn.mG.BottomLeft: cG.aG.className = 'pccMarkHandleBottomLeft'; break; case IPCC.dv.bn.mG.BottomCenter: cG.aG.className = 'pccMarkHandleBottomCenter'; break; case IPCC.dv.bn.mG.BottomRight: cG.aG.className = 'pccMarkHandleBottomRight'; break; case IPCC.dv.bn.mG.Point: cG.aG.className = 'pccMarkHandlePoint'; break; case IPCC.dv.bn.mG.TextSelectionStart: cG.aG.className = 'pccMarkHandleTextSelectionStart'; break; case IPCC.dv.bn.mG.TextSelectionEnd: cG.aG.className = 'pccMarkHandleTextSelectionEnd'; break; default: cG.aG.className = 'pccMarkHandlePoint'; break; } }; IPCC.dv.bn.prototype.An = function (cG, asp, mj, Ef, oH) { cG.be = mj.transform(asp); cG.aG.style.left = (cG.be.x - Ef / 2) + 'px'; cG.aG.style.top = (cG.be.y - Ef / 2) + 'px'; cG.aG.style.display = 'block'; cG.aG.style.zIndex = '1'; this.afa(cG, oH); }; IPCC.dv.bn.prototype.akH = function (cG, Ef, oH) { cG.aG.style.left = (cG.be.x - Ef / 2) + 'px'; cG.aG.style.top = (cG.be.y - Ef / 2) + 'px'; cG.aG.style.display = 'block'; cG.aG.style.zIndex = '1'; this.afa(cG, oH); }; IPCC.dv.bn.prototype.xb = function (cG) { cG.aG.style.display = 'none'; }; IPCC.dv.bn.prototype.aha = function (cU, mj) { cU.il.style.cursor = IPCC.bP.fq(this.bm.Bk()); var G, R = cU.R, dM = cU.dM, cG; var fd, h, oP, jV, wM, eR; var jD, GE, eW, fe, Tk; switch (R.get_type()) { case IPCC.Web.UI.MarkType.Line: case IPCC.Web.UI.MarkType.Polyline: fd = this.KW(R); GE = fd.length + 2 - dM.length; if (GE > 0) { cU.dM = cU.dM.concat(this.yk(cU.il, GE, this.gK, this.Kc, dM.length - 2, IPCC.bP.Move)); dM = cU.dM; } for (G = 0; G < fd.length; G++) { this.An(dM[G + 2], fd[G], mj, this.gK, IPCC.dv.bn.mG.Point); } for (G = fd.length + 2; G < dM.length; G++) { this.xb(dM[G + 2]); } break; case IPCC.Web.UI.MarkType.Polygon: fd = this.KW(R); GE = fd.length - dM.length; if (GE > 0) { cU.dM = cU.dM.concat(this.yk(cU.il, GE, this.gK, this.Kc, dM.length, IPCC.bP.Move)); dM = cU.dM; } for (G = 0; G < fd.length; G++) { this.An(dM[G], fd[G], mj, this.gK, IPCC.dv.bn.mG.Point); } for (G = fd.length; G < dM.length; G++) { this.xb(dM[G]); } break; case IPCC.Web.UI.MarkType.Freehand: h = R.fD(); oP = mj.transform({ x: h.x, y: h.y }); jV = mj.transform({ x: h.x + h.width, y: h.y + h.height }); eR = { x: Math.min(oP.x, jV.x), y: Math.min(oP.y, jV.y) }; eR.width = Math.max(oP.x, jV.x) - eR.x; eR.height = Math.max(oP.y, jV.y) - eR.y; cU.kB.style.left = eR.x + 'px'; cU.kB.style.top = eR.y + 'px'; cU.kB.style.width = eR.width + 'px'; cU.kB.style.height = eR.height + 'px'; cU.kB.setAttribute('data-pcc-mark', 'outline-' + R.jf()); break; case IPCC.Web.UI.MarkType.SignaturePath: case IPCC.Web.UI.MarkType.Rectangle: case IPCC.Web.UI.MarkType.RectangleRedaction: case IPCC.Web.UI.MarkType.Ellipse: case IPCC.Web.UI.MarkType.Text: case IPCC.Web.UI.MarkType.Stamp: case IPCC.Web.UI.MarkType.SignatureText: case IPCC.Web.UI.MarkType.TextLine: case IPCC.Web.UI.MarkType.TextAreaSignature: case IPCC.Web.UI.MarkType.ImageStampAnnotation: case IPCC.Web.UI.MarkType.ImageStampRedaction: if (R.get_type() === IPCC.Web.UI.MarkType.RectangleRedaction && R.cE !== undefined) { break; } h = R.fD(); dM[0].be = mj.transform({ x: h.x, y: h.y }); dM[1].be = mj.transform({ x: h.x + h.width, y: h.y }); dM[2].be = mj.transform({ x: h.x + h.width, y: h.y + h.height }); dM[3].be = mj.transform({ x: h.x, y: h.y + h.height }); eR = { x: Math.min(dM[0].be.x, dM[2].be.x), y: Math.min(dM[0].be.y, dM[2].be.y) }; eR.width = Math.max(dM[0].be.x, dM[2].be.x) - eR.x; eR.height = Math.max(dM[0].be.y, dM[2].be.y) - eR.y; Tk = { x: eR.x + eR.width / 2, y: eR.y + eR.height / 2 }; for (G = 0; G < 4; G++) { cG = dM[G]; wM = (cG.be.x < Tk.x) ? ((cG.be.y < Tk.y) ? 0 : 2) : ((cG.be.y < Tk.y) ? 1 : 3); this.akH(cG, this.gK, wM); switch (wM) { case 0: cG.cP = IPCC.bP.ResizeNW; break; case 1: cG.cP = IPCC.bP.ResizeNE; break; case 2: cG.cP = IPCC.bP.ResizeSW; break; case 3: cG.cP = IPCC.bP.ResizeSE; break; } } cU.kB.style.left = eR.x + 'px'; cU.kB.style.top = eR.y + 'px'; cU.kB.style.width = eR.width + 'px'; cU.kB.style.height = eR.height + 'px'; cU.kB.setAttribute('data-pcc-mark', 'outline-' + R.jf()); var atW = eR.x + eR.width / 4; var aqL = eR.x + eR.width * 3 / 4; var auT = eR.y + eR.height / 4; var aqp = eR.y + eR.height * 3 / 4; if (this.bm.Cp() === IPCC.Web.UI.MarkHandleMode.HideCornerHandlesWhenClose) { oP = dM[0].be; jV = dM[1].be; var azm = dM[2].be; eW = oP.x - jV.x; fe = jV.y - azm.y; var aFU = eW * eW; var aFd = fe * fe; if (Math.min(aFU, aFd) < this.gK * this.gK * 5) { this.xb(dM[0]); this.xb(dM[1]); this.xb(dM[2]); this.xb(dM[3]); } } for (G = 4; G < 8; G++) { cG = dM[G]; oP = cG.aHT.be; jV = cG.asJ.be; eW = oP.x - jV.x; fe = oP.y - jV.y; jD = eW * eW + fe * fe; if (this.bm.Cp() === IPCC.Web.UI.MarkHandleMode.HideSideHandlesWhenClose && jD < this.gK * this.gK * 5) { this.xb(cG); } else { cG.be = { x: (oP.x + jV.x) / 2, y: (oP.y + jV.y) / 2 }; this.akH(cG, this.gK, G); if (cG.be.x < atW) { cG.cP = IPCC.bP.ResizeW; } else if (cG.be.x > aqL) { cG.cP = IPCC.bP.ResizeE; } else if (cG.be.y < auT) { cG.cP = IPCC.bP.ResizeN; } else if (cG.be.y > aqp) { cG.cP = IPCC.bP.ResizeS; } } } if (R.get_type() === IPCC.Web.UI.MarkType.Text) { if (R.zg) { this.An(dM[8], { x: h.x + R.pj.x, y: h.y + R.pj.y }, mj, this.gK, IPCC.dv.bn.mG.Callout); } else { this.xb(dM[8]); } } break; case IPCC.Web.UI.MarkType.DocumentHyperlink: return; case IPCC.Web.UI.MarkType.TextHyperlinkAnnotation: case IPCC.Web.UI.MarkType.HighlightText: case IPCC.Web.UI.MarkType.TextSelectionRedaction: case IPCC.Web.UI.MarkType.Strikethrough: var gw, hs, CC; var IG = this.C.cv(); var gP = IG.gl(); if (R.kr === true) { CC = R.bh; if (CC >= gP.fb()) { gw = gP.jN(gP.fb() - 1); hs = gw.wz(); this.An(dM[0], new IPCC.Web.UI.Point(hs.x + hs.width, hs.y), mj, this.gK, IPCC.dv.bn.mG.TextSelectionStart); break; } gw = gP.jN(R.bh); hs = gw.wz(); this.An(dM[0], new IPCC.Web.UI.Point(hs.x, hs.y), mj, this.gK, IPCC.dv.bn.mG.TextSelectionStart); } else { this.xb(dM[0]); } if (R.lF === true) { CC = R.bh + R.cg - 1; if (CC < 0) { gw = gP.jN(0); hs = gw.wz(); this.An(dM[1], new IPCC.Web.UI.Point(hs.x, hs.y + hs.height), mj, this.gK, IPCC.dv.bn.mG.TextSelectionEnd); break; } gw = gP.jN(CC); hs = gw.wz(); this.An(dM[1], new IPCC.Web.UI.Point(hs.x + hs.width, hs.y + hs.height), mj, this.gK, IPCC.dv.bn.mG.TextSelectionEnd); } else { this.xb(dM[1]); } break; } if (R.get_type() === IPCC.Web.UI.MarkType.Text || R.get_type() === IPCC.Web.UI.MarkType.TextLine || R.get_type() === IPCC.Web.UI.MarkType.TextAreaSignature) { var wS = dM[dM.length - 1]; if (wS.aG.className.match(/pcc/)) { var Vk = cU.kB.clientHeight; var Vr = cU.kB.clientWidth; var apW = cU.kB.offsetTop; var aqE = cU.kB.offsetLeft; var are = wS.aG.clientHeight; var acH = wS.aG.clientWidth; wS.aG.style.position = 'absolute'; wS.aG.style.zIndex = '2'; if (Vk > are + 10 && Vr > acH + 10) { wS.aG.style.top = (Vk - are) / 2 + apW + 'px'; wS.aG.style.left = (Vr - acH) / 2 + aqE + 'px'; } else { wS.aG.style.top = Vk + apW + 10 + 'px'; wS.aG.style.left = (Vr - acH) / 2 + aqE + 'px'; } } } this.axW(cU); }; IPCC.dv.bn.prototype.ajT = function (hF, yb) { var aCw = IPCC.J.akE(hF, yb || '#ffffff'), aDr = IPCC.J.map(aCw, function (bL) { return { bh: bL.startIndex, fF: bL.endIndex, DV: bL.color }; }); return aDr; }; IPCC.dv.bn.prototype.ahz = function (T) { var R = T.R; if (R.eh) { var md = this.ajT(R.eh); var Fs = R.az; var CV = ''; for (var G = md.length - 1; G >= 0; G--) { var adP = md[G]; var bh = adP.bh; var fF = adP.fF; var dU = adP.DV; var cl = IPCC.J.LM(Fs.substr(bh, fF - bh + 1)); var aqa = IPCC.J.LM(Fs.substr(fF + 1, Fs.length - fF + 1)); Fs = Fs.substr(0, bh); CV = "<span style='background-color:" + dU + ";'>" + cl + '</span>' + aqa + CV; } CV = IPCC.J.LM(Fs) + CV; CV = CV.replace(/\n/g, '<br/>'); T.dE.innerHTML = CV; } else { T.vf.data = R.az; } }; IPCC.Web.UI.ImGearDocumentHyperlink = function (mC) { var aY = 0, fJ = 0, ax = 0, cR = 0, qY = mC.href || "", asH = mC.borderStyle || "Solid", ov = mC.borderThickness || 0, BK = mC.borderPattern || [1], Ep = mC.borderHorizontalRadius || 0, Fd = mC.borderHorizontalRadius || 0, pw = mC.borderColor || "#0000FF", oQ = mC.borderOpacity || 255, h, R; if (typeof oQ === 'string') { oQ = parseInt(oQ, 10); } if (mC.rectangle) { aY = mC.rectangle.x; fJ = mC.rectangle.y; ax = mC.rectangle.width; cR = mC.rectangle.height; } h = new IPCC.Web.UI.Rectangle(aY, fJ, ax, cR); this.fD = function () { var adb = new IPCC.Web.UI.Rectangle(h.x, h.y, h.width, h.height); return adb; }; this.Gn = function (mb) { h.x = mb.x; h.y = mb.y; h.width = mb.width; h.height = mb.height; }; this.ajk = function () { return qY; }; this.asg = function () { return asH; }; this.arJ = function () { return ov; }; this.arA = function () { return BK; }; this.atA = function () { return Ep; }; this.atj = function () { return Fd; }; this.avh = function () { return pw; }; this.auQ = function () { return oQ; }; this.Ry = function () { return R; }; this.aIv = function (avp) { R = avp; }; }; IPCC.Web.UI.ImGearTextCharacter = function (aY, fJ, ax, cR, Ba, azh) { this.av = new IPCC.Web.UI.Rectangle(aY, fJ, ax, cR); this.jJ = Ba; this.KX = azh; this.auu = function () { return Ba; }; this.wz = function () { var adb = new IPCC.Web.UI.Rectangle(this.av.x, this.av.y, this.av.width, this.av.height); return adb; }; this.aGL = function () { return this.KX; }; }; IPCC.Web.UI.ImGearTextCharacterCollection = function () { var kH = []; this.apR = function (nl) { kH.push(new IPCC.Web.UI.ImGearTextCharacter(nl.av.x, nl.av.y, nl.av.width, nl.av.height, nl.jJ, nl.KX)); }; this.aKy = function (atl) { function nD(nl) { kH.push(nl); }; atl.forEach(nD, {}); }; this.aAn = function () { var aem = []; for (var aj = 0; aj < this.fb() ; aj++) { var VY = this.jN(aj).av; var h = []; h.push(VY.x); h.push(VY.y); h.push(VY.width); h.push(VY.height); aem.push(h); } return aem; }; this.aMp = function (ak, aku) { var aj; var dg = kH.length; if (ak > kH.length || (ak < 0)) { throw new IPCC.Web.UI.ImGearArgumentOutOfRangeException('index', ak, 'index of theText Character Collection is out of range'); } for (aj = 0; aj < dg; aj++) { if (kH[aj] === aku) { throw new IPCC.Web.UI.ImGearInvalidOperationException('You cannot duplicate same az Character instance in a nl collection).'); } } kH.splice(ak, 0, aku); }; this.azY = function (agF, agQ) { IPCC.J.forEach(kH, function (jJ) { jJ.av.width = jJ.av.width * agF; jJ.av.height = jJ.av.height * agQ; jJ.av.x = jJ.av.x * agF; jJ.av.y = jJ.av.y * agQ; }); }; this.mR = function (kg, ca) { var Yb = [].concat(kH); var G; for (G = 0; G < Yb.length; G++) { kg.call(ca, new IPCC.Web.UI.ImGearTextCharacter(Yb[G].x, Yb[G].y), G, this); } }; function lO(ak) { if (ak > kH.length - 1 || (ak < 0)) { throw new IPCC.Web.UI.ImGearArgumentOutOfRangeException('index', ak); } }; this.jN = function (ak) { lO(ak); var um = kH[ak]; return new IPCC.Web.UI.ImGearTextCharacter(um.av.x, um.av.y, um.av.width, um.av.height, um.jJ, um.KX); }; this.aJH = function (ak, nl) { lO(ak); var Ii = kH[ak]; if (Ii.av.x === nl.av.x && Ii.av.y === nl.y && Ii.av.width === nl.av.width && Ii.av.height === nl.av.height && Ii.jJ === nl.jJ && Ii.KX === nl.KX) { return; } kH[ak] = nl; }; this.fb = function () { return kH.length; }; this.aKs = function (ak) { lO(ak); kH.splice(ak, 1); }; this.aJf = function () { if (kH.length < 1) { return; } kH = []; }; return this; }; IPCC.Web.UI.ImGearHyperlinkCollection = function () { var HL = []; this.arX = function (aDH) { HL.push(aDH); }; this.cz = function () { return HL.length; }; this.mR = function (kg, ca) { IPCC.J.forEach(HL, kg, ca); }; this.aEG = function () { if (HL.length < 1) { return; } HL = []; }; return this; }; IPCC.Web.UI.ImGearHyperlinkPage = function () { var JK = new IPCC.Web.UI.ImGearHyperlinkCollection(); this.GX = function () { return JK; }; }; IPCC.Web.UI.ImGearTextPage = function () { var asC = new IPCC.Web.UI.ImGearTextCharacterCollection(); var Yq = false; var akI = false; var UK = ""; var wN = new IPCC.Web.UI.ImGearTextSectionCollection(); var aaW = false; this.gl = function () { return asC; }; this.mw = function () { return Yq; }; this.PG = function (F) { akI = true; if (F === Yq) { return; } if ((F === true) || (F === false)) { Yq = F; } }; this.Ar = function () { return akI; }; this.FF = function () { return UK; }; this.aGM = function (F) { if (F === UK) { return; } UK = F; }; this.adw = function () { return wN; }; this.ata = function () { return aaW; }; this.acS = function (F) { if (F === aaW) { return; } if ((F === true) || (F === false)) { aaW = F; } }; }; IPCC.Web.UI.ImGearTextSection = function () { var h = null; var bh = 0; var fF = 0; this.fD = function () { return h; }; this.Gn = function (F) { h = F; }; this.acQ = function () { return bh; }; this.aDE = function (F) { bh = F; }; this.ahR = function () { return fF; }; this.aGj = function (F) { fF = F; }; }; IPCC.Web.UI.ImGearTextSectionCollection = function () { var wN = []; this.arm = function (iM) { wN.push(iM); }; function lO(ak) { if (ak > wN.length - 1 || (ak < 0)) { throw new IPCC.Web.UI.ImGearArgumentOutOfRangeException('index', ak); } }; this.azV = function (ak) { lO(ak); return wN[ak]; }; this.fb = function () { return wN.length; }; return this; }; IPCC.Type.registerNamespace('IPCC.Web.UI'); IPCC.Web.UI.ImGearThumbnailLayout = function () { }; IPCC.Web.UI.ImGearThumbnailLayout.registerEnum = IPCC.Web.regEnum; IPCC.Web.UI.ImGearThumbnailLayout.prototype = { VerticalScrollDirection: 0, HorizontalScrollDirection: 1 }; IPCC.Web.UI.ImGearThumbnailLayout.registerEnum('IPCC.Web.UI.ImGearThumbnailLayout', false); IPCC.Web.UI.ImGearThumbnailSelectionMode = function () { }; IPCC.Web.UI.ImGearThumbnailSelectionMode.registerEnum = IPCC.Web.regEnum; IPCC.Web.UI.ImGearThumbnailSelectionMode.prototype = { Single: 1, Multiple: 2 }; IPCC.Web.UI.ImGearThumbnailSelectionMode.registerEnum('IPCC.Web.UI.ImGearThumbnailSelectionMode', false); IPCC.Web.UI.ImGearPageCountStatus = function () { }; IPCC.Web.UI.ImGearPageCountStatus.registerEnum = IPCC.Web.regEnum; IPCC.Web.UI.ImGearPageCountStatus.prototype = { UnRequested: 0, RequestPending: 1, Known: 2, Failed: 3 }; IPCC.Web.UI.ImGearPageCountStatus.registerEnum('IPCC.Web.UI.ImGearPageCountStatus', false); IPCC.Web.UI.ImGearPageCreateArgs = function () { }; IPCC.Web.UI.ImGearPageCreateArgs.registerClass = IPCC.Web.regClass; IPCC.Web.UI.ImGearPageCreateArgs.prototype = {}; IPCC.Web.UI.ImGearPageCreateArgs.registerClass('IPCC.Web.UI.ImGearPageCreateArgs'); IPCC.Web.UI.ImGearPage = function (bo) { this.bE = undefined; var bp = 0; var aJ = 0, amb = 0, ana = 0; var by = 0, amf = 0, ani = 0; var De = ''; var pZ = false; var K = this; var bC = new IPCC.Web.UI.fR(); this.gu = undefined; this.aJJ = undefined; this.gd = { uz: 0, ajq: false, uw: 1000, Rs: false }; var gs = new IPCC.Web.UI.ImGearTextPage(); var Ud = new IPCC.Web.UI.ImGearHyperlinkPage(); var mk = 0; var nu = false; var EZ = false, HA = 0, FZ = 0; function amX(o) { return !isNaN(o - 0); }; if (bo.pageNumber !== undefined) { if (amX(bo.pageNumber)) { bp = bo.pageNumber; } else { throw new IPCC.Web.UI.ImGearArgumentOutOfRangeException("pageNumber", "", 'The value must be a number.'); } } if (bo.caption !== undefined) { IPCC.ad.aa(bo.caption, 'caption', 'string'); De = bo.caption; } if (bo.selected !== undefined) { pZ = bo.selected; } this.mc = function () { return bp; }; this.aKk = function (F) { if (amX(bo.pageNumber)) { bp = F; } }; this.kO = function () { return aJ; }; function alF() { var aqx = gs.gl(); var rO = aJ / HA, pL = by / FZ; aqx.azY(rO, pL); }; function amN() { var JK = Ud.GX(); var rO = aJ / HA, pL = by / FZ; JK.mR(function (iH) { iH.Gn(iH.fD().scale(rO, pL)); var aeC = iH.Ry(); aeC.set_rectangle(aeC.get_rectangle().scale(rO, pL)); }); }; this.FX = function (F) { aJ = F; if (EZ && aJ && aJ !== HA && by && by !== FZ) { alF(); amN(); EZ = false; } }; this.iE = function () { return by; }; this.FM = function (F) { by = F; if (EZ && aJ && aJ !== HA && by && by !== FZ) { alF(); amN(); EZ = false; } }; this.alc = function () { return amb; }; this.aek = function (F) { amb = F; }; this.aIe = function () { return amf; }; this.afv = function (F) { amf = F; }; this.aJz = function () { return ana; }; this.aJy = function (F) { ana = F; }; this.aHz = function () { return ani; }; this.aJD = function (F) { ani = F; }; this.Sk = function () { return pZ; }; this.Pb = function (F) { if (pZ !== F) { pZ = F; this.aL('selected'); } }; this.abp = function () { return De; }; this.YH = function (F) { IPCC.ad.jt(F, 'caption'); De = F; this.aL('caption'); }; this.arq = function () { return this.bE; }; this.cv = function () { return gs; }; this.hT = function () { return mk; }; this.tm = function (F) { if (mk === F) { return; } if (isNaN(F)) { return; } mk = F; this.aL('serviceResponseTimeout'); }; this.eG = function () { return nu; }; this.iA = function (F) { nu = F; }; this.lg = function (V) { bC.addHandler('propertyChanged', V); }; this.nt = function (V) { bC.removeHandler('propertyChanged', V); }; this.xq = function (V) { bC.addHandler('textPageReady', V); }; this.yI = function (V) { bC.removeHandler('textPageReady', V); }; this.ajz = function () { return Ud; }; this.Xy = function (V) { bC.addHandler('hyperlinkPageReady', V); }; this.afb = function (V) { bC.removeHandler('hyperlinkPageReady', V); }; this.Cg = function (V) { bC.du('textExtractionFailed', V); }; this.EU = function (V) { bC.dn('textExtractionFailed', V); }; this.aih = function (jx) { if (aJ === 0 && by === 0) { EZ = true; HA = jx.width; FZ = jx.height; } }; this.agi = function (jx) { if (gs.gl().fb() > 0) { return; } else if (jx.errorCode) { var pD = new IPCC.Web.UI.ImGearException(jx.errorDescription, { name: 'Text Extraction' }); var dz = new IPCC.Web.UI.ImGearPageOpenFailedEventArgs(); dz.exception = pD; dz.pageNumber = K.get_pageNumber(); K.aM('textExtractionFailed', dz); return; } var ayR = gs.gl(); var OP = false; var api; function LM(Vl) { return Vl; }; var pL = 1; var rO = 1; if (jx.height && jx.height > 0 && by > 0) { if (jx.height !== by) { pL = by / jx.height; } } if (jx.width && jx.width > 0 && aJ > 0) { if (jx.width !== aJ) { rO = aJ / jx.width; } } var iM; var aps = -1; var OD; var jk, Ba; for (var G = 0; G < jx.rectangles.length; G++) { jk = jx.rectangles[G]; Ba = LM(jx.text[G]); OP = false; if (jk[2] === 0) { Ba = "\n"; OP = true; if (G > 0) { api = jx.rectangles[G - 1]; jk[2] = api[2]; } } if (rO === 1 && pL === 1) { OD = new IPCC.Web.UI.ImGearTextCharacter(jk[0], jk[1], jk[2], jk[3], Ba, OP); } else { OD = new IPCC.Web.UI.ImGearTextCharacter(jk[0] * rO, jk[1] * pL, jk[2] * rO, jk[3] * pL, Ba, OP); } if (OD) { ayR.apR(OD); } if (iM === undefined || aps !== jk[1] || jk[0] < iM.fD().x) { if (iM) { gs.adw().arm(iM); } iM = new IPCC.Web.UI.ImGearTextSection(); iM.Gn(new IPCC.Web.UI.Rectangle(jk[0], jk[1], jk[2], jk[3])); iM.aDE(G); } else { if (jk[0] + jk[2] - iM.fD().x > iM.fD().width) { iM.fD().width = jk[0] + jk[2] - iM.fD().x; } } iM.aGj(G); aps = jk[1]; } if (iM) { gs.adw().arm(iM); } gs.aGM(jx.text); if (jx.text.length > 0) { gs.PG(true); K.aM('textPageReady', { pageNumber: K.mc(), containsText: true }); } else { gs.PG(false); K.aM('textPageReady', { pageNumber: K.mc(), containsText: false }); } }; this.agT = function (aiY, Pe, Qg) { if (!aiY) { return; } Ud.GX().aEG(); var pL = 1; var rO = 1; if (Pe && Pe > 0 && by > 0) { if (Pe !== by) { pL = by / Pe; } } if (Qg && Qg > 0 && aJ > 0) { if (Qg !== aJ) { rO = aJ / Qg; } } IPCC.J.forEach(aiY, function (aij) { var iH; switch (aij.markType) { case "DocumentHyperlink": iH = new IPCC.Web.UI.ImGearDocumentHyperlink(aij.properties); iH.Gn(iH.fD().scale(rO, pL)); Ud.GX().arX(iH); break; default: break; } }); K.aM('hyperlinkPageReady', { pageNumber: K.mc() }); }; this.aIf = function () { K.Bx(); }; this.Bx = function () { if (!K.bE) { throw new IPCC.Web.UI.ImGearInvalidOperationException('You must add this Page to a valid ImGearDocument object which has a valid ImageServicePath property.'); } if (gs.Ar()) { return; } var ahi = true; if (K.hT() === 0) { ahi = false; } function Qm(az) { if (az.pages) { var aD; if (az.pages.length > 0) { if (az.pages[0].number !== K.mc()) { for (var G = 0; G < az.pages.length; G++) { if (az.pages[G].number === K.mc()) { aD = G; break; } } if (!aD) { K.gd.Rs = false; return; } } else { aD = 0; } var jx = az.pages[aD]; K.gd.Rs = true; if (az.pages[aD].text && az.pages[aD].text.length > 0) { gs.PG(true); } else { gs.PG(false); } K.gd.uw = 1000; setTimeout(function () { K.aih(jx); K.agi(jx); K.agT(jx.markup, jx.height, jx.width); }, 10); return; } } var ri = K.gd.uw; if (!K.gd.Rs) { if (K.gd.uz < 6) { if (K.gd.uz < 2) { ri = ri + 1000; } else { ri = ri + 3000; } K.gd.uz++; K.gd.uw = ri; setTimeout(K.aIf, ri); } else { K.gd.ajq = true; } } }; function fa(bF) { var hw = K.bE.hw, bM; try { var gM; var lV = bF.getResponseHeader("Accusoft-Data-Encrypted"); if (lV === 'true') { var sf = IPCC.Web.hm.nC.te(bF.getResponseHeader("Accusoft-Data-SK")); var aq = IPCC.Web.Hw(sf, hw); var fw = IPCC.Web.Hg(bF); var vb = IPCC.Web.AB(fw, aq, hw); gM = IPCC.Web.hm.GR.nh(vb); } else { gM = bF.responseText; } if (typeof JSON !== 'undefined') { bM = JSON.parse(gM); } else { bM = IPCC.ct.pG(gM); } Qm(bM); } catch (e) { var dz = new IPCC.Web.UI.ImGearPageOpenFailedEventArgs(); dz.exception = e; dz.pageNumber = K.get_pageNumber(); K.aM('textExtractionFailed', dz); return; } }; function eZ(bM) { try { if (!bM.response) { throw new IPCC.Web.UI.ImGearHttpException(0, "Text extraction timeout"); } else { if (bM.response.statusText) { throw new IPCC.Web.UI.ImGearHttpException(bM.response.status, "Unable to obtain text, Error from the service = " + bM.response.statusText); } else { throw new IPCC.Web.UI.ImGearHttpException(bM.response.status, "Unable to obtain text from the service"); } } } catch (e) { var dz = new IPCC.Web.UI.ImGearPageOpenFailedEventArgs(); dz.exception = e; dz.pageNumber = K.get_pageNumber(); K.aM('textExtractionFailed', dz); return; } }; var bh = K.get_pageNumber(); var lw = K.bE.get_documentIdentifier(); if (!(/^[\x00-\x7F]*$/.test(lw))) { lw = 'e' + K.bE.get_encodedDocumentIdentifier(); } else { lw = 'u' + encodeURIComponent(lw); } var iY = K.bE.np; var nK = K.bE.nK; var am; if (K.eG()) { am = iY + '/Document/q/' + bh.toString() + '-' + bh.toString() + '/Text?DocumentID=' + lw + '&iv=' + nK; } else { am = iY + '/Document/q/' + bh.toString() + '-' + bh.toString() + '/Text?DocumentID=' + lw; } var hc = { method: 'GET', url: am, headers: { 'accept': 'application/json' } }; if (ahi === true) { hc.timeout = K.hT(); } IPCC.J.mt.dZ(hc).then(fa, eZ); }; this.cv = function () { return gs; }; this.aEU = function (F) { if (typeof F.mw !== 'function') { return; } gs = F; }; this.ajp = function () { gs = new IPCC.Web.UI.ImGearTextPage(); K.gd = { uz: 0, ajq: false, uw: 1000, Rs: false }; EZ = false; HA = 0; FZ = 0; }; this.SA = function (Bp, Bh) { var K = this; function fa(bF) { var bM; if (typeof JSON !== 'undefined') { bM = JSON.parse(bF.responseText); } else { bM = IPCC.ct.pG(bF.responseText); } if (bM.imageWidth && bM.imageHeight) { K.FX(bM.imageWidth); K.FM(bM.imageHeight); Bp(bM.imageWidth, bM.imageHeight); } else { Bh("Unable to obtain document information from the server"); } }; function eZ(bM) { Bh("Unable to obtain document information from the server"); }; if (K.kO() > 0 || K.iE() > 0) { Bp(K.kO(), K.iE()); } else { var sU = IPCC.gB.sv(K.bE.get_documentIdentifier()); if (!sU || sU === "") { Bh("Invalid encoded Identifier"); } var sB = ''; if (!IPCC.yZ.Bv()) { sB = '&ContentType=png'; } var am; if (!(/^[\x00-\x7F]*$/.test(sU))) { am = K.bE.np + '/Page/q/' + (K.get_pageNumber()) + '/Attributes?DocumentID=e' + sU + sB; } else { am = K.bE.np + '/Page/q/' + (K.get_pageNumber()) + '/Attributes?DocumentID=u' + encodeURIComponent(K.bE.get_documentIdentifier()) + sB; } IPCC.J.mt.dZ({ method: 'GET', url: am, headers: { 'Content-Type': 'application/json' } }).then(fa, eZ); } }; this.aL = function (cr) { var V = bC.getHandler('propertyChanged'); if (V) { V(this, new IPCC.qP(cr)); } }; this.aM = function (cA, L) { var V = bC.getHandler(cA); if (V !== null) { try { V(K, L); } catch (e) { IPCC.gG.Sa('event raise, ImGearPage, error: ' + e.message); } } }; return this; }; IPCC.Web.UI.ImGearPage.prototype = { get_pageNumber: function () { var ac = this.mc(); return ac; }, get_pageWidth: function () { var ac = this.kO(); return ac; }, get_pageHeight: function () { var ac = this.iE(); return ac; }, get_textPage: function () { var ac = this.cv(); return ac; }, get_selected: function () { var ac = this.Sk(); return ac; }, set_selected: function (value) { this.Pb(value); }, get_caption: function () { var ac = this.abp(); return ac; }, set_caption: function (value) { this.YH(value); }, get_encryption: function () { var ac = this.eG(); return ac; }, set_encryption: function (value) { this.iA(value); }, get_hyperlinkPage: function () { return this.ajz(); }, get_document: function () { var ac = this.arq(); return ac; }, add_propertyChanged: function (handler) { this.lg(handler); }, remove_propertyChanged: function (handler) { this.nt(handler); }, requestPageAttributes: function (attributesRetrievedCallback, attributesRetrievalFailedCallback) { this.SA(attributesRetrievedCallback, attributesRetrievalFailedCallback); } }; IPCC.Web.UI.ImGearPage.registerClass = IPCC.Web.regClass; IPCC.Web.UI.ImGearPage.registerClass('IPCC.Web.UI.ImGearPage'); IPCC.Web.UI.ImGearPageEventArgs = function () { return this; }; IPCC.Web.UI.ImGearPageEventArgs.prototype = {}; IPCC.Web.UI.ImGearPageEventArgs.registerClass = IPCC.Web.regClass; IPCC.Web.UI.ImGearPageEventArgs.registerClass('IPCC.Web.UI.ImGearPageEventArgs'); IPCC.Web.UI.ImGearPageCollection = function () { var K = this; var dP = []; var bC = new IPCC.Web.UI.fR(); this.aoY = false; this.aoM = true; this.bE = undefined; this.alK = function (bI) { this.amF(dP.length, bI); }; function lO(ak) { if (ak > dP.length - 1 || (ak < 0)) { throw new IPCC.Web.UI.ImGearArgumentOutOfRangeException('index', ak, 'page index is out of range in the page collection'); } }; this.amF = function (ak, bI) { var aj; var dg = dP.length; if (ak > dP.length || (ak < 0)) { throw new IPCC.Web.UI.ImGearArgumentOutOfRangeException('index', ak, 'index of the page Collection is out of range'); } if (K.aoM && K.aoY) { if (dg > 0) { throw new IPCC.Web.UI.ImGearInvalidOperationException('You must first remove the existing selected page before adding a new one to the selected page collection).'); } } for (aj = 0; aj < dg; aj++) { if (dP[aj] === bI) { throw new IPCC.Web.UI.ImGearInvalidOperationException('You cannot duplicate same page instance in a page collection).'); } } if (K.bE) { if (!bI.bE) { bI.bE = K.bE; } } bI.add_propertyChanged(BJ); dP.splice(ak, 0, bI); var L = new IPCC.Web.UI.ImGearPageEventArgs(); L.imGearPage = bI; L.length = 1; K.aM('pageAdded', L); }; this.jb = function (ak) { lO(ak); var eL = dP[ak]; return eL; }; this.aDI = function (ak, bI) { lO(ak); var VX = dP[ak]; if (VX === bI) { return; } dP[ak] = bI; var L = new IPCC.Web.UI.ImGearPageEventArgs(); L.imGearPage = bI; L.length = 1; this.aM('pageAdded', L); VX.remove_propertyChanged(BJ); var EA = new IPCC.Web.UI.ImGearPageEventArgs(); EA.imGearPage = VX; EA.length = 1; this.aM('pageRemoved', EA); }; this.fb = function () { return dP.length; }; this.mR = function (kg, ca) { var aln = [].concat(dP); var G; for (G = 0; G < aln.length; G++) { kg.call(ca, aln[G], G, this); } }; this.aeo = function (ak) { lO(ak); var L = new IPCC.Web.UI.ImGearPageEventArgs(); L.imGearPage = dP[ak]; dP[ak].remove_propertyChanged(BJ); L.length = 1; dP.splice(ak, 1); K.aM('pageRemoved', L); }; this.aGd = function (bI) { var cz = dP.length; for (var G = 0; G < cz; G++) { if (bI === dP[G]) { return G; } } return -1; }; this.aDT = function () { var G = 0; while (dP.length > 0) { this.aeo(G); } }; function BJ(aB, L) { var EA = new IPCC.Web.UI.ImGearPageEventArgs(); EA.imGearPage = aB; EA.length = 1; K.aM('pageChanged', EA); }; this.MQ = function (V) { bC.addHandler('pageAdded', V); }; this.HG = function (V) { bC.removeHandler('pageAdded', V); }; this.NM = function (V) { bC.addHandler('pageChanged', V); }; this.Ij = function (V) { bC.removeHandler('pageChanged', V); }; this.Mw = function (V) { bC.addHandler('pageRemoved', V); }; this.Iq = function (V) { bC.removeHandler('pageRemoved', V); }; this.aM = function (cA, L) { var V = bC.getHandler(cA); if (V !== null) { try { V(K, L); } catch (e) { IPCC.gG.Sa('raise event error in ImGearPageCollection, Error: ' + e.message); } } }; return this; }; IPCC.Web.UI.ImGearPageCollection.prototype = { addPage: function (page) { this.alK(page); }, insertPage: function (index, page) { this.amF(index, page); }, forEach: function (method, context) { this.mR(method, context); }, getPage: function (index) { return this.jb(index); }, setPage: function (index, page) { this.aDI(index, page); }, get_length: function () { return this.fb(); }, removePage: function (index) { this.aeo(index); }, removeAllPages: function () { this.aDT(); }, add_pageAdded: function (handler) { this.MQ(handler); }, remove_pageAdded: function (handler) { this.HG(handler); }, add_pageChanged: function (handler) { this.NM(handler); }, remove_pageChanged: function (handler) { this.Ij(handler); }, add_pageRemoved: function (handler) { this.Mw(handler); }, remove_pageRemoved: function (handler) { this.Iq(handler); } }; IPCC.Web.UI.ImGearPageCollection.registerClass = IPCC.Web.regClass; IPCC.Web.UI.ImGearPageCollection.registerClass('IPCC.Web.UI.ImGearPageCollection'); IPCC.Web.UI.ImGearDocumentCreateArgs = function () { return this; }; IPCC.Web.UI.ImGearDocumentCreateArgs.registerClass = IPCC.Web.regClass; IPCC.Web.UI.ImGearDocumentCreateArgs.prototype = {}; IPCC.Web.UI.ImGearDocumentCreateArgs.registerClass('IPCC.Web.UI.ImGearDocumentCreateArgs'); IPCC.Web.UI.ImGearDocument = function (bo) { var kC = ''; var hQ = ''; var K = this; this.dP = new IPCC.Web.UI.ImGearPageCollection(); this.st = undefined; this.dP.bE = this; var Vz = false; this.np = undefined; var eD = 0; var Pl = IPCC.Web.UI.ImGearPageCountStatus.UnRequested; var De; var bC = new IPCC.Web.UI.fR(); this.hw = IPCC.Web.qS.abx(4, IPCC.Web.PE()); this.nK = IPCC.Web.hm.Fr.nh(this.hw); var CI = []; var oe = 0; var pd = []; var Fq = []; var gd = { startPage: 0, lastPage: 0, requestCount: 0, stopRequests: false, lastTimeout: 1000 }; var Va = false; this.aM = function (cA, L) { var V = bC.getHandler(cA); if (V !== null) { try { V(K, L); } catch (e) { IPCC.gG.Sa('raise event error in ImGearDocument, error: ' + e.message); IPCC.gG.iP(e.message, IPCC.Web.UI.ImGearDocument, IPCC.Web.UI.DebugErrorLevel.Production, 'ImGearDocument', ''); } } }; function LP(aB, L) { if (L.length > 0) { K.aM('pageAdded', L); } }; function KQ(aB, L) { if (L.length > 0) { K.aM('pageRemoved', L); } }; function BJ(aB, L) { K.aM('pageChanged', L); }; this.dP.add_pageAdded(LP); this.dP.add_pageRemoved(KQ); this.dP.add_pageChanged(BJ); function aCW() { function asi(fH, hV) { var aw = fH + '() threw an exception '; if (hV.name) { aw += '( ' + hV.name + " "; } else { aw += "."; } if (hV.message) { aw += "  exception message = " + hV.message; } if (hV.statusCode) { aw += "  exception statusCode = " + hV.statusCode; } aw = aw.replace(/\n/g, " "); IPCC.gG.iP(aw, IPCC.Web.UI.DebugItemCause.Exception, IPCC.Web.UI.DebugErrorLevel.Production, 'ImGearDocument', "document"); }; this.bK = asi; this.aM = function (cA, L) { var V = bC.getHandler(cA); if (V !== null) { V(K, L); } }; }; if (arguments.length === 0) { var aw = "ImGearDocument object creation requires parameters"; throw new IPCC.Web.UI.ImGearArgumentException('ImGearDocument', aw); } if (arguments.length > 0) { if (bo.documentIdentifier !== undefined) { kC = bo.documentIdentifier; hQ = IPCC.gB.sv(kC); } if (bo.encodedDocumentIdentifier !== undefined) { var oS = bo.encodedDocumentIdentifier; if (bo.documentIdentifier !== undefined) { hQ = IPCC.gB.sv(kC); if (oS !== hQ) { throw new IPCC.Web.UI.ImGearArgumentException('documentIdentifier', 'When both are specified, documentIdentifier and encodedImageIdentifier must reference the same document.'); } } else { kC = IPCC.gB.Lt(bo.encodedDocumentIdentifier); } } if (bo.imageServicePath !== undefined) { this.np = bo.imageServicePath; if (!IPCC.Web.rG) { IPCC.Web.OA(this.np); } } else { throw new IPCC.Web.UI.ImGearArgumentException('ImGearDocument', 'Document creation requires imageServicePath.'); } var vw; if (bo.includeAllPages !== undefined) { Vz = bo.includeAllPages; if (Vz === true) { var awQ = new aCW(); var abY = 0; K.ap = new IPCC.gB(hQ, 0, 0, 0, 0, 0); var mH = function () { eD = K.ap.eD; Pl = IPCC.Web.UI.ImGearPageCountStatus.Known; for (; abY < eD; abY++) { var eE = new IPCC.Web.UI.ImGearPage({ pageNumber: abY, bE: K }); eE.bE = K; K.dP.addPage(eE); } }; Pl = IPCC.Web.UI.ImGearPageCountStatus.RequestPending; try { this.ap.Nd(this.np, awQ, mH); } catch (e) { Pl = IPCC.Web.UI.ImGearPageCountStatus.Failed; var dz = new IPCC.Web.UI.ImGearPageOpenFailedEventArgs(); dz.exception = e; K.aM('pageOpenFailed', dz); throw e; } } } else if (bo.pages !== undefined) { if (bo.pages.length > 0) { var G = 0; for (G = 0; G < bo.pages.length; G++) { var af = bo.pages[G]; af.document = this; this.dP.addPage(af); } } } else if (bo.pageNumber !== undefined) { if (bo.pageRangeCount !== undefined) { var pg = bo.pageRangeCount; if (pg > 0) { var ar; for (ar = bo.pageNumber; ar <= pg; ar++) { vw = new IPCC.Web.UI.ImGearPage(ar); vw.bE = K; this.dP.addPage(vw); } } else if (pg === 0) { vw = new IPCC.Web.UI.ImgearPage({ pageNumber: bo.pageNumber, bE: K }); vw.bE = K; K.dP.addPage(vw); } } else { if (bo.selected) { vw = new IPCC.Web.UI.ImGearPage({ pageNumber: bo.pageNumber, bE: K, selected: true }); } else { vw = new IPCC.Web.UI.ImGearPage({ pageNumber: bo.pageNumber, bE: K }); } vw.bE = K; K.dP.addPage(vw); } } } this.wK = function () { return kC; }; this.Dj = function () { return hQ; }; this.akG = function () { return this.dP; }; this.aGy = function () { return eD; }; this.aFp = function () { return Pl; }; this.atg = function () { return Vz; }; this.aGY = function (F) { Vz = F; this.aL('includeAllPages'); }; var nu = false; this.eG = function () { return nu; }; this.iA = function (F) { nu = F; }; this.MQ = function (V) { bC.addHandler('pageAdded', V); }; this.HG = function (V) { bC.removeHandler('pageAdded', V); }; this.Mw = function (V) { bC.addHandler('pageRemoved', V); }; this.Iq = function (V) { bC.removeHandler('pageRemoved', V); }; this.BI = function (V) { bC.addHandler('pageOpenFailed', V); }; this.BD = function (V) { bC.removeHandler('pageOpenFailed', V); }; this.lg = function (V) { bC.addHandler('propertyChanged', V); }; this.nt = function (V) { bC.removeHandler('propertyChanged', V); }; this.NM = function (V) { bC.addHandler('pageChanged', V); }; this.Ij = function (V) { bC.removeHandler('pageChanged', V); }; this.aL = function (cr) { var V = bC.getHandler('propertyChanged'); if (V) { V(this, new IPCC.qP(cr)); } }; this.abp = function () { return De; }; this.YH = function (F) { De = F; this.aL('caption'); }; this.atw = function (V) { bC.addHandler('textPagesReceived', V); }; this.aDg = function (V) { bC.removeHandler('textPagesReceived', V); }; this.aEC = function () { return Fq.length; }; this.aEX = function () { return CI; }; this.aDp = function () { return CI.length; }; this.aEL = function () { return gd; }; this.acq = function () { return Va; }; this.aGq = function (F) { Va = F; }; this.aCA = function (hn) { if (gd.stopRequests === true) { var L = {}; L.error = 0; L.textPagesReceived = Pq(hn); if (L.textPagesReceived.length === 0) { if (oe > 0 && oe < hn) { for (var dh = oe; dh < hn; dh++) { L.textPagesReceived.push(dh); } } } L.length = 2; K.aM('textPagesReceived', L); return; } var hO = true; var LB = false; for (var G = 0; G < oe; G++) { if (Array.prototype.indexOf) { if (CI.indexOf(G) < 0) { hO = false; LB = true; break; } } else { if (IPCC.Web.hK(CI, G) < 0) { LB = true; break; } } } if (LB) { K.Mp(G, undefined, hn); } else if (oe < hn) { for (var aj = 0; aj < hn; aj++) { if (Array.prototype.indexOf) { if (pd.indexOf(aj) < 0) { hO = false; break; } } else { if (IPCC.Web.hK(pd, aj) < 0) { hO = false; break; } } } if (!hO) { LB = true; K.Mp(aj, undefined, hn); } else { K.Mp(oe, undefined, hn); } } else { LB = false; } }; function Pq(hn) { var Yk = [], dh; if (pd.length > 0) { var hO = true; for (dh = 0; dh < hn; dh++) { hO = true; if (Array.prototype.indexOf) { if (pd.indexOf(dh) < 0) { hO = false; } } else { if (IPCC.Web.hK(pd, dh) < 0) { hO = false; } } if (!hO) { pd.push(dh); Fq.push(dh); Yk.push(dh); } } } else { for (dh = 0; dh < hn; dh++) { pd.push(dh); Fq.push(dh); Yk.push(dh); } } return Yk; }; this.Mp = function (ajI, ahy, hn) { Va = true; var bh; if (!isNaN(ajI)) { bh = ajI; } else { bh = 0; } var Fy; if (!isNaN(hn)) { Fy = hn; } var fF; if (!isNaN(ahy)) { fF = ahy; } else if (!isNaN(Fy)) { fF = Fy - 1; } else { Fy = hn; if (!isNaN(Fy)) { fF = Fy - 1; } } if (isNaN(fF)) { fF = bh + 1; } if (fF - bh > 9) { fF = bh + 9; } function Qm(az) { var Wc = oe; var Uj = []; var hO = true; var dw; for (var bI = 0; bI < az.pages.length; bI++) { if (Array.prototype.indexOf) { if (CI.indexOf(az.pages[bI].number) < 0) { hO = false; } } else { if (IPCC.Web.hK(CI, az.pages[bI].number) < 0) { hO = false; } } if (!hO) { CI.push(az.pages[bI].number); if (K.dP.jb(az.pages[bI].number).cv().Ar() === false) { dw = K.dP.jb(az.pages[bI].number); dw.aih(az.pages[bI]); dw.agi(az.pages[bI]); dw.agT(az.pages[bI].markup, az.pages[bI].height, az.pages[bI].width); } oe++; Uj.push(az.pages[bI].number); pd.push(az.pages[bI].number); if (!az.pages[bI].text) { Fq.push(az.pages[bI].number); } } } var L = {}; if (az.hasOwnProperty("errorCode")) { L.error = 0; K.pageExtractionFailed = true; L.textPagesReceived = Uj; L.length = 2; for (var DE = gd.startPage; DE < gd.lastPage + 1; DE++) { hO = true; if (Array.prototype.indexOf) { if (pd.indexOf(DE) < 0) { hO = false; } } else { if (IPCC.Web.hK(pd, DE) < 0) { hO = false; } } if (!hO) { pd.push(DE); Fq.push(DE); L.textPagesReceived.push(DE); } } K.aM('textPagesReceived', L); gd.stopRequests = true; return; } if (oe > Wc) { L.textPagesReceived = Uj; L.length = 2; L.error = 0; } var ri = gd.lastTimeout; if (gd.startPage === bh && gd.lastPage === fF && oe === Wc) { if (gd.requestCount < 25) { ri = ri + 1000; gd.requestCount++; } else { L.error = 0; L.textPagesReceived = []; L.length = 2; hO = true; var dh; for (dh = gd.startPage; dh < gd.lastPage + 1; dh++) { hO = true; if (Array.prototype.indexOf) { if (pd.indexOf(dh) < 0) { hO = false; } } else { if (IPCC.Web.hK(pd, dh) < 0) { hO = false; } } if (!hO) { pd.push(dh); Fq.push(dh); L.textPagesReceived.push(dh); } } if (L.textPagesReceived.length === 0) { if (oe > 0 && oe < hn) { for (dh = oe; dh < hn; dh++) { L.textPagesReceived.push(dh); } } } gd.stopRequests = true; K.aM('textPagesReceived', L); return; } } else { ri = 1000; gd.requestCount = 0; } gd.lastTimeout = ri; gd.startPage = bh; gd.lastPage = fF; setTimeout(function () { K.aCA(hn); }, ri); if (oe > Wc) { K.aM('textPagesReceived', L); } }; function fa(bF) { var L = {}, gM, bM; try { var lV = bF.getResponseHeader("Accusoft-Data-Encrypted"); if (lV === 'true') { var sf = IPCC.Web.hm.nC.te(bF.getResponseHeader("Accusoft-Data-SK")); var aq = IPCC.Web.Hw(sf, K.hw); var fw = IPCC.Web.Hg(bF); var vb = IPCC.Web.AB(fw, aq, K.hw); gM = IPCC.Web.hm.GR.nh(vb); } else { gM = bF.responseText; } if (typeof JSON !== 'undefined') { bM = JSON.parse(gM); } else { bM = IPCC.ct.pG(gM); } Qm(bM); } catch (e) { L.error = -1; Pq(hn); L.textPagesReceived = []; L.length = 2; K.aM('textPagesReceived', L); return; } }; function eZ(bM) { var L = {}, fS; try { fS = bM.response.status; if (bM.response.responseText) { if (typeof JSON !== 'undefined') { bM = JSON.parse(bM.response.responseText); } else { bM = IPCC.ct.pG(bM.response.responseText); } if (bM.hasOwnProperty("errorCode")) { L.error = 0; if (oe > 0) { if (bM.pages) { if (bM.pages.length > 0) { Qm(bM); return; } } } else { L.error = -1; } if (pd.length === 0) { L.error = -1; } K.pageExtractionFailed = true; L.textPagesReceived = []; L.length = 2; L.textPagesReceived = Pq(hn); K.aM('textPagesReceived', L); return; } else { throw new IPCC.Web.UI.ImGearHttpException(fS, "Unable to obtain text"); } } else { throw new IPCC.Web.UI.ImGearHttpException(fS, "Unable to obtain text"); } } catch (e) { L.error = -1; Pq(hn); L.textPagesReceived = []; L.length = 2; K.aM('textPagesReceived', L); return; } }; var lw = kC; var iY = K.np; if (!(/^[\x00-\x7F]*$/.test(lw))) { lw = 'e' + hQ; } else { lw = 'u' + lw; } var am; if (K.eG()) { am = iY + '/Document/q/' + bh.toString() + '-' + fF.toString() + '/Text?DocumentID=' + lw + '&iv=' + K.nK; } else { am = iY + '/Document/q/' + bh.toString() + '-' + fF.toString() + '/Text?DocumentID=' + lw; } IPCC.J.mt.dZ({ method: 'GET', url: am, headers: { 'accept': 'application/json' } }).then(fa, eZ); }; return this; }; IPCC.Web.UI.ImGearDocument.encodeDocumentIdentifier = function (kC) { var hQ; if (kC !== undefined) { hQ = IPCC.gB.sv(kC); } return hQ; }; IPCC.Web.UI.ImGearDocument.decodeDocumentIdentifier = function (hQ) { var aib; if (hQ !== undefined) { aib = IPCC.gB.Lt(hQ); } return aib; }; IPCC.Web.UI.ImGearDocument.prototype = { get_documentIdentifier: function () { var ac = this.wK(); return ac; }, get_encodedDocumentIdentifier: function () { var ac = this.Dj(); return ac; }, get_pages: function () { return this.akG(); }, get_pageCountStatus: function () { var r = this.aFp(); return r; }, set_pageCountStatus: function (value) { this.aIU(value); }, get_pageCount: function () { var r = this.aGy(); return r; }, get_includeAllPages: function () { try { var ac = this.atg(); return ac; } catch (e) { throw e; } }, set_includeAllPages: function (value) { try { this.aGY(value); } catch (e) { throw e; } }, get_caption: function () { var ac = this.abp(); return ac; }, set_caption: function (value) { this.YH(value); }, get_encryption: function () { var ac = this.eG(); return ac; }, set_encryption: function (value) { this.iA(value); }, add_pageChanged: function (handler) { this.NM(handler); }, remove_pageChanged: function (handler) { this.Ij(handler); }, add_pageRemoved: function (handler) { this.Mw(handler); }, remove_pageRemoved: function (handler) { this.Iq(handler); }, add_pageAdded: function (handler) { this.MQ(handler); }, remove_pageAdded: function (handler) { this.HG(handler); }, add_pageOpenFailed: function (handler) { this.BI(handler); }, remove_pageOpenFailed: function (handler) { this.BD(handler); }, get_textRequestInfo: function () { try { var ac = this.aEL(); return ac; } catch (e) { throw e; } }, get_pagesWithText: function () { try { var ac = this.aEX(); return ac; } catch (e) { throw e; } }, get_numberOfPagesWithText: function () { try { var ac = this.aDp(); return ac; } catch (e) { throw e; } }, get_numberOfPagesWithoutText: function () { try { var ac = this.aEC(); return ac; } catch (e) { throw e; } }, add_textPagesReceived: function (handler) { try { this.atw(handler); } catch (e) { throw e; } }, remove_textPagesReceived: function (handler) { try { this.aDg(handler); } catch (e) { this.bK('remove_textPagesReceived', e); throw e; } }, add_propertyChanged: function (handler) { this.lg(handler); }, remove_propertyChanged: function (handler) { this.nt(handler); } }; IPCC.Web.UI.ImGearDocument.registerClass = IPCC.Web.regClass; IPCC.Web.UI.ImGearDocument.registerClass('IPCC.Web.UI.ImGearDocument'); IPCC.Web.UI.ImGearDocumentEventArgs = function () { return this; }; IPCC.Web.UI.ImGearDocumentEventArgs.registerClass = IPCC.Web.regClass; IPCC.Web.UI.ImGearDocumentEventArgs.prototype = {}; IPCC.Web.UI.ImGearDocumentEventArgs.registerClass('IPCC.Web.UI.ImGearDocumentEventArgs'); IPCC.Web.UI.ImGearDocumentCollection = function () { var ku = []; var bC = new IPCC.Web.UI.fR(); var K = this; function ayA(aB, L) { if (L) { var RG = new IPCC.Web.UI.ImGearDocumentEventArgs(); RG.document = aB; RG.propertyName = L.get_propertyName(); RG.length = 2; K.aM('documentChanged', RG); } }; this.JA = function (avt) { this.amP(ku.length, avt); }; this.amP = function (ak, bE) { var aj; var dg = ku.length; if (ak > ku.length || (ak < 0)) { throw new IPCC.Web.UI.ImGearArgumentOutOfRangeException('index', ak, 'document index is out of range'); } for (aj = 0; aj < dg; aj++) { if (ku[aj] === bE) { throw new IPCC.Web.UI.ImGearInvalidOperationException('The document instance object to be inserted already exists in the collection. You cannot use the same instance of a document object.'); } } var ahn = bC.getHandler('pageAdded'); if (ahn) { bE.add_pageAdded(ahn); } var ahG = bC.getHandler('pageRemoved'); if (ahG) { bE.add_pageRemoved(ahG); } var agq = bC.getHandler('pageChanged'); if (agq) { bE.add_pageChanged(agq); } bE.add_propertyChanged(ayA); ku.splice(ak, 0, bE); var L = new IPCC.Web.UI.ImGearDocumentEventArgs(); L.imGearDocument = bE; L.index = ak; L.length = 1; this.aM('documentAdded', L); }; function lO(ak) { if (ak > ku.length - 1 || (ak < 0)) { throw new IPCC.Web.UI.ImGearArgumentOutOfRangeException('index', ak, 'document index is out of range'); } }; this.QO = function (ak) { lO(ak); return ku[ak]; }; this.fb = function () { return ku.length; }; this.aIV = function (kg, ca) { var akV = [].concat(ku); var G; for (G = 0; G < akV.length; G++) { kg.call(ca, akV[G], G, this); } }; this.afJ = function (ak) { lO(ak); var L = new IPCC.Web.UI.ImGearDocumentEventArgs(); L.imGearDocument = ku[ak]; L.length = 1; ku[ak].get_pages().removeAllPages(); ku.splice(ak, 1); this.aM('documentRemoved', L); }; this.aEf = function () { var G = 0; while (ku.length > 0) { this.afJ(G); } }; this.aIx = function (V) { bC.addHandler('documentAdded', V); }; this.aCm = function (V) { bC.removeHandler('documentAdded', V); }; this.aEw = function (V) { bC.addHandler('documentRemoved', V); }; this.aBb = function (V) { bC.removeHandler('documentRemoved', V); }; this.aEh = function (V) { bC.addHandler('documentChanged', V); }; this.aAX = function (V) { bC.removeHandler('documentChanged', V); }; this.MQ = function (V) { bC.addHandler('pageAdded', V); }; this.HG = function (V) { bC.removeHandler('pageAdded', V); for (var aj = 0; aj < ku.length; aj++) { ku[aj].remove_pageAdded(V); } }; this.NM = function (V) { bC.addHandler('pageChanged', V); }; this.Ij = function (V) { bC.removeHandler('pageChanged', V); for (var aj = 0; aj < ku.length; aj++) { ku[aj].remove_pageChanged(V); } }; this.Mw = function (V) { bC.addHandler('pageRemoved', V); }; this.Iq = function (V) { bC.removeHandler('pageRemoved', V); for (var aj = 0; aj < ku.length; aj++) { ku[aj].remove_pageRemoved(V); } }; this.aM = function (cA, L) { var V = bC.getHandler(cA); if (V !== null) { try { V(K, L); } catch (e) { IPCC.gG.Sa('event raise, ImGearDocumentCollection, error: ' + e.message); } } }; return this; }; IPCC.Web.UI.ImGearDocumentCollection.prototype = { addDocument: function (imGearDocument) { this.JA(imGearDocument); }, insertDocument: function (index, imGearDocument) { this.amP(index, imGearDocument); }, forEach: function (method, context) { this.mR(method, context); }, getDocument: function (index) { return this.QO(index); }, get_length: function () { return this.fb(); }, removeDocument: function (imGearDocument) { this.afJ(imGearDocument); }, removeAllDocuments: function () { this.aEf(); }, add_documentAdded: function (handler) { this.aIx(handler); }, remove_documentAdded: function (handler) { this.aCm(handler); }, add_documentRemoved: function (handler) { this.aEw(handler); }, remove_documentRemoved: function (handler) { this.aBb(handler); }, add_documentChanged: function (handler) { this.aEh(handler); }, remove_documentChanged: function (handler) { this.aAX(handler); }, add_pageAdded: function (handler) { this.MQ(handler); }, remove_pageAdded: function (handler) { this.HG(handler); }, add_pageRemoved: function (handler) { this.Mw(handler); }, remove_pageRemoved: function (handler) { this.Iq(handler); }, add_pageChanged: function (handler) { this.NM(handler); }, remove_pageChanged: function (handler) { this.Ij(handler); } }; IPCC.Web.UI.ImGearDocumentCollection.registerClass = IPCC.Web.regClass; IPCC.Web.UI.ImGearDocumentCollection.registerClass('IPCC.Web.UI.ImGearDocumentCollection'); IPCC.Web.UI.lq = function (bo) { this.bd = undefined; var bC = new IPCC.Web.UI.fR(); this.gu = undefined; this.mF = undefined; this.Am = undefined; this.DW = undefined; this.gH = undefined; this.ht = undefined; this.aX = undefined; this.EC = false; this.xV = 0; this.avy = undefined; this.kw = false; this.iT = false; if (arguments.length > 0) { if (bo.page !== undefined) { this.bd = bo.page; } } this.aL = function (cr) { var V = bC.getHandler('propertyChanged'); if (V) { V(this, new IPCC.qP(cr)); } }; return this; }; IPCC.Web.UI.aHi = function () { this.jj = new IPCC.Web.UI.ImGearPageCollection(); this.aJg = 0; return this; }; IPCC.Web.UI.Thumbnailcounter = 1; IPCC.Web.UI.ImGearThumbnailList = function (element) { var K = this; var pp = ''; var NR = IPCC.Web.UI.ImGearArtDataServices.None; var yo = ''; var sP = null; var Wj = null; var aCP; var aA = []; var np = ''; var mP = true; var vQ; var bC = new IPCC.Web.UI.fR(); var kx = IPCC.Web.UI.DebugErrorLevel.Production; var _debug = false; var PW = IPCC.Web.UI.ImGearThumbnailSelectionMode.Single; var kF = ''; var nB = ''; var sM = 0; var sX = IPCC.Web.UI.ImGearThumbnailLayout.VerticalScrollDirection; var Fz = 140; var wT = 124; var wh = 'gray'; var SI = 4; var zw = 4; var Ub = 2; var Sm = '#000000'; var ni = false; var zl = ""; var aun = false; this.jS = new IPCC.Web.UI.ImGearDocumentCollection(); var jj = new IPCC.Web.UI.ImGearPageCollection(); var VE = '#FFDA6A'; jj.aoY = true; var Ib = 0; var Bb = 10; var XM = 0; var ajL = false; var Xk = 0; var XI; function it(wL) { if (!_debug) { return false; } return kx >= wL; }; this.bK = function (fH, hV) { if (!it(IPCC.Web.UI.DebugErrorLevel.Production)) { return; } var aw = fH + '() threw an exception (' + hV.name + '), "' + hV.message + '"'; aw = aw.replace(/\n/g, " "); IPCC.gG.iP(aw, IPCC.Web.UI.DebugItemCause.Exception, IPCC.Web.UI.DebugErrorLevel.Production, 'ImGearThumbnailList', this.get_igelement().id); }; this.aI = function (fH, eB, jB) { if (!it(IPCC.Web.UI.DebugErrorLevel.Development)) { return; } var aw = fH + '('; var G; for (G = 0; G < eB.length; G++) { if (G > 0) { aw += ', '; } aw += IPCC.gG.io(eB[G], (jB ? jB : 0)); } aw += ')'; this.mB(aw, IPCC.Web.UI.DebugErrorLevel.Development); }; this.wb = function (fH, eB, js, jB) { if (!it(IPCC.Web.UI.DebugErrorLevel.Development)) { return; } var aw = fH + '('; var G; for (G = 0; G < eB.length; G++) { if (G > 0) { aw += ', '; } aw += IPCC.gG.io(eB[G], (jB ? jB : 0)); } aw += ') = '; aw += IPCC.gG.io(js, 1); this.mB(aw, IPCC.Web.UI.DebugErrorLevel.Development); }; this.ah = function (fH, eB, js) { if (!it(IPCC.Web.UI.DebugErrorLevel.Detailed)) { return; } var aw = fH + '('; var G; for (G = 0; G < eB.length; G++) { if (G > 0) { aw += ', '; } aw += IPCC.gG.io(eB[G], 0); } aw += ') = '; aw += IPCC.gG.io(js, 1); this.mB(aw, IPCC.Web.UI.DebugErrorLevel.Detailed); }; this.mB = function (hb, as) { IPCC.gG.iP(hb, IPCC.Web.UI.DebugItemCause.FunctionCall, as, 'ImGearThumbnailList', this.gx().id); }; this.iP = function (hb) { IPCC.gG.iP(hb, IPCC.Web.UI.DebugItemCause.Custom, IPCC.Web.UI.DebugErrorLevel.Production, 'ImGearThumbnailList', this.gx().id); }; this.rC = function () { return _debug; }; this.Ck = function (F) { var yQ = ! !F; if (_debug === yQ) { return; } _debug = yQ; this.aL('debug'); }; this.pm = function () { return kx; }; this.uG = function (F) { IPCC.ad.lm(F, 'value', IPCC.Web.UI.DebugErrorLevel); if (kx === F) { return; } kx = F; this.aL('debugErrorLevel'); }; function du(cA, V) { bC.addHandler(cA, V); }; function dn(cA, V) { bC.removeHandler(cA, V); }; this.lg = function (V) { bC.addHandler('propertyChanged', V); }; this.nt = function (V) { bC.removeHandler('propertyChanged', V); }; this.aLZ = function (V) { du('thumbnailSelectionChanged', V); }; this.aJi = function (V) { dn('thumbnailSelectionChanged', V); }; this.ast = function (V) { du('pageSelectionChanged', V); }; this.aEx = function (V) { dn('pageSelectionChanged', V); }; this.aGr = function (V) { du('pageAddFailed', V); }; this.aBl = function (V) { dn('pageAddFailed', V); }; var lU; this.gx = function () { return lU; }; this.rc = function (F) { lU = F; }; this.uS = 0; this.Ho = 0; this.aM = function (cA, L) { try { var V = bC.getHandler(cA); if (V !== null) { V(K, L); } } catch (e) { K.bK(cA + 'Event', e); } }; function qt() { var sd, hC; if (pp !== '') { sd = document.getElementById(pp); if (sd) { var Ng = jj.get_length(); var G = 0; if (Ng > 0) { hC = "{\"selectedPages\":["; for (G = 0; G < Ng; G++) { if (jj.getPage(G)) { var ahf = jj.getPage(G).bE.get_encodedDocumentIdentifier(); var ard = jj.getPage(G).get_pageNumber(); if (ahf) { if (ard >= 0) { if (G > 0) { hC += ","; } hC += '{\"encodedDocumentIdentifier\":"' + ahf; hC += '",\"pageNumber\":\"' + ard.toString() + "\""; hC += "}"; } } } } hC += ']}'; } sd.value = hC; } } }; this.aL = function (cr) { var V = bC.getHandler('propertyChanged'); if (V) { V(this, new IPCC.qP(cr)); } }; this.aJL = function (CO) { if (IPCC.Web.UI.Thumbnailcounter === undefined || IPCC.Web.UI.Thumbnailcounter === null) { IPCC.Web.UI.Thumbnailcounter = 1; } var fg = CO + '_' + IPCC.Web.UI.Thumbnailcounter.toString(); IPCC.Web.UI.Thumbnailcounter++; return fg; }; this.aIR = function (avU) { var fg = avU + '_' + '_tViewId'; return fg; }; this.ZK = function () { if (sM === undefined || sM === null) { sM = 1; } var fg = (this.gx().id.toString()) + '_' + sM.toString(); sM++; return fg; }; this.aaK = function (eo) { if (IPCC.Web.nr.length > 0) { if (Array.prototype.indexOf) { if (IPCC.Web.nr.indexOf(eo) >= 0) { return true; } } else { if (IPCC.Web.nr.aKb(eo) >= 0) { return true; } } } }; function DX() { for (var ar = 0; ar < aA.length; ar++) { if (aA[ar]) { if (aA[ar].gH) { aA[ar].gH = false; if (aA[ar].bd) { aA[ar].bd.set_selected(false); for (var eT = 0; eT < jj.get_length() ; eT++) { if (jj.getPage(eT) === aA[ar].bd) { jj.removePage(eT); } } } if (mP === true) { document.getElementById(aA[ar].gu).style.backgroundColor = wh; } else { document.getElementById(aA[ar].gu).className = 'imGearTNItem'; } } } } }; function rn(Pj, bk, bv) { if (bv) { if (bv.bd) { if (Pj === true) { if (bk) { bk.className = 'imGearTNSelected'; } bv.bd.set_selected(true); bv.gH = true; } else { if (bk) { bk.className = 'imGearTNItem'; } bv.bd.set_selected(false); bv.gH = false; } } } }; function sx(Pj, bk, bv) { if (bv) { if (bv.bd) { if (Pj === true) { if (bk) { bk.style.backgroundColor = VE; } bv.bd.set_selected(true); bv.gH = true; } else { if (bk) { bk.style.backgroundColor = wh; } bv.bd.set_selected(false); bv.gH = false; } } } }; function akJ(Pj, bk, bv, oJ) { if (mP === true) { if (K.get_selectionMode() === IPCC.Web.UI.ImGearThumbnailSelectionMode.Single) { if (oJ) { document.getElementById(oJ.gu).style.backgroundColor = wh; } sx(true, bk, bv); jj.removeAllPages(); } else if (K.get_selectionMode() === IPCC.Web.UI.ImGearThumbnailSelectionMode.Multiple) { sx(false, bk, bv); } } else { if (K.get_selectionMode() === IPCC.Web.UI.ImGearThumbnailSelectionMode.Single) { if (oJ) { document.getElementById(oJ.gu).className = 'imGearTNItem'; } rn(true, bk, bv); jj.removeAllPages(); } else if (K.get_selectionMode() === IPCC.Web.UI.ImGearThumbnailSelectionMode.Multiple) { rn(true, bk, bv); } } }; var gE = 0; var aqi = 1; var aqj = 50; function Yi() { Tn(); }; function Tn() { var G, lq, cu, qT, AX; var qF, qd, agS, aec; var Uq, VL, apI, anx; var Bf = []; var Tj, abU, SL, abo; if (nB === '') { return; } qF = nB.scrollTop; qd = nB.scrollLeft; agS = qF + nB.clientHeight; aec = qd + nB.clientWidth; for (G = 0; G < aA.length; G++) { lq = aA[G]; if (lq && lq.mF) { cu = document.getElementById(lq.gu); Uq = cu.offsetTop; VL = cu.offsetLeft; apI = Uq + cu.offsetHeight; anx = VL + cu.offsetWidth; Tj = qF - apI; abU = qd - anx; SL = Uq - agS; abo = VL - aec; if (Tj >= 0) { Bf.push({ lq: lq, abb: true, oE: Tj }); } else if (SL < 0 && abU >= 0) { Bf.push({ lq: lq, abb: true, oE: abU }); } else if (SL >= 0) { Bf.push({ lq: lq, abb: false, oE: SL }); } else if (Tj < 0 && abo >= 0) { Bf.push({ lq: lq, abb: false, oE: abo }); } else { qT = document.getElementById(lq.mF); if (qT) { AX = qT.bB; AX.zY(0); } } } } Bf.sort(function (a, b) { return a.oE - b.oE; }); for (G = 0; G < Bf.length; G++) { lq = Bf[G].lq; qT = document.getElementById(lq.mF); if (qT) { AX = qT.bB; if (AX) { if (G < aqi) { AX.zY(0); } else if (G < aqj) { AX.zY(1); } else { AX.zY(2); } } } } }; function ER(sender, eventArgs) { if (eventArgs) { if (eventArgs.domEvent.button !== 0) { return; } } else if (sender.button !== 0) { return; } var ya; var Qt = ""; var bk, ar; if (sender.id && sender.id !== null) { ya = sender.id.split('_'); if (ya !== undefined) { if (K.gx().id === ya[0]) { Qt = sender.id; bk = sender; } } } else { if (sender.target) { if (sender.target.tagName === "DIV") { if (sender.target.firstChild !== null) { if (sender.target.firstChild.tagName === "DIV") { bk = sender.target; } } } if (!bk) { if (sender.target.parentNode) { if (sender.target.parentNode.id !== undefined && sender.target.parentNode.id !== "") { ya = sender.target.parentNode.id.split('_'); if (ya !== undefined) { if (K.gx().id === ya[0]) { Qt = sender.target.parentNode.id; bk = sender.target.parentNode; } else { return; } } else { return; } } else { if (sender.target.parentNode.parentNode) { if (sender.target.parentNode.parentNode.id !== undefined && sender.target.parentNode.parentNode.id !== "") { ya = sender.target.parentNode.parentNode.id.split('_'); if (ya !== undefined) { if (K.gx().id === ya[0]) { Qt = sender.target.parentNode.parentNode.id; bk = sender.target.parentNode.parentNode; } else { return; } } else { return; } } } } } } } else { var aju = sender.gx(); Qt = aju.parentNode.id; bk = aju.parentNode; } } var oJ; if (K.get_selectionMode() === IPCC.Web.UI.ImGearThumbnailSelectionMode.Single) { for (ar = 0; ar < aA.length; ar++) { if (aA[ar].gH === true) { if (aA[ar].bd) { aA[ar].bd.set_selected(false); } if (mP === true) { document.getElementById(aA[ar].gu).style.backgroundColor = wh; } else { document.getElementById(aA[ar].gu).className = 'imGearTNItem'; } aA[ar].gH = false; oJ = aA[ar]; break; } } } if (bk !== undefined) { var wc; var jh; var amU = false; for (ar = 0; ar < aA.length; ar++) { wc = undefined; if (aA[ar].bd) { wc = document.getElementById(aA[ar].gu); if (wc === bk) { amU = true; jh = aA[ar]; break; } } } if (amU === true) { if (K.get_selectionMode() === IPCC.Web.UI.ImGearThumbnailSelectionMode.Multiple) { if (eventArgs) { if (eventArgs.domEvent.ctrlKey === false) { DX(); } } else if (sender.ctrlKey) { if (sender.ctrlKey === false) { DX(); } } else { DX(); } } if (mP === true) { if (K.get_selectionMode() === IPCC.Web.UI.ImGearThumbnailSelectionMode.Single) { if (oJ) { document.getElementById(oJ.gu).style.backgroundColor = wh; } sx(true, bk, jh); jj.removeAllPages(); } else if (K.get_selectionMode() === IPCC.Web.UI.ImGearThumbnailSelectionMode.Multiple) { if (eventArgs) { if (eventArgs.domEvent.ctrlKey === true) { if (jh.gH === true) { sx(false, bk, jh); } else { sx(true, bk, jh); } } else { sx(true, bk, jh); } } else if (sender.ctrlKey) { if (sender.ctrlKey === true) { if (jh.gH === true) { sx(false, bk, jh); } else { sx(true, bk, jh); } } else { sx(true, bk, jh); } } else { sx(true, bk, jh); } } } else { if (K.get_selectionMode() === IPCC.Web.UI.ImGearThumbnailSelectionMode.Single) { if (oJ) { document.getElementById(oJ.gu).className = 'imGearTNItem'; } rn(true, bk, jh); jj.removeAllPages(); } else if (K.get_selectionMode() === IPCC.Web.UI.ImGearThumbnailSelectionMode.Multiple) { if (eventArgs) { if (eventArgs.domEvent.ctrlKey === true) { if (jh.gH === true) { rn(false, bk, jh); } else { rn(true, bk, jh); } } else { rn(true, bk, jh); } } else if (sender.ctrlKey) { if (sender.ctrlKey === true) { if (jh.gH === true) { rn(false, bk, jh); } else { rn(true, bk, jh); } } else { rn(true, bk, jh); } } else { rn(true, bk, jh); } } } qt(); CU(jh); } } }; function avY(aJP, rS, auW) { function V(sender, evnt) { ER(sender, evnt); }; IPCC.Web.UI.al.addHandler(auW, "mouseDown", V); rS.add_mouseDown(V); }; function aiM(rS, vK) { function aFL(sender, evnt) { ayt(vK); K.scrollToSelectedThumbnail(); Tn(); vK.bd.FX(rS.get_pageWidth()); vK.bd.FM(rS.get_pageHeight()); }; rS.add_pageOpened(aFL); }; function KT(rS, vK) { function Yf(sender, evnt) { var cO = evnt.pageNumber; var CO = evnt.documentIdentifier; function ahJ(cO) { var eD = K.jS.getDocument(0).eD; if (!eD) { setTimeout(function () { ahJ(cO); }, 2000); return; } XM++; if (XM === 1) { if (eD < 30) { Bb = Math.floor((eD) / 3) + 1; } else { Bb = 10; } } function agj() { var bp = Ib; var alu = Bb; Ib += Bb; if (Ib + Bb > eD) { Bb = eD - Ib; } setTimeout(function () { K.jS.getDocument(0).Mp(bp, bp + alu - 1, bp + alu); }, 50); }; if (XM === Ib + Bb) { if (Ib === 0) { if (K.jS.getDocument(0).acq() === true) { ajL = true; } else { K.jS.getDocument(0).aGq(true); agj(); } } else { agj(); } } }; if (ajL === false) { ahJ(cO); } vK.bd.FX(rS.get_pageWidth()); vK.bd.FM(rS.get_pageHeight()); for (var ar = 0; ar < aA.length; ar++) { if (aA[ar].bd.get_pageNumber() === cO && aA[ar].bd.bE.get_documentIdentifier() === CO) { aA[ar].iT = false; aA[ar].kw = true; var cf; if (aA[ar].ht === false) { if (aA[ar].mF) { cf = document.getElementById(aA[ar].mF).bB; } if (cf) { cf.display(); aA[ar].ht = true; } } if (gE > 0) { gE = gE - 1; } break; } } Tn(); if (gE === 0) { setTimeout(function () { mJ(); }, 60); } }; rS.add_pageOpened(Yf); if (gE === 0 && aA.length > 1) { if (gE === 0) { setTimeout(function () { mJ(); }, 100); } } }; function mJ() { var Hy; var bj = asr(); if (bj > 0) { Hy = bj; } else { Hy = arE(0); } if (Hy && Hy > 0) { if (Hy < aA.length) { axe(aA[Hy]); } } }; function arE(mY) { var abd; for (var eT = mY; eT < aA.length; eT++) { if (aA[eT].iT === false) { if (aA[eT].kw === false) { abd = eT; break; } } } if (abd) { return abd; } else { return -1; } }; function asr() { var ahU = document.getElementById(vQ); var bv = aA[0]; var bL = document.getElementById(bv.gu); var NP; if (aA.length > 1) { var aqy = aA[1]; var auq = document.getElementById(aqy.gu); NP = auq.offsetHeight + (bL.offsetTop * 2); } else { NP = bL.clientHeight + bL.clientTop + (bL.offsetTop * 2); } var Xv; if (NP > 0) { var yf = Math.ceil(ahU.offsetHeight / NP); var Eq = Math.ceil(ahU.scrollTop / NP); var WY = Eq + yf + 2; Eq = Eq - 1; if (Eq < 0) { Eq = 0; } if (WY >= aA.length) { WY = aA.length - 1; } for (var ar = Eq; ar <= WY; ar++) { if (aA[ar].iT === false) { if (aA[ar].kw === false) { Xv = ar; break; } } } } if (Xv) { return Xv; } else { return (-1); } }; function LU(rS, vK) { function aGb(sender, evnt) { K.aM('pageAddFailed', evnt); }; rS.add_pageOpenFailed(aGb); }; function eK(la) { var uO = document.createElement('div'); var G; for (G in la) { if (la.hasOwnProperty(G)) { uO.style[G] = la[G]; } } return uO; }; function ajW() { var ET = K.gx().id; var bg = document.getElementById(ET); var Rm; if (kF === '') { nB = eK({ width: bg.clientWidth + 'px', height: bg.clientHeight + 'px', position: 'relative', margin: '0px', border: '1px solid #000000', overflow: 'auto' }); if (mP === true) { if (sX === IPCC.Web.UI.ImGearThumbnailLayout.HorizontalScrollDirection) { Rm = wT; kF = eK({ width: Rm + 'px', margin: '4px' }); nB.style.overflowY = 'hidden'; K.uS = 1; if (Rm > 0) { K.Ho = bg.clientWidth / Rm; } } else { kF = eK({ width: bg.clientWidth + 'px', height: bg.clientHeight + 'px', position: 'relative', margin: '4px' }); nB.style.overflowX = 'hidden'; K.uS = 1; if (wT > 0) { K.Ho = bg.clientWidth / wT; } K.uS = bg.clientHeight / Fz; } } else { kF = eK({ width: bg.clientWidth + 'px', height: bg.clientHeight + 'px', position: 'relative', margin: '4px' }); if (sX === IPCC.Web.UI.ImGearThumbnailLayout.HorizontalScrollDirection) { nB.style.overflowY = 'hidden'; } else { nB.style.overflowX = 'hidden'; } } nB.onscroll = Yi; kF.setAttribute('id', ET + '_ListContainer'); nB.setAttribute('id', ET + '_ListWrapper'); vQ = ET + '_ListWrapper'; nB.appendChild(kF); bg.appendChild(nB); } }; function Mx(bI) { var yY; var alq = ''; var mZ = ''; var yx = ''; var yl = ""; var G; if (zl !== "") { if (zl.indexOf('{') !== -1) { yY = zl.split('{'); if (yY.length > 0) { for (G = 0; G < yY.length; G++) { mZ = ''; yx = yY[G]; yl = ""; if (yY[G].indexOf('DC') !== -1) { mZ = bI.bE.get_caption(); if (mZ !== undefined) { yl = yx.replace(/DC\}/, bI.bE.get_caption()); } else { mZ = bI.bE.get_documentIdentifier(); yl = yx.replace(/DC\}/, bI.bE.get_documentIdentifier()); } } else if (yY[G].indexOf('PC') !== -1) { mZ = bI.get_caption(); if (mZ !== undefined && mZ !== "" && mZ !== null) { yl = yx.replace(/PC\}/, bI.get_caption()); } else { yl = yx.replace(/PC\}/, 'Page'); } } else if (yY[G].indexOf('P#') !== -1) { var GV = bI.bE.get_pages(); var ar = GV.aGd(bI); var eU = ar; if (typeof (eU) === 'number') { mZ = (ar + 1).toString(); } else if (eU) { var eo = parseInt(eU, 10); eo++; mZ = eo.toString(); } if (mZ !== null) { yl = yx.replace(/P#\}/, mZ); } } else if (yY[G].indexOf('PN') !== -1) { mZ = (bI.get_pageNumber() + 1).toString(); if (mZ !== null) { yl = yx.replace(/PN\}/, mZ); } } else if (yY[G].indexOf('PP') !== -1) { mZ = bI.bE.get_pages().get_length().toString(); if (mZ !== null) { yl = yx.replace(/PP\}/, mZ); } } alq += yl; } } } } return alq; }; function ajc(bo) { var bI = bo; var ahe = bI.get_pageNumber(); var cu; var qT; var bg = document.getElementById(K.gx().id); var bY = null; var sT; var zi = []; var G = 0; var aj = 0; var dg = K.get_documents().get_length(); for (aj = 0; aj < dg; aj++) { bY = K.get_documents().getDocument(aj); if (bY !== null) { sT = bY.st; if (sT === bI.bE.st) { break; } } } for (var eT = 0; eT < aA.length; eT++) { if (aA[eT].bE) { bY = aA[eT].bE; if (eT === 0) { zi[G] = bY; G++; continue; } else if (aA[eT - 1].bE !== bY) { zi[G] = bY; G++; continue; } } } for (eT = aA.length - 1; eT >= 0; eT--) { if (aA[eT].bd) { if (aA[eT].bd === bI) { return; } } } var Hn = true; var jr; var wv; var eE; var CD; for (eT = 0; eT < aA.length; eT++) { jr = aA[eT]; if (jr.xV === 1) { if (bI.bE.st === jr.DW) { cu = document.getElementById(jr.gu); jr.xV = 0; wv = jr.gu; Hn = false; eE = jr; break; } } } var nm = false; for (eT = aA.length - 1; eT >= 0; eT--) { if (aA[eT].bd) { if (aA[eT].bd.bE === bI.bE) { nm = true; break; } } } if (kF === '') { ajW(); } if (mP === false) { if (Hn) { cu = document.createElement('div'); cu.className = 'imGearTNItem'; cu.style.styleFloat = 'left'; } CD = document.createElement('div'); CD.className = 'imGearTNItemCaption'; } if (mP === true) { if (Hn) { cu = cu = eK({ width: wT + 'px', height: Fz + 'px', styleFloat: 'left', overflow: 'hidden', border: Ub + 'px solid ' + Sm, marginRight: zw + 'px', marginTop: SI + 'px' }); cu.style.cssFloat = 'left'; cu.style.backgroundColor = wh; } CD = eK({ width: wT + 'px', height: '30px', overflow: 'hidden', padding: '1px', position: 'relative', margin: '2px' }); } if (Hn === true) { wv = bI.bE.st + '_' + IPCC.Web.UI.Thumbnailcounter.toString(); IPCC.Web.UI.Thumbnailcounter++; cu.setAttribute('id', wv); } var OE = wv + '_' + '_tViewId'; if (mP === false) { qT = document.createElement('div'); qT.className = 'imGearTNImage'; } else { qT = eK({ width: (wT - 4) + 'px', height: (Fz - 40) + 'px', overflow: 'hidden', padding: '1px' }); } qT.setAttribute('id', OE); var adr = document.createElement("p"); if (mP === true) { adr.style.cssText = "font-family:arial,sans-serif;font-size:10pt;text-align: center;color:#000099;"; } var qe = ""; if (zl !== undefined && zl !== null && zl !== "") { qe = Mx(bI); adr.innerHTML = qe; CD.appendChild(adr); } IPCC.Web.UI.al.addHandler(CD, "mousedown", ER); IPCC.Web.UI.al.addHandler(cu, "mousedown", ER); cu.appendChild(CD); cu.appendChild(qT); if (Hn === true) { eE = new IPCC.Web.UI.lq({ page: bI }); } bI.gu = wv; eE.mF = OE; eE.gu = wv; eE.bd = bI; eE.DW = sT; eE.gH = false; eE.ht = false; eE.Am = CD; eE.aX = undefined; eE.EC = false; eE.bE = bI.bE; eE.kw = false; eE.cO = ahe; var akj; var ck; if (Hn) { if (aA.length === 0) { kF.appendChild(cu); aA.push(eE); } else { for (eT = 0; eT < aA.length; eT++) { jr = aA[eT]; if (jr.DW === sT) { if (jr.bd) { var atV = jr.bd.get_pageNumber(); if (ahe < atV) { aA.splice(eT, 0, eE); ck = document.getElementById(jr.gu); kF.insertBefore(cu, ck); akj = true; break; } } } } if (!akj) { kF.appendChild(cu); aA.push(eE); } } } var OX = false; if (sX === IPCC.Web.UI.ImGearThumbnailLayout.HorizontalScrollDirection) { var rK = cu.clientWidth * (aA.length + 1); if (mP === true) { rK = cu.clientWidth * (aA.length + 1); rK += ((2 * zw) * (aA.length + 1)); kF.style.width = rK + 'px'; kF.style.height = (cu.clientHeight + (2 * zw)) + 'px'; } else { rK = cu.clientWidth * (aA.length + 1); kF.style.width = rK + 'px'; kF.style.height = cu.clientHeight + 'px'; if (K.uS === 0) { if (cu.clientWidth > 0) { K.uS = bg.width / cu.clientWidth; } } if (this.Ho === 0) { if (cu.clientHeight > 0) { K.uS = bg.height / cu.clientHeight; } } } if ((bg.clientWidth + (cu.clientWidth * 4)) > rK) { OX = true; } } else { if (bg.clientWidth > 0) { var Go = bg.clientWidth / (cu.clientWidth + (cu.clientLeft * 2)); var yf = bg.clientHeight / (cu.clientHeight + (cu.clientTop * 2)); K.uS = yf; K.Ho = Go; if (aA.length < (Go * yf)) { OX = true; } } } var jy; jy = new IPCC.Web.UI.ThumbnailView(document.getElementById(OE)); if (jy) { jy.rc(document.getElementById(OE)); jy.iA(K.eG()); jy.initialize(); jy.set_imageHandlerUrl(bI.bE.np); jy.set_selected(false); jy.set_pageViewClientID(yo); if (K.ou()) { jy.tw(true); } } if (jy) { if (lT) { jy.set_resourcePath(lT); } LU(jy, eE); jy.iA(K.eG()); var qu = jy.aEQ(); if (!qu) { qu = new IPCC.Web.UI.PageViewState(); } qu.viewFitType = Wj; qu.viewRotationDegreesClockwise = Xk; qu.viewZoomFactor = XI; qu.encryption = K.eG(); jy.aGO(qu); } var aBa = K.get_artServiceOption(); avY(ER, jy, cu); var Ng = jj.get_length(); if (Ng > 0) { for (G = 0; G < Ng; G++) { for (eT = 0; eT < aA.length; eT++) { jr = aA[eT]; if (jr.bd) { if (jr.bd.bE.get_documentIdentifier() === jj.getPage(G).bE.get_documentIdentifier()) { if (jj.getPage(G).get_pageNumber === bI.get_pageNumber()) { aiM(jy, eE); break; } } } } } } else { if (bI.get_selected()) { aiM(jy, eE); } } KT(jy, eE); if (aA.length < 2) { jy.iA(K.eG()); jy.openPage({ encodedDocumentIdentifier: bI.bE.get_encodedDocumentIdentifier(), pageNumber: bI.get_pageNumber(), artServiceOption: aBa, imGearPage: bI }); eE.iT = true; gE++; } var GV = bI.bE.get_pages(); if (GV.get_length() > 1) { for (var hD = 0; hD < aA.length; hD++) { var dV = aA[hD]; if (dV.bd) { if (bI.bE === dV.bd.bE) { qe = Mx(dV.bd); var da = dV.Am.firstChild; if (!da.igPreviousCaption || da.igPreviousCaption !== qe) { da.innerHTML = qe; da.igPreviousCaption = qe; } } } } } qT.bB = jy; return cu; }; function avv(ajw) { var wv = ajw.st + '_' + IPCC.Web.UI.Thumbnailcounter.toString(); IPCC.Web.UI.Thumbnailcounter++; var cu; var bY; var zi = []; var ET = K.gx().id; var bg = document.getElementById(ET); var sT, aj; var dg = K.get_documents().get_length(); for (aj = 0; aj < dg; aj++) { bY = K.get_documents().getDocument(aj); if (bY) { sT = bY.st; if (sT === ajw.st) { break; } } } var G = 0; for (var eT = 0; eT < aA.length; eT++) { if (aA[eT].bE) { bY = aA[eT].bE; if (eT === 0) { zi[G] = bY; G++; continue; } else if (aA[eT - 1].bE !== bY) { zi[G] = bY; G++; continue; } } } if (kF === '') { ajW(); } if (mP === false) { cu = document.createElement('div'); cu.className = 'imGearTNItem'; cu.style.styleFloat = 'left'; } else if (mP === true) { cu = cu = eK({ width: wT + 'px', height: Fz + 'px', styleFloat: 'left', overflow: 'hidden', border: Ub + 'px solid ' + Sm, marginRight: zw + 'px', marginTop: SI + 'px' }); cu.style.cssFloat = 'left'; cu.style.backgroundColor = wh; } cu.setAttribute('id', wv); var eE = new IPCC.Web.UI.lq(); eE.gu = wv; eE.DW = sT; eE.gH = false; eE.ht = false; eE.aX = undefined; eE.EC = false; eE.xV = 1; eE.bE = bY; eE.kw = false; var acj; dg = K.get_documents().get_length(); for (aj = 0; aj < dg; aj++) { bY = K.get_documents().getDocument(aj); if (zi[aj]) { if (bY === zi[aj]) { continue; } else { if (aj + 1 < dg) { var avO = K.get_documents().getDocument(aj + 1); if (avO === zi[aj]) { acj = aj; break; } } } } } if (acj) { var pg = 0; for (G = 0; G < acj; G++) { if (K.get_documents().getDocument(G).get_pages()) { pg += K.get_documents().getDocument(G).get_pages().get_length(); } } var arp = aA[pg]; var ck = document.getElementById(arp.gu); kF.insertBefore(cu, ck); aA.splice(pg, 0, eE); } else { kF.appendChild(cu); aA.push(eE); } if (sX === IPCC.Web.UI.ImGearThumbnailLayout.HorizontalScrollDirection) { var rK = cu.clientWidth * (aA.length + 1); if (mP === true) { rK = cu.clientWidth * (aA.length + 1); rK += ((2 * zw) * (aA.length + 1)); kF.style.width = rK + 'px'; kF.style.height = (cu.clientHeight + (2 * zw)) + 'px'; } else { rK = cu.clientWidth * (aA.length + 1); kF.style.width = rK + 'px'; kF.style.height = cu.clientHeight + 'px'; if (this.uS === 0) { if (cu.clientWidth > 0) { K.uS = bg.width / cu.clientWidth; } } if (K.Ho === 0) { if (cu.clientHeight > 0) { K.uS = bg.height / cu.clientHeight; } } } } else { if (bg.clientWidth > 0) { var Go = bg.clientWidth / (cu.clientWidth + (cu.clientLeft * 2)); var yf = bg.clientHeight / (cu.clientHeight + (cu.clientTop * 2)); K.uS = yf; K.Ho = Go; } } return cu; }; function LP(aB, L) { var bI = L.imGearPage; ajc(bI); }; function azb(bo) { var bI = bo.imGearPage; var cf; var wc, ar; for (ar = 0; ar < aA.length; ar++) { wc = undefined; if (aA[ar].bd) { if (aA[ar].bd === bI) { wc = document.getElementById(aA[ar].gu); if (wc) { if (aA[ar].ht === true) { cf = document.getElementById(aA[ar].mF).bB; if (cf.get_selected()) { cf.set_selected(false); if (K.get_pageViewClientId()) { var pgView = document.getElementById(K.get_pageViewClientId()).bB; pgView.closePage(); } } cf.remove_mouseDown(ER); if (cf.get_currentState().documentIdentifier) { cf.dispose(); } aA[ar].ht = false; } if (aA[ar].Am) { IPCC.Web.UI.al.removeHandler(wc.Am, "mousedown", ER); } wc.style.display = 'none'; aA.splice(ar, 1); var GV = bI.bE.get_pages(); if (GV.get_length() >= 1) { for (var hD = 0; hD < aA.length; hD++) { var dV = aA[hD]; if (bI.bE === dV.bd.bE) { if (dV.bd) { var qe = Mx(dV.bd); dV.Am.firstChild.innerHTML = qe; } } } } break; } } } } }; function KQ(aB, L) { azb(L); }; function BJ(aB, L) { if (L) { for (var hD = 0; hD < aA.length; hD++) { var dV = aA[hD]; if (L.imGearPage === dV.bd) { if (dV.bd) { var oJ; if (K.get_selectionMode() === IPCC.Web.UI.ImGearThumbnailSelectionMode.Single) { for (var ar = 0; ar < aA.length; ar++) { if (aA[ar].gH === true) { if (aA[ar].bd) { aA[ar].bd.set_selected(false); } aA[ar].gH = false; oJ = aA[ar]; break; } } } var qe = Mx(dV.bd); dV.Am.firstChild.innerHTML = qe; var cf; var bk = document.getElementById(dV.gu); if (dV.bd.get_selected() && !dV.gH) { cf = document.getElementById(dV.mF).bB; if (cf) { cf.set_imGearPage(dV.bd); cf.set_selected(true); K.aM('pageSelectionChanged', {}); akJ(true, bk, dV, oJ); } } else if (!dV.bd.get_selected() && dV.gH) { cf = document.getElementById(dV.mF).bB; if (cf) { cf.set_selected(false); K.aM('pageSelectionChanged', {}); akJ(false, bk, dV, oJ); } } break; } } } } }; function axk(aB, L) { if (L) { if (L.propertyName === 'caption') { for (var hD = 0; hD < aA.length; hD++) { var dV = aA[hD]; if (dV.bd) { if (dV.bd.bE) { if (L.imGearDocument) { if (L.imGearDocument === dV.bd.bE) { var qe = Mx(dV.bd); dV.Am.firstChild.innerHTML = qe; } } } } } } } }; function JA(bo) { if (K.QX() === false) { return null; } if ((yo !== null) && (yo !== '')) { sP = document.getElementById(yo).bB; } var bY = bo.imGearDocument; var adn = K.ZK(); bY.st = adn; if (bY.get_includeAllPages() === false) { var dP = bY.get_pages(); var dg = dP.get_length(); if (dg > 0) { for (var ar = 0; ar < dg; ar++) { if (!dP.getPage(ar).bE) { dP.getPage(ar).bE = bY; } } dP.forEach(ajc); } } else { avv(bY); } }; function ZO(aB, L) { JA(L); }; function CU(Vu) { var ar, bk; for (ar = 0; ar < aA.length; ar++) { if (aA[ar] === Vu) { bk = document.getElementById(aA[ar].gu); if (mP === true) { sx(true, bk, aA[ar]); } else { rn(true, bk, aA[ar]); } if (K.get_selectionMode() === IPCC.Web.UI.ImGearThumbnailSelectionMode.Single) { var cf; if (K.get_pageViewClientId()) { cf = document.getElementById(aA[ar].mF).bB; if (aA[ar].kw === false || jj.get_length() === 0) { if (K.get_artServiceOption() === IPCC.Web.UI.ImGearArtDataServices.ArtDataService) { if (aA[ar].bd) { if (aA[ar].EC === true) { if (aA[ar].aX) { cf.openPage({ encodedDocumentIdentifier: aA[ar].bd.bE.get_encodedDocumentIdentifier(), pageNumber: aA[ar].bd.get_pageNumber(), artPage: aA[ar].aX, imGearPage: aA[ar].bd }); } } else { cf.openPage({ encodedDocumentIdentifier: aA[ar].bd.bE.get_encodedDocumentIdentifier(), pageNumber: aA[ar].bd.get_pageNumber(), imageServiceOption: K.get_artServiceOption(), imGearPage: aA[ar].bd }); } } } else { if (aA[ar].iT === false) { if (aA[ar].kw === false) { aA[ar].aX = cf.get_artPage(); if (aA[ar].bd) { if (aA[ar].aX) { cf.openPage({ encodedDocumentIdentifier: aA[ar].bd.bE.get_encodedDocumentIdentifier(), pageNumber: aA[ar].bd.get_pageNumber(), artPage: aA[ar].aX, imGearPage: aA[ar].bd }); aA[ar].iT = true; gE++; } else { cf.openPage({ encodedDocumentIdentifier: aA[ar].bd.bE.get_encodedDocumentIdentifier(), pageNumber: aA[ar].bd.get_pageNumber(), imGearPage: aA[ar].bd }); aA[ar].iT = true; gE++; } } } } } } if (cf) { cf.set_selected(true); K.aM('pageSelectionChanged', {}); } } if (aA[ar].bd) { if (jj.get_length() > 0) { jj.removeAllPages(); } } } if (aA[ar].bd) { jj.addPage(aA[ar].bd); } break; } } qt(); }; function axe(bv) { var bk; var cf; if (gE > 0) { if (bv.mF) { cf = document.getElementById(bv.mF).bB; } if (cf) { cf.display(); bv.ht = true; } return; } bk = document.getElementById(bv.gu); cf = document.getElementById(bv.mF).bB; if (bv.kw === false) { if (K.get_artServiceOption() === IPCC.Web.UI.ImGearArtDataServices.ArtDataService) { if (bv.bd) { if (bv.EC === true) { if (bv.aX) { cf.openPage({ encodedDocumentIdentifier: bv.bd.bE.get_encodedDocumentIdentifier(), pageNumber: bv.bd.get_pageNumber(), artPage: bv.aX, imaGearPage: bv.bd }); } } else { cf.openPage({ encodedDocumentIdentifier: bv.bd.bE.get_encodedDocumentIdentifier(), pageNumber: bv.bd.get_pageNumber(), imageServiceOption: K.get_artServiceOption(), imaGearPage: bv.bd }); } bv.iT = true; gE++; } } else { bv.aX = cf.get_artPage(); if (bv.bd) { if (bv.aX) { cf.openPage({ encodedDocumentIdentifier: bv.bd.bE.get_encodedDocumentIdentifier(), pageNumber: bv.bd.get_pageNumber(), artPage: bv.aX, imaGearPage: bv.bd }); } else { cf.openPage({ encodedDocumentIdentifier: bv.bd.bE.get_encodedDocumentIdentifier(), pageNumber: bv.bd.get_pageNumber(), imaGearPage: bv.bd }); } bv.iT = true; gE++; } } } qt(); }; function ayt(Vu) { var ar, bk; var bv; for (ar = 0; ar < aA.length; ar++) { bv = aA[ar]; if (bv === Vu) { bk = document.getElementById(bv.gu); if (mP === true) { sx(true, bk, bv); } else { rn(true, bk, bv); } if (K.get_selectionMode() === IPCC.Web.UI.ImGearThumbnailSelectionMode.Single) { var cf; if (K.get_pageViewClientId()) { cf = document.getElementById(bv.mF).bB; if (cf) { cf.set_selected(true); } } if (bv.bd) { if (jj.get_length() > 0) { jj.removeAllPages(); } } } if (bv.bd) { jj.addPage(bv.bd); bv.gH = true; } break; } } qt(); }; this.cn = function () { var ar, bk; var jr = aA[0]; if (jr && jr.bd) { var dP = jr.bd.bE.get_pages(); var ahT = dP.get_length(); var dg = 10; if (ahT < 10) { dg = ahT; } if (aA.length > 10 && dg > 10) { dg = 9; } dg = aA.length; for (ar = 0; ar < dg; ar++) { if (aA[ar].bd) { bk = document.getElementById(aA[ar].gu); var cf; cf = document.getElementById(aA[ar].mF).bB; if (aA[ar].ht === false) { if (K.get_artServiceOption() === IPCC.Web.UI.ImGearArtDataServices.ArtDataService) { if (aA[ar].EC === true) { if (aA[ar].aX) { if (aA[ar].kw === false) { cf.openPage({ encodedDocumentIdentifier: aA[ar].bd.bE.get_encodedDocumentIdentifier(), pageNumber: aA[ar].bd.get_pageNumber(), artPage: aA[ar].aX, imaGearPage: aA[ar].bd }); gE++; aA[ar].iT = true; } } } else { if (aA[ar].kw === false) { cf.openPage({ encodedDocumentIdentifier: aA[ar].bd.bE.get_encodedDocumentIdentifier(), pageNumber: aA[ar].bd.get_pageNumber(), imageServiceOption: K.get_artServiceOption(), imaGearPage: aA[ar].bd }); gE++; aA[ar].iT = true; } } } else { if (aA[ar].imageDataRequested === false) { if (aA[ar].kw === false) { if (gE === 0) { cf.openPage({ encodedDocumentIdentifier: aA[ar].bd.bE.get_encodedDocumentIdentifier(), pageNumber: aA[ar].bd.get_pageNumber(), imaGearPage: aA[ar].bd }); aA[ar].iT = true; } } } } } if (cf) { cf.display(); if (aA[ar].gH === true) { cf.set_selected(true); } } } } Tn(); } }; this.azO = function () { var bv = aA[0]; DX(); CU(bv); }; this.azr = function () { var bv = aA[aA.length - 1]; DX(); CU(bv); }; this.aAf = function () { var bv; var fV; for (var ar = 0; ar < aA.length; ar++) { fV = aA[ar]; if (fV.gH === true) { bv = fV; break; } } if (!bv) { bv = aA[0]; } else { if (ar <= aA.length - 1 && ar > 0) { ar--; bv = aA[ar]; DX(); CU(bv); } } }; this.aAC = function () { var bv; var jc; var ar = aA.length - 1; for (ar; ar >= 0; ar--) { jc = aA[ar]; if (jc.gH === true) { bv = jc; break; } } if (!bv) { bv = aA[0]; } else { if (ar <= aA.length - 2 && ar >= 0) { ar++; bv = aA[ar]; DX(); CU(bv); } } }; this.aAJ = function () { var ck = document.getElementById(vQ); if (sX === IPCC.Web.UI.ImGearThumbnailLayout.HorizontalScrollDirection) { ck.scrollLeft = 0; } else { ck.scrollTop = 0; } }; this.aAH = function () { var ck = document.getElementById(vQ); if (sX === IPCC.Web.UI.ImGearThumbnailLayout.HorizontalScrollDirection) { ck.scrollLeft = ck.scrollWidth; } else { ck.scrollTop = ck.scrollHeight; } }; this.aAq = function () { var bv; var fV; var ar; for (ar = 0; ar < aA.length; ar++) { fV = aA[ar]; if (fV.gH === true) { bv = fV; if (bv.kw === false) { CU(bv); } break; } } var aqs; var aym; var bL; var ck = document.getElementById(vQ); if (!bv) { return; } if (bv.gu) { if (sX === IPCC.Web.UI.ImGearThumbnailLayout.HorizontalScrollDirection) { aqs = ck.scrollWidth; bL = document.getElementById(bv.gu); aym = ar * bL.clientWidth; ck.scrollLeft = bL.offsetLeft; } else { aqs = ck.scrollHeight; bL = document.getElementById(bv.gu); ck.scrollTop = bL.offsetTop; } } }; this.azu = function () { var bv = aA[0]; var bL = document.getElementById(bv.gu); var ck = document.getElementById(vQ); var pP; if (sX === IPCC.Web.UI.ImGearThumbnailLayout.HorizontalScrollDirection) { pP = ck.scrollLeft + bL.clientWidth + bL.clientLeft; ck.scrollLeft = pP; } else { pP = ck.scrollTop; ck.scrollTop = pP + bL.clientHeight + bL.clientTop; } }; this.aAe = function () { var bv = aA[0]; var bL = document.getElementById(bv.gu); var ck = document.getElementById(vQ); var pP; if (sX === IPCC.Web.UI.ImGearThumbnailLayout.HorizontalScrollDirection) { pP = ck.scrollLeft; pP = pP - (bL.clientWidth + bL.clientLeft); if (pP > 0) { ck.scrollLeft = pP; } else { ck.scrollLeft = 0; } } else { pP = ck.scrollTop - (bL.clientHeight + bL.clientTop); if (pP > 0) { ck.scrollTop = pP; } else { ck.scrollTop = 0; } } }; function aAb(vK) { var cf; cf = document.getElementById(vK.mF).bB; if (cf) { cf.saveArtPage(); } }; this.azK = function (ami) { var bv; for (var ar = 0; ar < aA.length; ar++) { bv = aA[ar]; aAb(bv); } if (ami) { ami(); } }; this.aDX = function () { if (K.jS.get_length() > 0) { K.jS.removeAllDocuments(); } aA = []; }; this.aHR = function () { return np; }; this.aJo = function (F) { IPCC.ad.jt(F, 'value'); np = F; this.aL('imageServicePath'); }; this.KM = function () { return pp; }; this.KP = function (F) { IPCC.ad.jt(F, 'value'); pp = F; }; this.alp = function () { return yo; }; this.aDC = function () { return mP; }; this.aDO = function (F) { mP = F; this.aL('useDefaultStyling'); }; this.aDD = function () { return Sm; }; this.aEP = function (F) { Sm = F; this.aL('thumbnailBorderColor'); }; this.aEv = function () { return Ub; }; this.aFH = function (F) { Ub = F; this.aL('thumbnailBorderWidth'); }; this.Av = function (EK) { if (EK !== IPCC.Web.UI.ImGearArtDataServices.None && EK !== IPCC.Web.UI.ImGearArtDataServices.ArtDataService) { throw new IPCC.Web.UI.ImGearArgumentException('type', 'The value must be a member of the IPCC.Web.UI.ImGearArtDataServices enumeration.'); } NR = EK; }; this.Ak = function () { return NR; }; this.ND = function () { return this.jS; }; this.aKm = function () { return zl; }; this.aDt = function (F) { IPCC.ad.jt(F, 'value'); zl = F; this.aL('thumbnailCaptionFormat'); }; this.alp = function () { return yo; }; this.aHN = function (F) { if (yo !== F) { yo = F; sP = null; this.aL('pageViewClientId'); } }; this.aFs = function () { return sX; }; this.aEm = function (F) { sX = F; this.aL('thumbnailsLayout'); }; this.aFy = function () { return PW; }; this.aDP = function (F) { if (F !== IPCC.Web.UI.ImGearThumbnailSelectionMode.Multiple && F !== IPCC.Web.UI.ImGearThumbnailSelectionMode.Single) { throw new IPCC.Web.UI.ImGearArgumentException('type', 'The value must be a member of the IPCC.Web.UI.ImGearThumbnailSelectionMode enumeration.'); } PW = F; if (PW === IPCC.Web.UI.ImGearThumbnailSelectionMode.Multiple) { jj.aoM = false; } this.aL('selectionMode'); }; this.QX = function () { return ni; }; this.Md = function (F) { ni = F; this.aL('enabled'); }; this.aFS = function () { return wT; }; this.aDe = function (F) { wT = F; this.aL('thumbnailWidth'); }; this.aEy = function () { return Fz; }; this.aDn = function (F) { Fz = F; this.aL('thumbnailHeight'); }; this.aEE = function () { return wh; }; this.aGk = function (F) { wh = F; this.aL('thumbnailBackgroundColor'); }; this.aDv = function () { return VE; }; this.aDV = function (F) { VE = F; this.aL('thumbnailSelectedBackgroundColor'); }; this.aep = function () { return zw; }; this.aDc = function (F) { zw = F; this.aL('xSpacing'); }; this.aIn = function () { return SI; }; this.aDd = function (F) { SI = F; this.aL('ySpacing'); }; this.ave = function () { return aun; }; this.aGF = function () { return jj; }; var lT; this.uR = function (F) { lT = F; }; this.nQ = function () { return lT; }; this.hz = function (abW) { for (var hD = 0; hD < aA.length; hD++) { var dV = aA[hD]; if (abW === dV.bd) { var cf = document.getElementById(dV.mF).bB; if (cf) { return (cf.get_artPage()); } } } return null; }; this.aIm = function (F) { Wj = F; }; this.aGJ = function () { return Wj; }; this.aHk = function (F) { Xk = F; }; this.aFK = function () { return Xk; }; this.aGW = function (F) { XI = F; }; this.aFX = function () { return XI; }; var pA = false; this.ou = function () { return pA; }; this.tw = function (F) { if (pA === F) { return; } pA = F; this.aL('requireRequestsOptimize'); }; var nu = false; this.eG = function () { return nu; }; this.iA = function (F) { if (typeof F !== "boolean") { return; } if (F === nu) { return; } nu = F; }; this.initialize = function () { aCP = this.gx().id; var bg = this.gx(); var G; for (G = bg.childNodes.length - 1; G >= 0; G--) { if (bg.childNodes[G].tagName !== 'INPUT') { bg.removeChild(bg.childNodes[G]); } } this.jS.add_documentAdded(ZO); this.jS.add_pageAdded(LP); this.jS.add_pageRemoved(KQ); this.jS.add_pageChanged(BJ); this.jS.add_documentChanged(axk); this.Md(true); bg.bB = this; }; }; IPCC.Web.UI.ImGearThumbnailList.prototype = { dispose: function () { this.aI('dispose', arguments); this.aDX(); this.Md(false); }, get_debug: function () { try { var ac = this.rC(); this.ah('get_debug', arguments, ac); return ac; } catch (e) { this.bK('get_debug', e); throw e; } }, set_debug: function (value) { try { this.aI('set_debug', arguments); var oD = this.rC(); this.Ck(value); if (!oD) { this.aI('set_debug', arguments); } } catch (e) { this.bK('set_debug', e); throw e; } }, get_debugErrorLevel: function () { try { var ac = this.pm(); this.ah('get_debugErrorLevel', arguments, ac); return ac; } catch (e) { this.bK('get_debugErrorLevel', e); throw e; } }, set_debugErrorLevel: function (value) { try { this.aI('set_debugErrorLevel', arguments); var oD = this.pm(); this.uG(value); if (oD < IPCC.Web.UI.DebugErrorLevel.Development) { this.aI('set_debugErrorLevel', arguments); } } catch (e) { this.bK('set_debugErrorLevel', e); throw e; } }, add_pageSelectionChanged: function (handler) { try { this.ast(handler); } catch (e) { this.bK('add_pageSelectionChanged', e); throw e; } }, remove_pageSelectionChanged: function (handler) { try { this.aEx(handler); } catch (e) { this.bK('remove_pageSelectionChanged', e); throw e; } }, add_pageAddFailed: function (handler) { try { this.aGr(handler); } catch (e) { this.bK('add_pageAddFailed', e); throw e; } }, remove_pageAddFailed: function (handler) { try { this.aBl(handler); } catch (e) { this.bK('remove_pageAddFailed', e); throw e; } }, add_mouseDown: function (handler) { try { this.BS(handler); } catch (e) { this.bK('add_mouseDown', e); throw e; } }, remove_mouseDown: function (handler) { try { this.Fc(handler); } catch (e) { this.bK('remove_mouseDown', e); throw e; } }, add_mouseMove: function (handler) { try { this.Dg(handler); } catch (e) { this.bK('add_mouseMove', e); throw e; } }, remove_mouseMove: function (handler) { try { this.Gs(handler); } catch (e) { this.bK('remove_mouseMove', e); throw e; } }, add_mouseUp: function (handler) { try { this.Eu(handler); } catch (e) { this.bK('add_mouseUp', e); throw e; } }, remove_mouseUp: function (handler) { try { this.DH(handler); } catch (e) { this.bK('remove_mouseUp', e); throw e; } }, add_propertyChanged: function (handler) { try { this.add_propertyChanged(handler); } catch (e) { this.bK('add_propertyChanged', e); throw e; } }, remove_propertyChanged: function (handler) { try { this.nt(handler); } catch (e) { this.bK('remove_propertyChanged', e); throw e; } }, writeToLog: function (message) { try { this.iP(message); } catch (e) { this.bK('writeToLog', e); throw e; } }, get_documents: function () { return this.ND(); }, get_controlStateElementId: function () { try { var ac = this.KM(); this.ah('get_controlStateElementId', arguments, ac); return ac; } catch (e) { this.bK('get_controlStateElementId', e); throw e; } }, set_controlStateElementId: function (value) { try { this.aI('set_controlStateElementId', arguments); this.KP(value); } catch (e) { this.bK('set_controlStateElementId', e); throw e; } }, get_useDefaultStyling: function () { try { var ac = this.aDC(); this.ah('get_get_useDefaultStyling', arguments, ac); return ac; } catch (e) { this.bK('get_useDefaultStyling', e); throw e; } }, set_useDefaultStyling: function (value) { try { this.aI('set_useDefaultStyling', arguments); this.aDO(value); } catch (e) { this.bK('set_useDefaultStyling', e); throw e; } }, get_selectedPages: function () { try { var ac = this.aGF(); this.ah('get_currentSelectedPages', arguments, ac); return ac; } catch (e) { this.bK('get_currentSelectedPages', e); throw e; } }, get_artDataChanged: function () { try { var ac = this.ave(); this.ah('get_artDataChanged', arguments, ac); return ac; } catch (e) { this.bK('get_artDataChanged', e); throw e; } }, get_xSpacing: function () { try { var ac = this.aep(); this.ah('get_xSpacing', arguments, ac); return ac; } catch (e) { this.bK('get_xSpacing', e); throw e; } }, set_xSpacing: function (value) { try { this.aI('set_xSpacing', arguments); this.aDc(value); } catch (e) { this.bK('set_xSpacing', e); throw e; } }, get_ySpacing: function () { try { var ac = this.aIn(); this.ah('get_ySpacing', arguments, ac); return ac; } catch (e) { this.bK('get_ySpacing', e); throw e; } }, set_ySpacing: function (value) { try { this.aI('set_ySpacing', arguments); this.aDd(value); } catch (e) { this.bK('set_ySpacing', e); throw e; } }, get_thumbnailHeight: function () { try { var ac = this.aEy(); this.ah('get_thumbnailHeight', arguments, ac); return ac; } catch (e) { this.bK('get_thumbnailHeight', e); throw e; } }, set_thumbnailHeight: function (value) { try { this.aI('set_thumbnailHeight', arguments); this.aDn(value); } catch (e) { this.bK('set_thumbnailHeight', e); throw e; } }, get_thumbnailWidth: function () { try { var ac = this.aFS(); this.ah('get_thumbnailWidth', arguments, ac); return ac; } catch (e) { this.bK('get_thumbnailWidth', e); throw e; } }, set_thumbnailWidth: function (value) { try { this.aI('set_thumbnailWidth', arguments); this.aDe(value); } catch (e) { this.bK('set_thumbnailWidth', e); throw e; } }, get_thumbnailBackgroundColor: function () { try { var ac = this.aEE(); this.ah('get_thumbnailBackgroundColor', arguments, ac); return ac; } catch (e) { this.bK('get_thumbnailBackgroundColor', e); throw e; } }, set_thumbnailBackgroundColor: function (value) { try { this.aI('set_thumbnailBackgroundColor', arguments); this.aGk(value); } catch (e) { this.bK('set_thumbnailBackgroundColor', e); throw e; } }, get_thumbnailSelectedBackgroundColor: function () { try { var ac = this.aDv(); this.ah('get_thumbnailSelectedBackgroundColor', arguments, ac); return ac; } catch (e) { this.bK('get_thumbnailSelectedBackgroundColor', e); throw e; } }, set_thumbnailSelectedBackgroundColor: function (value) { try { this.aI('set_thumbnailSelectedBackgroundColor', arguments); this.aDV(value); } catch (e) { this.bK('set_thumbnailSelectedBackgroundColor', e); throw e; } }, get_thumbnailBorderWidth: function () { try { var ac = this.aEv(); this.ah('get_thumbnailBorderWidth', arguments, ac); return ac; } catch (e) { this.bK('get_thumbnailBorderWidth', e); throw e; } }, set_thumbnailBorderWidth: function (value) { try { this.aI('set_thumbnailBorderWidth', arguments); this.aFH(value); } catch (e) { this.bK('set_thumbnailBorderWidth', e); throw e; } }, get_thumbnailBorderColor: function () { try { var ac = this.aDD(); this.ah('get_thumbnailBorderColor', arguments, ac); return ac; } catch (e) { this.bK('get_thumbnailBorderColor', e); throw e; } }, set_thumbnailBorderColor: function (value) { try { this.aI('set_thumbnailBorderColor', arguments); this.aEP(value); } catch (e) { this.bK('set_thumbnailBorderColor', e); throw e; } }, get_resourcePath: function () { try { var ac = this.nQ(); this.ah('get_resourcePath', arguments, ac); return ac; } catch (e) { this.bK('get_resourcePath', e); throw e; } }, set_resourcePath: function (F) { try { this.aI('set_resourcePath', arguments); this.uR(F); } catch (e) { this.bK('set_resourcePath', e); throw e; } }, get_pageViewClientId: function () { try { var ac = this.alp(); this.ah('get_pageViewClientId', arguments, ac); return ac; } catch (e) { this.bK('get_pageViewClientId', e); throw e; } }, set_pageViewClientId: function (value) { try { this.aI('set_pageViewClientId', arguments); this.aHN(value); } catch (e) { this.bK('set_pageViewClientId', e); throw e; } }, get_selectionMode: function () { try { var ac = this.aFy(); this.ah('selectionMode', arguments, ac); return ac; } catch (e) { this.bK('get_selectionMode', e); throw e; } }, set_selectionMode: function (value) { try { this.aI('set_selectionMode', arguments); this.aDP(value); } catch (e) { this.bK('set_selectionMode', e); throw e; } }, get_layout: function () { try { var ac = this.aFs(); this.ah('getthumbnailsLayout', arguments, ac); return ac; } catch (e) { this.bK('get_thumbnailsLayout', e); throw e; } }, set_layout: function (value) { try { this.aI('set_thumbnailsLayout', arguments); this.aEm(value); } catch (e) { this.bK('set_thumbnailsLayout', e); throw e; } }, get_enabled: function () { try { var ac = this.QX(); this.ah('get_enabled', arguments, ac); return ac; } catch (e) { this.bK('get_enabled', e); throw e; } }, get_thumbnailCaptionFormat: function () { try { var ac = this.aep(); this.ah('get_thumbnailCaptionFormat', arguments, ac); return ac; } catch (e) { this.bK('get_thumbnailCaptionFormat', e); throw e; } }, set_thumbnailCaptionFormat: function (value) { try { this.aI('set_thumbnailCaptionFormat', arguments); this.aDt(value); } catch (e) { this.bK('set_thumbnailCaptionFormat', e); throw e; } }, get_artServiceOption: function () { try { var ac = this.Ak(); this.ah('get_artServiceOption', arguments, ac); return ac; } catch (e) { this.bK('get_artServiceOption', e); throw e; } }, set_artServiceOption: function (value) { try { this.aI('set_artServiceOption', arguments); this.Av(value); } catch (e) { this.bK('set_artServiceOption', e); throw e; } }, selectPreviousThumbnail: function () { try { this.aI('selectPreviousThumbnail', arguments, 1); this.aAf(); } catch (e) { this.bK('selectPreviousThumbnail', e); throw e; } }, selectNextThumbnail: function () { try { this.aI('selectNextThumbnail', arguments, 1); this.aAC(); } catch (e) { this.bK('selectNextThumbnail', e); throw e; } }, selectFirstThumbnail: function () { try { this.aI('selectFirstThumbnail', arguments, 1); this.azO(); } catch (e) { this.bK('selectFirstThumbnail', e); throw e; } }, selectLastThumbnail: function () { try { this.aI('selectLastThumbnail', arguments, 1); this.azr(); } catch (e) { this.bK('selectLastThumbnail', e); throw e; } }, scrollToNextBand: function () { try { this.aI('scrollToNextBand', arguments, 1); this.azu(); } catch (e) { this.bK('scrollToNextBand', e); throw e; } }, scrollToPreviousBand: function () { try { this.aI('scrollToPreviousBand', arguments, 1); this.aAe(); } catch (e) { this.bK('scrollToPreviousBand', e); throw e; } }, scrollToFirstThumbnail: function () { try { this.aI('scrollToFirst', arguments, 1); this.aAJ(); } catch (e) { this.bK('scrollToFirst', e); throw e; } }, scrollToLastThumbnail: function () { try { this.aI('scrollToFirst', arguments, 1); this.aAH(); } catch (e) { this.bK('scrollToFirst', e); throw e; } }, scrollToSelectedThumbnail: function () { try { this.aI('ScrollToSelectedThumbnail', arguments, 1); this.aAq(); } catch (e) { this.bK('ScrollToSelectedThumbnail', e); throw e; } }, saveArtData: function (onComplete) { try { this.aI('saveArtData', arguments, 1); this.azK(onComplete); } catch (e) { this.bK('saveArtData', e); throw e; } }, getArtPage: function (page) { try { var ac = this.hz(page); this.wb('getArtPage', arguments, ac, 1); return ac; } catch (e) { this.bK('getArtPage', e); throw e; } }, display: function () { try { this.aI('display', arguments, 1); this.cn(); } catch (e) { this.bK('display', e); throw e; } }, get_requireRequestsOptimize: function () { try { var ac = this.ou(); this.ah('get_requireRequestsOptimize', arguments, ac); return ac; } catch (e) { this.bK('ou', e); throw e; } }, set_requireRequestsOptimize: function (value) { try { this.aI('set_requireRequestsOptimize', arguments); this.tw(value); } catch (e) { this.bK('set_requireRequestsOptimize', e); throw e; } }, get_pageViewFitType: function () { try { var ac = this.aGJ(); this.ah('get_pageViewFitType', arguments, ac); return ac; } catch (e) { this.bK('get_pageViewFitType', e); throw e; } }, set_pageViewFitType: function (value) { try { this.aI('set_pageViewFitType', arguments); this.aIm(value); } catch (e) { this.bK('set_pageViewFitType', e); throw e; } }, get_pageViewRotationDegreesClockwise: function () { try { var ac = this.aFK(); this.ah('get_pageViewRotationDegreesClockwise', arguments, ac); return ac; } catch (e) { this.bK('get_pageViewRotationDegreesClockwise', e); throw e; } }, set_pageViewRotationDegreesClockwise: function (value) { try { this.aI('set_pageViewRotationDegreesClockwise', arguments); this.aHk(value); } catch (e) { this.bK('set_pageViewRotationDegreesClockwise', e); throw e; } }, get_pageViewZoomFactor: function () { try { var ac = this.aFX(); this.ah('get_pageViewZoomFactor', arguments, ac); return ac; } catch (e) { this.bK('get_pageViewZoomFactor', e); throw e; } }, set_pageViewZoomFactor: function (value) { try { this.aI('set_pageViewZoomFactor', arguments); this.aGW(value); } catch (e) { this.bK('set_pageViewZoomFactor', e); throw e; } }, get_encryption: function () { try { var ac = this.eG(); this.ah('get_encryption', arguments, ac); return ac; } catch (e) { this.bK('get_encryption', e); throw e; } }, set_encryption: function (value) { try { this.aI('set_encryption', arguments); this.iA(value); } catch (e) { this.bK('set_encryption', e); throw e; } } }; IPCC.Web.UI.ImGearThumbnailList.registerClass = IPCC.Web.regClass; IPCC.Web.UI.ImGearThumbnailList.registerClass('IPCC.Web.UI.ImGearThumbnailList', IPCC.Sys.UI.Control); IPCC.Type.registerNamespace('IPCC'); IPCC.PageLayout = function () { }; IPCC.PageLayout.registerEnum = IPCC.Web.regEnum; IPCC.PageLayout.prototype = { VerticalScrollDirection: 0, HorizontalScrollDirection: 1 }; IPCC.PageLayout.registerEnum('IPCC.PageLayout', false); IPCC.ViewMode = function () { }; IPCC.ViewMode.registerEnum = IPCC.Web.regEnum; IPCC.ViewMode.prototype = { Document: 0, EqualWidthPages: 1, SinglePage: 2, EqualFitPages: 3 }; IPCC.ViewMode.registerEnum('IPCC.ViewMode', false); IPCC.FitType = function () { }; IPCC.FitType.registerEnum = IPCC.Web.regEnum; IPCC.FitType.prototype = { FitToWidth: 0, ShrinkToWidth: 1, ActualSize: 2, FitToHeight: 3, BestFit: 4 }; IPCC.FitType.registerEnum('IPCC.FitType', false); IPCC.ScaleTrigger = function () { }; IPCC.ScaleTrigger.registerEnum = IPCC.Web.regEnum; IPCC.ScaleTrigger.prototype = { Pinch: "Pinch", Zoom: "Zoom", Fit: "Fit", ViewMode: "ViewMode" }; IPCC.ScaleTrigger.registerEnum('IPCC.ScaleTrigger', false); IPCC.PageEventArgs = function () { return this; }; IPCC.PageEventArgs.registerClass = IPCC.Web.regClass; IPCC.PageEventArgs.prototype = {}; IPCC.PageEventArgs.registerClass('IPCC.PageEventArgs'); IPCC.ExceptionEventArgs = function () { return this; }; IPCC.ExceptionEventArgs.registerClass = IPCC.Web.regClass; IPCC.ExceptionEventArgs.prototype = {}; IPCC.ExceptionEventArgs.registerClass('IPCC.ExceptionEventArgs'); IPCC.OpenPageEventArgs = function () { return this; }; IPCC.OpenPageEventArgs.registerClass = IPCC.Web.regClass; IPCC.OpenPageEventArgs.prototype = {}; IPCC.OpenPageEventArgs.registerClass('IPCC.OpenPageEventArgs'); IPCC.Pagecounter = 1; IPCC.PageList = function (element) { var K = this; var Ks = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || function (func) { return setTimeout(func, 16); }; var aAy = window.cancelAnimationFrame || window.mozCancelAnimationFrame || window.webkitCancelAnimationFrame || function (id) { return clearTimeout(id); }; var bC = new IPCC.Web.UI.fR(); var aE = []; var vQ; var bA = ''; var CE = ''; var an = ''; var mf = ''; var po = ''; var sM = 0; this.jS = new IPCC.Web.UI.ImGearDocumentCollection(); var KR = []; this.aIP = 0; this.aJa = { x: 0, y: 0 }; var gE = 0; var apP = 0; var kx = IPCC.Web.UI.DebugErrorLevel.Production; var _debug = false; var ni = false; var dp = 0; var un = false; var QG = []; var KY = ''; var cq = 1; var bW = IPCC.Web.UI.MouseTool.None; var CS = false; var wl = true; var cP = IPCC.bP.None; var kq; var hE = 0; var jg = 0; var aky = 0; var eS = 0; var ga = 15; var kb = 0; var ji = 15; var qw = 0; var os = 0; var sY = 0; var pz = 0; var amk = 0; var gV = 0; var hl = 0; var rf = 1; var ea = IPCC.PageLayout.VerticalScrollDirection; var bZ = IPCC.ViewMode.Document; var nP = null; var UU = null; var SU = 0; var YT = 0; var zE = 0; var ks = null; var Lv = 0; var JT = ''; var Ff = ''; var sF = []; var Gx = 0; var vu = 3; var QS = 0.5; var Jd = true; var Sp = false; var QU = false; var UM; var wy = IPCC.Web.UI.MarkHandleMode.HideSideHandlesWhenClose; var pA = true; var mk; var fK = {}; var tW = false; var pE = function () { return null; }; var ik = null; var ake = "font-size:11px;color:#888;text-align:center;cursor:pointer;"; var alE = ake + "padding:18px 0 20px;display:table-caption;caption-side:bottom;"; var ans = ake + "white-space:nowrap;line-height:50px;display:table-cell;vertical-align:middle;padding-right:10px;"; var ed = 96; var bO; function it(wL) { if (!_debug) { return false; } return kx >= wL; }; this.bK = function (fH, hV) { if (!it(IPCC.Web.UI.DebugErrorLevel.Production)) { return; } var aw = fH + '() threw an exception (' + hV.name + '), "' + hV.message + '"'; aw = aw.replace(/\n/g, " "); IPCC.gG.iP(aw, IPCC.Web.UI.DebugItemCause.Exception, IPCC.Web.UI.DebugErrorLevel.Production, 'PageList', this.gx().id); var nG = new IPCC.ExceptionEventArgs(); nG.functionName = fH; nG.exception = hV; this.aM('exceptionThrown', nG); }; this.aI = function (fH, eB, jB) { if (!it(IPCC.Web.UI.DebugErrorLevel.Development)) { return; } var aw = fH + '('; var G; for (G = 0; G < eB.length; G++) { if (G > 0) { aw += ', '; } aw += IPCC.gG.io(eB[G], (jB ? jB : 0)); } aw += ')'; this.mB(aw, IPCC.Web.UI.DebugErrorLevel.Development); }; this.wb = function (fH, eB, js, jB) { if (!it(IPCC.Web.UI.DebugErrorLevel.Development)) { return; } var aw = fH + '('; var G; for (G = 0; G < eB.length; G++) { if (G > 0) { aw += ', '; } aw += IPCC.gG.io(eB[G], (jB ? jB : 0)); } aw += ') = '; aw += IPCC.gG.io(js, 1); this.mB(aw, IPCC.Web.UI.DebugErrorLevel.Development); }; this.ah = function (fH, eB, js) { if (!it(IPCC.Web.UI.DebugErrorLevel.Detailed)) { return; } var aw = fH + '('; var G; for (G = 0; G < eB.length; G++) { if (G > 0) { aw += ', '; } aw += IPCC.gG.io(eB[G], 0); } aw += ') = '; aw += IPCC.gG.io(js, 1); this.mB(aw, IPCC.Web.UI.DebugErrorLevel.Detailed); }; this.mB = function (hb, as) { IPCC.gG.iP(hb, IPCC.Web.UI.DebugItemCause.FunctionCall, as, 'PageList', this.gx().id); }; this.iP = function (hb) { IPCC.gG.iP(hb, IPCC.Web.UI.DebugItemCause.Custom, IPCC.Web.UI.DebugErrorLevel.Production, 'PageList', this.gx().id); }; this.rC = function () { return _debug; }; this.Ck = function (F) { var yQ = ! !F; if (_debug === yQ) { return; } _debug = yQ; var cJ = iW(); var cc = []; if (cJ) { cc = sN(cJ); } var G = 0; for (G = 0; G < cc.length; G++) { var ao; if (aE[cc[G]].ds) { ao = document.getElementById(aE[cc[G]].ds).bB; } if (ao) { ao.set_debug(_debug); } } this.aL('debug'); }; this.pm = function () { return kx; }; this.uG = function (F) { IPCC.ad.lm(F, 'value', IPCC.Web.UI.DebugErrorLevel); if (kx === F) { return; } kx = F; var cJ = iW(); var cc = []; if (cJ) { cc = sN(cJ); } var G = 0; for (G = 0; G < cc.length; G++) { var ao; if (aE[cc[G]].ds) { ao = document.getElementById(aE[cc[G]].ds).bB; } if (ao) { ao.set_debugErrorLevel(kx); } } this.aL('debugErrorLevel'); }; function du(cA, V) { bC.addHandler(cA, V); }; function dn(cA, V) { bC.removeHandler(cA, V); }; this.BS = function (V) { du('mouseDown', V); }; this.Fc = function (V) { dn('mouseDown', V); }; this.Dg = function (V) { du('mouseMove', V); }; this.Gs = function (V) { dn('mouseMove', V); }; this.Eu = function (V) { du('mouseUp', V); }; this.DH = function (V) { dn('mouseUp', V); }; this.YE = function (V) { du('selectTextMouseToolCompleted', V); }; this.Xd = function (V) { dn('selectTextMouseToolCompleted', V); }; this.xq = function (V) { du('textPageReady', V); }; this.yI = function (V) { dn('textPageReady', V); }; this.Xy = function (V) { du('hyperlinkPageReady', V); }; this.afb = function (V) { dn('hyperlinkPageReady', V); }; this.aHX = function (V) { du('allPagesAdded', V); }; this.aCd = function (V) { dn('allPagesAdded', V); }; this.KN = function (V) { du('pageOpening', V); }; this.HJ = function (V) { dn('pageOpening', V); }; this.LW = function (V) { du('pageOpened', V); }; this.HD = function (V) { dn('pageOpened', V); }; this.BI = function (V) { du('pageOpenFailed', V); }; this.BD = function (V) { dn('pageOpenFailed', V); }; this.Lk = function (V) { du('pageDisplayed', V); }; this.GY = function (V) { dn('pageDisplayed', V); }; this.lg = function (V) { du('propertyChanged', V); }; this.nt = function (V) { dn('propertyChanged', V); }; this.XA = function (V) { du('exceptionThrown', V); }; this.Wh = function (V) { dn('exceptionThrown', V); }; this.Cg = function (V) { du('textExtractionFailed', V); }; this.EU = function (V) { dn('textExtractionFailed', V); }; this.yd = function (V) { du('markAdded', V); }; this.zu = function (V) { dn('markAdded', V); }; this.We = function (V) { du('markCreating', V); }; this.Xe = function (V) { dn('markCreating', V); }; this.Fb = function (V) { du('markChanged', V); }; this.Gb = function (V) { dn('markChanged', V); }; this.EY = function (V) { du('markReordered', V); }; this.Fu = function (V) { dn('markReordered', V); }; this.EJ = function (V) { du('markSelectionChanged', V); }; this.EO = function (V) { dn('markSelectionChanged', V); }; this.JU = function (V) { du('markTextSelectionChanged', V); }; this.Ig = function (V) { dn('markTextSelectionChanged', V); }; this.yp = function (V) { du('markRemoved', V); }; this.zp = function (V) { dn('markRemoved', V); }; this.aFF = function (V) { du('commentAdding', V); }; this.aBX = function (V) { dn('commentAdding', V); }; this.xy = function (V) { du('commentAdded', V); }; this.FN = function (V) { dn('commentAdded', V); }; this.xP = function (V) { du('commentRemoved', V); }; this.DM = function (V) { dn('commentRemoved', V); }; this.vW = function (V) { du('commentChanged', V); }; this.vp = function (V) { dn('commentChanged', V); }; this.ZI = function (V) { du('scaleChanged', V); }; this.WZ = function (V) { dn('scaleChanged', V); }; this.wm = function () { var bB = document.getElementById(aE[dp].ds).bB; if (bB) { return bB.get_currentState(); } else { return null; } }; this.ajl = function () { var bI = IPCC.J.find(aE, function (eL) { return eL.cO === dp; }); if (!bI) { return; } return bI.bd; }; this.aGA = function (aD) { var bI = IPCC.J.find(aE, function (eL) { return eL.cO === dp; }); if (!bI) { return; } return bI.ds; }; this.qs = function () { return cq; }; this.aDj = function (bS) { kD(bS, undefined, undefined, undefined, undefined, undefined, IPCC.ScaleTrigger.Zoom); }; this.TU = function (ab, zH, Vd, eQ) { eQ = eQ || IPCC.ScaleTrigger.Zoom; kD(cq * ab, Vd, undefined, undefined, undefined, zH, eQ); }; this.awD = function (ab, aY, fJ, It, eQ) { eQ = eQ || IPCC.ScaleTrigger.Zoom; if (cq * ab < 8) { kD(cq * ab, false, aY, fJ, It, undefined, eQ); } else { kD(8, false, aY, fJ, It); } }; this.UV = function (ab, eQ) { eQ = eQ || IPCC.ScaleTrigger.Zoom; kD(cq / ab, false, undefined, undefined, undefined, undefined, eQ); }; this.aGo = function () { return Vo(); }; this.agd = function (eQ, fA, aat) { var Mt, Lu, aJ, by; var abG = 0; var G = 0; for (G = 0; G < aE.length; G++) { aJ = aE[G].ml(); by = aE[G].pM(); if (jU(aE[G].gh) === true) { var Ob = aJ; aJ = by; by = Ob; } if (aJ > 0 && by > 0) { var JN = aJ / by; if (JN > abG) { abG = JN; Mt = by; Lu = aJ; } } } if (abG > 0) { var atO = (bA.offsetWidth - IPCC.Web.pI() - yT() - (ga + ji + os + pz)); var ats = atO / (Lu * ed / aE[0].gS); var fj = hE; var eN = jg; if (jU(aE[0].gh) === true) { fj = jg; eN = hE; } var amH = Mt / eN * ats; var lo = (bA.clientHeight - (eS + kb + qw + sY)) / (eN * ed / aE[0].hq); var IA = amH; if (aat === true && amH > lo) { IA = lo; } kD(IA, true, undefined, undefined, undefined, undefined, eQ, fA); } }; this.agu = function (eQ, fA, aat) { var Mt, Lu, aJ, by; var aaL = 0; var G = 0; for (G = 0; G < aE.length; G++) { aJ = aE[G].ml(); by = aE[G].pM(); if (jU(aE[G].gh) === true) { var Ob = aJ; aJ = by; by = Ob; } if (aJ > 0 && by > 0) { var JN = by / aJ; if (JN > aaL) { aaL = JN; Mt = by; Lu = aJ; } } } if (aaL > 0) { var aur = (bA.offsetHeight - IPCC.Web.pI() - (eS + kb + qw + sY)); var aum = aur / (Mt * ed / aE[0].hq); var fj = hE; var eN = jg; if (jU(aE[0].gh) === true) { fj = jg; eN = hE; } var alO = Lu / fj * aum; var lo = (bA.clientWidth - yT() - (ga + ji + os + pz)) / (fj * ed / aE[0].gS); var IA = alO; if (aat === true && alO > lo) { IA = lo; } kD(IA, true, undefined, undefined, undefined, undefined, eQ, fA); } }; this.aqS = function (fA, eQ) { if (K.xo && typeof K.xo === 'function') { K.xo(); } var aJ; var by; var eA; var ko = 1; eQ = eQ || IPCC.ScaleTrigger.Fit; if (fA === IPCC.FitType.FitToWidth) { if (bZ === IPCC.ViewMode.Document) { ko = (bA.offsetWidth - IPCC.Web.pI() - yT() - (ga + ji + os + pz)) / (gV / cq); kD(ko, true, undefined, undefined, undefined, undefined, eQ, fA); } else if (bZ === IPCC.ViewMode.SinglePage) { if (jU(aE[dp].gh) === true) { aJ = aE[dp].pM(); eA = ed / aE[dp].hq; } else { aJ = aE[dp].ml(); eA = ed / aE[dp].gS; } ko = (bA.offsetWidth - IPCC.Web.pI() - yT() - (ga + ji + os + pz)) / (aJ * eA); kD(ko, true, undefined, undefined, undefined, undefined, eQ, fA); } else { if (ea === IPCC.PageLayout.VerticalScrollDirection) { Zd(eQ, fA); } else { K.agd(eQ, fA); } } } else if (fA === IPCC.FitType.ShrinkToWidth) { var avK = bA.clientWidth - yT(); var avR = 20; var VO = avK - avR; if (bZ === IPCC.ViewMode.SinglePage) { if (jU(aE[dp].gh) === true) { aJ = aE[dp].pM(); eA = ed / aE[dp].hq; } else { aJ = aE[dp].ml(); eA = ed / aE[dp].gS; } if (VO < cq * aJ * eA) { ko = (bA.offsetWidth - IPCC.Web.pI() - yT() - (ga + ji + os + pz)) / (aJ * eA); kD(ko, true, undefined, undefined, undefined, undefined, eQ, fA); } } else { if (VO < gV) { kD(cq * VO / gV, true, undefined, undefined, undefined, undefined, eQ, fA); } } } else if (fA === IPCC.FitType.ActualSize) { if (bZ === IPCC.ViewMode.Document || bZ === IPCC.ViewMode.SinglePage) { kD(1, true, undefined, undefined, undefined, undefined, eQ, fA); } } else if (fA === IPCC.FitType.FitToHeight) { if (bZ === IPCC.ViewMode.Document) { ko = (bA.offsetHeight - IPCC.Web.pI() - (eS + kb + qw + sY)) / (hl / cq); kD(ko, true, undefined, undefined, undefined, undefined, eQ, fA); } else if (bZ === IPCC.ViewMode.SinglePage) { if (jU(aE[dp].gh) === true) { by = aE[dp].ml(); eA = ed / aE[dp].gS; } else { by = aE[dp].pM(); eA = ed / aE[dp].hq; } ko = (bA.offsetHeight - IPCC.Web.pI() - (eS + kb + qw + sY)) / (by * eA); kD(ko, true, undefined, undefined, undefined, undefined, eQ, fA); } else { if (ea === IPCC.PageLayout.HorizontalScrollDirection) { Zd(eQ, fA); } else { K.agu(eQ, fA); } } } else if (fA === IPCC.FitType.BestFit) { var HE; if (bZ === IPCC.ViewMode.Document) { ko = (bA.offsetWidth - IPCC.Web.pI() - (ga + ji + os + pz)) / (gV / cq); HE = (bA.offsetHeight - IPCC.Web.pI() - (eS + kb + qw + sY)) / (hl / cq); if (HE < ko) { ko = HE; } kD(ko, true, undefined, undefined, undefined, undefined, eQ, fA); } else if (bZ === IPCC.ViewMode.SinglePage) { if (jU(aE[dp].gh) === true) { aJ = aE[dp].pM(); by = aE[dp].ml(); eA = ed / aE[dp].gS; } else { aJ = aE[dp].ml(); by = aE[dp].pM(); eA = ed / aE[dp].hq; } ko = (bA.offsetWidth - IPCC.Web.pI() - yT() - (ga + ji + os + pz)) / (aJ * eA); HE = (bA.offsetHeight - IPCC.Web.pI() - (eS + kb + qw + sY)) / (by * eA); if (HE < ko) { ko = HE; } kD(ko, true, undefined, undefined, undefined, undefined, eQ, fA); } else { if (ea === IPCC.PageLayout.HorizontalScrollDirection) { K.agd(eQ, fA, true); } else { K.agu(eQ, fA, true); } } } }; this.azx = function (bp, ag) { var bI = aE[bp - 1]; var bQ = document.getElementById(bI.ds); var HH = []; if (bQ) { var ey, Hj, be; try { ey = Vm(bQ); } catch (e) { return null; } HH = IPCC.J.map(ag, function (eL) { Hj = bQ.bB.transformPagePointToWindow(new IPCC.Web.UI.Point(eL.x, eL.y), true); be = amh(bQ, Hj.x, Hj.y, ey); return { clientX: be.x, clientY: be.y }; }); return HH; } else { return null; } }; this.awv = function () { var G = 0; for (G = 0; G < aE.length; G++) { K.cn(G); } iW(); mJ(); }; this.cn = function (aD) { var bD; if (aE[aD].ds) { bD = document.getElementById(aE[aD].ds); } K.xl(bD, aD); }; this.La = function (aD) { var bD; if (aE[aD].ds) { bD = document.getElementById(aE[aD].ds); } if (bD) { var ao = bD.bB; ao.La(); } }; this.xl = function (bD, aD) { if (bD && bD.bB && bD.bB.gJ() === true) { var ao = bD.bB; ao.display(); aE[aD].ht = true; if (bZ === IPCC.ViewMode.SinglePage) { var ph = -1; if (Array.prototype.indexOf) { ph = sF.indexOf(aD); } else { ph = IPCC.Web.hK(sF, aD); } if (ph !== -1) { sF.splice(ph, 1); } } } }; function amJ(cc) { var bD; for (var G = 0; G < cc.get_length() ; G++) { var bI = cc.getPage(G); var aD = bI.get_pageNumber(); if (aE[aD].ds) { bD = document.getElementById(aE[aD].ds); } if (bD && bD.bB && bD.bB.Fa() !== null) { return bD.bB; } } return null; }; this.KU = function () { var cc = this.get_displayedPages(); var SQ = amJ(cc); SQ.KU(); }; this.Fa = function () { var cc = this.get_displayedPages(); var SQ = amJ(cc); if (SQ) { return SQ.Fa(); } return null; }; this.xh = function (aD, R) { var bD; if (aE[aD].ds) { bD = document.getElementById(aE[aD].ds); } if (bD && bD.bB) { bD.bB.xh(R); } }; this.sm = function (aD) { var bD; if (aE[aD].ds) { bD = document.getElementById(aE[aD].ds); } if (bD && bD.bB) { bD.bB.sm(); } }; this.aaK = function (eo) { var nU = false; if (IPCC.Web.nr.length > 0) { if (Array.prototype.indexOf) { if (IPCC.Web.nr.indexOf(eo) >= 0) { return true; } } else { if (IPCC.Web.hK(IPCC.Web.nr, eo) >= 0) { return true; } } } return nU; }; var lU = ''; this.rc = function (F) { lU = F; }; this.gx = function () { return lU; }; this.aM = function (cA, L) { try { var V = bC.getHandler(cA); if (V !== null) { V(K, L); } } catch (e) { K.bK(cA + 'Event', e); } }; this.aL = function (cr) { var V = bC.getHandler('propertyChanged'); if (V) { V(this, new IPCC.qP(cr)); } }; this.aHs = function (V) { bC.addHandler('currentPageChanged', V); }; this.aBm = function (V) { bC.removeHandler('currentPageChanged', V); }; this.akU = function () { return an.style.cursor || 'auto'; }; this.aHd = function (F) { an.style.cursor = F || 'auto'; }; this.adj = function () { return bW; }; this.LJ = function (F) { IPCC.ad.lm(F, 'value', IPCC.Web.UI.MouseTool); var nY = false; if (bW !== F) { kq = null; bW = F; switch (bW) { case IPCC.Web.UI.MouseTool.HandPan: cP = IPCC.bP.HandOpen; an.style.cursor = IPCC.bP.fq(cP); break; case IPCC.Web.UI.MouseTool.SelectText: case IPCC.Web.UI.MouseTool.CreateHighlightTextMark: case IPCC.Web.UI.MouseTool.CreateTextHyperlinkMark: case IPCC.Web.UI.MouseTool.CreateTextSelectionRedaction: case IPCC.Web.UI.MouseTool.CreateStrikethroughMark: K.AJ(); cP = IPCC.bP.Text; an.style.cursor = IPCC.bP.fq(cP); break; case IPCC.Web.UI.MouseTool.None: cP = IPCC.bP.None; an.style.cursor = IPCC.bP.fq(cP); break; case IPCC.Web.UI.MouseTool.Magnifier: cP = IPCC.bP.Magnifier; an.style.cursor = IPCC.bP.fq(cP); break; case IPCC.Web.UI.MouseTool.RectangleZoom: cP = IPCC.bP.RectangleZoom; an.style.cursor = IPCC.bP.fq(cP); break; case IPCC.Web.UI.MouseTool.CreateRectangleMark: cP = IPCC.bP.AddRectangleMark; an.style.cursor = IPCC.bP.fq(cP); nY = true; kq = function () { return [new IPCC.fI(IPCC.Web.UI.MarkType.Rectangle)]; }; break; case IPCC.Web.UI.MouseTool.CreateRectangleRedactionMark: cP = IPCC.bP.AddRectangleRedactionMark; an.style.cursor = IPCC.bP.fq(cP); nY = true; kq = function () { return [new IPCC.fI(IPCC.Web.UI.MarkType.RectangleRedaction)]; }; break; case IPCC.Web.UI.MouseTool.CreateEllipseMark: cP = IPCC.bP.AddEllipseMark; an.style.cursor = IPCC.bP.fq(cP); nY = true; kq = function () { return [new IPCC.fI(IPCC.Web.UI.MarkType.Ellipse)]; }; break; case IPCC.Web.UI.MouseTool.CreateLineMark: cP = IPCC.bP.AddLineMark; an.style.cursor = IPCC.bP.fq(cP); nY = true; kq = function () { return [new IPCC.rJ()]; }; break; case IPCC.Web.UI.MouseTool.CreateStampMark: cP = IPCC.bP.AddStampMark; an.style.cursor = IPCC.bP.fq(cP); nY = true; kq = function () { return [new IPCC.fI(IPCC.Web.UI.MarkType.Stamp)]; }; break; case IPCC.Web.UI.MouseTool.CreateImageStampAnnotationMark: cP = IPCC.bP.AddImageStampMark; an.style.cursor = IPCC.bP.fq(cP); nY = true; kq = function () { return [new IPCC.fI(IPCC.Web.UI.MarkType.ImageStampAnnotation)]; }; break; case IPCC.Web.UI.MouseTool.CreateImageStampRedactionMark: cP = IPCC.bP.AddImageStampMark; an.style.cursor = IPCC.bP.fq(cP); nY = true; kq = function () { return [new IPCC.fI(IPCC.Web.UI.MarkType.ImageStampRedaction)]; }; break; case IPCC.Web.UI.MouseTool.CreateTextMark: cP = IPCC.bP.AddTextMark; an.style.cursor = IPCC.bP.fq(cP); nY = true; kq = function () { return [new IPCC.fI(IPCC.Web.UI.MarkType.Text)]; }; break; case IPCC.Web.UI.MouseTool.CreateTextInputSignatureMark: cP = IPCC.bP.AddTextMark; an.style.cursor = IPCC.bP.fq(cP); nY = true; kq = function () { return [new IPCC.fI(IPCC.Web.UI.MarkType.TextLine)]; }; break; case IPCC.Web.UI.MouseTool.CreateTextAreaSignatureMark: cP = IPCC.bP.AddTextMark; an.style.cursor = IPCC.bP.fq(cP); nY = true; kq = function () { return [new IPCC.fI(IPCC.Web.UI.MarkType.TextAreaSignature)]; }; break; case IPCC.Web.UI.MouseTool.CreateFreehandMark: cP = IPCC.bP.AddFreehandLineMark; an.style.cursor = IPCC.bP.fq(cP); nY = true; kq = function () { return [new IPCC.qb()]; }; break; case IPCC.Web.UI.MouseTool.CreatePolylineMark: cP = IPCC.bP.AddPolylineMark; an.style.cursor = IPCC.bP.fq(cP); nY = true; kq = function () { return [new IPCC.pb(IPCC.Web.UI.MarkType.Polyline)]; }; break; case IPCC.Web.UI.MouseTool.EditMarks: cP = IPCC.bP.EditMarks; an.style.cursor = IPCC.bP.fq(cP); nY = true; kq = function () { return [new IPCC.oB(IPCC.Web.UI.MarkType.Text)]; }; break; default: cP = IPCC.bP.None; an.style.cursor = IPCC.bP.fq(cP); break; } var G = 0; for (G = 0; G < aE.length; G++) { var ao; if (aE[G].ds) { var bD = document.getElementById(aE[G].ds); if (bD) { ao = bD.bB; } } if (ao) { if (nY === true) { ao.Nx(kq()); } else { ao.set_mouseTool(IPCC.Web.UI.MouseTool.None); } } } this.aL('mouseTool'); } }; this.atH = function () { return CS; }; this.aGU = function (bool) { CS = ! !bool; }; this.Cp = function () { return wy; }; this.Mb = function (F) { if (wy !== F) { wy = F; var cJ = iW(); var cc = []; if (cJ) { cc = sN(cJ); } var G = 0; for (G = 0; G < cc.length; G++) { var bD; var ao; bD = document.getElementById(aE[cc[G]].ds); ao = bD.bB; if (ao) { ao.set_markHandleMode(wy); this.xl(bD, G); } } this.aL('markHandleMode'); } }; this.iw = function () { return wl; }; this.zr = function (F) { if (wl !== F) { wl = F; var cJ = iW(); var cc = []; if (cJ) { cc = sN(cJ); } var G = 0; for (G = 0; G < cc.length; G++) { var ao; if (aE[cc[G]].ds) { ao = document.getElementById(aE[cc[G]].ds).bB; } if (ao) { ao.set_textRequired(wl); } } this.aL('textRequired'); } }; this.aIj = function () { return vu; }; this.aHh = function (F) { if (F < 0) { F = 0; } if (vu !== F) { vu = F; this.aL('maxPrefetch'); } }; this.arM = function () { return Jd; }; this.aFm = function (F) { if (Jd !== F) { Jd = F; this.aL('displayPagesWhenScrolling'); } }; this.aHc = function () { return Gx; }; this.aHj = function (F) { if (F < 0) { F = 0; } if (Gx !== F) { Gx = F; this.aL('maxOutOfViewDisplay'); } }; this.aru = function () { return Sp; }; this.aFj = function (F) { if (Sp !== F) { Sp = ! !F; this.aL('discardOutOfViewText'); } }; this.aGl = function () { return QU; }; this.aEl = function (F) { if (QU !== F) { QU = ! !F; this.aL('retainPageText'); } }; this.aGB = function () { return QS; }; this.aEr = function (F) { if (F < 0) { F = 0; } if (QS !== F) { QS = F; this.aL('scrollDisplayThreshold'); } }; this.aDu = function () { return ea; }; this.aHY = function (F) { if (ea === F) { return; } ea = F; if (bA === '' || bA.clientHeight <= 0 || bZ === IPCC.ViewMode.SinglePage) { this.aL('pageLayout'); return; } var vs = dp; var HZ = bZ; if (bZ === IPCC.ViewMode.EqualWidthPages || bZ === IPCC.ViewMode.EqualFitPages) { K.OK(IPCC.ViewMode.Document); } bA.scrollLeft = 0; bA.scrollTop = 0; var G = 0; var bD; if (ea === IPCC.PageLayout.VerticalScrollDirection) { if (po) { po.setAttribute('style', alE); } CE.insertBefore(mf, po); for (G = 0; G < aE.length; G++) { bD = document.getElementById(aE[G].ds); bD.style.display = 'block'; if (hE > 0) { bD.style.margin = eS + 'px auto ' + kb + 'px auto'; } } an.style.margin = '0px ' + ga + 'px 0px ' + ji + 'px'; bA.scrollLeft = (gV - bA.clientWidth) / 2 + ga + os; } else { if (po) { po.setAttribute('style', ans); } CE.removeChild(mf); for (G = 0; G < aE.length; G++) { bD = document.getElementById(aE[G].ds); if (bD) { bD.style.display = 'inline-block'; if (hE > 0) { bD.style.margin = eS + 'px ' + ga + 'px ' + kb + 'px ' + ji + 'px'; } } } an.style.margin = '0px'; bA.scrollTop = (hl - bA.clientHeight) / 2 + eS + qw; } if (HZ === IPCC.ViewMode.EqualWidthPages) { K.OK(IPCC.ViewMode.EqualWidthPages); } else if (HZ === IPCC.ViewMode.EqualFitPages) { K.OK(IPCC.ViewMode.EqualFitPages); } this.rU(vs); mJ(); this.aL('layout'); }; this.aDS = function () { return bZ; }; this.OK = function (F, eQ) { eQ = eQ || IPCC.ScaleTrigger.ViewMode; if (bZ === F) { return; } bZ = F; if (bA === '' || bA.clientHeight <= 0) { this.aL('viewMode'); return; } var vs = dp; this.rU(vs); if (bZ === IPCC.ViewMode.Document) { var lo = 1; var aJ = hE; var by = jg; if (jU(rV) === true) { aJ = jg; by = hE; } if (ea === IPCC.PageLayout.VerticalScrollDirection) { lo = (bA.clientWidth - (ga + ji + os + pz)) / aJ; } else { lo = (bA.clientHeight - (eS + kb + qw + sY)) / by; } kD(lo, true, undefined, undefined, undefined, undefined, eQ); } else { Zd(eQ); } this.rU(vs); this.aL('viewMode'); Bw(fK, true); lE(fK, true); }; var rV = 0; this.aFq = function () { return rV; }; this.aIz = function (F) { if (rV !== F) { rV = F; var G = 0; for (G = 0; G < aE.length; G++) { if (aE[G].Ik === 0) { aE[G].gh = rV; } } this.aL('pageRotation'); } }; this.Zo = function (bp) { var cO; if (arguments.length > 0) { if (!isNaN(bp)) { cO = bp; } else { cO = dp; } } else { cO = dp; } for (var G = 0; G < aE.length; G++) { if (cO === G) { return aE[G].gh; } } return 0; }; var nu = false; this.eG = function () { return nu; }; this.iA = function (F) { if (typeof F !== "boolean") { return; } if (F === nu) { return; } nu = F; }; this.auP = function () { return UM; }; this.aIu = function (F, tk, yS, wD) { if (UM !== F) { UM = F; for (var G = 0; G < aE.length; G++) { aE[G].aX.ask(F, G, aE[G].ml(), aE[G].pM(), aE[G].bd, tk, yS, wD); var asG = !aE[G].ml(); aE[G].YQ(asG); } this.aL('annotationXmlDom'); } }; var lT; this.uR = function (F) { lT = F; }; this.nQ = function () { return lT; }; var sR = false; this.kU = function () { return sR; }; this.rq = function (F) { if (typeof F !== "boolean") { return; } if (F === sR) { return; } sR = F; IPCC.J.forEach(aE, function (af, G) { var ao; if (aE[G].ds) { var bD = document.getElementById(aE[G].ds); if (bD) { ao = bD.bB; } } if (ao) { ao.rq(sR); ao = undefined; } }); }; this.aIw = function (F) { if (KY !== F) { KY = F; this.aL('loadingContent'); } }; this.aGV = function () { return KY; }; this.arz = function () { var cJ = iW(); var cc = []; if (cJ) { cc = sN(cJ); } var ali = new IPCC.Web.UI.ImGearPageCollection(); var G = 0; for (G = 0; G < cc.length; G++) { ali.alK(aE[cc[G]].bd); } return ali; }; this.aGH = function (aD) { if (aE[aD]) { return aE[aD].ds; } }; this.ou = function () { return pA; }; this.tw = function (F) { pA = F; }; this.hT = function () { return mk; }; this.tm = function (F) { mk = F; }; this.SA = function (bI, Bp, Bh) { var K = this; if (bI.kO() > 0 || bI.iE() > 0) { Bp(bI.kO(), bI.iE()); return; } bI.requestPageAttributes(function (ax, cR) { if (aE[bI.get_pageNumber()].agW() === true) { var ij = ax / bI.alc(); if (ij !== 1) { var aX = K.hz(bI); if (aX) { anc(aX, ij); } } } aE[bI.get_pageNumber()].YQ(false); Bp(ax, cR); }, function (fr) { Bh(fr); }); }; this.axC = function () { if (tW === true) { return; } tW = true; this.fB(mf, 'pccHidden'); Bw(fK, true); lE(fK, true); }; this.aCl = function () { if (tW === false) { return; } tW = false; this.ke(mf, 'pccHidden'); }; this.asb = function () { return tW; }; this.ke = function (aW, wR) { var Jm = new RegExp('(?:^|\\s)' + wR + '(?!\\S)', 'g'); if (aW.className.match(Jm) === null) { aW.className = aW.className + ' ' + wR; } }; this.fB = function (aW, wR) { var Jm = new RegExp('(?:^|\\s)' + wR + '(?!\\S)', 'g'); aW.className = aW.className.replace(Jm, ''); }; this.asF = function () { return pE; }; this.aHU = function (F) { pE = F; }; this.aFN = function () { return ik; }; this.aEF = function (F) { if (ik === F) { return; } var R, dR, wA; if (ik) { R = ik.get_mark(); wA = fK[R.get_markID()]; dR = pE(R, { isSelected: true }, (wA) ? wA.dR : undefined); if (wA) { Eh(R, fK, dR); } } R = dR = wA = undefined; ik = F; if (ik) { R = ik.get_mark(); wA = fK[R.get_markID()]; dR = pE(R, { isSelected: true }, (wA) ? wA.dR : undefined); if (wA) { Eh(R, fK, dR); } } lE(fK, true); }; this.aCJ = function (aac) { var kQ = Ax(); IPCC.J.forEach(aac, function (Nt) { var dk = fK[Nt]; if (dk) { var me = pE(dk.R, { isSelected: (dk.R.get_conversation() === ik) }, dk.dR); if (!IPCC.J.yP(me)) { throw new Error(me + ' is not a valid HTMLElement'); } if (me !== dk.dR) { Eh(dk.R, fK, me); } } }); lE(fK, true, kQ); }; this.initialize = function () { var bg = this.gx(); var G; for (G = bg.childNodes.length - 1; G >= 0; G--) { if (bg.childNodes[G].tagName !== 'INPUT') { bg.removeChild(bg.childNodes[G]); } } this.jS.add_documentAdded(ZO); this.jS.add_pageAdded(LP); this.jS.add_pageRemoved(KQ); this.Md(true); bg.bB = this; ajR(); var acU = 'webkit moz o'.split(' '), wr = ''; if (an.style.animationName !== undefined) { JT = 'animationend'; Ff = 'transitionend'; return; } for (G = 0; G < acU.length; G++) { if (an.style[acU[G] + 'Animation'] !== undefined) { wr = acU[G]; JT = wr + 'AnimationEnd'; Ff = wr + 'TransitionEnd'; break; } } }; this.arr = function () { po = document.createElement('div'); var Hb = document.createElement('div'), aol = document.createElement('div'), ot = document.createElement('button'), AT = document.createElement('span'), gb = new Date(), IU = gb.getFullYear(), Sq = '?utm_source=rv&utm_medium=rv&utm_campaign=rv' + IU, anB = function () { K.ke(Hb, 'open'); }, aeR = function () { K.fB(Hb, 'open'); }; ot.innerHTML = '&#215;'; ot.setAttribute('type', 'button'); aol.innerHTML = '<h3>PrizmDoc v' + PCCViewer.Zw() + '</h3><p>PrizmDoc is a web based online document viewer and can be embedded into any web page or linked from any page. Learn more about PrizmDoc at <a href="http://www.accusoft.com' + Sq + '">www.accusoft.com</a>.</p><p>&copy; ' + IU + ' Accusoft - All Rights Reserved.</p>'; Hb.className = 'pccPageListAboutModal'; Hb.appendChild(ot); Hb.appendChild(aol); element.appendChild(Hb); AT.setAttribute('style', '' + 'background: ' + 'url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAvlJREFUeNp0kk9IHGcYxp95Z76Zb/bbT8xuFXdd3QXBquTmoX/EWgoe7MmI9laKZ2/SemlDaRsIRG9JLz30kFx6Smkh5lQs/WMXehHciEiVKllYdHdmcGeZcXe/b3pIWppoHniO7+/9wfsaS0tLuCoXFxcYHh7+tq+vb7nZbPpEZJim2ZskyR+7u7tv+74PIQSSJHlhzqpWq1cC4zhGFEW3hRALrutei+MY3W4XqVTqrWKx+L3neTeCIIBt2y9AzYmJCTiOc6lSSoRh6Hme97BUKq0kSWJordHpdNDf3z+WSqVe833/sRACruuCcw7OOYyNjY1Ldv9ulFKiUqlgf3//w5mZmfutVgtaawAA5xzVanUtCIL1fD4PIoLWGlaxWLwE1FrDMAzYtm3mcrnC4eHhg+3t7denp6c/9X0fANButzE0NHSHiPbK5fIjpRQYY6AwDPGqep63GkXR38vLy+9GUfTZwcHBr5lMBkmSQCmFbreLwcHBH1qt1sTOzg6Ojo5AeHU+NgzjThiGkFL+uLCwYG1tbb1zcnJSkVL+9wlaa3NxcfGn2dnZzOjo6NVAIvocwDoRQQiBs7OzT4QQ3fHxcezt7a2YpgnLsgAAURSBiAYmJye/azabMOfn51/m3TMMY822bSilolqtthpFUeX8/PzG2NgYPz09/SUIgsrAwMAHnU4HRM+cHMcZ4Zz3Wy9d965t2ytKKcRxjDAMn8ZxvJROp+/29PRACIFCoXBzc3PzluM4X5VKpZtBEJw3Go37pmnWc7nc7/83fGhZ1ke+7//m+77SWl9zHCfb29tbJCIkSQKtNfL5/HthGP5ZrVa/SafTFaXUg2w2mxkZGfkCwFMLgAXgZwBTRPSEiOaCIAjb7fabtm2PMsYKrutOcc6nGWPStm3Mzc09Oj4+/pox9lc2m/2SMSY9z1ur1WrrFoDV59DrSqknQghwzlGv18uGYZSTJIHrupBSMiJ6gzE2JaVczOfzK0SERqPxuF6vv29ZFkzTxD8DAOIqXOXDxS7hAAAAAElFTkSuQmCC)' + ' no-repeat;' + 'background: ' + 'url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAaCAYAAADFTB7LAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAB3dJREFUeNqkl0tsG9cVhv97586T5FAULVKibFmiHAu2E7R2ZMZtVTtJi3ahjV9Igy4CxAW0CQIvEvQBZOdFs+imRbsKUBe2gyBujcLOC0lTx5WFNrCMMorhGHJb2YJMPWlxRHKGM3d4Z7oRCVkVHdm9wFlwMMPz4Zzz//deMjIygkdd9XodyWTyb6qqHnRdt0gplVq8qkqSZFiWdbRYLP7ZcRyEYQhCyKZzkYMHDz4yoO/7iMVih3K53JUwDOH7/oZJwzCEJEnQNI3fvHkzNzk5OSHLMiRJ2nQuqbe3F4SQRwpJkmBZ1rSu6/9Kp9PHPM9rmSAIAhBCJNM0h1dWVs7W63VHURRIkrSpIMPDw3jcxTnH1q1bf7V9+/bXbNtu2bogCKDrOsIwvDo5OXlwcXERiqJsKgd91Oo1glKKIAhw586d113X/cAwDARBsHESSuG6Lhhj381kMu/4vg/f95vwQoiWIfX09KBer28qhBAP/A7DEJRSeJ73YSKR+JGiKIlW80gIaczuk4qiMM75Z5IkQVVV6LoOVVU3DJbL5TZV6jAMm0CNpSgKyuUyRkdHLdd1jw4ODl4TQsgPE02tVkNfX98bsVjsP9PT038wTRO6rkMIsWFetm/fvk0DBkHwgAIlSYIsy1hZWcGZM2e+oJSeOHDgwNlSqYQwDDesYhiGsG0bpmme1jRt1nGcT1RVRUPd679jlUrlsQHDMIQsyzh27BgqlQry+fy5/v7+PfF4/OflcvmBaq+FFEKAUoq+vr535+bmnq5Wq1Plchme5/2PBZHTp08/NuDq898YhvGxLMsfnDp1CpOTkxgZGfm4vb39B5VKZUPIhjg0TQNj7HY+nx8cGxurWJYFXdcfFBj+v/U2IeRV27bPAciePHkSnZ2dmJiYeEFRlClN075W2WEY7hwYGLgQiURACIGqqlAUpRnS4cOHN02zTiSXABxfbZvmOM73u7u7f9/X11c/f/68VywW/7579+6fhGFIhRAtlc05h2ma/el0OgPgfU3TkEqlkEgkkEgkHhvwMwA/XFeRVKVS2d/T03NO13WMjo7OdnZ2TnV0dBzlnLfeawmB53nIZDJPq6rqz83NXU0mk4hEIojFYo8MGKGUXgUw1OKVbkrp2729vda1a9cwMTHxZSKR0Lq7u4dc133oIYFzjvb29u9xzm+Vy+WbQgg4jrN5QEJInBDyD0LI3hYzVZZl+XnXdb9aWFhANBrFzMwMLMv6a39//wFd13d4ntey1Q0fzGazxzjnH929e3d2dnZ20yLZAmCcELJnfcsJIVAUZVEI8Q3Hccanp6cxNTWFvXv34vjx4+js7MSNGzdetG17WtO0Df2xIRrOORzHof39/Zd0Xe8uFoubAuwHkAfwxHo4Xdeh6/pHCwsL6Vu3bt11HCcthDAB4P79+0gmk0ilUlheXl65ffv2C7Isi43MeC2k4zhgjHUODQ19fujQoeTXAQ4AuA5g6/qWGIaBYrF4Znx8/MTS0tJLyWTyK8bYfFtb2/S2bdtuGoZxOQiC12q1GiKRCABcm5mZeVmW5Zaz2PjfSqUCxlj7wMBAD3sI3FMAxgCYjY8ppc1Nf2VlxV1eXk60tbV9sWXLlnQQBPB9H5qmtRmG0SaE2G0YxnO7du1K5fP5nxWLRdTr9bOKojyZyWR+allWE7RxPqzVapifn3/XcZxfApgwTbOlSJ4BcDUMwyhjDIwxCCHgeV5o2zYcx4HneXI8Hh8wDCPKOW/OY2PHaRwuMpnMdyzLKly8ePGfqqoiEol8qqpqzjCMJwCAMYZyuVwqFApvhGE4vLy8/EfTNJd6e3vDVCplbLTVfRvAKACJEBK4rsuFEJoQoumDDZBWs7R2TlVVRb1ex9jY2LcWFhY+X21jx86dO//CGNOKxeII53xU0zR0dXW90tXV9SaAqO/7KBQKr69v8dCqCUurQ0s9zxuZmZn5MhaL/VjTtEFJkvaqqppYVS+CIGjGemBCCFzXhaZpOHLkyMULFy7kXNed3rFjx1K5XP5mEAQwTTOSyWR+G4/HXwmCALIsw3VdLC4unrp3796v1wI+C+AyALL29pZOp8uO40xYljXhui5KpZIK4Kmurq5ngiDI6bo+qKrqLsYYkWW5WdlGqxv2Ua1WU9ls9rJlWYMdHR2lWCx2VFGUV9va2p6llCIMQwghUCwWLzmO87Jt28uyLKMBOAzg/TWw0wDep5T+yfO8K7FYDNVqFYwxAPBc173ued71paWl31FKQSntzGQy+znng9FoNMcY28cYS8my3KykbdvIZrNZz/Nuua4bpFKprrWWU61WC9Vq9cT8/Pwn8Xi8eWdhAF4E8A6AAoC3AHwIYHzt3ttw+YYQJEkCpRSapkEIgSAI5jnn75VKpffq9To454qqqnsopYPRaHQ/gEFVVfd4nqfIspw2DAOe5yEIAnDOUSqV3rRt+xeKokBVVVBKUa/Xm4BbADwH4MrjnLfWXqIadkEp5b7v54UQed/336rVamhvb++o1Wr7NE0bBJCLx+PPu657o1AovEQp/Xc0Gt3wvvzfAQC0fOWy6L2jqgAAAABJRU5ErkJggg==)' + ' no-repeat 0% 0% / 20px'); AT.style.width = '20px'; AT.style.height = '14px'; AT.style.display = 'inline-block'; AT.style.position = 'relative'; AT.style.marginRight = '5px'; AT.style.top = '3px'; po.appendChild(AT); po.innerHTML += 'PrizmDoc v' + PCCViewer.Zw(); if (ea === IPCC.PageLayout.HorizontalScrollDirection && bZ !== IPCC.ViewMode.SinglePage) { po.setAttribute('style', ans); } else { po.setAttribute('style', alE); } CE.appendChild(po); if (!po.addEventListener) { po.attachEvent('onclick', anB); } else { po.addEventListener('click', anB, false); } if (!ot.addEventListener) { ot.attachEvent('onclick', aeR); } else { ot.addEventListener('click', aeR, false); } amk = po.offsetHeight; }; this.QX = function () { return ni; }; this.Md = function (F) { ni = F; this.aL('enabled'); }; this.aAP = function () { if (dp + 1 < aE.length) { K.rU(dp + 1); } }; this.azU = function () { var XR = dp - 1; if (XR < 0) { XR = 0; } K.rU(XR); }; function FE(L) { IPCC.Web.UI.al.removeHandler(L.target, JT, FE); IPCC.Web.UI.al.removeHandler(L.target, Ff, FE); if (Lv > dp) { K.fB(L.target, 'pccNextPageIn'); K.fB(L.target, 'pccPreviousPageIn'); K.fB(L.target, 'pccCurrentPage'); K.fB(L.target, 'pccPageBack'); K.fB(L.target, 'pccPageForward'); K.ke(L.target, 'pccNextPage'); } else if (Lv < dp) { K.fB(L.target, 'pccNextPageIn'); K.fB(L.target, 'pccPreviousPageIn'); K.fB(L.target, 'pccCurrentPage'); K.fB(L.target, 'pccPageBack'); K.fB(L.target, 'pccPageForward'); K.ke(L.target, 'pccPreviousPage'); } K.fB(an, 'pccPageListContainerPageChanging'); bA.style.overflow = 'auto'; ks = null; an.style.overflow = 'hidden'; var lX = IPCC.J.filter(fK, function (bL) { return bL.bp === dp + 1; }); Uu(lX); setTimeout(function () { mJ(); }, 60); }; this.rU = function aIZ(aD) { var JE = dp; var lX; if (bZ === IPCC.ViewMode.SinglePage) { lX = IPCC.J.filter(fK, function (bL) { return bL.bp !== aD + 1; }); MC(lX); } else { un = true; var ahc = agE(aD); if (ea === IPCC.PageLayout.VerticalScrollDirection) { bA.scrollTop = ahc; } else { bA.scrollLeft = ahc; } } var Cx = []; if (dp !== aD) { dp = aD; var af = aE[dp]; var L = new IPCC.PageEventArgs(); L.imGearPage = K.get_currentPage(); L.pageIndex = dp; L.pageNodeID = af.ds; K.aM('currentPageChanged', L); if (bZ === IPCC.ViewMode.SinglePage) { var hJ = document.getElementById(aE[dp].ds); var ti = document.getElementById(aE[JE].ds); if (hJ === null) { hJ = JO(aE[dp].bd); Cx.push(aE[dp]); hJ.className = 'pccPageListItem pccCurrentPage'; sF.push(dp); if (hE > 0) { var fQ = WK(aE[dp]); hJ.style.width = fQ.ax + 'px'; hJ.style.height = fQ.cR + 'px'; } else { hJ.style.width = an.clientWidth - ga - ji + 'px'; hJ.style.height = an.clientWidth * 0.8 + 'px'; } hJ.style.display = 'block'; hJ.setAttribute('id', aE[dp].ds); an.appendChild(hJ); } if (Ff.length > 0) { bA.style.overflow = 'hidden'; an.style.width = hJ.style.width; an.style.height = hJ.style.height; an.style.overflow = 'visible'; if (ks !== null) { IPCC.Web.UI.al.removeHandler(ks, JT, FE); IPCC.Web.UI.al.removeHandler(ks, Ff, FE); if (Lv > dp) { this.fB(ks, 'pccNextPageIn'); this.fB(ks, 'pccPreviousPageIn'); this.fB(ks, 'pccCurrentPage'); this.fB(ks, 'pccPageForward'); this.fB(ks, 'pccPageBack'); this.ke(ks, 'pccNextPage'); } else if (Lv < dp) { this.fB(ks, 'pccNextPageIn'); this.fB(ks, 'pccPreviousPageIn'); this.fB(ks, 'pccCurrentPage'); this.fB(ks, 'pccPageForward'); this.fB(ks, 'pccPageBack'); this.ke(ks, 'pccPreviousPage'); } } IPCC.Web.UI.al.addHandler(ti, JT, FE); IPCC.Web.UI.al.addHandler(ti, Ff, FE); ks = ti; Lv = JE; this.ke(an, 'pccPageListContainerPageChanging'); if (dp > JE) { this.ke(ti, 'pccPageForward'); this.fB(hJ, 'pccPageBack'); this.fB(hJ, 'pccPreviousPage'); this.fB(hJ, 'pccPreviousPageIn'); this.fB(hJ, 'pccNextPage'); this.ke(hJ, 'pccCurrentPage'); this.ke(hJ, 'pccNextPageIn'); } else { this.ke(ti, 'pccPageBack'); this.fB(hJ, 'pccPageForward'); this.fB(hJ, 'pccPreviousPage'); this.fB(hJ, 'pccNextPage'); this.fB(hJ, 'pccNextPageIn'); this.ke(hJ, 'pccCurrentPage'); this.ke(hJ, 'pccPreviousPageIn'); } } else { an.style.width = hJ.style.width; an.style.height = hJ.style.height; if (dp > JE) { this.fB(ti, 'pccNextPage'); this.fB(ti, 'pccCurrentPage'); this.ke(ti, 'pccPreviousPage'); } else { this.fB(ti, 'pccPreviousPage'); this.fB(ti, 'pccCurrentPage'); this.ke(ti, 'pccNextPage'); } this.fB(hJ, 'pccPreviousPage'); this.fB(hJ, 'pccNextPage'); this.ke(hJ, 'pccCurrentPage'); lX = IPCC.J.filter(fK, function (el) { return el.bp === aD + 1; }); Uu(lX); setTimeout(function () { mJ(); }, 60); } IPCC.J.forEach(Cx, ahF); } } }; this.azL = function () { if (aE.length > 0) { K.rU(0); } }; this.azv = function () { if (dp < aE.length - 1) { K.rU(aE.length - 1); } }; this.ayh = function (df) { if (tW === false) { return "CommentsPanelClosed"; } var ej = fK[df.get_mark().get_markID()]; if (!ej) { return "ConversationDivDoesNotExist"; } if (bZ === IPCC.ViewMode.SinglePage && ej.bp - 1 !== dp) { return "SinglePageModePageNotShown"; } var bI = document.getElementById(aE[ej.bp - 1].ds); if (aE[ej.bp - 1].ht === false || bI === undefined || bI.bB === undefined || bI.bB === null || bI.bB.gJ() === false) { return "PageOutOfView"; } var h = df.get_mark().get_boundingRectangle(); var uK = bI.bB.transformPagePointToWindow(new IPCC.Web.UI.Point(h.x, h.y), true); var zz = bI.bB.transformPagePointToWindow(new IPCC.Web.UI.Point(h.x + h.width, h.y), true); uK.x = an.offsetWidth; zz.x = an.offsetWidth + yT(); K.aeB(bI.offsetTop, bI.offsetLeft, uK, zz); return "Success"; }; this.azf = function (aD, h) { if (bZ === IPCC.ViewMode.SinglePage && aD !== dp) { return true; } var bI = document.getElementById(aE[aD].ds); if (aE[aD].ht === false || bI === undefined || bI.bB === undefined || bI.bB === null || bI.bB.gJ() === false) { return false; } var uK = bI.bB.transformPagePointToWindow(new IPCC.Web.UI.Point(h.x, h.y), true); var zz = bI.bB.transformPagePointToWindow(new IPCC.Web.UI.Point(h.x + h.width, h.y + h.height), true); K.aeB(bI.offsetTop, bI.offsetLeft, uK, zz); return true; }; this.axv = function (auD, awJ) { bA.scrollTop += Math.round(awJ); bA.scrollLeft += Math.round(auD); }; this.aeB = function (atk, asf, uK, zz) { var aiS = zz.x - uK.x; var aip = zz.y - uK.y; var fL = new IPCC.Web.UI.Point(0, 0); if (aiS > bA.clientWidth) { fL.x = uK.x; } else { fL.x = uK.x + (aiS / 2); } if (aip > bA.clientHeight) { fL.y = uK.y; } else { fL.y = uK.y + (aip / 2); } if (ea === IPCC.PageLayout.VerticalScrollDirection) { bA.scrollTop = atk + fL.y - bA.clientHeight / 2; bA.scrollLeft = fL.x - bA.clientWidth / 2; } else { bA.scrollLeft = asf + fL.x - bA.clientWidth / 2; bA.scrollTop = fL.y - bA.clientHeight / 2; } }; this.aDQ = function () { if (K.jS.get_length() > 0) { K.jS.removeAllDocuments(); } var cJ = iW(); var cc = []; if (cJ) { cc = sN(cJ); } if (cc.length > 0) { apP++; agf(); } }; this.ZA = function (aD, bh, fF, dU) { if (aE[aD] && aE[aD].ht === true) { var bD = document.getElementById(aE[aD].ds); if (bD && bD.bB && bD.bB.gJ() === true) { if (dU) { IPCC.ad.dU(dU, "selectText"); var jE = bD.bB.zI(); var apE = jE.gX; var avz = jE.cK; jE.gX = dU; jE.cK = dU; bD.bB.showTextSelection(bh, fF); jE.gX = apE; jE.cK = avz; } else { bD.bB.showTextSelection(bh, fF); } } } }; this.aBr = function () { var cJ = iW(); var cc = []; if (cJ) { cc = sN(cJ); } var G; for (G = 0; G < cc.length; G++) { if (aE[cc[G]].ht === true) { var ck = document.getElementById(aE[cc[G]].ds), bB = ck ? ck.bB : undefined; if (bB && bB.gJ() === true) { bB.showEmptyTextSelection(0); bB.extendTextSelection(undefined); bB.display(); } } } }; this.aBP = function (aD) { if (aE[aD] && aE[aD].ht === true) { var ck = document.getElementById(aE[aD].ds), bB = ck ? ck.bB : undefined; if (bB && bB.gJ() === true) { bB.showEmptyTextSelection(0); bB.extendTextSelection(undefined); bB.display(); } } }; this.AJ = function () { var bI, aS, bB; bO = null; IPCC.J.forEach(QG, function (G) { bI = aE[G]; aS = document.getElementById(bI.ds); if (aS) { bB = aS.bB; } if (bB) { if (bB.gJ() && bB.Gz()) { bB.showEmptyTextSelection(0); bB.extendTextSelection(undefined); if (bI.ht) { bB.display(); } } } bI = aS = bB = undefined; }); }; this.xW = function (aD, tG) { var bD; var ao; var ahw = function (axx, avD) { return (axx + avD) % 360; }; aE[aD].gh = ahw(aE[aD].gh, tG); if (aE[aD].ds) { bD = document.getElementById(aE[aD].ds); } if (bD === undefined || bD === null) { return; } ao = bD.bB; if (ao && ao.gJ() === false) { aE[aD].Ik = ahw(aE[aD].Ik, tG); return; } un = true; if (ao && ao.gJ() === true) { ao.rotate(tG); } var aJ = 0; var by = 0; var fj = hE; var eN = jg; if (jU(rV) === true) { fj = jg; eN = hE; } if (jU(aE[aD].gh) === true) { if (ao && ao.gJ() === true) { aJ = ao.get_pageHeight(); by = ao.get_pageWidth(); } else { aJ = jg; by = hE; } } else { if (ao && ao.gJ() === true) { aJ = ao.get_pageWidth(); by = ao.get_pageHeight(); } else { aJ = hE; by = jg; } } un = true; if (bZ === IPCC.ViewMode.SinglePage) { bD.style.width = aJ * cq * ed / aE[aD].gS + 'px'; bD.style.height = by * cq * ed / aE[aD].hq + 'px'; if (aD === dp) { an.style.width = aJ * cq * ed / aE[aD].gS + 'px'; an.style.height = by * cq * ed / aE[aD].hq + 'px'; } } else if (bZ === IPCC.ViewMode.Document) { bD.style.width = aJ * cq * ed / aE[aD].gS + 'px'; bD.style.height = by * cq * ed / aE[aD].hq + 'px'; var G = 0; if (ea === IPCC.PageLayout.VerticalScrollDirection) { if (aJ * cq * ed / aE[aD].gS > gV) { gV = aJ * cq * ed / aE[aD].gS; } else if (bD.clientHeight >= gV - 10) { gV = 0; for (G = 0; G < aE.length; G++) { bD = document.getElementById(aE[G].ds); if (bD && bD.clientWidth > gV) { gV = bD.clientWidth; } } } if (by * cq * ed / aE[aD].hq > hl) { hl = by * cq * ed / aE[aD].hq; } } else { if (by * cq * ed / aE[aD].hq > hl) { hl = by * cq * ed / aE[aD].hq; } else if (bD.clientWidth >= hl - 10) { hl = 0; for (G = 0; G < aE.length; G++) { bD = document.getElementById(aE[G].ds); if (bD && bD.clientHeight > hl) { hl = bD.clientHeight; } } } if (aJ * cq * ed / aE[aD].gS > gV) { gV = aJ * cq * ed / aE[aD].gS; } } } else { var ha; if (ea === IPCC.PageLayout.VerticalScrollDirection) { ha = fj / aJ * cq * ed / aE[aD].hq; if (ao && ao.gJ() === true) { ao.zoom(ha); } un = true; bD.style.width = fj * cq * ed / aE[aD].gS + 'px'; bD.style.height = ha * by + 'px'; } else { ha = eN / by * cq * ed / aE[aD].hq; if (ao && ao.gJ() === true) { ao.zoom(ha); } un = true; bD.style.height = eN * cq * ed / aE[aD].hq + 'px'; bD.style.width = ha * aJ + 'px'; } if (fj * cq * ed / aE[aD].gS > gV) { gV = fj * cq * ed / aE[aD].gS; } if (eN * cq * ed / aE[aD].hq > hl) { hl = eN * cq * ed / aE[aD].hq; } } if (ao && ao.gJ() === true) { un = true; this.xl(bD, aD); setTimeout(function () { if (tW === false) { return; } var kQ = Ax(); var lX = IPCC.J.filter(fK, function (el) { return aD === el.bp - 1; }); Bw(lX); lE(lX, true, kQ); }, 0); } }; this.azW = function (tG) { var vs = dp; var cJ = iW(); this.xW(dp, tG); if (bZ !== IPCC.ViewMode.SinglePage) { var K = this; setTimeout(function () { Zj(cJ); K.rU(vs); }, 10); } }; this.agP = function (tG) { var vs = dp; var cJ = iW(); if (bZ !== IPCC.ViewMode.SinglePage) { this.rU(vs); } var ir = 0; var iz = aE.length - 1; var G; for (G = ir; G <= iz; G++) { this.xW(G, tG); } if (bZ !== IPCC.ViewMode.SinglePage) { var K = this; setTimeout(function () { Zj(cJ); K.rU(vs); }, 10); } }; function amE(BE, nL) { var oM = 0; var qJ = 0; var FL = false; un = true; var cJ = iW(); if (cJ) { IPCC.J.forEach(cJ.Lm, function (bj) { var gL = ea === IPCC.PageLayout.VerticalScrollDirection ? bj.cR + eS : bj.ax + ga + ji; var aAK = BE.Lm[bj.dJ]; if (aAK.zx) { FL = true; return; } if (nL && bj.dJ >= nL.fV && bj.dJ <= nL.jc) { var bD = document.getElementById(aE[bj.dJ].ds); if (bD) { return; } } if (FL) { qJ += gL; } else { oM += gL; } }); } return { 'qJ': qJ, 'oM': oM }; }; function Zj(BE) { if (bZ === IPCC.ViewMode.SinglePage) { return; } var nL = VW(BE); var uW = amE(BE, nL); if (ea === IPCC.PageLayout.VerticalScrollDirection) { an.style.paddingTop = uW.oM + 'px'; an.style.paddingBottom = uW.qJ + 'px'; } else { an.style.paddingLeft = uW.oM + 'px'; an.style.paddingRight = uW.qJ + 'px'; } }; function aAp(BE) { if (bZ === IPCC.ViewMode.SinglePage) { return; } var NI; var nL; if (ea === IPCC.PageLayout.VerticalScrollDirection) { NI = parseInt(window.getComputedStyle(an, null).getPropertyValue('padding-top'), 10); } else { NI = parseInt(window.getComputedStyle(an, null).getPropertyValue('padding-left'), 10); } nL = VW(BE); var uW = amE(BE, nL); if (ea === IPCC.PageLayout.VerticalScrollDirection) { an.style.paddingTop = uW.oM + 'px'; an.style.paddingBottom = uW.qJ + 'px'; bA.scrollTop = bA.scrollTop + uW.oM - NI; } else { an.style.paddingLeft = uW.oM + 'px'; an.style.paddingRight = uW.qJ + 'px'; bA.scrollLeft = bA.scrollLeft + uW.oM - NI; } }; this.Fj = function (aD) { IPCC.ad.mL(aD, 'pageIndex', 0, aE.length - 1); var bI = aE[aD]; if (bI && bI.ds && (bI.GD === true || bI.iT === false)) { var ay; var bD = document.getElementById(bI.ds); if (bD.bB) { bD.bB.dispose(); } adT(bD); ay = new IPCC.Web.UI.PageView(bD, false, bA); if (ay) { ay.set_autoUpdate(false); ay.rc(bD); ay.initialize(); ay.set_imageHandlerUrl(bI.bE.np); ay.set_requireRequestsOptimize(pA); if (mk !== undefined) { ay.set_serviceResponseTimeout(mk); } ay.set_scrollBars(IPCC.Web.UI.ScrollBars.None); KT(ay, bI); VQ(ay); LU(ay); Xl(ay); Um(ay); } ay.set_textRequired(wl); ay.set_markHandleMode(wy); ay.set_cursor(-1); ay.set_debug(_debug); ay.set_debugErrorLevel(kx); ay.iA(K.eG()); if (lT) { ay.set_resourcePath(lT); } if (kq) { ay.Nx(kq()); } else { ay.set_mouseTool(IPCC.Web.UI.MouseTool.None); } ay.rq(K.kU()); bI.GD = false; bI.kw = false; var Db = { encodedDocumentIdentifier: bI.bE.get_encodedDocumentIdentifier(), pageNumber: aD, artServiceOption: 0, documentArtPage: bI.eO, viewRotationDegreesClockwise: bI.gh }; if (bI.aX) { Db.artPage = bI.aX; } if (bI.eO) { Db.documentArtPage = bI.eO; } ay.openPage(Db); bI.iT = true; gE++; } }; function Zd(eQ, fA) { if (hE <= 0) { return; } var fj = hE; var eN = jg; var eA = ed / aE[0].gS; if (jU(rV) === true) { fj = jg; eN = hE; eA = ed / aE[0].hq; } var lo = 1; if (ea === IPCC.PageLayout.VerticalScrollDirection) { lo = (bA.clientWidth - yT() - (ga + ji + os + pz)) / (fj * eA); } else { lo = (bA.clientHeight - (eS + kb + qw + sY)) / (eN * eA); } var vr; if (cq <= lo) { vr = false; } else if (cq > lo) { vr = true; } if (isNaN(lo) || lo <= 0 || Math.abs(lo) === Infinity) { return; } cq = lo; gV = 0; hl = 0; var ir = 0; var iz = aE.length - 1; var ar = 0; var ao; for (ar = ir; ar <= iz; ar++, ao = undefined) { var bD = document.getElementById(aE[ar].ds); if (bD) { ao = bD.bB; } if (ao === undefined) { continue; } var aJ = fj; var by = eN; if (aE[ar].ml() > 0) { if (jU(aE[ar].gh) === true) { aJ = aE[ar].pM(); by = aE[ar].ml(); } else { aJ = aE[ar].ml(); by = aE[ar].pM(); } } var ha = 1; if (ea === IPCC.PageLayout.VerticalScrollDirection) { ha = fj / aJ * cq * eA; bD.style.width = fj * cq * eA + 'px'; bD.style.height = by * ha + 'px'; if (fj * cq * eA > gV) { gV = fj * cq * eA; } if (by * ha * ed / aE[ar].hq > hl) { hl = by * ha * eA; } } else { ha = eN / by * cq; bD.style.height = eN * cq * eA + 'px'; bD.style.width = aJ * ha * eA + 'px'; if (aJ * cq * ed / aE[ar].gS > gV) { gV = aJ * cq * eA; } if (eN * ha * eA > hl) { hl = eN * ha * eA; } } if (ao && aE[ar].ht === true && ao.gJ() === true) { ao.zoom(ha); } if (ao && aE[ar].ht === true && ao.gJ() === true) { ao.display(); } ao = undefined; } iW(); mJ(); setTimeout(function () { Bw(fK); lE(fK); }, 0); K.aM('scaleChanged', { scaleType: (vr) ? "scaledDown" : "scaledUp", scaleTrigger: eQ, fitType: fA, scaleFactor: cq }); }; function jU(ce) { switch (ce) { case 90: case 270: case -90: case -270: return true; default: return false; } }; function eK(la) { var uO = document.createElement('div'); var G; for (G in la) { if (la.hasOwnProperty(G)) { uO.style[G] = la[G]; } } return uO; }; this.ZK = function () { if (sM === undefined || sM === null) { sM = 1; } var fg = this.gx().id.toString() + '_' + sM.toString(); sM++; return fg; }; this.ND = function () { return this.jS; }; this.hz = function (abW) { for (var hD = 0; hD < aE.length; hD++) { var dV = aE[hD]; if (abW === dV.bd) { return aE[hD].aX; } } return null; }; function ZO(aB, L) { JA(L); }; function JA(bo) { var bY = bo.imGearDocument; var adn = K.ZK(); bY.st = adn; var dP = bY.get_pages(); var dg = dP.get_length(); if (dg > 0) { var ST = document.createDocumentFragment(); for (var ar = 0; ar < dg; ar++) { var bI = dP.getPage(ar); if (!bI.bE) { bI.bE = bY; } JO(bI, bI.get_pageNumber() === 0 ? null : ST); } an.appendChild(ST); } }; var aty = IPCC.J.ahb(function () { if (KR.length > 0 && ni) { var cO; var LY; var MY = 0; IPCC.J.forEach(KR, ajg); var aqd = iW(); if (!aqd) { return; } var fQ = aqd.Lm; IPCC.J.forEach(KR, function (bI, dJ) { cO = bI.mc(); LY = fQ[cO]; if (ea === IPCC.PageLayout.VerticalScrollDirection) { MY += LY.cR + eS; } else { MY += LY.ax + ga; } }); if (MY && bZ !== IPCC.ViewMode.SinglePage) { if (ea === IPCC.PageLayout.VerticalScrollDirection) { an.style.paddingBottom = MY + 'px'; } else { an.style.paddingRight = MY + 'px'; } } Bw(fK, true); lE(fK, true); if (K.jS.QO(0).eD === aE.length) { K.aM('allPagesAdded'); } mJ(); } KR = []; }, 10); function LP(aB, L) { if (L.imGearPage.get_pageNumber() === 0) { JO(L.imGearPage); return; } KR.push(L.imGearPage); aty(); }; function KQ(aB, L) { var cO = L.imGearPage.get_pageNumber(); var CO = L.imGearPage.bE.get_documentIdentifier(); for (var ar = 0; ar < aE.length; ar++) { if (aE[ar].bd.get_pageNumber() === cO && aE[ar].bd.bE.get_documentIdentifier() === CO) { var bD = document.getElementById(aE[ar].ds); an.removeChild(bD); if (bD.bB) { bD.bB.dispose(); var lX = IPCC.J.filter(fK, function (el) { return el.bp === aE[ar].cO + 1; }); MC(lX); } aE.splice(ar, 1); } } }; function ajg(lA) { if (!IPCC.J.contains(aE, lA)) { var af = new IPCC.af({ page: lA }); if (rV) { af.gh = rV; } if (!af.bE) { af.bE = lA.bE; } aE.push(af); IPCC.Pagecounter++; aE = aE.sort(function (dH, fC) { return dH.cO - fC.cO; }); aug(lA); auA(lA); awd(lA); af.EC = false; af.kw = false; awm(af); avi(af); awx(af); awU(af); avw(af); awu(af); awb(af); awR(af); auM(af); awk(af); return af; } }; function JO(bI, ST) { var RX = bI.get_pageNumber(); var bg = K.gx(); var bY = null; var sT; var dg = K.get_documents().get_length(); for (var aj = 0; aj < dg; aj++) { bY = K.get_documents().getDocument(aj); if (bY !== null) { sT = bY.st; if (sT === bI.bE.st) { break; } } } var hx = IPCC.J.find(aE, function (af) { return af.bd && af.bd === bI; }); if (!hx) { hx = ajg(bI); } hx.GN = true; var alZ = hx.ds; if (hx.xV === 1) { return document.getElementById(alZ); } hx.xV = 1; if (an === '') { ajR(); } var mh = (function () { var bk; if (bZ !== IPCC.ViewMode.SinglePage) { bk = eK({ overflow: 'hidden', position: 'relative' }); } else { bk = eK({ overflow: 'hidden', position: 'absolute', margin: '0px' }); if (hx.cO > dp) { K.ke(bk, 'pccNextPage'); } else if (hx.cO < dp) { K.ke(bk, 'pccPreviousPage'); } else { K.ke(bk, 'pccCurrentPage'); } } sF.push(bI.cO); K.ke(bk, 'pccPageListItem'); adT(bk); var Gw = WK(hx); bk.style.width = Gw.ax + 'px'; bk.style.height = Gw.cR + 'px'; var cJ = iW(); var Rd; if (ea === IPCC.PageLayout.VerticalScrollDirection || bZ === IPCC.ViewMode.SinglePage) { bk.style.display = 'block'; if (hE > 0) { bk.style.margin = eS + 'px auto ' + kb + 'px auto'; } if (cJ.ep.length > 0 && bZ !== IPCC.ViewMode.SinglePage) { Rd = cJ.ep[0]; if (RX < Rd.dJ) { var ayQ = IPCC.J.PF(an, 'padding-top'); var axU = IPCC.J.MA(ayQ); var UZ = axU - Gw.cR - eS; if (UZ < 0) { UZ = 0; } an.style.paddingTop = UZ + 'px'; } else { var aya = IPCC.J.PF(an, 'padding-bottom'); var ayn = IPCC.J.MA(aya); var VU = ayn - Gw.cR - eS; if (VU < 0) { VU = 0; } an.style.paddingBottom = VU + 'px'; } } } else { bk.style.display = 'inline-block'; if (hE > 0) { bk.style.margin = eS + 'px ' + ga + 'px ' + kb + 'px ' + ji + 'px'; } if (cJ.ep.length > 0 && bZ !== IPCC.ViewMode.SinglePage) { Rd = cJ.ep[0]; if (RX < Rd.dJ) { var ayy = IPCC.J.PF(an, 'padding-left'); var ayd = IPCC.J.MA(ayy); var Uz = ayd - Gw.ax - ga; if (Uz < 0) { Uz = 0; } an.style.paddingLeft = Uz + 'px'; } else { var ayG = IPCC.J.PF(an, 'padding-right'); var ayf = IPCC.J.MA(ayG); var VH = ayf - Gw.ax - ga; if (VH < 0) { VH = 0; } an.style.paddingRight = VH + 'px'; } } } bk.setAttribute('id', alZ); return bk; }()); hx.bd = hx.bd || bI; hx.DW = hx.DW || sT; hx.gh = hx.gh !== undefined ? hx.gh : rV; hx.ht = false; function atN(ck) { var BG = ck.childNodes; var aDA = IPCC.J.find(aE, function (af) { if (af.cO <= RX) { return; } var jZ = IPCC.J.find(BG, function (jZ) { return jZ.id && jZ.id === af.ds; }); if (!jZ) { return; } if (af.cO > RX) { jZ.parentElement.insertBefore(mh, jZ); return true; } }); if (!aDA) { ck.appendChild(mh); } } (function aKt() { if (aE.length === 1) { an.appendChild(mh); } else { return atN(ST || an); } }()); var OX = false; if (mh && bg.clientWidth > 0) { var Go = bg.clientWidth / (mh.clientWidth + (mh.clientLeft * 2)); var yf = bg.clientHeight / (mh.clientHeight + (mh.clientTop * 2)); if (aE.length < (Go * yf)) { OX = true; } } if (aE.length < 2) { var ay = new IPCC.Web.UI.PageView(mh, false, bA); if (ay) { ay.set_autoUpdate(false); ay.rc(mh); ay.initialize(); ay.set_imageHandlerUrl(bI.bE.np); ay.set_imGearPage(hx.bd); ay.set_artPage(hx.aX); ay.set_documentArtPage(hx.eO); ay.set_requireRequestsOptimize(pA); if (mk !== undefined) { ay.set_serviceResponseTimeout(mk); } ay.set_scrollBars(IPCC.Web.UI.ScrollBars.None); ay.set_textRequired(wl); ay.set_markHandleMode(wy); ay.set_cursor(-1); ay.set_debug(_debug); ay.set_debugErrorLevel(kx); ay.iA(K.eG()); if (lT) { ay.set_resourcePath(lT); } if (kq) { ay.Nx(kq()); } else { ay.set_mouseTool(IPCC.Web.UI.MouseTool.None); } ay.rq(K.kU()); } KT(ay, hx); LU(ay); Xl(ay); VQ(ay); Um(ay); ay.openPage({ encodedDocumentIdentifier: bI.bE.get_encodedDocumentIdentifier(), pageNumber: bI.get_pageNumber(), artServiceOption: 0, imGearPage: hx.bd, artPage: hx.aX, documentArtPage: hx.eO, viewRotationDegreesClockwise: hx.gh }); hx.iT = true; gE++; } return mh; }; function akm(af) { return af.GN; }; function mJ() { if (gE > 0 || ni === false || ks !== null) { return; } var cJ = iW(); if (!cJ) { return; } aE.forEach(function (bI, dJ) { if (!bI.ht) { return; } K.La(dJ); }); var Cx = aqW(cJ); IPCC.J.forEach(Cx || [], function (dJ) { var bI = aE[dJ]; if (bI) { ahF(bI); } }); IPCC.J.forEach(cJ.ep, function (LY) { var af = aE[LY.dJ]; if (akm(af) && !af.ht && af.xV) { Sn(af); } }); var nL = VW(cJ); for (var dJ = nL.fV; dJ <= nL.jc; dJ++) { var af = aE[dJ]; if (!akm(af)) { af.GN = true; var adc = K.ND(); var bY = adc.QO(0); var lA = bY.dP.jb(dJ); JO(lA); ahd(af, false); } } agf(); }; function aqW(cJ) { var aCG = sN(cJ); var Cx = []; IPCC.J.forEach(aCG, function (dJ) { var bI = aE[dJ]; if (bI && bI.xV === 0) { var adc = K.ND(); var bY = adc.QO(0); var lA = bY.dP.jb(dJ); JO(lA); Cx.push(dJ); } }); return Cx; }; function agf() { var qF = bA.scrollTop; var qd = bA.scrollLeft; var xp = bA.clientHeight; var xi = bA.clientWidth; var vT = bA.scrollWidth; var vZ = bA.scrollHeight; var cJ = UR({ qF: qF, qd: qd, xp: xp, xi: xi, vT: vT, vZ: vZ }); var nL = VW(cJ); var aiz = auS(cJ); var oM = 0; var qJ = 0; var FL = false; IPCC.J.forEach(cJ.Lm, function (bj) { var gL = ea === IPCC.PageLayout.VerticalScrollDirection ? bj.cR + eS : bj.ax + ga + ji; var dJ = +bj.dJ; if (bj.zx || (bZ === IPCC.ViewMode.SinglePage && dJ === dp)) { FL = true; return; } if (dJ >= nL.fV && dJ <= nL.jc) { if (dJ >= aiz.fV && dJ <= aiz.jc) { return; } if (FL) { if (QN(dJ, true) > -1) { qJ += gL; } } else { if (QN(dJ, true) > -1) { oM += gL; } } return; } if (FL) { qJ += gL; QN(dJ); } else { oM += gL; QN(dJ); } }); if (bZ === IPCC.ViewMode.SinglePage) { return; } if (ea === IPCC.PageLayout.VerticalScrollDirection) { an.style.paddingTop = oM + 'px'; an.style.paddingBottom = qJ + 'px'; } else { an.style.paddingLeft = oM + 'px'; an.style.paddingRight = qJ + 'px'; } }; function QN(ar, axX) { var bI = aE[ar]; if (!bI) { return -1; } var cO = bI.cO; if (axX === true && !bI.ht) { return -1; } bI.kw = false; bI.iT = false; bI.ht = false; bI.xV = 0; bI.GN = false; if (Sp && !bI.bd.cv().ata() && QU !== true) { bI.bd.ajp(); } var DS = document.getElementById(bI.ds); if (!DS) { return -1; } if (DS.bB) { DS.bB.dispose(); var lX = IPCC.J.filter(fK, function (el) { return el.bp === cO + 1; }); MC(lX); DS.parentElement.removeChild(DS); return ar; } else { DS.parentElement.removeChild(DS); } return -1; }; function Sn(af) { var bk = document.getElementById(af.ds); K.xl(bk, af.cO); }; function ahF(af) { ahd(af, true); Sn(af); }; function ahd(bI, aEz) { var bk = document.getElementById(bI.ds); if (bk === null) { return; } var ay = new IPCC.Web.UI.PageView(bk, false, bA); ay.set_autoUpdate(false); ay.rc(document.getElementById(bI.ds)); ay.initialize(); ay.set_imageHandlerUrl(bI.bE.np); ay.set_imGearPage(bI.bd); ay.set_artPage(bI.aX); ay.set_requireRequestsOptimize(pA); if (mk !== undefined) { ay.set_serviceResponseTimeout(mk); } ay.set_scrollBars(IPCC.Web.UI.ScrollBars.None); ay.set_textRequired(wl); ay.set_markHandleMode(wy); ay.set_cursor(-1); ay.set_debug(_debug); ay.set_debugErrorLevel(kx); ay.iA(K.eG()); if (lT) { ay.set_resourcePath(lT); } if (kq) { ay.Nx(kq()); } else { ay.set_mouseTool(IPCC.Web.UI.MouseTool.None); } ay.rq(K.kU()); KT(ay, bI); LU(ay); Xl(ay); VQ(ay); Um(ay); if (aEz === true) { ay.add_pageOpened(function aJe(au) { K.xl(bk, bI.cO); }); } if (bI.kw === false && bI.bd) { bI.GN = true; var Db = { encodedDocumentIdentifier: bI.bd.bE.get_encodedDocumentIdentifier(), pageNumber: bI.bd.get_pageNumber(), imGearPage: bI.bd, viewRotationDegreesClockwise: bI.gh }; if (bI.aX) { Db.artPage = bI.aX; } if (bI.eO) { Db.documentArtPage = bI.eO; } ay.openPage(Db); bI.iT = true; gE++; } }; function anc(aX, ij) { var ai; aX.forEachMark(function (R) { switch (R.get_type()) { case IPCC.Web.UI.MarkType.Line: var ag = R.get_points(); var be = ag.Bq(0); var jV = ag.Bq(1); ag.setPoint(0, new IPCC.Web.UI.Point(be.x * ij, be.y * ij)); ag.setPoint(1, new IPCC.Web.UI.Point(jV.x * ij, jV.y * ij)); break; case IPCC.Web.UI.MarkType.Text: case IPCC.Web.UI.MarkType.Rectangle: case IPCC.Web.UI.MarkType.RectangleRedaction: case IPCC.Web.UI.MarkType.Ellipse: case IPCC.Web.UI.MarkType.Stamp: case IPCC.Web.UI.MarkType.ImageStampAnnotation: case IPCC.Web.UI.MarkType.ImageStampRedaction: case IPCC.Web.UI.MarkType.RectangleRedaction: case IPCC.Web.UI.MarkType.Freehand: case IPCC.Web.UI.MarkType.SignaturePath: case IPCC.Web.UI.MarkType.SignatureText: case IPCC.Web.UI.MarkType.TextLine: case IPCC.Web.UI.MarkType.TextAreaSignature: case IPCC.Web.UI.MarkType.TextSelectionRedaction: ai = R.get_rectangle(); R.set_rectangle({ x: ai.x * ij, y: ai.y * ij, width: ai.width * ij, height: ai.height * ij }); break; case IPCC.Web.UI.MarkType.HighlightText: case IPCC.Web.UI.MarkType.TextHyperlinkAnnotation: case IPCC.Web.UI.MarkType.Strikethrough: ai = R.get_rectangle(); R.set_rectangle({ x: ai.x * ij, y: ai.y * ij, width: ai.width * ij, height: ai.height * ij }); var bV = R.bV, gR; for (var i = 0; i < bV.length; i++) { gR = bV[i]; gR.x = gR.x * ij; gR.y = gR.y * ij; gR.width = gR.width * ij; gR.height = gR.height * ij; } break; default: break; } }); }; function KT(ay, bI) { function Yf(sender, evnt) { var aoD = function (ax, cR, bp) { var YO = { 'width': ax, 'height': cR, 'pageNumber': bp }; K.aM('pageOpening', YO); }; var cO = evnt.pageNumber; var CO = evnt.documentIdentifier; bI.aJ = ay.get_pageWidth(); bI.by = ay.get_pageHeight(); var hi = ay.get_pageXResolution(); var hk = ay.get_pageYResolution(); if (!isNaN(parseFloat(hi)) && isFinite(hi)) { bI.gS = hi; } if (!isNaN(parseFloat(hk)) && isFinite(hk)) { bI.hq = hk; } ay = null; for (var ar = 0; ar < aE.length; ar++) { if (ni && aE[ar].bd.get_pageNumber() === cO && aE[ar].bd.bE.get_documentIdentifier() === CO) { aE[ar].iT = false; aE[ar].kw = true; aE[ar].GD = false; if (bZ === IPCC.ViewMode.SinglePage) { var ph = -1; if (Array.prototype.indexOf) { ph = sF.indexOf(ar); } else { ph = IPCC.Web.hK(sF, ar); } if (ph !== -1) { sF.splice(ph, 1); } } var aom = false; for (var aj = 0; aj < QG.length; aj++) { if (QG[aj] === ar) { aom = true; } } if (aom === false) { QG.push(ar); } var mo = 0; var lJ = 0; var bD = document.getElementById(aE[ar].ds); var ao = bD.bB; var fj; var eN; var Vq; if (hE === 0 && (ar === 0 || aE[0].GD === true)) { if (bD.currentStyle) { qw = parseInt(bD.currentStyle.borderTopWidth, 10) || 0; eS = parseInt(bD.currentStyle.marginTop, 10) || 0; os = parseInt(bD.currentStyle.borderLeftWidth, 10) || 0; ga = parseInt(bD.currentStyle.marginLeft, 10) || 0; sY = parseInt(bD.currentStyle.borderBottomWidth, 10) || 0; kb = parseInt(bD.currentStyle.marginBottom, 10) || 0; pz = parseInt(bD.currentStyle.borderRightWidth, 10) || 0; ji = parseInt(bD.currentStyle.marginRight, 10) || 0; } else if (document.defaultView && document.defaultView.getComputedStyle) { var zj = document.defaultView.getComputedStyle(bD); qw = parseInt(zj.borderTopWidth, 10) || 0; eS = parseInt(zj.marginTop, 10) || 0; os = parseInt(zj.borderLeftWidth, 10) || 0; ga = parseInt(zj.marginLeft, 10) || 0; sY = parseInt(zj.borderBottomWidth, 10) || 0; kb = parseInt(zj.marginBottom, 10) || 0; pz = parseInt(zj.borderRightWidth, 10) || 0; ji = parseInt(zj.marginRight, 10) || 0; } if (bZ === IPCC.ViewMode.SinglePage) { bD.style.margin = eS + 'px 0px ' + kb + 'px 0px'; an.style.margin = "0px auto"; } else { if (ea === IPCC.PageLayout.VerticalScrollDirection) { bD.style.margin = eS + 'px auto ' + kb + 'px auto'; } else { bD.style.margin = eS + 'px ' + ji + 'px ' + kb + 'px ' + ga + 'px'; an.style.margin = '0px ' + ji + 'px 0px ' + ga + 'px'; } } hE = ao.get_pageWidth(); jg = ao.get_pageHeight(); aky = hi; fj = hE; eN = jg; var eA = ed / aE[ar].gS; if (jU(aE[ar].gh) === true) { eN = hE; fj = jg; eA = ed / aE[ar].hq; } K.arr(); if (bZ === IPCC.ViewMode.SinglePage) { var atq = (bA.offsetWidth - (ga + ji + os + pz)); var auH = (bA.offsetHeight - (eS + kb + qw + sY + amk)); rf = atq / (fj * eA); Vq = auH / (eN * eA); if (Vq < rf) { rf = Vq; } ao.zoom(rf * eA); } else if (ea === IPCC.PageLayout.VerticalScrollDirection) { rf = (bA.offsetWidth - IPCC.Web.pI() - (ga + ji + os + pz)) / (fj * eA); ao.zoom(rf * eA); } else { rf = (bA.offsetHeight - IPCC.Web.pI() - (eS + kb + qw + sY)) / (eN * eA); ao.zoom(rf * eA); } mo = fj * rf * eA; lJ = eN * rf * eA; bD.style.width = mo + 'px'; bD.style.height = lJ + 'px'; if (bZ === IPCC.ViewMode.SinglePage) { an.style.width = mo + 'px'; an.style.height = lJ + 'px'; } if (bZ !== IPCC.ViewMode.SinglePage) { for (var hD = 0; hD < aE.length; hD++) { if (aE[hD].ht === false && hD !== ar) { if (aE[hD].ds) { bD = document.getElementById(aE[hD].ds); bD.style.width = fj * rf + 'px'; bD.style.height = eN * rf + 'px'; if (ea === IPCC.PageLayout.VerticalScrollDirection) { bD.style.margin = eS + 'px auto ' + kb + 'px auto'; } else { bD.style.margin = eS + 'px ' + ji + 'px ' + kb + 'px ' + ga + 'px'; } } } } } cq = rf; aoD(bI.aJ, bI.by, cO + 1); bD.bB.display(); } else { if (bZ === IPCC.ViewMode.Document || bZ === IPCC.ViewMode.SinglePage) { if (jU(aE[ar].gh) === true) { mo = ao.get_pageHeight() * cq * ed / aE[ar].gS; lJ = ao.get_pageWidth() * cq * ed / aE[ar].hq; } else { mo = ao.get_pageWidth() * cq * ed / aE[ar].gS; lJ = ao.get_pageHeight() * cq * ed / aE[ar].hq; } } else { var ha; var aJ = ao.get_pageWidth(); var by = ao.get_pageHeight(); fj = hE; eN = jg; if (jU(rV) === true) { fj = jg; eN = hE; } if (jU(aE[ar].gh) === true) { aJ = ao.get_pageHeight(); by = ao.get_pageWidth(); } if (ea === IPCC.PageLayout.VerticalScrollDirection) { ha = fj / aJ * cq * ed / aE[0].hq; mo = fj * cq * ed / aE[0].gS; lJ = by * ha; } else { ha = eN / by * cq * ed / aE[0].gS; lJ = eN * cq * ed / aE[0].hq; mo = aJ * ha; } } if (mo !== Math.round(mo)) { mo = Math.floor(mo * 100) / 100; } if (lJ !== Math.round(lJ)) { lJ = Math.floor(lJ * 100) / 100; } if (bD.style.width !== mo + 'px' || bD.style.height !== lJ + 'px') { if (ea === IPCC.PageLayout.VerticalScrollDirection) { bD.style.width = mo + 'px'; bD.style.height = lJ + 'px'; } else { bD.style.width = mo + 'px'; bD.style.height = lJ + 'px'; } Bw(fK, true); lE(fK, true); } aoD(bI.aJ, bI.by, cO + 1); } if (mo > gV) { gV = mo; if (ea === IPCC.PageLayout.VerticalScrollDirection) { bA.scrollLeft = (gV - bA.clientWidth) / 2; } } if (lJ > hl) { hl = lJ; if (ea === IPCC.PageLayout.HorizontalScrollDirection) { bA.scrollTop = (hl - bA.clientHeight) / 2; } } if (aE[ar].Ik > 0) { var XB = document.getElementById(aE[ar].ds).bB; if (XB) { XB.rotate(aE[ar].Ik); XB.display(); aE[ar].Ik = 0; } } if (gE > 0) { gE = gE - 1; } if (aE[ar].agW() === true) { var lA = aE[ar].bd; var ij = aE[ar].ml() / lA.alc(); if (ij !== 1) { var aX = K.hz(lA); if (aX) { anc(aX, ij); } } } aE[ar].YQ(false); iW(); var MU = new IPCC.OpenPageEventArgs(); MU.pageIndex = evnt.pageNumber; MU.imGearPage = evnt.imGearPage; MU.viewRotationDegreesClockwise = evnt.viewRotationDegreesClockwise; MU.pageNodeID = aE[ar].ds; K.aM('pageOpened', MU); break; } } if (gE === 0 && nP === null && ks === null) { setTimeout(function () { mJ(); }, 60); } }; ay.add_pageOpened(Yf); }; function LU(ay) { function aEZ(aB, bx) { if (ni === false) { return; } var zF; if (bx.pageNumber >= 0) { if (aE[bx.pageNumber].ds) { zF = aE[bx.pageNumber].ds; } } aE[bx.pageNumber].GD = true; aE[bx.pageNumber].iT = false; aE[bx.pageNumber].kw = false; aE[bx.pageNumber].ht = false; var nG = new IPCC.ExceptionEventArgs(); nG.exception = bx.exception; nG.pageIndex = bx.pageNumber; nG.pageNodeID = zF; K.aM('pageOpenFailed', nG); if (gE > 0) { gE = gE - 1; if (gE === 0) { setTimeout(function () { mJ(); }, 60); } } }; ay.add_pageOpenFailed(aEZ); }; function Xl(ay) { function aFa(aB, bx) { if (ni === false) { return; } var L = new IPCC.PageEventArgs(); L.pageIndex = bx.bp; L.imGearPage = aE[bx.bp].bd; L.pageNodeID = aE[bx.bp].ds; aE[bx.bp].ht = true; if (bZ === IPCC.ViewMode.SinglePage) { var ph = -1; if (Array.prototype.indexOf) { ph = sF.indexOf(bx.bp); } else { ph = IPCC.Web.hK(sF, bx.bp); } if (ph !== -1) { sF.splice(ph, 1); } } K.aM('pageDisplayed', L); setTimeout(function () { var lX = IPCC.J.filter(fK, function (el) { if (bZ === IPCC.ViewMode.SinglePage) { return bx.bp === el.bp - 1 && el.bp - 1 === dp; } else { return bx.bp === el.bp - 1; } }); Bw(lX); lE(lX); }, 0); }; ay.add_pageDisplayed(aFa); }; function auA(bI) { function Or(aB, bx) { if (ni === false) { return; } K.aM('textPageReady', { pageIndex: bx.pageNumber, containsText: bx.containsText }); var cJ = iW(); var cc = []; if (cJ) { cc = sN(cJ); } if (bx.containsText === true && bx.pageNumber >= cc[0] && bx.pageNumber <= cc[cc.length - 1]) { if (aE[bx.pageNumber].aX && aE[bx.pageNumber].aX.get_markCount() > 0) { var bD = document.getElementById(aE[bx.pageNumber].ds); K.xl(bD, bx.pageNumber); } } }; bI.xq(Or); }; function awd(bI) { function aFZ(aB, bx) { if (ni === false) { return; } var eO = aE[bx.pageNumber].eO; bI.ajz().GX().mR(function (iH) { var R = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.DocumentHyperlink), ai = iH.fD(); R.set_rectangle(new IPCC.Web.UI.Rectangle(ai.x, ai.y, ai.width, ai.height)); R.set_href(iH.ajk()); R.set_lineColor(iH.avh()); R.set_lineWidth(iH.arJ()); R.set_borderPattern(iH.arA()); R.set_borderType(iH.asg()); R.set_borderHorizontalRadius(iH.atA()); R.set_borderVerticalRadius(iH.atj()); R.set_borderOpacity(iH.auQ()); eO.addMark(R); iH.aIv(R); }); K.aM('hyperlinkPageReady', { pageIndex: bx.pageNumber }); var cJ = iW(); var cc = []; if (cJ) { cc = sN(cJ); } if (bx.pageNumber >= cc[0] && bx.pageNumber <= cc[cc.length - 1]) { var bD = document.getElementById(aE[bx.pageNumber].ds); K.xl(bD, bx.pageNumber); } }; bI.Xy(aFZ); }; function aug(bI) { function NJ(aB, bx) { if (ni === false) { return; } var zF; if (bx.pageNumber >= 0) { if (aE[bx.pageNumber].ds) { zF = aE[bx.pageNumber].ds; } } K.aM('textExtractionFailed', { 'exception': bx.exception, 'pageIndex': bx.pageNumber, 'pageNodeID': zF }); }; bI.Cg(NJ); }; function VQ(ay) { function aFl(aB, bx) { if (ni === false) { return; } var zF; if (isNaN(bx.pageNumber) === false) { if (bx.pageNumber >= 0) { if (aE[bx.pageNumber].ds) { zF = aE[bx.pageNumber].ds; } } aE[bx.pageNumber].GD = true; aE[bx.pageNumber].iT = false; aE[bx.pageNumber].kw = false; aE[bx.pageNumber].ht = false; } var nG = new IPCC.ExceptionEventArgs(); nG.functionName = bx.function_name; nG.exception = bx.exception; nG.pageIndex = bx.pageNumber; nG.pageNodeID = zF; K.aM('exceptionThrown', nG); if (gE > 0) { gE = gE - 1; if (gE === 0) { setTimeout(function () { mJ(); }, 60); } } }; ay.add_exceptionThrown(aFl); }; function Um(ay) { function Mn(aB, bx) { K.aM('markCreating', bx); }; ay.add_markCreating(Mn); }; function awm(af) { function alB() { if (ni === false) { return; } var cJ = iW(); var cc = []; if (cJ) { cc = sN(cJ); } if (af.cO >= cc[0] && af.cO <= cc[cc.length - 1]) { var bD = document.getElementById(af.ds); K.xl(bD, af.cO); } var L = new IPCC.Web.UI.MarkEventArgs(); L.pageIndex = af.cO; K.aM('marksLoaded', L); }; af.aX.add_marksLoaded(alB); }; function avi(af) { function ld(aB, bx) { var L = new IPCC.Web.UI.MarkEventArgs(); L.pageIndex = af.cO; L.mark = bx.mark; L.zIndex = bx.zIndex; L.clientX = bx.clientX; L.clientY = bx.clientY; K.aM('markAdded', L); }; af.aX.add_markAdded(ld); }; function awx(af) { var abO, tx = false, adC, acy; function Kp(H, ej) { if (tW === false) { return; } var kQ = Ax(); amR(H, ej, kQ); lE(fK, true, kQ); }; function aCB(H, ej) { adC = H; acy = ej; if (tx && !abO) { abO = Ks(function () { tx = false; abO = undefined; if (adC && acy) { Kp(adC, acy); } else { Kp(H, ej); } }); } }; function sZ(aB, bx) { if (bx.mark.za === true) { return; } var L = new IPCC.Web.UI.MarkEventArgs(); L.pageIndex = af.cO; L.mark = bx.mark; L.zIndex = bx.zIndex; L.propertyName = bx.propertyName; K.aM('markChanged', L); var ej = fK[bx.mark.get_markID()]; if (ej && (bx.propertyName === 'rectangle' || bx.propertyName === 'points' || bx.propertyName === 'startPoint' || bx.propertyName === 'endPoint')) { tx = true; aCB(bx.mark, ej); } else if (ej && bx.propertyName === 'visible') { var aAQ = bx.mark.get_visible(); var Yr = (function (dk) { return IPCC.J.inArray(Ri(), dk.bp - 1); })(ej); if (aAQ && Yr) { Uu([ej]); lE(fK, true, Ax()); } else { MC([ej]); } } }; af.aX.add_markChanged(sZ); }; function awU(af) { function alb(aB, bx) { var L = new IPCC.Web.UI.MarkEventArgs(); L.pageIndex = af.cO; L.mark = bx.mark; L.zIndex = bx.zIndex; L.oldZIndex = bx.oldZIndex; K.aM('markReordered', L); }; af.aX.add_markReordered(alb); }; function avw(af) { function Ev(aB, bx) { if (bx.mark.za === true) { return; } var L = new IPCC.Web.UI.MarkEventArgs(); L.pageIndex = af.cO; L.mark = bx.mark; L.zIndex = bx.zIndex; K.aM('markSelectionChanged', L); }; af.aX.add_markSelectionChanged(Ev); }; function awb(af) { function Ed(aB, bx) { if (bx.mark) { var L = new IPCC.Web.UI.MarkEventArgs(); L.pageIndex = af.cO; L.mark = bx.mark; L.zIndex = bx.zIndex; K.aM('markRemoved', L); var ej = fK[bx.mark.get_markID()]; if (ej) { if (bx.mark.get_conversation() === ik) { ik = null; } ej.dR.parentElement.removeChild(ej.dR); delete fK[bx.mark.get_markID()]; lE(fK, true); } } }; af.aX.add_markRemoved(Ed); }; function awu(af) { function zK(aB, bx) { var L = new IPCC.Web.UI.MarkEventArgs(); L.pageIndex = af.cO; L.mark = bx.mark; L.zIndex = bx.zIndex; K.aM('markTextSelectionChanged', L); }; af.aX.add_markTextSelectionChanged(zK); }; function amR(H, ej, Sg) { var af = aE[ej.bp - 1], bI = document.getElementById(af.ds), Ft = VZ(H, af.cO + 1); if (bI.bB) { var fL = bI.bB.transformPagePointToWindow(new IPCC.Web.UI.Point(Ft.x, Ft.y), true); var qz = (eS * af.cO); var Kq = (bI.offsetTop - qz + fL.y) / (Sg - (eS * aE.length)); ej.ai = Ft; ej.aaQ = Kq; } }; function MC(kl, bp) { var aEt = typeof bp === 'undefined'; IPCC.J.forEach(kl, function (bL) { if (bL && (aEt || bL.pageNumber === bp)) { bL.dR.style.display = 'none'; bL.zx = false; } }); }; function yT() { if (mf.currentStyle && mf.currentStyle.display === 'none') { return 0; } return mf.clientWidth; }; function Ax() { if (mf.currentStyle && mf.currentStyle.display === 'none') { return 0; } return mf.offsetHeight; }; function Uu(kl, bp) { var aGw = typeof bp === 'undefined'; IPCC.J.forEach(kl, function (el) { if (aGw || el.pageNumber === bp) { el.dR.style.display = ''; el.zx = true; if (el && el.R && el.R.get_visible() === false) { el.dR.style.display = 'none'; el.zx = false; } } }); }; function Bw(kl, aaf) { if (tW === false) { return; } var TA = (! !aaf) ? IPCC.J.filter(fK, function (dk) { return IPCC.J.contains(Ri(), dk.bp - 1); }) : kl; var kQ = Ax(); IPCC.J.forEach(TA, function (el) { amR(el.R, el, kQ); }); }; function aBv(a, b) { return (a.ai.y !== b.ai.y) ? (a.ai.y - b.ai.y) : (a.ai.x !== b.ai.x) ? (a.ai.x - b.ai.x) : (a.Ao - b.Ao); }; function aBJ(a, b) { return (a.ai.x !== b.ai.x) ? (a.ai.x - b.ai.x) : (a.ai.y !== b.ai.y) ? (b.ai.y - a.ai.y) : (a.Ao - b.Ao); }; function aAZ(a, b) { return (a.ai.y !== b.ai.y) ? (b.ai.y - a.ai.y) : (a.ai.x !== b.ai.x) ? (b.ai.x - a.ai.x) : (a.Ao - b.Ao); }; function aCn(a, b) { return (a.ai.x !== b.ai.x) ? (b.ai.x - a.ai.x) : (a.ai.y !== b.ai.y) ? (a.ai.y - b.ai.y) : (a.Ao - b.Ao); }; function azE(ZS, kQ, Aj) { Aj = Aj || 0; var _top, aoO, NX, Vi = (eS * aE.length), VT = kQ - Vi; IPCC.J.forEach(ZS, function (dk) { NX = (eS * (dk.bp - 1)); aoO = (dk.aaQ * VT) + NX; _top = Math.max(Aj + 5, aoO); if (dk.dR.style.top !== _top + 'px') { dk.dR.style.top = _top + 'px'; } Aj = _top + dk.adf; }); }; function azF(ZS, kQ) { var TY, _top, PK, NX, aoA, Vi = (eS * aE.length), VT = kQ - Vi; IPCC.J.forEach(ZS, function (dk) { NX = (eS * (dk.bp - 1)); PK = (dk.aaQ * VT) + NX; if (TY === undefined) { TY = PK; } if (dk.R.get_conversation() === ik) { _top = PK; aoA = _top + dk.adf; } else { _top = Math.min(TY - 5 - dk.adf, PK); } if (dk.dR.style.top !== _top + 'px') { dk.dR.style.top = _top + 'px'; } TY = _top; }); return aoA; }; function lE(kl, aaf, kQ) { if (tW === false) { return; } if (!kQ) { kQ = Ax(); } var aGx = function (a, b) { if (a.bp !== b.bp) { return (a.bp - b.bp); } var bI = aE[a.bp - 1], ce = bI.gh; switch (ce) { case 90: return aBJ(a, b); case 180: return aAZ(a, b); case 270: return aCn(a, b); default: return aBv(a, b); } }; var TA = (! !aaf) ? IPCC.J.filter(fK, function (dk) { return IPCC.J.inArray(Ri(), dk.bp - 1); }) : kl; Uu(TA); var ayl = IPCC.J.map(TA, function (dk, aq) { dk.adf = dk.dR.offsetHeight; return dk; }); var Zf = ayl.sort(aGx); var TP = [], acZ = [], YG = false; if (ik) { var aAd = fK[ik.get_mark().get_markID()]; if (!IPCC.J.inArray(Zf, aAd)) { YG = true; } IPCC.J.forEach(Zf, function (dk) { if (YG) { acZ.push(dk); } else if (dk.R.get_conversation() === ik) { TP.unshift(dk); YG = true; } else { TP.unshift(dk); } }); } else { acZ = Zf; } var Aj = 0; if (TP.length) { Aj = azF(TP, kQ); } azE(acZ, kQ, Aj); }; function aEb(kl, H, cO) { var dk = kl[H.jf()]; dk.bp = cO; dk.R = H; dk.ai = VZ(H, cO); dk.Ao = H.eI().qW(H); }; function Eh(H, kl, me) { var ej = kl[H.get_markID()]; if (ej) { ej.dR.parentElement.replaceChild(me, ej.dR); ej.dR = me; } return ej; }; function ava(H, kl, me, aFw, aHy, Kq, cO) { var ej = new IPCC.ej(); ej.dR = me; fK[H.get_markID()] = ej; aEb(fK, H, cO); ej.aaQ = Kq; aFw.appendChild(me); return ej; }; function VZ(H, bp) { var ai = (H.get_boundingRectangle) ? H.get_boundingRectangle() : {}, ce = aE[bp - 1].gh; switch (ce) { case 90: return { x: ai.x, y: ai.y + (ai.height || 0) }; case 180: return { x: ai.x + (ai.width || 0), y: ai.y + (ai.height || 0) }; case 270: return { x: ai.x + (ai.width || 0), y: ai.y }; default: return { x: ai.x, y: ai.y }; } }; function awR(af) { function Tu(aB, bx) { var L = new IPCC.Web.UI.CommentEventArgs(); L.pageIndex = af.cO; L.mark = bx.mark; L.index = bx.index; L.comment = bx.comment; var bI = document.getElementById(af.ds); K.aM('commentAdding', L); setTimeout(function () { var Sg = Ax(), ej, dR; if (bx.index === 0) { dR = pE(bx.mark, { isSelected: false }, null); if (!dR) { return; } else if (!IPCC.J.yP(dR)) { throw new Error(dR + ' is not a valid HTMLElement'); } var Ft = VZ(bx.mark, af.cO + 1), arG = Ft.x, aFD = Ft.y; var fL; if (bI && bI.bB) { fL = bI.bB.transformPagePointToWindow(new IPCC.Web.UI.Point(arG, aFD), true); } else { fL = new IPCC.Web.UI.Point(0, 0); } var qz = (eS * (af.cO)); var Kq = (agE(af.cO) - qz + fL.y) / (Sg - (eS * aE.length)); ej = ava(bx.mark, fK, dR, mf, fL, Kq, af.cO + 1); } else { var gH = bx.mark.get_conversation() === ik; var currentConversationDiv = fK[bx.mark.get_markID()]; if (!currentConversationDiv) { return; } dR = pE(bx.mark, { isSelected: gH }, currentConversationDiv.dR); if (!dR) { return; } else if (!IPCC.J.yP(dR)) { throw new Error(dR + ' is not a valid HTMLElement'); } ej = Eh(bx.mark, fK, dR); } if (IPCC.J.contains(Ri(), af.cO)) { lE(fK, true, Sg); } else { MC([ej]); } K.aM('commentAdded', L); }, 0); }; af.aX.add_commentAdded(Tu); }; function auM(af) { function Sx(aB, bx) { var dR = null; if (fK[bx.mark.get_markID()]) { dR = fK[bx.mark.get_markID()].dR; var gH = bx.mark.get_conversation() === ik; dR = pE(bx.mark, { isSelected: gH }, dR); } if (!dR) { K.aM('commentChanged', bx); return; } else if (!IPCC.J.yP(dR)) { throw new Error(dR + ' is not a valid HTMLElement'); } if (dR) { var kQ = Ax(); Eh(bx.mark, fK, dR); lE(fK, true, kQ); } K.aM('commentChanged', bx); }; af.aX.add_commentChanged(Sx); }; function awk(af) { function Uc(aB, bx) { var dR = null; if (fK[bx.mark.get_markID()]) { dR = fK[bx.mark.get_markID()].dR; } var gH = bx.mark.get_conversation() === ik; dR = pE(bx.mark, { isSelected: gH }, dR); if (IPCC.J.yP(dR)) { Eh(bx.mark, fK, dR); } else { var ej = fK[bx.mark.get_markID()]; if (ej) { if (bx.mark.get_conversation() === ik) { ik = null; } ej.dR.parentElement.removeChild(ej.dR); delete fK[bx.mark.get_markID()]; } } lE(fK, true); K.aM('commentRemoved', bx); }; af.aX.add_commentRemoved(Uc); }; function Vo() { var cR = jg; var ax = hE; var aFc = function (jX) { return { width: jX.width || (jX.right - jX.left), height: jX.height || (jX.bottom - jX.top), top: jX.top, bottom: jX.bottom, left: jX.left, right: jX.right }; }; var aiu = aFc(bA.getBoundingClientRect()); var oi = { height: aiu.height / 2 }; oi.width = oi.height * ax / cR; if (oi.width > ax / 2) { oi.width = ax / 2; } if (oi.height > cR / 2) { oi.height = cR / 2; } var adE = 8; var amD = { height: cR * adE, width: ax * adE }; var avP = ax * cq < oi.width + 5; var avo = ax * cq > amD.width - 5; return { min: oi, max: amD, page: { width: ax, height: cR }, viewport: aiu, atMin: avP, atMax: avo, maxFactor: adE, minFactor: oi.width / ax }; }; function kD(ab, Vd) { if (Vd) { afm.apply(this, arguments); return; } var vr = (ab < cq) ? true : false; var qA = Vo(); if ((qA.atMin && vr) || (qA.atMax && !vr)) { return; } if (ab > qA.maxFactor) { ab = qA.maxFactor; } else if (ab < qA.minFactor) { ab = qA.minFactor; } if (!qA.atMax || !qA.atMin) { afm.apply(this, arguments); } }; function afm(ab, aIS, aY, fJ, It, zH, eQ, fA) { if (isNaN(ab) || ab <= 0 || Math.abs(ab) === Infinity) { return; } var Wa = dp; var cJ = iW(); var vr = (ab < cq) ? true : false; var ir = 0; var iz = aE.length - 1; if (bZ === IPCC.ViewMode.SinglePage) { if (dp - vu >= 0) { ir = dp - vu; } if (dp + vu < aE.length - 1) { iz = dp + vu; } } var Tg = ab / cq; cq = ab; var Ec = bA.getBoundingClientRect(); var aiF = (zH && zH.x !== undefined) ? zH.x : bA.scrollLeft + (Ec.width / 2); var ahP = (zH && zH.y !== undefined) ? zH.y : bA.scrollTop + (Ec.height / 2); gV = 0; hl = 0; for (var ar = ir; ar <= iz; ar++) { var ao; var bD = document.getElementById(aE[ar].ds); if (bD) { ao = bD.bB; } else { continue; } if (ar === Wa) { var QA = bD.getBoundingClientRect(); if (ea === IPCC.PageLayout.HorizontalScrollDirection && Ec.height > QA.height) { ahP -= ((Ec.height - QA.height) / 2); } else if (ea === IPCC.PageLayout.VerticalScrollDirection && Ec.width > QA.width) { aiF -= ((Ec.width - QA.width) / 2); } } var iZ = ab * ed / aE[ar].gS; var aJ = hE; var by = jg; var fj = hE; var eN = jg; if (jU(rV) === true) { fj = jg; eN = hE; } if (aE[ar].ml() > 0) { if (jU(aE[ar].gh) === true) { aJ = aE[ar].pM(); by = aE[ar].ml(); } else { aJ = aE[ar].ml(); by = aE[ar].pM(); } } else { iZ = ab * ed / aE[0].gS; if (jU(aE[ar].gh) === true) { var Ob = aJ; aJ = by; by = Ob; iZ = ab * ed / aE[0].hq; } } var IT, JW, ha; if (bZ === IPCC.ViewMode.SinglePage) { JW = aJ * iZ; IT = by * iZ; bD.style.width = JW + 'px'; bD.style.height = IT + 'px'; if (ar === dp) { an.style.width = JW + 'px'; an.style.height = IT + 'px'; } if (ao && aE[ar].ht === true && ao.gJ() === true) { ao.zoom(iZ); } } else if (bZ === IPCC.ViewMode.Document) { JW = aJ * iZ; IT = by * iZ; bD.style.width = JW + 'px'; bD.style.height = IT + 'px'; if (ao && aE[ar].ht === true && ao.gJ() === true) { ao.zoom(iZ); } if (aJ * iZ > gV) { gV = aJ * iZ; } if (by * iZ > hl) { hl = by * iZ; } } else { iZ = ab * ed / aE[0].gS; if (ea === IPCC.PageLayout.VerticalScrollDirection) { ha = fj / aJ * iZ; bD.style.width = fj * iZ + 'px'; bD.style.height = by * ha + 'px'; if (fj * iZ > gV) { gV = fj * iZ; } if (by * iZ > hl) { hl = by * iZ; } } else { ha = eN / by * iZ; bD.style.height = eN * iZ + 'px'; bD.style.width = aJ * ha + 'px'; if (aJ * iZ > gV) { gV = aJ * iZ; } if (eN * iZ > hl) { hl = eN * iZ; } } if (ao && aE[ar].ht === true && ao.gJ() === true) { ao.zoom(ha); } } if (ao && aE[ar].ht === true && ao.gJ() === true) { ao.display(); if (IPCC.J.LK.SY) { var axu = bA.style.display; bA.style.display = 'none'; bA.style.display = axu; avW(); } } } if (ea === IPCC.PageLayout.VerticalScrollDirection) { SU = bA.scrollTop; } else { SU = bA.scrollLeft; } var Tp, Sz, Pa = 0, Qc = 0; if (It) { Tp = It.offsetLeft + Tg * aY; Sz = It.offsetTop + Tg * fJ; bA.scrollLeft = Tp - (bA.clientWidth / 2) + Pa; bA.scrollTop = Sz - (bA.clientHeight / 2) + Qc; aAp(cJ); } else { if (ea === IPCC.PageLayout.VerticalScrollDirection) { Qc = eS * (Wa); } else { Pa = (ga + ji) * (Wa); } Tp = Tg * (aiF - Pa); Sz = Tg * (ahP - Qc); Zj(cJ); bA.scrollLeft = Tp - (bA.clientWidth / 2) + Pa; bA.scrollTop = Sz - (bA.clientHeight / 2) + Qc; } if (vr === true && bZ !== IPCC.ViewMode.SinglePage) { mJ(); } lE(fK, true); K.aM('scaleChanged', { scaleType: (vr) ? "scaledDown" : "scaledUp", scaleTrigger: eQ, fitType: fA, scaleFactor: cq }); }; function avW() { var dummy = document.createElement('div'); setTimeout(function () { bA.appendChild(dummy); bA.removeChild(dummy); }, 0); }; function amh(bQ, kM, kV, ey) { var fO = bQ.igElements; ey = ey || Vm(bQ); if (ey && (ey.right - ey.left) > 0 && (ey.bottom - ey.top) > 0) { return new IPCC.Web.UI.Point(kM + ey.left + fO.nI.scrollLeft, kV + ey.top + fO.nI.scrollTop); } else { return; } }; function Vm(bQ) { var fO = bQ.igElements; var ey = null; if (!bQ || !fO || !fO.nd) { return null; } if (fO.nd.getBoundingClientRect) { try { ey = fO.nd.getBoundingClientRect(); } catch (bJ) { return; } } else { var ck = fO.nd; var we = document.documentElement; ey = { left: we.clientLeft - we.scrollLeft, top: we.clientTop - we.scrollTop }; ck = ck.offsetParent; while (ck) { ey.top += ck.offsetTop - ck.scrollTop; ey.left += ck.offsetLeft - ck.scrollLeft; ck = ck.offsetParent; } } return ey; }; function ajR() { var bg = K.gx(); var Pu = bg.id; var yU; var yz; var nZ; var ZC; var Yt; var aR = false; var bQ; var pU = []; var wp = -1; var jn = 0; var pB; var FS; var Ci; var lP = 0; var cW = 0; var uB = null; var vP = null; if (an === '') { bA = eK({ width: '100%', height: '100%', position: 'relative', margin: '0px', overflow: 'auto', textAlign: 'center' }); bA.className = 'pccPageListContainerWrapper'; bA.tabIndex = 2; var Oz = function (kM, kV) { var jW = document.elementFromPoint(kM, kV); while (jW && (jW.parentNode || jW.ownerSVGElement)) { if (jW.parentNode.id && jW.parentNode.id.indexOf("__pViewId") !== -1) { return jW.parentNode; } jW = jW.ownerSVGElement || jW.parentNode; } return false; }; var Qp = function (bQ, kM, kV) { var fO = bQ.igElements; var ey = Vm(bQ); if (ey && (ey.right - ey.left) > 0 && (ey.bottom - ey.top) > 0) { return new IPCC.Web.UI.Point(kM - ey.left - fO.nI.scrollLeft, kV - ey.top - fO.nI.scrollTop); } else { return; } }; var aDa = function (qG) { qG.Nx([new IPCC.oB(IPCC.Web.UI.MarkType.Text)]); }; var aEO = function (qG) { qG.set_mouseTool(IPCC.Web.UI.MouseTool.None); }; var MZ = false, arN = ""; var aoH = function aJh(bJ, jP, bI) { if (jP.match(/edit/)) { MZ = true; return; } aDa(bI.bB); MZ = true; arN = jP; bI.bB.Jq("touchstart", bJ); }; var aoN = function (bI) { MZ = false; aEO(bI.bB); }; var ZZ = function (bJ) { if (bJ.target && bJ.target.attributes && bJ.target.getAttribute('data-pcc-mark')) { return bJ.target; } else if (bJ.target.parentElement && bJ.target.parentElement.attributes && bJ.target.parentElement.getAttribute('data-pcc-mark')) { return bJ.target.parentElement; } else if (bJ.target.parentNode && bJ.target.parentNode.attributes && bJ.target.parentNode.getAttribute('data-pcc-mark')) { return bJ.target.parentNode; } else { return undefined; } }; var abu = function (bJ) { var aW = ZZ(bJ); if (aW) { return aW.getAttribute('data-pcc-mark'); } return undefined; }; var aii = function (qG) { if (qG && qG.eI()) { qG.eI().FJ(function (R) { R.set_selected(false); }); qG.display(); } }; var Nv, abr = false; var Ql = function (bJ, L) { var oX = { cD: undefined, R: undefined, aD: null }; var mT = ZZ(bJ); if (mT) { if (typeof bQ !== 'undefined' && bQ !== false && bQ.bB && bQ.igElements && bQ.bB.gJ() === true) { oX.aD = bQ.bB.mc(); } if (mT.ImGearMarkRelation) { oX.cD = 'mark'; oX.R = mT.ImGearMarkRelation.R; oX.VM = oX.R.get_selected(); return oX; } else { while (!(mT.ImGearMarkRelation) && mT.parentNode && mT !== document.body) { mT = mT.parentNode; if (mT.ImGearMarkRelation) { oX.cD = 'mark'; oX.R = mT.ImGearMarkRelation.R; oX.VM = oX.R.get_selected(); return oX; } } } } if (typeof bQ !== 'undefined' && bQ !== false && bQ.bB && bQ.igElements && bQ.bB.gJ() === true) { oX.aD = bQ.bB.mc(); var aD = 0; for (aD = 0; aD < aE.length; aD++) { if (aE[aD].ds === bQ.id) { if (typeof L.targetType === 'undefined' || L.targetType === null) { oX.cD = 'page'; return oX; } break; } } } return oX; }; var PN = function (aD, vn, jK, aCY) { if (bO === null || bO === undefined) { return; } var UT = false; if (vn === undefined) { vn = bO.vn; UT = true; } if (jK === undefined) { jK = bO.jK; UT = true; } var R; var bI = document.getElementById(aE[aD].ds); if (aCY === true) { R = bO.zN; } else { R = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.HighlightText); R.set_rectangle({ x: 0, y: 0, width: 0, height: 0 }); R.dI = 127; R.cK = '#3366CC'; R.bV = null; bI.bB.mK().addMark(R); } R.set_selected(true); if (UT === true) { if (bO.ir === bO.iz) { R.bh = jn; R.cg = jK - jn + 1; R.kr = true; R.lF = true; bI.bB.display(); } else if (aD === bO.ir) { R.bh = jn; R.cg = bI.bB.cv().gl().fb() - 1 - vn; R.kr = true; R.lF = false; bI.bB.display(); } else if (aD === bO.iz) { R.bh = 0; R.cg = jK + 1; R.kr = false; R.lF = true; bI.bB.display(); } else { R.bh = 0; R.cg = bI.bB.cv().gl().fb() - 1 - jn; R.kr = false; R.lF = false; } } else { if (bO.ir === bO.iz) { R.kr = true; R.lF = true; } else if (aD === bO.ir) { R.kr = true; R.lF = false; } else if (aD === bO.iz) { R.kr = false; R.lF = true; } else { R.kr = false; R.lF = false; } } bO.fl[aD] = R; }; var jO = function (bJ) { if (Ci) { if (Ci.clientX === bJ.clientX && Ci.clientY === bJ.clientY) { if (bJ.rawEvent.preventDefault) { bJ.rawEvent.preventDefault(); } else if (bJ.preventDefault) { bJ.preventDefault(); } if (bJ.rawEvent.stopPropagation) { bJ.rawEvent.stopPropagation(); } else if (bJ.stopPropagation) { bJ.stopPropagation(); } abr = true; Ci = undefined; return false; } } Nv = bJ; agk(bJ, bJ.clientX, bJ.clientY, bJ.button); }; var aee = function (bJ, L) { nZ = Ql(bJ, L); }; var agk = function (bJ, kM, kV, qm) { var L = new IPCC.Web.UI.MouseEventArgs(); bQ = Oz(kM, kV); aee(bJ, L); var jP; var mT = ZZ(bJ); if (mT) { jP = mT.getAttribute('data-pcc-mark'); } var acA = false; var MH = jP && jP.substring(0, 10); if (jP && MH === 'texthandle') { FS = true; acA = true; MH = jP.substring(10, 13); var R = mT.parentNode.ImGearMarkRelation.R; if (bO && R.bV === null) { pU = bO.ss.slice(); pU[L.pageIndex] = undefined; } else { bO = null; pU = []; K.AJ(); } var afM = function (aDw) { jn = bO.vn; var G; for (G = bO.iz; G >= bO.ir; G--) { var bI = document.getElementById(aE[G].ds); if (bI.bB === undefined || bI.bB === null) { continue; } var BC = jn; if (G !== bO.ir) { BC = 0; } var tj; if (G === bO.iz) { tj = bO.jK; } else { tj = bI.bB.get_textPage().gl().fb() - 1; } aDw(bI, BC, tj); if (G !== bO.sH) { PN(G); } } uB = bW; bW = IPCC.Web.UI.MouseTool.SelectText; aR = true; }; var G, aD, aX, NL, fW, uf, cl; if (MH === 'sta') { if (bO === null || bO === undefined) { aD = R.aD; bO = {}; bO.fl = []; bO.ir = aD; bO.vn = R.bh; jn = R.bh; while (aD < aE.length) { aX = aE[aD].aX; NL = aX.get_markCount(); for (G = 0; G < NL; G++) { fW = aX.getMark(G); if (R.cE === fW.cE && fW.get_type() === R.get_type()) { bO.fl[aD] = fW; for (uf = fW.bV.length - 1; uf >= 0; uf--) { if (fW.bV[uf].set_visible) { fW.bV[uf].set_visible(false); } else { fW.set_visible(false); break; } } if (aD === R.aD) { vP = fW; } else { pU[aD] = cl.substring(fW.bh, fW.cg); fW.set_selected(false); } cl = fW.cl.substring(fW.cg); if (fW.lF === true) { bO.jK = fW.bh + fW.cg - 1; bO.iz = aD; break; } } } aD++; } } pB = bO.jK + 1; lP = bO.iz; var aAk = function (bI, BC, tj) { bI.bB.showEmptyTextSelection(tj + 1); bI.bB.extendTextSelection(undefined); bI.bB.extendTextSelection(tj); bI.bB.extendTextSelection(BC); }; bO.fl[bO.ir].za = true; bO.sH = bO.ir; bO.zN = bO.fl[bO.ir]; afM(aAk); } else if (MH === 'end') { if (bO === null || bO === undefined) { aD = R.aD; bO = {}; bO.fl = []; bO.iz = aD; bO.jK = R.bh + R.cg - 1; while (aD >= 0) { aX = aE[aD].aX; NL = aX.get_markCount(); for (G = 0; G < NL; G++) { fW = aX.getMark(G); if (R.cE === fW.cE && fW.get_type() === R.get_type()) { bO.fl[aD] = fW; for (uf = fW.bV.length - 1; uf >= 0; uf--) { if (fW.bV[uf].set_visible) { fW.bV[uf].set_visible(false); } else { fW.set_visible(false); break; } } if (aD === R.aD) { cl = fW.cl; } else { pU[aD] = cl.substring(cl.length - fW.cg); fW.set_selected(false); } cl = fW.cl.substring(0, cl.length - fW.cg); if (fW.kr === true) { bO.vn = fW.bh; jn = fW.bh; bO.ir = aD; vP = fW; break; } } } aD--; } } pB = bO.vn; lP = bO.ir; var aAG = function (bI, BC, tj) { bI.bB.showEmptyTextSelection(BC); bI.bB.extendTextSelection(undefined); bI.bB.extendTextSelection(BC); bI.bB.extendTextSelection(tj); }; bO.fl[bO.iz].za = true; bO.sH = bO.iz; bO.zN = bO.fl[bO.iz]; afM(aAG); } if (vP) { bQ.bB.display(); } } var Cr = bJ.target.tagName && bJ.target.tagName.toLowerCase() === 'textarea'; if (Cr) { return; } var zM = bJ.target.tagName && bJ.target.tagName.toLowerCase() === 'input' && bJ.target.type && bJ.target.type.toLowerCase() === 'text'; if (zM) { return; } if (bW === IPCC.Web.UI.MouseTool.HandPan && CS && jP && acA === false) { if(nZ != undefined){if(!nZ || nZ.R.get_interactionMode() !== IPCC.Web.UI.MarkInteractionMode.SelectionDisabled) { aoH(bJ, jP, bQ); return; }} } var cS; var fU; if (bQ !== false && bQ.bB && bQ.igElements && bQ.bB.gJ() === true) { var ak = 0; for (ak = 0; ak < aE.length; ak++) { if (aE[ak].ds === bQ.id) { L.pageIndex = ak; break; } } L.pointLiesWithinImage = true; fU = Qp(bQ, kM, kV); if (fU) { cS = bQ.bB.Lg(fU, false); L.imagePoint = cS; L.constrainedImagePoint = cS; } else { L.pointLiesWithinImage = false; } } else { L.pointLiesWithinImage = false; } L.domEvent = bJ; L.windowPoint = new IPCC.Web.UI.Point(kM, kV); if (acA === true) { wp = -1; cW = L.pageIndex; bJ.preventDefault(); K.aM('mouseDown', L); return; } switch (bW) { case IPCC.Web.UI.MouseTool.None: bJ.preventDefault(); break; case IPCC.Web.UI.MouseTool.HandPan: bJ.preventDefault(); yU = kV; yz = kM; ZC = bA.scrollTop; Yt = bA.scrollLeft; aR = true; an.style.cursor = IPCC.bP.fq(IPCC.bP.HandClosed); break; case IPCC.Web.UI.MouseTool.SelectText: case IPCC.Web.UI.MouseTool.CreateHighlightTextMark: case IPCC.Web.UI.MouseTool.CreateTextSelectionRedaction: case IPCC.Web.UI.MouseTool.CreateTextHyperlinkMark: case IPCC.Web.UI.MouseTool.CreateStrikethroughMark: bJ.preventDefault(); if (qm === 0 && bQ && bQ.bB && cS) { K.AJ(); pU = []; wp = -1; FS = undefined; var cQ = bQ.bB.transformPagePointToTextIndex(cS); jn = cQ; pB = cQ; aR = true; if (cQ === undefined) { K.aM('mouseDown', L); return; } bQ.bB.showEmptyTextSelection(cQ); bQ.bB.extendTextSelection(undefined); bQ.bB.extendTextSelection(cQ); bQ.bB.display(); lP = L.pageIndex; cW = L.pageIndex; } break; case IPCC.Web.UI.MouseTool.Magnifier: bJ.preventDefault(); if (qm === 0 && bQ && bQ.bB && fU) { var ie = IPCC.bP.fq(IPCC.bP.None); an.style.cursor = ie; bQ.bB.showMagnifier(fU); bQ.bB.display(); } aR = true; break; case IPCC.Web.UI.MouseTool.RectangleZoom: bJ.preventDefault(); if (qm === 0 && bQ && bQ.bB && cS) { aR = true; yU = fU.y; yz = fU.x; bQ.bB.showEmptySelection(cS); bQ.bB.display(); } break; } K.aM('mouseDown', L); }; var lp = function (bJ) { afs(bJ, bJ.clientX, bJ.clientY, bJ.button); }; var afs = function (bJ, kM, kV, qm) { var Cr = bJ.target.tagName && bJ.target.tagName.toLowerCase() === 'textarea'; if (Cr) { return; } var zM = bJ.target.tagName && bJ.target.tagName.toLowerCase() === 'input' && bJ.target.type && bJ.target.type.toLowerCase() === 'text'; if (zM) { return; } var L = new IPCC.Web.UI.MouseEventArgs(); L.domEvent = bJ; L.windowPoint = new IPCC.Web.UI.Point(kM, kV); var ez = Oz(kM, kV); var cS; var fU; if (ez !== false && ez.bB && ez.igElements && ez.bB.gJ() === true) { L.pointLiesWithinImage = true; fU = Qp(ez, kM, kV); if (fU) { cS = ez.bB.Lg(fU, false); L.imagePoint = cS; L.constrainedImagePoint = cS; } else { L.pointLiesWithinImage = false; } } else { L.pointLiesWithinImage = false; } var mT = Ql(bJ, L); if (mT && mT.R) { L.mark = mT.R; } var ie; switch (bW) { case IPCC.Web.UI.MouseTool.None: bJ.preventDefault(); break; case IPCC.Web.UI.MouseTool.HandPan: bJ.preventDefault(); if (aR) { var awX = kV; var awH = kM; var aGn = yU - awX; var aGa = yz - awH; bA.scrollTop = ZC + aGn; bA.scrollLeft = Yt + aGa; } break; case IPCC.Web.UI.MouseTool.SelectText: case IPCC.Web.UI.MouseTool.CreateHighlightTextMark: case IPCC.Web.UI.MouseTool.CreateTextSelectionRedaction: case IPCC.Web.UI.MouseTool.CreateTextHyperlinkMark: case IPCC.Web.UI.MouseTool.CreateStrikethroughMark: bJ.preventDefault(); if (aR) { if (qm !== 0) { EE(); } var iK; if (!ez) { K.aM('mouseMove', L); return; } if (jn === undefined) { bQ = ez; } else if (ez !== bQ && ez.bB && fU) { wp = -1; var lf = 0; var G = 0; for (G = 0; G < aE.length; G++) { if (aE[G].ds === ez.id) { lf = G; break; } } if (lf > cW) { if (lf > lP) { iK = bQ.bB.get_textPage().gl().fb() - 1; if (iK < 0) { EE(); K.aM('mouseMove', L); return; } bQ.bB.extendTextSelection(iK); if (bO) { iK = bQ.bB.get_textPage().gl().fb() - 1; bO.fl[cW].set_startIndex(bQ.bB.RO()); bO.fl[cW].set_textLength(bQ.bB.Gv()); bO.iz = lf; jn = bQ.bB.RO(); } pU[cW] = bQ.bB.getSelectedText(); ez.bB.showEmptyTextSelection(0); ez.bB.extendTextSelection(undefined); wp = 0; bQ.bB.display(); bQ = ez; } else { jn = 0; pU[cW] = undefined; pU[lf] = undefined; bQ.bB.showEmptyTextSelection(0); bQ.bB.extendTextSelection(undefined); if (bO && bO.fl[cW]) { bO.fl[cW].kr = false; } bQ.bB.display(); bQ = ez; if (bO && bO.fl[cW]) { bO.fl[cW] = undefined; bO.ir = lf; bO.fl[lf].set_startIndex(0); bO.fl[lf].set_textLength(bO.fl[lf].get_startIndex() + bO.fl[lf].get_textLength()); bO.fl[lf].kr = true; bQ.bB.display(); } } } else if (lf < cW) { if (lf < lP) { iK = bQ.bB.get_currentTextIndex(); if (iK !== 0) { bQ.bB.extendTextSelection(0); } if (bO) { bO.fl[cW].set_startIndex(bQ.bB.RO()); bO.fl[cW].set_textLength(bQ.bB.Gv()); bO.ir = lf; } pU[cW] = bQ.bB.getSelectedText(); bQ.bB.display(); iK = ez.bB.cv().gl().fb() - 1; wp = iK; jn = 0; ez.bB.showEmptyTextSelection(iK + 1); ez.bB.extendTextSelection(undefined); bQ = ez; bQ.bB.display(); } else { pU[cW] = undefined; pU[lf] = undefined; bQ.bB.showEmptyTextSelection(0); bQ.bB.extendTextSelection(undefined); if (bO && bO.fl[cW]) { bO.fl[cW].lF = false; } bQ.bB.display(); bQ = ez; if (bO && bO.fl[cW]) { bO.fl[cW] = undefined; bO.iz = lf; iK = bQ.bB.cv().gl().fb() - 1; bO.fl[lf].set_textLength(ez.bB.Gv()); bO.fl[lf].lF = true; bQ.bB.display(); } } } cW = lf; } var aBH = (cW < lP), aBh = (cW > lP); if (bQ && bQ.bB && bQ.bB.gJ() === true && fU) { fU = Qp(bQ, kM, kV); cS = bQ.bB.Lg(fU, false); var cQ = bQ.bB.transformPagePointToTextIndex(cS); if (jn === undefined) { jn = cQ; pB = cQ; if (cQ === undefined) { K.aM('mouseMove', L); return; } bQ.bB.showEmptyTextSelection(cQ); bQ.bB.extendTextSelection(undefined); bQ.bB.extendTextSelection(cQ); bQ.bB.display(); var aj = 0; for (aj = 0; aj < aE.length; aj++) { if (aE[aj].ds === bQ.id) { lP = aj; cW = aj; break; } } } else { if (jn === +jn && cQ === +cQ) { if (aBH) { jn = cQ; } else if (!aBh) { jn = Math.min(pB, cQ); } } } iK = bQ.bB.get_currentTextIndex(); if (iK === cQ || cQ === undefined) { K.aM('mouseMove', L); return; } if (wp !== -1) { if (cQ !== wp) { bQ.bB.extendTextSelection(wp); } wp = -1; } if ((cQ > pB && cW === lP) || cW > lP) { if (bO) { if (bO.fl[cW] === undefined || bO.fl[cW] === null) { PN(cW, 0, 0, cW === bO.sH); if (cW - 1 >= 0 && bO.fl[cW - 1]) { bO.fl[cW - 1].lF = false; document.getElementById(aE[cW - 1].ds).bB.display(); } } bO.fl[cW].lF = true; } if (FS === undefined) { FS = false; } } else if (cQ < pB || cW < lP) { if (bO) { if (bO.fl[cW] === undefined || bO.fl[cW] === null) { PN(cW, bQ.bB.cv().gl().fb() - 1, 0, cW === bO.sH); if (bO.fl[cW + 1]) { bO.fl[cW + 1].kr = false; document.getElementById(aE[cW + 1].ds).bB.display(); } } bO.fl[cW].kr = true; } if (FS === undefined) { FS = true; pB++; bQ.bB.showEmptyTextSelection(pB); bQ.bB.extendTextSelection(undefined); var tj = bQ.bB.cv().gl().fb(); if (pB >= tj) { bQ.bB.extendTextSelection(tj - 1); } else { bQ.bB.extendTextSelection(pB); } } } bQ.bB.extendTextSelection(cQ); if (bO && bO.fl[cW]) { bO.fl[cW].set_startIndex(bQ.bB.RO()); bO.fl[cW].set_textLength(bQ.bB.Gv()); } bQ.bB.display(); } } break; case IPCC.Web.UI.MouseTool.Magnifier: bJ.preventDefault(); if (aR) { if (qm !== 0 || (bQ && bQ.bB && bQ !== ez)) { bQ.bB.hideMagnifier(); ie = IPCC.bP.fq(IPCC.bP.Magnifier); an.style.cursor = ie; bQ.bB.display(); } if (ez && ez.bB && fU) { bQ = ez; ie = IPCC.bP.fq(IPCC.bP.None); an.style.cursor = ie; ez.bB.showMagnifier(fU); ez.bB.display(); } } break; case IPCC.Web.UI.MouseTool.RectangleZoom: bJ.preventDefault(); if (aR) { if (ez && ez.bB && cS && ez === bQ) { if (qm !== 0) { ez.bB.hideSelection(); ez.bB.display(); aR = false; } else { ez.bB.extendSelection(cS); ez.bB.display(); } } else { bQ.bB.hideSelection(); bQ.bB.display(); aR = false; } } break; } K.aM('mouseMove', L); }; var iB = function (bJ) { if (abr !== true) { aaY(bJ, bJ.clientX, bJ.clientY); } else { abr = false; } }; var afu = function (bJ, L) { L.upTargetType = null; var Iw = Ql(bJ, L); L.originalEvent = bJ.rawEvent; L.clientX = bJ.clientX; L.clientY = bJ.clientY; L.downTarget = { type: undefined, pageIndex: undefined }; if (typeof nZ !== 'undefined' && typeof nZ.cD !== 'undefined') { L.downTarget.type = nZ.cD; } if (typeof nZ !== 'undefined' && typeof nZ.aD !== 'undefined') { L.downTarget.pageIndex = nZ.aD; } if (typeof nZ !== 'undefined' && typeof nZ.VM !== 'undefined') { L.downTarget.alreadySelected = nZ.VM; } L.downMark = (typeof nZ !== 'undefined') ? nZ.R : undefined; L.upMark = Iw.R; switch (Iw.cD) { case 'page': case 'mark': L.upTarget = { type: Iw.cD, pageIndex: Iw.aD }; break; } if (L.pointLiesWithinImage === false && Iw.cD === 'page') { Iw.aD = -1; } }; var aaY = function (bJ, kM, kV) { var L = new IPCC.Web.UI.MouseEventArgs(); var ez; var cS; var fU; if (bJ) { ez = Oz(kM, kV); if (ez !== false && ez.bB && ez.igElements && ez.bB.gJ() === true) { bQ = ez; L.pointLiesWithinImage = true; fU = Qp(ez, kM, kV); if (fU) { cS = ez.bB.Lg(fU, false); L.imagePoint = cS; L.constrainedImagePoint = cS; } else { L.pointLiesWithinImage = false; } } else { L.pointLiesWithinImage = false; } L.domEvent = bJ; L.windowPoint = new IPCC.Web.UI.Point(kM, kV); afu(bJ, L); K.aM('mouseUp', L); } nZ = undefined; var ie; switch (bW) { case IPCC.Web.UI.MouseTool.None: bJ.preventDefault(); break; case IPCC.Web.UI.MouseTool.HandPan: bJ.preventDefault(); if (aR) { yz = undefined; yU = undefined; ZC = undefined; Yt = undefined; aR = false; cP = IPCC.bP.HandOpen; ie = IPCC.bP.fq(cP); an.style.cursor = ie; } break; case IPCC.Web.UI.MouseTool.SelectText: case IPCC.Web.UI.MouseTool.CreateHighlightTextMark: case IPCC.Web.UI.MouseTool.CreateTextSelectionRedaction: case IPCC.Web.UI.MouseTool.CreateTextHyperlinkMark: case IPCC.Web.UI.MouseTool.CreateStrikethroughMark: if (bJ) { bJ.preventDefault(); } if (aR) { var rX = new IPCC.Web.UI.TextSelectedEventArgs(), ka = [], G, zZ, Bn; var jK; var JM = bQ.bB.getSelectedText(); var ss = pU.slice(); if (JM.length > 0) { ss[cW] = bQ.bB.getSelectedText(); } else { if (cW > lP) { cW--; bQ = document.getElementById(aE[cW].ds); if (ss[cW]) { JM = ss[cW]; } } else if (cW < lP) { cW++; bQ = document.getElementById(aE[cW].ds); if (ss[cW]) { JM = ss[cW]; } } } rX.text = ss.join(''); var adm = true; if (cW >= lP) { if (cW === lP) { if (bQ.bB.get_currentTextIndex() >= pB) { adm = false; } jK = jn + JM.length - 1; } else { jK = JM.length - 1; } if (jK < 0) { jK = 0; } zZ = lP; Bn = cW; } else { adm = false; jK = pB - 1; zZ = cW; Bn = lP; } for (G = zZ; G <= Bn; G++) { ka.push(G); } if (rX.text.length === 0) { EE(); ka = []; } rX.pageNumbers = ka; rX.clientX = kM; rX.clientY = kV; if (jn !== undefined) { if (bW === IPCC.Web.UI.MouseTool.SelectText) { var aFz = function (bI, CC) { var IG = bI.bB.cv(); var gP = IG.gl(); var gw = gP.jN(CC); return gw.wz(); }; var iK = bQ.bB.get_currentTextIndex(); var SH = aFz(bQ, iK); var eP = 0, gr = 0; if (adm === false) { eP = SH.width; gr = SH.height; } var Hj = bQ.bB.transformPagePointToWindow(new IPCC.Web.UI.Point(SH.x + eP, SH.y + gr), true); var fL = amh(bQ, Hj.x, Hj.y); rX.handleClientX = fL.x; rX.handleClientY = fL.y; } var asW = bO === undefined || bO === null; if (vP) { rX.previousFirstMark = vP; rX.firstMark = bO.fl[zZ]; if (bO.sH < zZ || bO.sH > Bn) { var IH = document.getElementById(aE[bO.sH].ds); if (IH.bB) { IH.bB.mK().removeMark(bO.zN); } } bO.zN.za = false; K.AJ(); if (uB !== null) { bW = uB; } uB = null; } else if (asW === true) { if (bW === IPCC.Web.UI.MouseTool.SelectText) { bO = { ir: zZ, vn: jn, iz: Bn, jK: jK, ss: ss.slice(), fl: [] }; for (G = 0; G < ka.length; G++) { PN(ka[G]); } } else { K.AJ(); } } else { if (bO.sH < zZ || bO.sH > Bn) { var aqJ = document.getElementById(aE[bO.sH].ds); if (aqJ.bB) { aqJ.bB.mK().removeMark(bO.zN); } } bO.zN.za = false; bO.ir = zZ; bO.vn = jn; bO.iz = Bn; bO.jK = jK; bO.ss = ss.slice(); if (uB !== null) { bW = uB; } uB = null; } rX.mouseTool = bW; rX.startIndex = jn; K.aM('selectTextMouseToolCompleted', rX); if (vP) { vP = null; bO = null; } } aR = false; } break; case IPCC.Web.UI.MouseTool.Magnifier: bJ.preventDefault(); if (ez && ez.bB) { ez.bB.hideMagnifier(); ie = IPCC.bP.fq(IPCC.bP.Magnifier); an.style.cursor = ie; ez.bB.display(); } aR = false; break; case IPCC.Web.UI.MouseTool.RectangleZoom: bJ.preventDefault(); if (aR && fU) { var FH = 0; var GG = 0; var ZB = 0; var ZV = 0; if (fU.x < yz) { FH = yz - fU.x; ZB = fU.x + FH / 2; } else { FH = fU.x - yz; ZB = yz + FH / 2; } if (fU.y < yU) { GG = yU - fU.y; ZV = fU.y + GG / 2; } else { GG = fU.y - yU; ZV = yU + GG / 2; } var ajh = bA.clientWidth / FH; var aid = bA.clientHeight / GG; var qj = ajh; if (ajh > aid) { qj = aid; } if (ez && ez.bB) { ez.bB.ny(); ez.bB.display(); } aR = false; if (FH * 2 + GG * 2 > 25) { K.awD(qj, ZB, ZV, ez); } } break; } var Cr = false; var zM = false; if (bJ) { Cr = bJ.target.tagName && bJ.target.tagName.toLowerCase() === 'textarea'; zM = bJ.target.tagName && bJ.target.tagName.toLowerCase() === 'input' && bJ.target.type && bJ.target.type.toLowerCase() === 'text'; } if (MZ && !Cr && !zM) { aoN(bQ); } else if (bW === IPCC.Web.UI.MouseTool.HandPan && Nv && !Cr && !zM && bJ && Nv.clientX === bJ.clientX && Nv.clientY === bJ.clientY && bJ.shiftKey !== true && bJ.ctrlKey !== true) { aii(bQ.bB); } }; var aAO = function () { var ie; switch (bW) { case IPCC.Web.UI.MouseTool.None: break; case IPCC.Web.UI.MouseTool.HandPan: cP = IPCC.bP.HandOpen; ie = IPCC.bP.fq(cP); an.style.cursor = ie; aR = false; break; case IPCC.Web.UI.MouseTool.SelectText: EE(); break; case IPCC.Web.UI.MouseTool.Magnifier: if (bQ && bQ.bB) { bQ.bB.hideMagnifier(); ie = IPCC.bP.fq(IPCC.bP.Magnifier); an.style.cursor = ie; bQ.bB.display(); } aR = false; break; case IPCC.Web.UI.MouseTool.RectangleZoom: if (bQ && bQ.bB) { bQ.bB.hideSelection(); bQ.bB.display(); aR = false; } break; } }; var ayW = function () { aAO(); }; var atB = function () { if (bW === IPCC.Web.UI.MouseTool.Magnifier) { if (bQ && bQ.bB) { bQ.bB.hideMagnifier(); var ie = IPCC.bP.fq(IPCC.bP.Magnifier); an.style.cursor = ie; bQ.bB.display(); } aR = false; } else if (bW === IPCC.Web.UI.MouseTool.RectangleZoom) { if (bQ && bQ.bB) { bQ.bB.hideSelection(); bQ.bB.display(); aR = false; } } else if (bW === IPCC.Web.UI.MouseTool.SelectText) { EE(); } }; var lY = function (bJ) { if (bJ.ctrlKey) { switch (bW) { case IPCC.Web.UI.MouseTool.None: break; case IPCC.Web.UI.MouseTool.SelectText: break; default: break; case IPCC.Web.UI.MouseTool.HandPan: var RS = bJ.rawEvent.wheelDelta; bJ.preventDefault(); if (RS < 0) { K.zoomOut(1.5); } else { K.zoomIn(1.5); } break; } } else { bJ.preventDefault(); bA.scrollTop -= bJ.rawEvent.wheelDelta * 0.72; } if (bW === IPCC.Web.UI.MouseTool.Magnifier) { if (bQ && bQ.bB) { bQ.bB.hideMagnifier(); var ie = IPCC.bP.fq(IPCC.bP.Magnifier); an.style.cursor = ie; bQ.bB.display(); } aR = false; } else if (bW === IPCC.Web.UI.MouseTool.RectangleZoom) { if (bQ && bQ.bB) { bQ.bB.hideSelection(); bQ.bB.display(); aR = false; } } else if (bW === IPCC.Web.UI.MouseTool.SelectText) { EE(); } }; var aAx = function (au) { var L = new IPCC.Web.UI.MouseEventArgs(); L.upTarget = { type: 'comments', element: au.target }; L.downTarget = { type: 'comments', element: au.target }; L.originalEvent = au.rawEvent; L.clientX = au.clientX; L.clientY = au.clientY; L.pageIndex = undefined; K.aM('mouseUp', L); }; var EE = function () { if (aR === true) { if (bO && bO.sH !== undefined) { if (vP) { aaY(null, 0, 0); return; } else { var IH = document.getElementById(aE[bO.sH].ds); if (IH.bB) { IH.bB.mK().removeMark(bO.zN); } bO.zN.za = false; } } K.AJ(); vP = null; aR = false; if (uB !== null) { bW = uB; } uB = null; } }; CE = eK({ position: 'relative', width: 'auto', height: 'auto', display: 'table', tableLayout: 'fixed', borderSpacing: '0px', margin: '0px auto', clear: 'both', boxSizing: 'border-box' }); if (bZ === IPCC.ViewMode.SinglePage) { an = eK({ position: 'relative', whiteSpace: 'nowrap', width: 'auto', height: 'auto', overflow: 'hidden' }); an.className = 'pccPageListContainer pccSinglePageView'; } else { an = eK({ position: 'relative', whiteSpace: 'nowrap', width: 'auto', height: 'auto', display: 'table-cell', verticalAlign: 'top' }); an.className = 'pccPageListContainer'; } IPCC.Web.UI.al.addHandler(an, "mousedown", jO); IPCC.Web.UI.al.addHandler(an, "mouseup", iB); IPCC.Web.UI.al.addHandler(an, "mousemove", lp); IPCC.Web.UI.al.addHandler(an, "mouseleave", ayW); IPCC.Web.UI.al.addHandler(an, "mousewheel", lY); IPCC.Web.UI.al.addHandler(an, "DOMMouseScroll", atB); bA.onscroll = (! !Ks) ? aIo : Yi; an.setAttribute('id', Pu + '_ListContainer'); bA.setAttribute('id', Pu + '_ListWrapper'); vQ = Pu + '_ListWrapper'; mf = eK(); mf.className = 'pccPageListComments pccHidden'; mf.setAttribute('id', Pu + '_CommentsPanel'); var XK = []; if (IPCC.J.aAE) { XK.push('touchend'); } else { XK.push('click'); } IPCC.J.forEach(XK, function (evName) { IPCC.Web.UI.al.addHandler(mf, evName, aAx); }); CE.appendChild(an); CE.appendChild(mf); bA.appendChild(CE); bg.appendChild(bA); if (navigator.userAgent.match('MSIE 10') && document.documentMode === 10) { var ax = '', cR = '', uT = '', ve = '', qh; var xo = function () { qh = getComputedStyle(bg); uT = qh.getPropertyValue('width'); ve = qh.getPropertyValue('height'); if (uT !== ax || ve !== cR) { ax = uT; cR = ve; bA.style.width = ax; bA.style.height = cR; } }; setInterval(xo, 1000); window.addEventListener('resize', xo); xo(); K.xo = xo; } var aAA = IPCC.J.Op; if (document.documentElement.getBoundingClientRect && Array.prototype.forEach && aAA && window.addEventListener && document.querySelector) { atf(bA); } var axI = function (an, aJb) { var nv; var ZU = function (au) { var cA = au.rawEvent, ja = cA.touches[0] || cA.changedTouches[0]; au.clientX = ja.clientX; au.clientY = ja.clientY; au.preventDefault = function () { cA.preventDefault(); }; au.stopPropagation = function () { cA.stopPropagation(); }; return au; }; var Gc = function (ll, au) { var L = new IPCC.Web.UI.MouseEventArgs(), Gq = (ll === 'touchstart') ? 'mouseDown' : (ll === 'touchend') ? 'mouseUp' : null; var Gr = (ll === 'touchstart') ? agk : (ll === 'touchmove') ? afs : (ll === 'touchend') ? aaY : null; nv = Oz(au.clientX, au.clientY); if (ll === 'doubleTap') { nv && nv.bB && nv.bB.Jq(ll, au); } var jP; jP = abu(au); if (jP) { if (jP.substring(0, 5) === 'texth') { au.preventDefault(); au.stopPropagation(); if (ll === 'touchstart') { Ci = au; } Gr && Gr(au, au.clientX, au.clientY, 0); return; } } switch (bW) { case IPCC.Web.UI.MouseTool.CreateLineMark: case IPCC.Web.UI.MouseTool.CreatePolylineMark: case IPCC.Web.UI.MouseTool.CreateRectangleMark: case IPCC.Web.UI.MouseTool.CreateRectangleRedactionMark: case IPCC.Web.UI.MouseTool.CreateEllipseMark: case IPCC.Web.UI.MouseTool.CreateTextMark: case IPCC.Web.UI.MouseTool.CreateTextInputSignatureMark: case IPCC.Web.UI.MouseTool.CreateTextAreaSignatureMark: case IPCC.Web.UI.MouseTool.CreateStampMark: case IPCC.Web.UI.MouseTool.CreateFreehandMark: case IPCC.Web.UI.MouseTool.EditMarks: case IPCC.Web.UI.MouseTool.CreateImageStampAnnotationMark: case IPCC.Web.UI.MouseTool.CreateImageStampRedactionMark: nv && nv.bB && nv.bB.Jq(ll, au); if (Gq === 'mouseUp') { afu(au, L); } else if (Gq === 'mouseDown') { aee(au, L); } K.aM(ll, L); break; case IPCC.Web.UI.MouseTool.SelectText: case IPCC.Web.UI.MouseTool.CreateHighlightTextMark: case IPCC.Web.UI.MouseTool.CreateTextSelectionRedaction: case IPCC.Web.UI.MouseTool.CreateTextHyperlinkMark: case IPCC.Web.UI.MouseTool.CreateStrikethroughMark: au.preventDefault(); au.stopPropagation(); if (ll === 'touchstart') { Ci = au; if (jP) { K.AJ(); break; } } Gr && Gr(au, au.clientX, au.clientY, 0); break; case IPCC.Web.UI.MouseTool.Magnifier: case IPCC.Web.UI.MouseTool.RectangleZoom: au.preventDefault(); au.stopPropagation(); if (ll === 'touchstart') { Ci = au; } Gr && Gr(au, au.clientX, au.clientY, 0); break; case IPCC.Web.UI.MouseTool.HandPan: if (jP === undefined) { jP = abu(au); } var T = Ql(au, {}); if (jP && CS) { if (!T || T.R.get_interactionMode() !== IPCC.Web.UI.MarkInteractionMode.SelectionDisabled) { if (ll === 'touchstart') { aoH(au, jP, nv); } else if (ll === 'touchmove') { nv && nv.bB && nv.bB.Jq(ll, au); } else if (ll === 'touchend') { nv && nv.bB && nv.bB.Jq(ll, au); aoN(nv); } } } break; } }; var Dq, CT, xM; var axR = function (au) { if (au.rawEvent.touches.length > 1) { clearTimeout(xM); xM = CT = Dq = undefined; return; } au = ZU(au); Dq = au; if (bW === IPCC.Web.UI.MouseTool.CreatePolylineMark) { au.preventDefault(); } CT = function () { Gc('touchstart', au); xM = CT = Dq = undefined; }; xM = setTimeout(function () { CT(); }, 200); }; var IO, Di; var ayi = function (au) { au = ZU(au); tx = false; var aBV = function () { if (!Di) { return false; } var eW = Di.clientX - au.clientX; var fe = Di.clientY - au.clientY; var jD = eW * eW + fe * fe; return jD < 2500; }; var aoG = function () { IO = Di = undefined; var jP = abu(au); if (!jP && bW === IPCC.Web.UI.MouseTool.HandPan && CS && nv) { aii(nv.bB); } }; var arj = function () { var akg = CT; if (IO && aBV()) { clearTimeout(IO); Di = IO = undefined; akg(); Gc('touchend', au); Gc('doubleTap', au); } else { IO = setTimeout(function () { akg(); Gc('touchend', au); aoG(); }, 300); Di = au; } }; if (Dq && xM) { clearTimeout(xM); if (bW === IPCC.Web.UI.MouseTool.CreatePolylineMark) { arj(); } else { aoG(); } xM = CT = Dq = undefined; return; } Gc('touchend', au); }; var aml, tx = false; var ayc = function (au) { if (au.rawEvent.touches.length > 1) { return; } aml = au; if (Dq && xM) { clearTimeout(xM); CT(); } aGE(); }; function aGE() { var au = ZU(aml); Gc('touchmove', au); }; IPCC.Web.UI.al.addHandler(an, "touchstart", axR); IPCC.Web.UI.al.addHandler(an, "touchmove", ayc); IPCC.Web.UI.al.addHandler(an, "touchend", ayi); }; axI(an, mf); } }; function atf(hM) { var ajF = function () { }, bS = 1; function WI(afV, ahj, ig, apH) { hM.style['-ms-transform'] = afV; hM.style['-moz-transform'] = afV; hM.style['-webkit-transform'] = ahj; hM.style['transform'] = ahj; hM.style['-ms-transform-origin'] = ig; hM.style['-moz-transform-origin'] = ig; hM.style['-webkit-transform-origin'] = ig; hM.style['transform-origin'] = ig; hM.style.overflow = apH || ''; }; WI('initial', 'initial', '0% 0%', 'auto'); function aFG(qj, gL, Rg, wQ) { var eP = (-gL.x / qj) - Rg.x, gr = (-gL.y / qj) - Rg.y, aAN = "scale3d(" + qj + "," + qj + ",1) translate3d(" + eP + "px," + gr + "px,0px)", aAF = "scale(" + qj + ", " + qj + ") translate(" + eP + "px," + gr + "px)"; WI(aAF, aAN, 'center center', 'visible'); ajF = function () { var av = hM.getBoundingClientRect(); var Vx = { x: (hM.clientWidth / 2 + -av.left + wQ.left) / qj, y: (hM.clientHeight / 2 + -av.top + wQ.top) / qj }; if (wQ.ahS) { Vx.x = Vx.x - (wQ.ahS / 2); } WI('scale(1,1) translate(0px,0px)', 'scale3d(1,1,1) translate3d(0px,0px,0px)', '0% 0%', 'auto'); K.TU(qj, Vx, undefined, IPCC.ScaleTrigger.Pinch); }; return hM; }; function aji(x, y, x0, y0) { return Math.sqrt((x -= x0) * x + (y -= y0) * y); }; function aje(x, y, x0, y0) { return { x: (x + x0) / 2, y: (y + y0) / 2 }; }; function atu(amW, HK) { return { x: amW.x - HK.x, y: amW.y - HK.y }; }; var Wx = false; hM.addEventListener('touchstart', function (ev) { if (!Wx && ev.touches.length === 2) { afi(ev); } }); var standardizeMSTouch = function (ev) { var event = {}; event.identifier = ev.pointerId; event.x = event.clientX = ev.clientX; event.y = event.clientY = ev.clientY; event.preventDefault = ev.preventDefault; event.stopPropagation = ev.stopPropagation; event.rawEvent = ev; event.touches = [event]; event.changedTouches = [event]; return event; }; var Dc, abR = false, Dw = {}; PCCViewer.EventEmitter.extend(Dw); hM.addEventListener(IPCC.J.pn['down'], function (au) { abR = true; au = standardizeMSTouch(au); if (Dc) { var cA = {}; cA.touches = [Dc, au]; cA.changedTouches = [Dc, au]; cA.preventDefault = function () { Dc.rawEvent.preventDefault(); au.rawEvent.preventDefault(); }; cA.stopPropagation = function () { Dc.rawEvent.stopPropagation(); au.rawEvent.stopPropagation(); }; afi(cA); } else { Dc = au; } }); hM.addEventListener(IPCC.J.pn['move'], function (au) { Dw.trigger('touchmove', { rawEvent: au }); }); hM.addEventListener(IPCC.J.pn['up'], function (au) { Dw.trigger('touchend', { rawEvent: au }); Dc = undefined; }); function afi(ev) { var Rg = { x: hM.scrollLeft, y: hM.scrollTop }; var wQ = hM.getBoundingClientRect(); var qA = Vo(); var KF = hM.querySelector('.pccPageListItem'); if (KF.clientWidth < wQ.width - 30) { wQ.ahS = wQ.width - KF.clientWidth; } var gL = { x: 0, y: 0, set: function (alI) { this.x = alI.x; this.y = alI.y; return this; } }; var tx = false; Wx = true; ev.preventDefault(); ev.stopPropagation(); function QI(ja) { ja.x = ja.clientX || ja.pageX || ja.screenX; ja.y = ja.clientY || ja.pageY || ja.screenY; return ja; }; var fV = QI(ev.touches[0]); var yE = QI(ev.touches[1]); var oE = aji(fV.x, fV.y, yE.x, yE.y); var ayo = aje(fV.x, fV.y, yE.x, yE.y); var FQ, Ga; function WN(au) { au.preventDefault();[].forEach.call(au.changedTouches, function (t) { if (t.identifier === fV.identifier) { FQ = QI(t); } else if (t.identifier === yE.identifier) { Ga = QI(t); } }); if (!FQ || !Ga) { return; } var aut = aji(FQ.x, FQ.y, Ga.x, Ga.y); var awc = aje(FQ.x, FQ.y, Ga.x, Ga.y); bS = aut / oE; if ((cq * bS) < qA.minFactor) { bS = qA.minFactor / cq; } else if ((cq * bS) > qA.maxFactor) { bS = qA.maxFactor / cq; } gL.set(atu(ayo, awc)); if (!tx) { tx = true; Kp(); } }; function XC() { Wx = false; tx = false; hM.removeEventListener('touchmove', WN); hM.removeEventListener('touchend', XC); if (abR) { Dw.off('touchmove', apm); Dw.off('touchend', apk); } Ks(ajF); }; var apm = function (au) { var akx = standardizeMSTouch(au.rawEvent); akx.preventDefault = function () { }; WN(akx); }; var apk = function (au) { XC(standardizeMSTouch(au.rawEvent)); }; hM.addEventListener('touchmove', WN); hM.addEventListener('touchend', XC); if (abR) { Dw.on('touchmove', apm); Dw.on('touchend', apk); } function Kp() { if (tx) { Ks(function () { aFG(bS, gL, Rg, wQ); Kp(); }); } } } }; function aIo() { if (bZ === IPCC.ViewMode.SinglePage) { return; } if (nP) { clearTimeout(nP); } if (UU) { aAy(UU); } aCS(); nP = setTimeout(function () { nP = null; UU = Ks(function aJW() { mJ(); }); }, 40); }; function Yi() { if (ni === false || bZ === IPCC.ViewMode.SinglePage) { return; } iW(true); if (nP !== null) { clearTimeout(nP); } var aqR = bA.scrollHeight / aE.length; var QC = 0; if (ea === IPCC.PageLayout.VerticalScrollDirection) { QC = bA.scrollTop; } else { QC = bA.scrollLeft; } var axA = QC - SU; SU = QC; var ayB = new Date().getTime(); var Vn = ayB - zE; if (Vn > 1000) { Vn = 1000; } YT = axA / aqR * 1000 / Vn; nP = setTimeout(function () { nP = null; zE = 0; zE = new Date().getTime(); mJ(); }, 1000); zE = new Date().getTime(); if (YT !== 0 && Math.abs(YT) < QS) { if (Jd && nP !== null) { clearTimeout(nP); nP = null; } zE = 0; zE = new Date().getTime(); setTimeout(function () { if (Jd && nP !== null) { clearTimeout(nP); nP = null; } zE = 0; zE = new Date().getTime(); mJ(); }, 40); } }; function adT(mh) { var aj = 0; var agA = false; var Oh; var MV; for (aj = 0; aj < mh.childNodes.length; aj++) { if (mh.childNodes[aj].className === "pccPageListItemLoading") { agA = true; } } if (agA === false) { MV = document.createElement('div'); MV.className = 'pccPageListItemLoading'; mh.innerHTML = ""; mh.appendChild(MV); if (KY.length > 0) { Oh = document.createElement('div'); Oh.className = 'pccPageListItemLoadingContent'; Oh.innerHTML = KY; MV.appendChild(Oh); } } }; function aCS() { var qF = bA.scrollTop; var qd = bA.scrollLeft; var xp = bA.clientHeight; var xi = bA.clientWidth; var vT = bA.scrollWidth; var vZ = bA.scrollHeight; var cJ = UR({ qF: qF, qd: qd, xp: xp, xi: xi, vT: vT, vZ: vZ }); var G = cJ.Ot; if (ni && un === false && dp !== G && G >= 0) { dp = G; var L = new IPCC.PageEventArgs(); L.imGearPage = K.get_currentPage(); L.pageIndex = dp; L.pageNodeID = aE[dp].ds; K.aM('currentPageChanged', L); } }; function WK(af) { var ax = af.aJ || hE; var cR = af.by || jg; if (af.gh % 180) { var um = ax; ax = cR; cR = um; } var Xu = af.gS || aky; return { ax: ax * (cq * ed / Xu), cR: cR * (cq * ed / Xu), aIb: Xu, dJ: af.cO }; }; function Uk(art) { return IPCC.J.reduce(art, function (eb, bj, dJ) { eb[dJ] = WK(bj); return eb; }, {}); }; function agE(aD) { var wE, DN, BU, zc, qz; if (ea === IPCC.PageLayout.VerticalScrollDirection) { wE = bA.scrollTop; DN = bA.scrollHeight; BU = bA.clientHeight; zc = 'cR'; qz = eS; } else { wE = bA.scrollLeft; DN = bA.scrollWidth; BU = bA.clientWidth; zc = 'ax'; qz = ga + ji; } var fQ = Uk(aE); var Oj = ea === IPCC.PageLayout.VerticalScrollDirection ? eS : ga; var aot = false; IPCC.J.forEach(fQ, function (bj, dJ) { if (bj.dJ === aD) { aot = true; } if (aot) { return; } Oj += bj[zc] + qz; }); return Oj - (qz / 2); }; function sN(cJ) { var Ge = IPCC.J.map(cJ.ep, function (bj) { return +bj.dJ; }).sort(); var fV = Ge[0]; var jc = Ge[Ge.length - 1]; var eD = aE.length; for (var G = Gx; G; G--) { fV -= 1; jc += 1; if (fV >= 0) { Ge.unshift(fV); } if (jc < eD) { Ge.push(jc); } } return Ge.sort(); }; function VW(cJ) { var fV = Math.max(cJ.ep[0].dJ - vu, 0); var jc = Math.min(cJ.ep[cJ.ep.length - 1].dJ + vu, aE.length - 1); return { fV: fV, jc: jc }; }; function auS(cJ) { var fV = Math.max(cJ.ep[0].dJ - Gx, 0); var jc = Math.min(cJ.ep[cJ.ep.length - 1].dJ + Gx, aE.length - 1); return { fV: fV, jc: jc }; }; function UR(bw) { if (bZ === IPCC.ViewMode.SinglePage) { return aiv(); } var wE, DN, BU, zc, qz; if (ea === IPCC.PageLayout.VerticalScrollDirection) { wE = bw.qF; DN = bw.vZ; BU = bw.xp; zc = 'cR'; qz = eS; } else { wE = bw.qd; DN = bw.vT; BU = bw.xi; zc = 'ax'; qz = ga + ji; } var auf = wE; var auV = wE + BU; var fQ = Uk(aE); var Oj = ea === IPCC.PageLayout.VerticalScrollDirection ? eS : ga; var aAo = wE / DN; var RQ = (aAo * BU) + wE; var abK = Number.MAX_VALUE; var uE = -1; var ep = []; IPCC.J.forEach(fQ, function (bj, dJ) { var iO = Oj; var ec = iO + bj[zc]; if (iO < auV && ec > auf) { bj.zx = true; ep.push(bj); } var ajo = Math.min(Math.abs(iO - RQ), Math.abs(ec - RQ)); if (iO < RQ && ec > RQ) { abK = 0; uE = dJ; } else if (ajo < abK) { uE = dJ; abK = ajo; } Oj += bj[zc] + qz; }); if (ep.length === 0 && fQ[uE] !== undefined) { ep.push(fQ[uE]); } return { ep: ep, Ot: Number(uE) || 0, Lm: fQ }; }; function aiv() { var fQ = Uk(aE); var aui = [dp]; var ep = IPCC.J.filter(fQ, function (bj) { return IPCC.J.contains(aui, +bj.dJ); }); return { ep: ep, Ot: dp, Lm: fQ }; }; function Ri() { var cJ = iW(); if (!cJ) { return []; } return IPCC.J.map(cJ.ep, function (bj) { return bj.dJ; }); }; function iW() { if (bZ === IPCC.ViewMode.SinglePage) { return aiv(); } if (bA === '' || bA.clientHeight <= 0) { return; } var qF = bA.scrollTop; var qd = bA.scrollLeft; var xp = bA.clientHeight; var xi = bA.clientWidth; var vT = bA.scrollWidth; var vZ = bA.scrollHeight; var TF = UR({ qF: qF, qd: qd, xp: xp, xi: xi, vT: vT, vZ: vZ }); if (un !== true && TF.Ot !== dp && TF.Ot >= 0) { dp = TF.Ot; var L = new IPCC.PageEventArgs(); L.imGearPage = K.get_currentPage(); L.pageIndex = dp; L.pageNodeID = aE[dp].ds; K.aM('currentPageChanged', L); } un = false; return TF; } }; IPCC.PageList.prototype = { dispose: function () { this.aI('dispose', arguments); this.Md(false); this.aDQ(); }, get_debug: function () { try { var ac = this.rC(); this.ah('get_debug', arguments, ac); return ac; } catch (e) { this.bK('get_debug', e); throw e; } }, set_debug: function (value) { try { this.aI('set_debug', arguments); var oD = this.rC(); this.Ck(value); if (!oD) { this.aI('set_debug', arguments); } } catch (e) { this.bK('set_debug', e); throw e; } }, get_debugErrorLevel: function () { try { var ac = this.pm(); this.ah('get_debugErrorLevel', arguments, ac); return ac; } catch (e) { this.bK('get_debugErrorLevel', e); throw e; } }, set_debugErrorLevel: function (value) { try { this.aI('set_debugErrorLevel', arguments); var oD = this.pm(); this.uG(value); if (oD < IPCC.Web.UI.DebugErrorLevel.Development) { this.aI('set_debugErrorLevel', arguments); } } catch (e) { this.bK('set_debugErrorLevel', e); throw e; } }, add_mouseDown: function (handler) { try { this.BS(handler); } catch (e) { this.bK('add_mouseDown', e); throw e; } }, remove_mouseDown: function (handler) { try { this.Fc(handler); } catch (e) { this.bK('remove_mouseDown', e); throw e; } }, add_mouseMove: function (handler) { try { this.Dg(handler); } catch (e) { this.bK('add_mouseMove', e); throw e; } }, remove_mouseMove: function (handler) { try { this.Gs(handler); } catch (e) { this.bK('remove_mouseMove', e); throw e; } }, add_mouseUp: function (handler) { try { this.Eu(handler); } catch (e) { this.bK('add_mouseUp', e); throw e; } }, remove_mouseUp: function (handler) { try { this.DH(handler); } catch (e) { this.bK('remove_mouseUp', e); throw e; } }, add_selectTextMouseToolCompleted: function (handler) { try { this.YE(handler); } catch (e) { this.bK('add_selectTextMouseToolCompleted', e); throw e; } }, remove_selectTextMouseToolCompleted: function (handler) { try { this.Xd(handler); } catch (e) { this.bK('remove_selectTextMouseToolCompleted', e); throw e; } }, add_currentPageChanged: function (handler) { try { this.aHs(handler); } catch (e) { this.bK('add_currentPageChanged', e); throw e; } }, remove_currentPageChanged: function (handler) { try { this.aBm(handler); } catch (e) { this.bK('remove_currentPageChanged', e); throw e; } }, add_textPageReady: function (handler) { try { this.xq(handler); } catch (e) { this.bK('add_textPageReady', e); throw e; } }, remove_textPageReady: function (handler) { try { this.yI(handler); } catch (e) { this.bK('remove_textPageReady', e); throw e; } }, add_hyperlinkPageReady: function (handler) { try { this.Xy(handler); } catch (e) { this.bK('add_hyperlinkPageReady', e); throw e; } }, remove_hyperlinkPageReady: function (handler) { try { this.afb(handler); } catch (e) { this.bK('remove_hyperlinkPageReady', e); throw e; } }, add_textExtractionFailed: function (handler) { this.Cg(handler); }, remove_textExtractionFailed: function (handler) { this.EU(handler); }, add_allPagesAdded: function (handler) { try { this.aHX(handler); } catch (e) { this.bK('add_allPagesAdded', e); throw e; } }, remove_allPagesAdded: function (handler) { try { this.aCd(handler); } catch (e) { this.bK('remove_allPagesAdded', e); throw e; } }, add_pageOpening: function (handler) { try { this.KN(handler); } catch (e) { this.bK('add_pageOpening', e); throw e; } }, remove_pageOpening: function (handler) { try { this.HJ(handler); } catch (e) { this.bK('remove_pageOpening', e); throw e; } }, add_pageOpened: function (handler) { try { this.LW(handler); } catch (e) { this.bK('add_pageOpened', e); throw e; } }, remove_pageOpened: function (handler) { try { this.HD(handler); } catch (e) { this.bK('remove_pageOpened', e); throw e; } }, add_pageOpenFailed: function (handler) { try { this.BI(handler); } catch (e) { this.bK('add_pageOpenFailed', e); throw e; } }, remove_pageOpenFailed: function (handler) { try { this.BD(handler); } catch (e) { this.bK('remove_pageOpenFailed', e); throw e; } }, add_pageDisplayed: function (handler) { try { this.Lk(handler); } catch (e) { this.bK('add_pageDisplayed', e); throw e; } }, remove_pageDisplayed: function (handler) { try { this.GY(handler); } catch (e) { this.bK('remove_pageDisplayed', e); throw e; } }, add_propertyChanged: function (handler) { try { this.lg(handler); } catch (e) { this.bK('add_propertyChanged', e); throw e; } }, remove_propertyChanged: function (handler) { try { this.nt(handler); } catch (e) { this.bK('remove_propertyChanged', e); throw e; } }, add_markAdded: function (handler) { try { this.yd(handler); } catch (e) { this.bK('add_markAdded', e); throw e; } }, remove_markAdded: function (handler) { try { this.zu(handler); } catch (e) { this.bK('remove_markAdded', e); throw e; } }, add_markCreating: function (handler) { try { this.We(handler); } catch (e) { this.bK('add_markCreating', e); throw e; } }, remove_markCreating: function (handler) { try { this.Xe(handler); } catch (e) { this.bK('remove_markCreating', e); throw e; } }, add_markChanged: function (handler) { try { this.Fb(handler); } catch (e) { this.bK('add_markChanged', e); throw e; } }, remove_markChanged: function (handler) { try { this.Gb(handler); } catch (e) { this.bK('remove_markChanged', e); throw e; } }, add_markReordered: function (handler) { try { this.EY(handler); } catch (e) { this.bK('add_markReordered', e); throw e; } }, remove_markReordered: function (handler) { try { this.Fu(handler); } catch (e) { this.bK('remove_markReordered', e); throw e; } }, add_markSelectionChanged: function (handler) { try { this.EJ(handler); } catch (e) { this.bK('add_markSelectionChanged', e); throw e; } }, remove_markSelectionChanged: function (handler) { try { this.EO(handler); } catch (e) { this.bK('remove_markSelectionChanged', e); throw e; } }, add_markTextSelectionChanged: function (handler) { try { this.JU(handler); } catch (e) { this.bK('add_markTextSelectionChanged', e); throw e; } }, remove_markTextSelectionChanged: function (handler) { try { this.Ig(handler); } catch (e) { this.bK('remove_markTextSelectionChanged', e); throw e; } }, add_markRemoved: function (handler) { try { this.yp(handler); } catch (e) { this.bK('add_markRemoved', e); throw e; } }, remove_markRemoved: function (handler) { try { this.zp(handler); } catch (e) { this.bK('remove_markRemoved', e); throw e; } }, add_commentAdding: function (handler) { try { this.aFF(handler); } catch (e) { this.bK('add_commentAdding', e); throw e; } }, remove_commentAdding: function (handler) { try { this.aBX(handler); } catch (e) { this.bK('remove_commentAdding', e); throw e; } }, add_commentAdded: function (handler) { try { this.xy(handler); } catch (e) { this.bK('add_commentAdded', e); throw e; } }, remove_commentAdded: function (handler) { try { this.FN(handler); } catch (e) { this.bK('remove_commentAdded', e); throw e; } }, add_commentRemoved: function (handler) { try { this.xP(handler); } catch (e) { this.bK('add_commentRemoved', e); throw e; } }, remove_commentRemoved: function (handler) { try { this.DM(handler); } catch (e) { this.bK('remove_commentRemoved', e); throw e; } }, add_commentChanged: function (handler) { try { this.vW(handler); } catch (e) { this.bK('add_commentChanged', e); throw e; } }, remove_commentChanged: function (handler) { try { this.vp(handler); } catch (e) { this.bK('remove_commentChanged', e); throw e; } }, add_scaleChanged: function (handler) { try { this.ZI(handler); } catch (e) { this.bK('add_scaleChanged', e); throw e; } }, remove_scaleChanged: function (handler) { try { this.WZ(handler); } catch (e) { this.bK('remove_scaleChanged', e); throw e; } }, add_exceptionThrown: function (handler) { this.XA(handler); }, remove_exceptionThrown: function (handler) { this.Wh(handler); }, writeToLog: function (message) { try { this.iP(message); } catch (e) { this.bK('writeToLog', e); throw e; } }, get_currentState: function () { try { var ac = this.wm(); this.ah('get_currentState', arguments, ac); return ac; } catch (e) { this.bK('get_currentState', e); throw e; } }, get_scaleFactor: function () { try { var ac = this.qs(); this.ah('get_scaleFactor', arguments, ac); return ac; } catch (e) { this.bK('get_scaleFactor', e); throw e; } }, set_scaleFactor: function (scaleFactor) { try { this.aI('set_scaleFactor', arguments); this.aDj(scaleFactor); } catch (e) { this.bK('set_scaleFactor', e); throw e; } }, zoomIn: function (factor) { try { this.aI('zoomIn', arguments); this.TU(factor); } catch (e) { this.bK('zoomIn', e); throw e; } }, zoomOut: function (factor) { try { this.aI('zoomOut', arguments); this.UV(factor); } catch (e) { this.bK('zoomOut', e); throw e; } }, getMinMaxZoom: function () { return this.aGo(); }, displayAll: function () { try { this.aI('displayAll', arguments, 1); this.awv(); } catch (e) { this.bK('displayAll', e); throw e; } }, display: function (pageIndex) { try { this.aI('display', arguments); this.cn(pageIndex); } catch (e) { this.bK('display', e); throw e; } }, get_textRequired: function () { try { var ac = this.iw(); this.ah('get_textRequired', arguments, ac); return ac; } catch (e) { this.bK('get_textRequired', e); throw e; } }, set_textRequired: function (value) { try { this.aI('set_textRequired', arguments); this.zr(value); } catch (e) { this.bK('set_textRequired', e); throw e; } }, selectText: function (pageIndex, startIndex, endIndex, color) { try { this.aI('selectText', arguments, 1); this.ZA(pageIndex, startIndex, endIndex, color); } catch (e) { this.bK('selectText', e); throw e; } }, clearSelectedText: function (pageIndex) { try { this.aI('clearSelectedText', arguments, 1); this.aBP(pageIndex); } catch (e) { this.bK('clearSelectedText', e); throw e; } }, clearAllSelectedText: function () { try { this.aI('clearAllSelectedText', arguments); this.aBr(); } catch (e) { this.bK('clearAllSelectedText', e); throw e; } }, get_maxPrefetch: function () { try { var ac = this.aIj(); this.ah('get_maxPrefetch', arguments, ac); return ac; } catch (e) { this.bK('get_maxPrefetch', e); throw e; } }, set_maxPrefetch: function (value) { try { this.aI('set_maxPrefetch', arguments); this.aHh(value); } catch (e) { this.bK('set_maxPrefetch', e); throw e; } }, get_displayPagesWhenScrolling: function () { try { var ac = this.arM(); this.ah('get_displayPagesWhenScrolling', arguments, ac); return ac; } catch (e) { this.bK('get_displayPagesWhenScrolling', e); throw e; } }, set_displayPagesWhenScrolling: function (value) { try { this.aI('set_displayPagesWhenScrolling', arguments); this.aFm(value); } catch (e) { this.bK('set_displayPagesWhenScrolling', e); throw e; } }, get_maxOutOfViewDisplay: function () { try { var ac = this.aHc(); this.ah('get_maxOutOfViewDisplay', arguments, ac); return ac; } catch (e) { this.bK('get_maxOutOfViewDisplay', e); throw e; } }, set_maxOutOfViewDisplay: function (value) { try { this.aI('set_maxOutOfViewDisplay', arguments); this.aHj(value); } catch (e) { this.bK('set_maxOutOfViewDisplay', e); throw e; } }, get_discardOutOfViewText: function () { try { var ac = this.aru(); this.ah('get_discardOutOfViewText', arguments, ac); return ac; } catch (e) { this.bK('get_discardOutOfViewText', e); throw e; } }, set_discardOutOfViewText: function (value) { try { this.aI('set_discardOutOfViewText', arguments); this.aFj(value); } catch (e) { this.bK('set_discardOutOfViewText', e); throw e; } }, get_scrollDisplayThreshold: function () { try { var ac = this.aGB(); this.ah('get_scrollDisplayThreshold', arguments, ac); return ac; } catch (e) { this.bK('get_scrollDisplayThreshold', e); throw e; } }, set_scrollDisplayThreshold: function (value) { try { this.aI('set_scrollDisplayThreshold', arguments); this.aEr(value); } catch (e) { this.bK('set_scrollDisplayThreshold', e); throw e; } }, get_mouseCursor: function () { try { var ac = this.akU(); this.ah('get_mouseCursor', arguments, ac); return ac; } catch (e) { this.bK('akU', e); throw e; } }, set_mouseCursor: function (value) { try { this.aI('set_mouseCursor', arguments); this.aHd(value); } catch (e) { this.bK('set_mouseCursor', e); throw e; } }, get_mouseTool: function () { try { var ac = this.adj(); this.ah('get_mouseTool', arguments, ac); return ac; } catch (e) { this.bK('get_mouseTool', e); throw e; } }, set_mouseTool: function (value) { try { this.aI('set_mouseTool', arguments); this.LJ(value); } catch (e) { this.bK('set_mouseTool', e); throw e; } }, get_markHandleMode: function () { try { var ac = this.Cp(); this.aI('get_markHandleMode', arguments); return ac; } catch (e) { this.bK('get_markHandleMode', e); throw e; } }, set_markHandleMode: function (F) { try { this.aI('set_markHandleMode', arguments); this.Mb(F); } catch (e) { this.bK('set_markHandleMode', e); throw e; } }, get_retainPageText: function () { try { var ac = this.aGl(); this.aI('get_retainPageText', arguments); return ac; } catch (e) { this.bK('get_retainPageText', e); throw e; } }, set_retainPageText: function (F) { try { this.aI('set_retainPageText', arguments); this.aEl(F); } catch (e) { this.bK('set_retainPageText', e); throw e; } }, get_allowMarkEdits: function () { try { var ac = this.atH(); this.aI('get_allowMarkEdits', arguments); return ac; } catch (e) { this.bK('get_allowMarkEdits', e); throw e; } }, set_allowMarkEdits: function (bool) { try { this.aI('set_allowMarkEdits', arguments); this.aGU(! !bool); } catch (e) { this.bK('set_allowMarkEdits', e); throw e; } }, get_currentPage: function () { try { var ac = this.ajl(); this.ah('get_currentPage', arguments, ac); return ac; } catch (e) { this.bK('get_currentPage', e); throw e; } }, get_pageNodeId: function (pageIndex) { try { var anp = this.aGA(pageIndex); this.ah('get_pageNodeId', arguments, anp); return anp; } catch (e) { this.bK('get_pageNodeId', e); throw e; } }, scrollToNextPage: function () { try { this.aI('scrollToNextPage', arguments); this.aAP(); } catch (e) { this.bK('scrollToNextPage', e); throw e; } }, scrollToPreviousPage: function () { try { this.aI('scrollToPreviousPage', arguments); this.azU(); } catch (e) { this.bK('scrollToPreviousPage', e); throw e; } }, scrollToFirstPage: function () { try { this.aI('scrollToFirstPage', arguments); this.azL(); } catch (e) { this.bK('scrollToFirstPage', e); throw e; } }, scrollToLastPage: function () { try { this.aI('scrollToLastPage', arguments); this.azv(); } catch (e) { this.bK('scrollToLastPage', e); throw e; } }, scrollToPage: function (pageIndex) { try { this.aI('scrollToPage', arguments, 1); this.rU(pageIndex); } catch (e) { this.bK('scrollToPage', e); throw e; } }, rotate: function (degreesClockwise) { try { this.aI('rotate', arguments, 1); this.azW(degreesClockwise); } catch (e) { this.bK('rotate', e); throw e; } }, rotateAll: function (degreesClockwise) { try { this.aI('rotateAll', arguments, 1); this.agP(degreesClockwise, true); } catch (e) { this.bK('rotateAll', e); throw e; } }, get_enabled: function () { try { var ac = this.QX(); this.ah('get_enabled', arguments, ac); return ac; } catch (e) { this.bK('get_enabled', e); throw e; } }, get_pageLayout: function () { try { var ac = this.aDu(); this.ah('get_pageLayout', arguments, ac); return ac; } catch (e) { this.bK('get_pageLayout', e); throw e; } }, set_pageLayout: function (value) { try { this.aI('set_pageLayout', arguments); this.aHY(value); } catch (e) { this.bK('set_pageLayout', e); throw e; } }, get_viewMode: function () { try { var ac = this.aDS(); this.ah('get_viewMode', arguments, ac); return ac; } catch (e) { this.bK('get_viewMode', e); throw e; } }, set_viewMode: function (value) { try { this.aI('set_viewMode', arguments); this.OK(value); } catch (e) { this.bK('set_viewMode', e); throw e; } }, get_loadingContent: function () { try { var ac = this.aGV(); this.ah('get_loadingContent', arguments, ac); return ac; } catch (e) { this.bK('get_loadingContent', e); throw e; } }, set_loadingContent: function (value) { try { this.aI('set_loadingContent', arguments); this.aIw(value); } catch (e) { this.bK('set_loadingContent', e); throw e; } }, fitPages: function (fitType) { try { this.aI('fitPages', arguments, 1); this.aqS(fitType); } catch (e) { this.bK('fitPages', e); throw e; } }, openPage: function (pageIndex) { try { this.aI('openPage', arguments, 1); this.Fj(pageIndex); } catch (e) { this.bK('openPage', e); throw e; } }, requestPageAttributes: function (page, attributesRetrievedCallback, attributesRetrievalFailedCallback) { try { this.aI('requestPageAttributes', arguments, 1); this.SA(page, attributesRetrievedCallback, attributesRetrievalFailedCallback); } catch (e) { this.bK('requestPageAttributes', e); throw e; } }, scrollRegionIntoView: function (pageIndex, rectangle) { try { this.aI('scrollRegionIntoView', arguments, 1); return this.azf(pageIndex, rectangle); } catch (e) { this.bK('scrollRegionIntoView', e); throw e; } }, scrollBy: function (xVal, yVal) { try { this.aI('scrollBy', arguments, 1); return this.axv(xVal, yVal); } catch (e) { this.bK('scrollBy', e); throw e; } }, scrollConversationIntoView: function (conversation) { try { this.aI('scrollConversationIntoView', arguments, 1); return this.ayh(conversation); } catch (e) { this.bK('scrollConversationIntoView', e); throw e; } }, get_documents: function () { return this.ND(); }, get_encryption: function () { try { var ac = this.eG(); this.ah('get_encryption', arguments, ac); return ac; } catch (e) { this.bK('get_encryption', e); throw e; } }, set_encryption: function (value) { try { this.aI('set_encryption', arguments); this.iA(value); } catch (e) { this.bK('set_encryption', e); throw e; } }, get_annotationXmlDom: function () { try { var ac = this.auP(); return ac; } catch (e) { this.bK('get_annotationXmlDom', e); throw e; } }, set_annotationXmlDom: function (value, stampImages, retainExistingMarks, loadAsHidden) { try { this.aIu(value, stampImages, retainExistingMarks, loadAsHidden); } catch (e) { this.bK('set_annotationXmlDom', e); throw e; } }, get_resourcePath: function () { try { var ac = this.nQ(); this.ah('get_resourcePath', arguments, ac); return ac; } catch (e) { this.bK('get_resourcePath', e); throw e; } }, set_resourcePath: function (F) { try { this.aI('set_resourcePath', arguments); this.uR(F); } catch (e) { this.bK('set_resourcePath', e); throw e; } }, get_redactionDraftMode: function () { try { var ac = this.kU(); this.ah('get_redactionDraftMode', arguments, ac); return ac; } catch (e) { this.bK('get_redactionDraftMode', e); throw e; } }, set_redactionDraftMode: function (value) { try { this.aI('set_redactionDraftMode', arguments); this.rq(value); } catch (e) { this.bK('set_redactionDraftMode', e); throw e; } }, get_displayedPages: function () { try { var ac = this.arz(); this.ah('get_displayedPages', arguments, ac); return ac; } catch (e) { this.bK('get_displayedPages', e); throw e; } }, get_requireRequestsOptimize: function () { try { var ac = this.ou(); this.ah('get_requireRequestsOptimize', arguments, ac); return ac; } catch (e) { this.bK('ou', e); throw e; } }, set_requireRequestsOptimize: function (value) { try { this.aI('set_requireRequestsOptimize', arguments); this.tw(value); } catch (e) { this.bK('set_requireRequestsOptimize', e); throw e; } }, get_serviceResponseTimeout: function () { try { var ac = this.hT(); this.ah('get_serviceResponseTimeout', arguments, ac); return ac; } catch (e) { this.bK('get_serviceResponseTimeout', e); throw e; } }, set_serviceResponseTimeout: function (value) { try { this.aI('set_serviceResponseTimeout', arguments); this.tm(value); } catch (e) { this.bK('set_serviceResponseTimeout', e); throw e; } }, get_pageRotation: function () { try { var ac = this.aFq(); this.ah('get_pageRotation', arguments, ac); return ac; } catch (e) { this.bK('get_pageRotation', e); throw e; } }, set_pageRotation: function (value) { try { this.aI('set_pageRotation', arguments); this.aIz(value); } catch (e) { this.bK('set_pageRotation', e); throw e; } }, getNodeID: function (pageIndex) { try { this.aI('getNodeID', arguments, 1); return this.aGH(pageIndex); } catch (e) { this.bK('getNodeID', e); throw e; } }, get_isCommentsPanelOpen: function () { try { var ac = this.asb(); this.ah('get_isCommentsPanelOpen', arguments, ac); return ac; } catch (e) { this.bK('get_isCommentsPanelOpen', e); throw e; } }, openCommentsPanel: function () { try { this.aI('openCommentsPanel', arguments); this.axC(); } catch (e) { this.bK('openCommentsPanel', e); throw e; } }, closeCommentsPanel: function () { try { this.aI('closeCommentsPanel', arguments); this.aCl(); } catch (e) { this.bK('closeCommentsPanel', e); throw e; } }, get_conversationDOMFactory: function () { try { var ac = this.asF(); this.ah('get_conversationDOMFactory', arguments, ac); return ac; } catch (e) { this.bK('get_conversationDOMFactory', e); throw e; } }, set_conversationDOMFactory: function (value) { try { this.aI('set_conversationDOMFactory', arguments); this.aHU(value); } catch (e) { this.bK('set_conversationDOMFactory', e); throw e; } }, get_selectedConversation: function () { try { var ac = this.aFN(); this.ah('get_selectedConversation', arguments, ac); return ac; } catch (e) { this.bK('get_selectedConversation', e); throw e; } }, set_selectedConversation: function (value) { try { this.aI('set_selectedConversation', arguments); this.aEF(value); } catch (e) { this.bK('set_selectedConversation', e); throw e; } }, refreshConversations: function (markIDs) { try { this.aI('refreshConversations', arguments); this.aCJ(markIDs); } catch (e) { this.bK('refreshConversations', e); throw e; } } }; IPCC.PageList.registerClass = IPCC.Web.regClass; IPCC.PageList.registerClass('IPCC.PageList', IPCC.Sys.UI.Control); IPCC.af = function (bo) { this.bd = bo.page; this.aJ = 0; this.by = 0; this.gS = 0; this.hq = 0; var bC = new IPCC.Web.UI.fR(); this.Am = undefined; this.DW = undefined; this.ht = false; this.EC = false; this.xV = 0; this.avy = undefined; this.kw = false; this.iT = false; this.GD = false; this.gh = 0; this.Ik = 0; this.Hs = false; this.GN = false; this.aX = new IPCC.Web.UI.ArtPage(); this.eO = new IPCC.Web.UI.ArtPage(); this.cO = this.bd.get_pageNumber(); this.ds = this.bd.bE.st + '_' + this.cO + '__pViewId'; this.bE = this.bd.bE; this.aL = function (cr) { var V = bC.getHandler('propertyChanged'); if (V) { V(this, new IPCC.qP(cr)); } }; return this; }; IPCC.af.prototype.ml = function () { if (this.bd) { return this.bd.kO() || this.aJ; } return this.aJ; }; IPCC.af.prototype.pM = function () { if (this.bd) { return this.bd.iE() || this.by; } return this.by; }; IPCC.af.prototype.YQ = function (bool) { bool = ! !bool; if (this.bd) { this.bd.Hs = bool; } this.Hs = bool; }; IPCC.af.prototype.agW = function () { if (this.bd) { return this.bd.Hs || this.Hs; } return this.Hs; }; IPCC.ej = function () { this.dR = undefined; return this; }; var PCCViewer = window.PCCViewer || {}; (function (PCCViewer) { var wX = '12.4.0.0347'; PCCViewer.Zw = function Zw() { return wX; }; })(PCCViewer); (function (PCCViewer) { PCCViewer.Error = function (code, message) { var alm = Error.call(null, message); this.code = code; function ayN(cD, hj) { Object.getOwnPropertyNames(hj).forEach(function (propName) { Object.defineProperty(cD, propName, Object.getOwnPropertyDescriptor(hj, propName)); }); return cD; }; function ayv(cD, hj) { for (var i in hj) { if (hj.hasOwnProperty(i)) { cD[i] = hj[i]; } } return cD; }; if (typeof Object.create === 'function') { ayN(this, alm); } else { ayv(this, alm); } }; var awq = (function () { var fp = function () { }; return function (amu) { if (arguments.length > 1) { throw Error('Second argument not supported'); } if (typeof amu !== 'object') { throw TypeError('Argument must be an object'); } fp.prototype = amu; var bM = new fp(); fp.prototype = null; return bM; }; })(); if (typeof Object.create === 'function') { PCCViewer.Error.prototype = Object.create(Error.prototype); } else { PCCViewer.Error.prototype = awq(Error.prototype); } PCCViewer.Error.prototype.constructor = PCCViewer.Error; })(PCCViewer || {}); (function (PCCViewer) { PCCViewer.Language = { data: {}, initializeData: function (aGR) { PCCViewer.Language.data = IPCC.J.extend({}, aGR); return PCCViewer.Language; }, getData: function () { return PCCViewer.Language.data; }, getValue: function (anr) { if (typeof PCCViewer.Language.data === 'undefined') { throw new Error('Language data is not set.'); } var oG = anr.split('.'), aC = PCCViewer.Language.data, aq; while (oG.length) { aq = oG.shift(); aC = aC[aq]; if (typeof aC === 'undefined') { aC = anr; break; } } return aC; } }; })(PCCViewer || {}); (function (PCCViewer) { "use strict"; function Event(target, type) { this.cD = target; this.aa = type; }; PCCViewer.Event = Event; PCCViewer.Event.prototype.getTarget = function () { return this.cD; }; PCCViewer.Event.prototype.getType = function () { return this.aa; }; if (Object.defineProperties) { Object.defineProperties(PCCViewer.Event.prototype, { "target": { enumerable: true, get: function () { return this.getTarget(); } }, "type": { enumerable: true, get: function () { return this.getType(); } } }); } PCCViewer.EventEmitter = (function () { function on(eventType, handler) { if (!this.ln) { this.ln = {}; } var lowerCaseEventType = eventType.toLowerCase(), handlers = this.ln[lowerCaseEventType]; if (!handlers) { handlers = this.ln[lowerCaseEventType] = []; } handlers.push(handler); return this; }; function off(eventType, handler) { if (!this.ln) { this.ln = {}; } var lowerCaseEventType = eventType.toLowerCase(), handlers = this.ln[lowerCaseEventType]; if (handlers) { var i = handlers.length; for (; i >= 0; i--) { if (handlers[i] === handler) { handlers.splice(i, 1); } } } return this; }; function trigger(eventType, properties) { if (!this.ln) { this.ln = {}; } var lowerCaseEventType = eventType.toLowerCase(), event = new PCCViewer.Event(this, lowerCaseEventType), handlers = this.ln[lowerCaseEventType], i, length = 0; if (properties) { PCCViewer.BV.uQ(event, properties); } if (handlers) { length = handlers.length; handlers = handlers.slice(0); for (i = 0; i < length; i++) { handlers[i](event); } } return this; }; return { extend: function (o) { o.on = on; o.off = off; o.trigger = trigger; } }; })(); })(PCCViewer || {}); (function (PCCViewer) { 'use strict'; function PromiseDeferred() { this.dW = PromiseDeferred.States.Pending; this.F = null; this.fr = null; this.gg = []; }; PromiseDeferred.prototype.then = function (onFulfilled, onRejected) { var zn = new PromiseDeferred(); var aaD, WB; if (onFulfilled && typeof onFulfilled === 'function') { var auY = function (F) { try { var ac = onFulfilled(F); zn.resolve(ac); } catch (e) { zn.reject(e); } }; aaD = auY; } else { var atx = function (F) { zn.resolve(F); }; aaD = atx; } if (onRejected && typeof onRejected === 'function') { var axG = function (fr) { try { var ac = onRejected(fr); Xp(zn, ac); } catch (e) { zn.reject(e); } }; WB = axG; } else { var ayI = function (fr) { zn.reject(fr); }; WB = ayI; } this.gg.push({ arP: aaD, aCh: WB }); if (this.dW === PromiseDeferred.States.Fulfilled) { this.amz(); } if (this.dW === PromiseDeferred.States.Rejected) { this.alP(); } return zn; }; PromiseDeferred.prototype.resolve = function (x) { if (!this.aov()) { return; } Xp(this, x); }; PromiseDeferred.prototype.reject = function (reason) { if (!this.aov()) { return; } this.Ez(reason); }; PromiseDeferred.prototype.Wr = function (aY) { this.dW = PromiseDeferred.States.Fulfilled; this.F = aY; this.amz(); }; PromiseDeferred.prototype.amz = function () { var callback; while (this.gg.length > 0) { callback = this.gg.shift().arP; (function (nD, F) { setTimeout(function () { nD(F); }, 0); })(callback, this.F); } }; PromiseDeferred.prototype.alP = function () { var callback; while (this.gg.length > 0) { callback = this.gg.shift().aCh; (function (nD, F) { setTimeout(function () { nD(F); }, 0); })(callback, this.fr); } }; function Xp(cZ, aY) { if (cZ === aY) { cZ.Ez(new TypeError("A Promise cannot be resolved with a value that is itself.")); return; } if (aY && aY.adQ && cZ.amY && cZ.amY === aY) { cZ.Ez(new TypeError("A Promise cannot be resolved with a value that is itself.")); return; } if (aY && aY.adQ && aY.adQ === "PCCViewer.Promise") { aY.then(function (aul) { cZ.Wr(aul); }, function (atG) { cZ.Ez(atG); }); } else if (aY !== null && (typeof aY === 'object' || typeof aY === 'function')) { var Ur; try { Ur = aY.then; } catch (e) { cZ.Ez(e); return; } if (typeof Ur === 'function') { var IZ = true; var atC = function (fJ) { if (IZ) { Xp(cZ, fJ); IZ = false; } }; var atn = function (ac) { if (IZ) { cZ.Ez(ac); IZ = false; } }; try { Ur.call(aY, atC, atn); } catch (e) { if (IZ) { cZ.Ez(e); } } } else { cZ.Wr(aY); } } else { cZ.Wr(aY); } }; PromiseDeferred.prototype.Ez = function (reason) { this.dW = PromiseDeferred.States.Rejected; this.fr = reason; this.alP(); }; PromiseDeferred.prototype.aov = function () { return this.dW === PromiseDeferred.States.Pending; }; PromiseDeferred.States = { Pending: "Pending", Fulfilled: "Fulfilled", Rejected: "Rejected" }; PCCViewer.Deferred = function () { var WO = new PromiseDeferred(); function Promise(cZ) { this.then = function (onFulfilled, onRejected) { return new Promise(cZ.then(onFulfilled, onRejected)); }; this.adQ = "PCCViewer.Promise"; cZ.amY = this; }; var promise = new Promise(WO); return { getPromise: function () { return promise; }, resolve: function (value) { WO.resolve(value); }, reject: function (reason) { WO.reject(reason); } }; }; PCCViewer.Promise = { all: function (promises) { var i, aT = new PCCViewer.Deferred(), VI = aT.getPromise(); if (Object.prototype.toString.call(promises) !== '[object Array]') { throw new TypeError("The 'promises' argument must be an array."); } function createPushFunction(promise) { return function (results) { return wrapWithPromise(promise).then(function (value) { results.push(value); return results; }); }; }; function wrapWithPromise(value) { var aT = new PCCViewer.Deferred(); aT.resolve(value); return aT.getPromise(); }; aT.resolve([]); for (i = 0; i < promises.length; i++) { VI = VI.then(createPushFunction(promises[i])); } return VI; } }; if (typeof exports !== 'undefined' && module.exports) { module.exports.Deferred = PCCViewer.Deferred; } })(PCCViewer || {}); (function (PCCViewer) { "use strict"; PCCViewer.AjaxResponse = function (bF) { if (bF instanceof PCCViewer.AjaxResponse) { return bF; } else if (!(this instanceof PCCViewer.AjaxResponse)) { return new PCCViewer.AjaxResponse(bF); } this.tc = new IPCC.J.tc(bF); this.status = this.tc.status; this.statusText = this.tc.statusText; this.responseText = this.tc.responseText; if (typeof this.tc.responseBody !== 'undefined') { this.responseBody = this.tc.responseBody; } return this; }; PCCViewer.AjaxResponse.prototype.getResponseHeader = function (ZX) { return this.tc.getResponseHeader(ZX); }; PCCViewer.Ajax = (function () { function aqV() { return IPCC.J.extend({}, IPCC.J.mt.hY); }; function aBx(hY) { if (!(typeof hY === 'undefined' || (typeof hY === 'object' && hY !== null && !(hY instanceof Array)))) { throw new Error('Headers should be an object or undefined.'); } IPCC.J.mt.hY = IPCC.J.extend({}, hY); return PCCViewer.Ajax; }; function apA() { return IPCC.J.mt.OM; }; function aCc(kg) { if (typeof kg !== 'undefined' && typeof kg !== 'function') { throw new Error('Method should be a function or undefined.'); } IPCC.J.mt.OM = kg; return PCCViewer.Ajax; }; function dZ(aH) { var aT = PCCViewer.Deferred(); if (!(typeof aH === 'undefined' || (typeof aH === 'object' && aH !== null && !(aH instanceof Array)))) { throw new Error('Options should be an object or undefined.'); } function fa(bF) { if (!(bF instanceof PCCViewer.AjaxResponse)) { bF = new PCCViewer.AjaxResponse(bF); } aT.resolve(bF); }; function eZ(bM) { if (bM.response) { bM.response = new PCCViewer.AjaxResponse(bM.response); } aT.reject(bM); }; IPCC.J.mt.dZ(aH).then(fa, eZ); return aT.getPromise(); }; return { getHeaders: aqV, setHeaders: aBx, getOverrideMethod: apA, setOverrideMethod: aCc, dZ: dZ, }; })(); if (Object.defineProperties) { Object.defineProperties(PCCViewer.Ajax, { "headers": { enumerable: true, get: function () { return PCCViewer.Ajax.getHeaders(); }, set: function (hY) { return PCCViewer.Ajax.setHeaders(hY); } }, "overrideMethod": { enumerable: true, get: function () { return PCCViewer.Ajax.getOverrideMethod(); }, set: function (kg) { return PCCViewer.Ajax.setOverrideMethod(kg); } } }); } })(PCCViewer || {}); (function (PCCViewer) { function afQ(message, value) { var err = new Error('PCC Range Error: ' + message); err.value = value; return err; }; function aHG(aAw) { var aE = []; var anJ = function (n) { return !(isNaN(+n)); }; var aie = aAw.split(','); var Ug, Xn; var RH = 0; var Qw = 0; for (var G = 0; G < aie.length; G++) { var IY = aie[G].split('-'); var HS = IY[0].replace(/\s+/g, ''); if (HS.length === 0) { continue; } var Ku = HS; if (IY[1] !== undefined && IY[1] !== "") { Ku = IY[1].replace(/\s+/g, ''); } HS = +(HS); Ku = +(Ku); if (anJ(HS) === true) { RH = parseInt(HS); } if (anJ(Ku) === true) { Qw = parseInt(Ku); } if (RH < Qw) { Ug = RH; Xn = Qw; } else { Ug = Qw; Xn = RH; } if (IY.length > 1) { for (var ak = Ug; ak <= Xn; ak++) { aE.push(ak); } } else { aE.push(Ug); } } aE.sort(function (a, b) { return a - b; }); for (G = aE.length - 1; G > 0; G--) { if (aE[G - 1] === aE[G]) { aE.splice(G, 1); } } return aE; }; var alternateObjectURL = function (blob, str) { blob.data = str; var type = blob.type, data_URI_header; if (type === null) { type = "application/octet-stream"; } data_URI_header = "data:" + type; if (blob.encoding === "base64") { return data_URI_header + ";base64," + blob.data; } else if (blob.encoding === "URI") { return data_URI_header + "," + decodeURIComponent(blob.data); } if (btoa) { return data_URI_header + ";base64," + btoa(blob.data); } else { return data_URI_header + "," + encodeURIComponent(blob.data); } }; PCCViewer.Util = { save: function (filename, stringValue) { if ('Blob' in window) { var blob = new Blob([stringValue], { 'type': 'text/plain;charset=utf-8' }); if (window.navigator.msSaveBlob) { window.navigator.msSaveBlob(blob, filename); } else if (window.saveAs) { window.saveAs(blob, filename); } else if (window.URL && window.URL.createObjectURL) { var a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.target = '_blank'; a.download = filename; a.style.display = 'none'; document.body.appendChild(a); a.click(); document.body.removeChild(a); } else { var objectURL = alternateObjectURL(blob, stringValue); window.open(objectURL); } } else { if (document.execCommand) { var oWin = window.open('about:blank', '_blank'); oWin.document.write(stringValue); oWin.document.close(); oWin.document.execCommand('SaveAs', true, filename + '.txt'); oWin.close(); } } }, calculateNonOverlappingSelections: function (selections, backgroundColor) { var hF; if (!(selections instanceof Array)) { hF = [selections]; } else { hF = selections; } IPCC.J.forEach(hF, function (dk) { IPCC.ad.ps(dk.startIndex, 'selection.startIndex', 0, Number.MAX_VALUE); IPCC.ad.ps(dk.length, 'selection.length', 1, Number.MAX_VALUE); IPCC.ad.dU(dk.color, 'selection.color'); IPCC.ad.ps(dk.opacity, 'selection.opacity', 0, 255); }); IPCC.ad.dU(backgroundColor, 'backgroundColor'); var aDz = IPCC.J.akE(hF); return IPCC.J.map(aDz, function (bL) { bL.length = bL.endIndex - bL.startIndex + 1; return bL; }); }, layerColors: function (colors, backgroundColor) { var Rh; if (!(colors instanceof Array)) { Rh = [colors]; } else { Rh = colors; } IPCC.J.forEach(Rh, function (dk) { IPCC.ad.dU(dk.color, 'selection.color'); IPCC.ad.ps(dk.opacity, 'selection.opacity', 0, 255); }); IPCC.ad.dU(backgroundColor, 'backgroundColor'); return IPCC.J.alM(Rh, backgroundColor); }, validatePageRange: function (pageRange, options) { if (pageRange && typeof pageRange !== 'string') { return false; } else { try { PCCViewer.Util.convertPageRangeToArray(pageRange, options); } catch (e) { return false; } return true; } }, convertPageRangeToArray: function (pageRange, options) { options = options || {}; var lowerLimit = options.lowerLimit || 1, upperLimit = options.upperLimit || Number.MAX_VALUE, allowEmpty = options.allowEmpty || false; if (pageRange !== 'all' && pageRange.match(/[^0-9\-\,\s]/g)) { throw afQ('Illegal page range value', pageRange); } var dP = []; if (pageRange === 'all') { while (upperLimit >= lowerLimit) { dP.unshift(upperLimit--); } } else { dP = aHG(pageRange); if ((dP.length === 0 && !allowEmpty) || dP[0] < lowerLimit || dP[dP.length - 1] > upperLimit) { throw afQ('Pages are out of range', dP.join(', ')); } } return dP; } }; })(PCCViewer || {}); (function (PCCViewer) { PCCViewer.ObservableCollection = function () { var Cy = []; var rh = {}; PCCViewer.EventEmitter.extend(rh); rh.Ox = function (Gq, dm) { var K = this; return setTimeout(function () { K.trigger(Gq, dm); }, 0); }; this.add = function (item) { Cy.push(item); rh.Ox(this.EventType.ItemAdded, { item: item, count: Cy.length }); return this; }; this.remove = function (item) { var K = this; this.forEach(function (e, idx) { if (e === item) { Cy.splice(idx, 1); rh.Ox(K.EventType.ItemRemoved, { item: item, count: Cy.length }); } }); return this; }; this.removeAll = function () { Cy = []; rh.Ox(this.EventType.ItemRemoved, { count: Cy.length }); return this; }; this.forEach = function (iterator, thisArg) { if (typeof iterator !== 'function') { throw new TypeError('The iterator parameter is not a function'); } IPCC.J.forEach(this.toArray(), iterator, thisArg); return this; }; this.toArray = function () { return [].concat(Cy); }; this.on = function (eventType, handler) { rh.on.apply(rh, arguments); return this; }; this.off = function (eventType, handler) { rh.off.apply(rh, arguments); return this; }; }; PCCViewer.ObservableCollection.prototype.EventType = { ItemAdded: "ItemAdded", ItemRemoved: "ItemRemoved" }; })(PCCViewer || {}); (function (PCCViewer) { "use strict"; PCCViewer.Data = (function () { function getData(key) { return this.dc.get_data(key); }; function setData(key, value) { this.dc.set_data(key, value); return this; }; function getDataKeys() { return this.dc.get_dataKeys(); }; return { extend: function (o) { o.getData = getData; o.setData = setData; o.getDataKeys = getDataKeys; }, qH: function (hj, qv) { if (typeof hj.getData !== "function" || typeof hj.setData !== "function" || typeof hj.getDataKeys !== "function" || typeof qv.getData !== "function" || typeof qv.setData !== "function" || typeof qv.getDataKeys !== "function") { throw new Error("Arguments `_source` and `_destination` must be extended with the Data Mixin."); } var oG = hj.getDataKeys(), i, length = oG.length; for (i = 0; i < length; i++) { var aq = oG[i]; qv.setData(aq, hj.getData(aq)); } } }; })(); PCCViewer.SessionData = (function () { function getSessionData(key) { return this.Fk.get_data(key); }; function setSessionData(key, value) { this.Fk.set_data(key, value); return this; }; function getSessionDataKeys() { return this.Fk.get_dataKeys(); }; return { extend: function (o) { o.getSessionData = getSessionData; o.setSessionData = setSessionData; o.getSessionDataKeys = getSessionDataKeys; }, aKq: function (hj, qv) { if (typeof hj.getSessionData !== "function" || typeof hj.setSessionData !== "function" || typeof hj.getSessionDataKeys !== "function" || typeof qv.getSessionData !== "function" || typeof qv.setSessionData !== "function" || typeof qv.getSessionDataKeys !== "function") { throw new Error("Arguments `_source` and `_destination` must be extended with the SessionData Mixin."); } var oG = hj.getSessionDataKeys(), i, length = oG.length; for (i = 0; i < length; i++) { var aq = oG[i]; qv.setSessionData(aq, hj.getSessionData(aq)); } } }; })(); })(PCCViewer || {}); (function (PCCViewer) { 'use strict'; function Mark(parameters) { this.bp = 0; this.fg = undefined; this.CJ = false; this.qi = PCCViewer.Mark.InteractionMode.Full; this.ep = true; if (parameters.uid && parameters.viewerControl) { (function (bN, mD) { IPCC.J.forEach(bN, function validateMark(lH) { if (lH.getUid() === mD) { throw new Error('Uid ' + mD + ' already exists in the document and cannot be duplicated.'); } }); })(parameters.viewerControl.getAllMarks(), parameters.uid); } var mD = parameters.uid || IPCC.J.acu(); if (parameters.igMark && parameters.igMark instanceof IPCC.Web.UI.Mark) { this.H = parameters.igMark; this.fg = this.H.get_markID().toString(); this.dc = this.H.get_data(); } else { this.dc = new IPCC.Web.UI.Data(); } PCCViewer.Data.extend(this); this.Fk = new IPCC.Web.UI.Data(); PCCViewer.SessionData.extend(this); if (parameters.pageNumber !== undefined) { IPCC.ad.hL(parameters.pageNumber, 'pageNumber'); this.bp = parameters.pageNumber; } if (parameters.id !== undefined) { IPCC.ad.jt(parameters.id, 'id'); this.fg = parameters.id; } if (parameters.type && parameters.type === 'PlaceSignature' && parameters.CJ) { this.aa = parameters.type; this.CJ = true; } else if (parameters.type !== undefined) { IPCC.ad.jt(parameters.type, 'type'); var HN = QV(parameters.type, PCCViewer.Mark.Type); if (HN === null) { throw new RangeError("The value of mark type was invalid."); } this.aa = HN; } if ('cs' in parameters) { this.cs = parameters.cs; } if ('bq' in parameters) { this.bq = parameters.bq; } addPropertiesToMark(this); addMethodsToMark(this); this.getUid = function () { return mD; }; if (Object.defineProperties && Object.defineProperty) { Object.defineProperty(this, 'uid', { value: mD, enumerable: true, writable: false }); } }; PCCViewer.Mark = Mark; PCCViewer.Mark.prototype.getType = function () { return this.aa; }; PCCViewer.Mark.prototype.getId = function () { return this.fg; }; PCCViewer.Mark.prototype.getPageNumber = function () { return this.bp; }; PCCViewer.Mark.prototype.getConversation = function () { if (!this.df) { this.df = new PCCViewer.Conversation(this); } return this.df; }; PCCViewer.Mark.prototype.getBoundingRectangle = function () { if (this.H) { var ai = this.H.get_boundingRectangle(); if (ai instanceof IPCC.Web.UI.Rectangle) { this.nV = { width: ai.width, height: ai.height, x: ai.x, y: ai.y }; } } return this.nV; }; PCCViewer.Mark.prototype.getInteractionMode = function () { if (this.H) { switch (this.H.get_interactionMode()) { case IPCC.Web.UI.MarkInteractionMode.SelectionDisabled: return PCCViewer.Mark.InteractionMode.SelectionDisabled; case IPCC.Web.UI.MarkInteractionMode.Full: return PCCViewer.Mark.InteractionMode.Full; default: return PCCViewer.Mark.InteractionMode.Full; } } return this.qi; }; PCCViewer.Mark.prototype.setInteractionMode = function (interactionMode) { var qi = QV(interactionMode, PCCViewer.Mark.InteractionMode), adL; switch (qi) { case PCCViewer.Mark.InteractionMode.SelectionDisabled: adL = IPCC.Web.UI.MarkInteractionMode.SelectionDisabled; break; case PCCViewer.Mark.InteractionMode.Full: adL = IPCC.Web.UI.MarkInteractionMode.Full; break; default: throw new Error("The specified interactionMode is not valid."); } if (this.H) { this.H.set_interactionMode(adL); } this.qi = qi; return this; }; PCCViewer.Mark.prototype.reset = function () { var co = new Mark({ type: this.aa, CJ: this.CJ }); this.dc = {}; if (this.setBorderColor && co.getBorderColor) { this.setBorderColor(co.getBorderColor()); } if (this.setBorderThickness && co.getBorderThickness) { this.setBorderThickness(co.getBorderThickness()); } if (this.setColor && co.getColor) { this.setColor(co.getColor()); } if (this.setEndHeadType && co.getEndHeadType) { this.setEndHeadType(co.getEndHeadType()); } if (this.setEndPoint && co.getEndPoint) { this.setEndPoint(co.getEndPoint()); } if (this.setFillColor && co.getFillColor) { this.setFillColor(co.getFillColor()); } if (this.setFontColor && co.getFontColor) { this.setFontColor(co.getFontColor()); } if (this.setFontName && co.getFontName) { this.setFontName(co.getFontName()); } if (this.setFontSize && co.getFontSize) { this.setFontSize(co.getFontSize()); } if (this.setFontStyle && co.getFontStyle) { this.setFontStyle(co.getFontStyle()); } if (this.setHorizontalAlignment && co.getHorizontalAlignment) { this.setHorizontalAlignment(co.getHorizontalAlignment()); } if (this.setLabel && co.getLabel) { this.setLabel(co.getLabel()); } if (this.setPosition && this.H && co.getPosition) { this.setPosition(co.getPosition()); } if (this.setReason && co.setReason) { this.setReason(co.getReason()); } if (this.setOpacity && co.getOpacity) { this.setOpacity(co.getOpacity()); } if (this.setRectangle && co.getRectangle) { this.setRectangle(co.getRectangle()); } if (this.setStartPoint && co.getStartPoint) { this.setStartPoint(co.getStartPoint()); } if (this.setText && co.getText) { this.setText(co.getText()); } if (this.setThickness && co.getThickness) { this.setThickness(co.getThickness()); } if (this.setPath && co.getPath) { this.setPath(co.getPath()); } if (this.setHref && co.getHref) { this.setHref(co.getHref()); } if (this.setImage && co.getImage) { this.setImage(co.getImage()); } if (this.setInteractionMode && co.getInteractionMode) { this.setInteractionMode(co.getInteractionMode()); } if (this.setPoints && co.getPoints) { this.setPoints(co.getPoints()); } if (this.setMask && co.getMask) { this.setMask(co.getMask()); } if (this.setMaxLength && co.getMaxLength) { this.setMaxLength(co.getMaxLength()); } if (this.setMaxFontSize && co.getMaxFontSize) { this.setMaxFontSize(co.getMaxFontSize()); } }; if (Object.defineProperties) { Object.defineProperties(PCCViewer.Mark.prototype, { "type": { enumerable: true, get: function () { return this.getType(); } }, "pageNumber": { enumerable: true, get: function () { return this.getPageNumber(); } }, "id": { enumerable: true, get: function () { return this.getId(); } }, "conversation": { enumerable: true, get: function () { return this.getConversation(); } }, "boundingRectangle": { enumerable: true, get: function () { return this.getBoundingRectangle(); } }, "interactionMode": { enumerable: true, get: function () { return this.getInteractionMode(); }, set: function (value) { return this.setInteractionMode(value); } } }); } PCCViewer.Mark.Type = { LineAnnotation: "LineAnnotation", RectangleAnnotation: "RectangleAnnotation", EllipseAnnotation: "EllipseAnnotation", TextAnnotation: "TextAnnotation", StampAnnotation: "StampAnnotation", HighlightAnnotation: "HighlightAnnotation", RectangleRedaction: "RectangleRedaction", TransparentRectangleRedaction: "TransparentRectangleRedaction", TextHyperlinkAnnotation: "TextHyperlinkAnnotation", TextRedaction: "TextRedaction", StampRedaction: "StampRedaction", FreehandAnnotation: "FreehandAnnotation", FreehandSignature: "FreehandSignature", TextSignature: "TextSignature", TextInputSignature: "TextInputSignature", TextAreaSignature: "TextAreaSignature", TextSelectionRedaction: "TextSelectionRedaction", ImageStampAnnotation: "ImageStampAnnotation", ImageStampRedaction: "ImageStampRedaction", PolylineAnnotation: "PolylineAnnotation", StrikethroughAnnotation: "StrikethroughAnnotation" }; PCCViewer.Mark.LineHeadType = { None: "None", FilledTriangle: "FilledTriangle" }; PCCViewer.Mark.FontStyles = { Bold: "Bold", Italic: "Italic", Strikeout: "Strikeout", Underline: "Underline" }; PCCViewer.Mark.InteractionMode = { Full: "Full", SelectionDisabled: "SelectionDisabled" }; PCCViewer.Mark.HorizontalAlignment = { Center: "Center", Left: "Left", Right: "Right" }; function QV(Xg, aa) { var abD = Xg.toLowerCase(); for (var standardType in aa) { if (aa.hasOwnProperty(standardType) && standardType.toLowerCase && standardType.toLowerCase() === abD) { return standardType; } } return null; }; function addMethodsToMark(R) { function awL(R) { R.highlightText = function (highlights) { if (!this.H) { throw new Error("It is invalid to highlight text on this mark."); } var mO; if (highlights !== null && typeof highlights !== "undefined") { if (Object.prototype.toString.call(highlights) !== '[object Array]') { mO = [highlights]; } else { mO = highlights; } for (var i = 0; i < mO.length; i++) { aAc(mO[i]); } } else { mO = []; } var aa = R.getType(); switch (aa) { case PCCViewer.Mark.Type.TextAnnotation: case PCCViewer.Mark.Type.TextRedaction: R.H.selectText(mO); break; case PCCViewer.Mark.Type.HighlightAnnotation: case PCCViewer.Mark.Type.TextSelectionRedaction: case PCCViewer.Mark.Type.TextHyperlinkAnnotation: case PCCViewer.Mark.Type.StrikethroughAnnotation: var K = this; var SX = []; var uQ = false, NT = 0, SD, FB; var afN = function (HO, atd, hF) { var yj; var WQ = -1, Wd = []; var xN = (HO.bh + HO.cg); if (uQ === true && SD >= 0 && FB >= 0) { if (HO.aD - 1 === SD) { yj = 0; if (NT <= xN) { Wd.push({ startIndex: yj, length: NT, color: hF[FB].color, opacity: (hF[FB].opacity) ? hF[FB].opacity : 127 }); uQ = false; NT = 0; SD = -1; FB = -1; } } } for (var aj = 0; aj < hF.length; aj++) { yj = HO.bh + hF[aj].startIndex - atd; if (yj < 0) { continue; } if (Array.prototype.indexOf) { WQ = SX.indexOf(aj); } else { WQ = IPCC.Web.hK(SX, aj); } var dI = 127; if (WQ === -1) { if (yj + hF[aj].length <= xN) { if (hF[aj].opacity) { dI = hF[aj].opacity; } Wd.push({ startIndex: yj, length: hF[aj].length, color: hF[aj].color, opacity: dI }); SX.push(aj); K.EQ.push(hF[aj]); } else { var Zg = xN - yj; if (Zg > 0) { NT = hF[aj].length - Zg; dI = 127; if (hF[aj].opacity) { dI = hF[aj].opacity; } Wd.push({ startIndex: yj, length: Zg, color: hF[aj].color, opacity: dI }); SX.push(aj); K.EQ.push(hF[aj]); uQ = true; FB = aj; SD = HO.aD; } } } } return Wd; }; this.EQ = []; var eh = afN(this.H, 0, mO); R.clearHighlights(); if (eh.length > 0) { K.H.selectText(eh); } eh = []; var gL = this.H.cg; if (this.dF && this.dF.length) { for (var G = 0; G < this.dF.length; G++) { eh = []; eh = afN(this.dF[G], gL, mO); gL += this.dF[G].cg; if (eh.length > 0) { this.dF[G].selectText(eh); } } } break; } return this; }; function aAc(IR) { IPCC.ad.ps(IR.startIndex, 'highlight.startIndex', 0, R.getText().length); IPCC.ad.ps(IR.length, 'highlight.length', 1, Number.MAX_VALUE); IPCC.ad.dU(IR.color, 'highlight.color'); if (IR.opacity) { IPCC.ad.ps(IR.opacity, "highlight.opacity", 0, 255); } }; R.clearHighlights = function () { if (this.H) { if (!this.H) { throw new Error("It is invalid to clear highlights on this mark."); } } var aa = R.getType(); switch (aa) { case PCCViewer.Mark.Type.TextAnnotation: case PCCViewer.Mark.Type.TextRedaction: R.H.selectText(); break; case PCCViewer.Mark.Type.HighlightAnnotation: case PCCViewer.Mark.Type.TextSelectionRedaction: case PCCViewer.Mark.Type.TextHyperlinkAnnotation: case PCCViewer.Mark.Type.StrikethroughAnnotation: this.H.selectText(); if (this.dF && this.dF.length) { for (var G = 0; G < this.dF.length; G++) { this.dF[G].selectText(); } } break; } return this; }; }; var aa = R.getType(); switch (aa) { case PCCViewer.Mark.Type.TextAnnotation: case PCCViewer.Mark.Type.TextRedaction: case PCCViewer.Mark.Type.HighlightAnnotation: case PCCViewer.Mark.Type.TextSelectionRedaction: case PCCViewer.Mark.Type.TextHyperlinkAnnotation: case PCCViewer.Mark.Type.StrikethroughAnnotation: awL(R); break; default: break; } }; function addPropertiesToMark(R) { R.nV = { x: 0, y: 0, width: 0, height: 0 }; var aa = R.getType(); switch (aa) { case PCCViewer.Mark.Type.LineAnnotation: R.dU = '#18385F'; R.ii = IPCC.Web.UI.LineStyle.Solid; R.qD = 6; R.dI = 255; R.RC = { x: 0, y: 0 }; R.xN = { x: 0, y: 0 }; R.mW = "None"; break; case PCCViewer.Mark.Type.RectangleAnnotation: case PCCViewer.Mark.Type.EllipseAnnotation: R.cK = '#FB0404'; R.dI = 255; R.pw = '#000000'; R.ov = 4; R.h = { x: 0, y: 0, width: 0, height: 0 }; break; case PCCViewer.Mark.Type.RectangleRedaction: R.fr = ""; R.cK = '#000000'; R.pw = '#000000'; R.ov = 1; R.iF = '#FFFFFF'; R.h = { x: 0, y: 0, width: 0, height: 0 }; R.qK = true; if (R.H) { R.H.mg(R.qK); } break; case PCCViewer.Mark.Type.TransparentRectangleRedaction: R.h = { x: 0, y: 0, width: 0, height: 0 }; R.qK = true; if (R.H) { R.H.mg(R.qK); R.H.set_fillColor('#FFFF00'); R.H.set_opacity(127); R.H.set_lineWidth(1); R.H.set_lineColor('#FFFF00'); } break; case PCCViewer.Mark.Type.TextAnnotation: R.az = ''; R.cK = '#FFFFFF'; R.dI = 127; R.pw = '#000000'; R.ov = 4; R.iF = '#000000'; R.gZ = "Arial"; R.cd = 12; R.de = []; R.pa = "Left"; R.gU = 0; R.h = { x: 0, y: 0, width: 0, height: 0 }; break; case PCCViewer.Mark.Type.StampAnnotation: case PCCViewer.Mark.Type.StampRedaction: R.wU = "Approved"; R.h = { x: 0, y: 0, width: 0, height: 0 }; if (aa === PCCViewer.Mark.Type.StampRedaction) { R.qK = true; if (R.H) { R.H.mg(R.qK); R.H.set_fillColor('#000000'); } } else { R.dU = "#000000"; } break; case PCCViewer.Mark.Type.HighlightAnnotation: R.cK = "#FFFF00"; R.az = ''; R.cl = ''; if (R.H) { if (R.H.cl) { R.az = R.H.cl; } } R.cF = { startIndex: 0, length: 0 }; R.EQ = []; R.dF = []; break; case PCCViewer.Mark.Type.TextSelectionRedaction: R.fr = ""; R.az = ''; R.cF = { startIndex: 0, length: 0 }; if (R.H) { R.H.set_fillColor('#000000'); if (R.H.cl) { R.az = R.H.cl; } } R.EQ = []; R.dF = []; break; case PCCViewer.Mark.Type.TextHyperlinkAnnotation: R.qY = ''; R.cK = "#3B00FF"; R.az = ''; if (R.H) { if (R.H.cl) { R.az = R.H.cl; } } R.cF = { startIndex: 0, length: 0 }; R.EQ = []; R.dF = []; break; case PCCViewer.Mark.Type.TextRedaction: R.az = ''; R.iF = '#000000'; R.gZ = "Arial"; R.cd = 12; R.h = { x: 0, y: 0, width: 0, height: 0 }; R.qK = true; R.gU = 0; if (R.H) { R.H.mg(R.qK); R.H.set_fillColor('#FFFFFF'); } R.pa = "Left"; break; case PCCViewer.Mark.Type.FreehandAnnotation: R.dI = 255; R.h = { x: 0, y: 0, width: 0, height: 0 }; R.qD = 4; R.dU = '#000000'; R.cj = 'M0,0'; break; case PCCViewer.Mark.Type.FreehandSignature: R.h = { x: 0, y: 0, width: 0, height: 0 }; R.qD = 4; R.dU = '#000000'; R.pa = "Center"; R.cj = 'M0,0'; break; case PCCViewer.Mark.Type.TextSignature: R.az = "John Doe"; R.h = { x: 0, y: 0, width: 0, height: 0 }; R.dU = "#000000"; if (R.H) { R.dU = R.H.cK || '#000000'; R.H.mg(R.qK); R.H.set_fillColor(R.dU); } R.pa = "Center"; R.gZ = ""; break; case PCCViewer.Mark.Type.TextInputSignature: R.az = ""; R.h = { x: 0, y: 0, width: 0, height: 0 }; R.iF = "#000000"; R.gU = 0; if (R.H) { R.iF = R.H.get_textColor() || '#000000'; R.H.mg(false); } R.pa = "Left"; R.gZ = "Courier New"; R.iJ = null; break; case PCCViewer.Mark.Type.TextAreaSignature: R.az = ""; R.h = { x: 0, y: 0, width: 0, height: 0 }; R.iF = "#000000"; if (R.H) { R.iF = R.H.get_textColor() || '#000000'; R.H.mg(false); } R.pa = "Left"; R.gZ = "Courier New"; R.de = []; R.gU = 0; R.jA = 0; break; case 'PlaceSignature': R.nn = undefined; R.h = { x: 0, y: 0, width: 0, height: 0 }; break; case PCCViewer.Mark.Type.ImageStampAnnotation: case PCCViewer.Mark.Type.ImageStampRedaction: R.ap = ""; R.sc = ""; R.h = { x: 0, y: 0, width: 0, height: 0 }; if (R.H && aa === PCCViewer.Mark.Type.ImageStampRedaction) { R.qK = true; R.H.mg(R.qK); } break; case PCCViewer.Mark.Type.PolylineAnnotation: R.dU = '#000000'; R.ii = IPCC.Web.UI.LineStyle.Solid; R.qD = 2; R.dI = 255; R.ag = [{ x: 0, y: 0 }, { x: 0, y: 0 }]; break; case PCCViewer.Mark.Type.StrikethroughAnnotation: R.dU = '#000000'; R.ii = IPCC.Web.UI.LineStyle.Solid; R.qD = 2; R.az = ''; R.cl = ''; if (R.H) { if (R.H.cl) { R.az = R.H.cl; } } R.cF = { startIndex: 0, length: 0 }; R.EQ = []; R.dF = []; break; } function getSignature() { return this.nn || undefined; }; function setSignature(signature) { if (typeof signature === 'undefined') { this.nn = undefined; return; } else if (typeof signature !== 'object') { throw new Error("The parameter `signature` is not an Object."); } if (!signature.path && !signature.text) { throw new Error("The parameter `signature` should have at least one of these properties: text, path"); } else { if (signature.path) { if (signature.path.length < 1) { throw new Error("The property `signature.path` cannot be empty."); } else if (signature.path.match(/[^MLC0-9,.\s]/)) { throw new Error("The property `signature.path` has invalid characters."); } } else if (signature.text) { if (signature.text.length < 1) { signature.text = ''; } } } this.nn = signature; return this; }; if (R.nn || R.aa === 'PlaceSignature') { R.getSignature = getSignature; R.setSignature = setSignature; if (Object.defineProperties) { Object.defineProperties(R, { "signature": { enumerable: true, get: function () { return this.getSignature(); }, set: function (value) { return this.setSignature(value); } } }); } } function getColor() { if (this.H) { switch (this.aa) { case PCCViewer.Mark.Type.LineAnnotation: case PCCViewer.Mark.Type.PolylineAnnotation: case PCCViewer.Mark.Type.FreehandSignature: case PCCViewer.Mark.Type.FreehandAnnotation: case PCCViewer.Mark.Type.StrikethroughAnnotation: this.dU = this.H.get_lineColor() || this.dU; break; case PCCViewer.Mark.Type.StampAnnotation: case PCCViewer.Mark.Type.TextSignature: this.dU = this.H.get_fillColor() || this.dU; break; } } return this.dU; }; function setColor(value) { IPCC.ad.dU(value, 'color'); this.dU = value; if (this.H) { switch (this.aa) { case PCCViewer.Mark.Type.LineAnnotation: case PCCViewer.Mark.Type.PolylineAnnotation: case PCCViewer.Mark.Type.FreehandSignature: case PCCViewer.Mark.Type.FreehandAnnotation: this.H.set_lineColor(value); break; case PCCViewer.Mark.Type.StampAnnotation: this.H.set_fillColor(value); break; case PCCViewer.Mark.Type.TextSignature: this.H.set_textColor(value); this.H.set_fillColor(value); break; case PCCViewer.Mark.Type.StrikethroughAnnotation: this.H.set_lineColor(value); if (this.dF && this.dF.length) { for (var G = 0; G < this.dF.length; G++) { this.dF[G].set_lineColor(value); } } break; } } return this; }; if (R.dU !== undefined) { R.getColor = getColor; R.setColor = setColor; if (Object.defineProperties) { Object.defineProperties(R, { "color": { enumerable: true, get: function () { return this.getColor(); }, set: function (value) { return this.setColor(value); } } }); } } function getFillColor() { if (this.H) { switch (this.aa) { case PCCViewer.Mark.Type.RectangleAnnotation: case PCCViewer.Mark.Type.EllipseAnnotation: case PCCViewer.Mark.Type.TextAnnotation: case PCCViewer.Mark.Type.HighlightAnnotation: case PCCViewer.Mark.Type.TextHyperlinkAnnotation: case PCCViewer.Mark.Type.RectangleRedaction: this.cK = this.H.get_fillColor() || this.cK; break; } } return this.cK; }; function setFillColor(value) { if (this.aa === PCCViewer.Mark.Type.HighlightAnnotation || this.aa === PCCViewer.Mark.Type.TextHyperlinkAnnotation) { IPCC.ad.dU(value, 'fillColor'); } else { IPCC.ad.abc(value, 'fillColor'); } this.cK = value; if (this.H) { switch (this.aa) { case PCCViewer.Mark.Type.RectangleAnnotation: case PCCViewer.Mark.Type.EllipseAnnotation: case PCCViewer.Mark.Type.TextAnnotation: case PCCViewer.Mark.Type.RectangleRedaction: this.H.set_fillColor(value); break; case PCCViewer.Mark.Type.HighlightAnnotation: case PCCViewer.Mark.Type.TextHyperlinkAnnotation: this.H.set_fillColor(value); if (this.dF && this.dF.length) { for (var G = 0; G < this.dF.length; G++) { this.dF[G].set_fillColor(value); } } break; } } return this; }; if (R.cK !== undefined) { R.getFillColor = getFillColor; R.setFillColor = setFillColor; if (Object.defineProperties) { Object.defineProperties(R, { "fillColor": { enumerable: true, get: function () { return this.getFillColor(); }, set: function (value) { return this.setFillColor(value); } } }); } } function getImage() { var retVal = { dataUrl: this.ap, id: this.sc }; return retVal; }; function setImage(params) { IPCC.ad.jt(params.dataUrl, 'string'); IPCC.ad.jt(params.id, 'string'); this.ap = params.dataUrl; this.sc = params.id; if (this.H) { switch (this.aa) { case PCCViewer.Mark.Type.ImageStampAnnotation: case PCCViewer.Mark.Type.ImageStampRedaction: this.H.set_image(params.dataUrl); this.H.sc = params.id; break; } } return this; }; if (R.ap !== undefined) { R.getImage = getImage; R.setImage = setImage; if (Object.defineProperties) { Object.defineProperties(R, { "image": { enumerable: true, get: function () { return this.getImage(); }, set: function (params) { return this.setImage(params); } } }); } } function getBorderColor() { if (this.H) { switch (this.aa) { case PCCViewer.Mark.Type.RectangleAnnotation: case PCCViewer.Mark.Type.EllipseAnnotation: case PCCViewer.Mark.Type.TextAnnotation: case PCCViewer.Mark.Type.RectangleRedaction: this.pw = this.H.get_lineColor() || this.pw; break; } } return this.pw; }; function setBorderColor(value) { IPCC.ad.abc(value, 'borderColor'); this.pw = value; if (this.H) { switch (this.aa) { case PCCViewer.Mark.Type.RectangleAnnotation: case PCCViewer.Mark.Type.EllipseAnnotation: case PCCViewer.Mark.Type.TextAnnotation: case PCCViewer.Mark.Type.RectangleRedaction: this.H.set_lineColor(value); break; } } return this; }; if (R.pw !== undefined) { R.getBorderColor = getBorderColor; R.setBorderColor = setBorderColor; if (Object.defineProperties) { Object.defineProperties(R, { "borderColor": { enumerable: true, get: function () { return this.getBorderColor(); }, set: function (value) { return this.setBorderColor(value); } } }); } } function getOpacity() { if (this.H) { switch (this.aa) { case PCCViewer.Mark.Type.LineAnnotation: case PCCViewer.Mark.Type.RectangleAnnotation: case PCCViewer.Mark.Type.EllipseAnnotation: case PCCViewer.Mark.Type.TextAnnotation: case PCCViewer.Mark.Type.FreehandAnnotation: case PCCViewer.Mark.Type.PolylineAnnotation: this.dI = this.H.get_opacity() || this.dI; break; } } return this.dI; }; function setOpacity(value) { IPCC.ad.ps(value, 'opacity', 0, 255); this.dI = value; if (this.H) { switch (this.aa) { case PCCViewer.Mark.Type.LineAnnotation: case PCCViewer.Mark.Type.RectangleAnnotation: case PCCViewer.Mark.Type.EllipseAnnotation: case PCCViewer.Mark.Type.TextAnnotation: case PCCViewer.Mark.Type.FreehandAnnotation: case PCCViewer.Mark.Type.PolylineAnnotation: this.H.set_opacity(value); break; } } return this; }; if (R.dI !== undefined && R.dI >= 0) { R.getOpacity = getOpacity; R.setOpacity = setOpacity; if (Object.defineProperties) { Object.defineProperties(R, { "opacity": { enumerable: true, get: function () { return this.getOpacity(); }, set: function (value) { return this.setOpacity(value); } } }); } } function getThickness() { if (this.H) { switch (this.aa) { case PCCViewer.Mark.Type.LineAnnotation: case PCCViewer.Mark.Type.FreehandSignature: case PCCViewer.Mark.Type.FreehandAnnotation: case PCCViewer.Mark.Type.PolylineAnnotation: case PCCViewer.Mark.Type.StrikethroughAnnotation: this.qD = this.H.get_lineWidth() || this.qD; break; } } return this.qD; }; function setThickness(value) { IPCC.ad.mL(value, 'thickness', 1, 50); this.qD = value; if (this.H) { switch (this.aa) { case PCCViewer.Mark.Type.LineAnnotation: case PCCViewer.Mark.Type.FreehandSignature: case PCCViewer.Mark.Type.FreehandAnnotation: case PCCViewer.Mark.Type.PolylineAnnotation: this.H.set_lineWidth(value); break; case PCCViewer.Mark.Type.StrikethroughAnnotation: this.H.set_lineWidth(value); if (this.dF && this.dF.length) { for (var G = 0; G < this.dF.length; G++) { this.dF[G].set_lineWidth(value); } } break; } } return this; }; if (R.qD) { R.getThickness = getThickness; R.setThickness = setThickness; if (Object.defineProperties) { Object.defineProperties(R, { "thickness": { enumerable: true, get: function () { return this.getThickness(); }, set: function (value) { return this.setThickness(value); } } }); } } function getBorderThickness() { if (this.H) { switch (this.aa) { case PCCViewer.Mark.Type.RectangleAnnotation: case PCCViewer.Mark.Type.EllipseAnnotation: case PCCViewer.Mark.Type.TextAnnotation: case PCCViewer.Mark.Type.RectangleRedaction: this.ov = this.H.get_lineWidth() || this.ov; break; } } return this.ov; }; function setBorderThickness(value) { IPCC.ad.mL(value, 'borderThickness', 1, 50); this.ov = value; if (this.H) { switch (this.aa) { case PCCViewer.Mark.Type.RectangleAnnotation: case PCCViewer.Mark.Type.EllipseAnnotation: case PCCViewer.Mark.Type.TextAnnotation: case PCCViewer.Mark.Type.RectangleRedaction: this.H.set_lineWidth(value); break; } } return this; }; if (R.ov !== undefined) { R.getBorderThickness = getBorderThickness; R.setBorderThickness = setBorderThickness; if (Object.defineProperties) { Object.defineProperties(R, { "borderThickness": { enumerable: true, get: function () { return this.getBorderThickness(); }, set: function (value) { return this.setBorderThickness(value); } } }); } } function getVisible() { if (this.H) { this.ep = this.H.get_visible(); } return this.ep; }; function setVisible(value) { if (value !== true && value !== false) { throw new Error("The parameter value is invalid. The parameter must be boolean true or false."); } this.ep = value; if (this.H) { this.H.set_visible(value); } var G; switch (this.aa) { case PCCViewer.Mark.Type.TextSelectionRedaction: case PCCViewer.Mark.Type.TextHyperlinkAnnotation: case PCCViewer.Mark.Type.HighlightAnnotation: case PCCViewer.Mark.Type.StrikethroughAnnotation: if (this.dF && this.dF.length) { for (G = 0; G < this.dF.length; G++) { this.dF[G].set_visible(value); } } if (this.aa === PCCViewer.Mark.Type.TextSelectionRedaction) { var fu = this.H; for (G = 0; G < this.H.bV.length; G++) { fu.bV[G].set_visible(value); } if (fu.cE) { IPCC.J.forEach(this.dF, function (H) { for (G = 0; G < H.bV.length; G++) { H.bV[G].set_visible(value); } }); } } break; } return this; }; if (R.ep !== undefined) { R.getVisible = getVisible; R.setVisible = setVisible; if (Object.defineProperties) { Object.defineProperties(R, { "visible": { enumerable: true, get: function () { return this.getVisible(); }, set: function (value) { return this.setVisible(value); } } }); } } function getStartPoint() { if (this.H && this.H !== null) { var ag = this.H.get_points(); if (ag.get_length() > 0) { switch (this.aa) { case PCCViewer.Mark.Type.LineAnnotation: var be = ag.getPoint(0); if (be) { this.RC = { x: be.x, y: be.y }; } break; } } } return this.RC; }; function setStartPoint(value) { IPCC.ad.hL(value.x, 'startPoint' + '.x'); IPCC.ad.hL(value.y, 'startPoint' + '.y'); if (this.H && this.H !== null) { var ag = this.H.get_points(); switch (this.aa) { case PCCViewer.Mark.Type.LineAnnotation: ag.setPoint(0, new IPCC.Web.UI.Point(value.x, value.y)); break; } } this.RC = value; return this; }; if (R.RC) { R.getStartPoint = getStartPoint; R.setStartPoint = setStartPoint; if (Object.defineProperties) { Object.defineProperties(R, { "startPoint": { enumerable: true, get: function () { return this.getStartPoint(); }, set: function (value) { return this.setStartPoint(value); } } }); } } function getEndPoint() { if (this.H && this.H !== null) { var ag = this.H.get_points(); if (ag.get_length() > 0) { switch (this.aa) { case PCCViewer.Mark.Type.LineAnnotation: var be = ag.getPoint(1); if (be) { this.xN = { x: be.x, y: be.y }; } break; } } } return this.xN; }; function setEndPoint(value) { IPCC.ad.hL(value.x, 'endPoint' + '.x'); IPCC.ad.hL(value.y, 'endPoint' + '.y'); if (this.H && this.H !== null) { var ag = this.H.get_points(); switch (this.aa) { case PCCViewer.Mark.Type.LineAnnotation: ag.setPoint(1, new IPCC.Web.UI.Point(value.x, value.y)); break; } } this.xN = value; return this; }; if (R.xN) { R.getEndPoint = getEndPoint; R.setEndPoint = setEndPoint; if (Object.defineProperties) { Object.defineProperties(R, { "endPoint": { enumerable: true, get: function () { return this.getEndPoint(); }, set: function (value) { return this.setEndPoint(value); } } }); } } function getEndHeadType() { if (this.H && this.H !== null) { var ES; switch (this.aa) { case PCCViewer.Mark.Type.LineAnnotation: ES = this.H.get_endHeadType(); switch (ES) { case IPCC.Web.UI.LineHeadType.None: this.mW = PCCViewer.Mark.LineHeadType.None; break; case IPCC.Web.UI.LineHeadType.Solid: this.mW = PCCViewer.Mark.LineHeadType.FilledTriangle; break; } break; } } return this.mW; }; function setEndHeadType(value) { var ES; switch (value) { case PCCViewer.Mark.LineHeadType.None: ES = IPCC.Web.UI.LineHeadType.None; break; case PCCViewer.Mark.LineHeadType.FilledTriangle: ES = IPCC.Web.UI.LineHeadType.Solid; break; default: throw "The specified value is not a valid line head type."; } if (this.H && this.H !== null) { switch (this.aa) { case PCCViewer.Mark.Type.LineAnnotation: this.H.set_endHeadType(ES); break; } } this.mW = value; return this; }; if (R.mW) { R.getEndHeadType = getEndHeadType; R.setEndHeadType = setEndHeadType; if (Object.defineProperties) { Object.defineProperties(R, { "endHeadType": { enumerable: true, get: function () { return this.getEndHeadType(); }, set: function (value) { return this.setEndHeadType(value); } } }); } } function getPoints() { if (this.H && this.H !== null) { var Ir = this.H.get_points(); var dg = Ir.get_length(); var anP = []; var abk = function (aCv, ak) { anP.push(aCv.getPoint(ak)); }; if (dg > 1) { switch (this.aa) { case PCCViewer.Mark.Type.PolylineAnnotation: for (var G = 0; G < dg; G++) { abk(Ir, G); } this.ag = anP; break; } } } return this.ag.slice(); }; function setPoints(value) { if (!(value instanceof Array)) { throw "invalid parameter. The parameter should be an array."; } if (value.length <= 1) { return; } for (var aj = 0; aj < value.length; aj++) { IPCC.ad.be(value[aj], 'PolylinePoint'); } if (this.H && this.H !== null) { var Ir = this.H.get_points(); var aDK = function (ak) { Ir.addPoint(new IPCC.Web.UI.Point(value[ak].x, value[ak].y)); }; switch (this.aa) { case PCCViewer.Mark.Type.PolylineAnnotation: Ir.removeAllPoints(); for (var G = 0; G < value.length; G++) { aDK(G); } } } this.ag = value; return this; }; if (R.ag) { R.getPoints = getPoints; R.setPoints = setPoints; if (Object.defineProperties) { Object.defineProperties(R, { "points": { enumerable: true, get: function () { return this.getPoints(); }, set: function (value) { return this.setPoints(value); } } }); } } function getRectangle() { if (this.H) { switch (this.aa) { case PCCViewer.Mark.Type.RectangleAnnotation: case PCCViewer.Mark.Type.RectangleRedaction: case PCCViewer.Mark.Type.TransparentRectangleRedaction: case PCCViewer.Mark.Type.EllipseAnnotation: case PCCViewer.Mark.Type.TextAnnotation: case PCCViewer.Mark.Type.TextRedaction: case PCCViewer.Mark.Type.StampAnnotation: case PCCViewer.Mark.Type.StampRedaction: case PCCViewer.Mark.Type.FreehandAnnotation: case PCCViewer.Mark.Type.FreehandSignature: case PCCViewer.Mark.Type.TextSignature: case PCCViewer.Mark.Type.TextInputSignature: case PCCViewer.Mark.Type.TextAreaSignature: case PCCViewer.Mark.Type.ImageStampAnnotation: case PCCViewer.Mark.Type.ImageStampRedaction: var ai = this.H.get_rectangle(); if (ai instanceof IPCC.Web.UI.Rectangle) { this.h = { width: ai.width, height: ai.height, x: ai.x, y: ai.y }; } break; } } return this.h; }; function setRectangle(value) { IPCC.ad.hL(value.x, 'rectangle' + '.x'); IPCC.ad.hL(value.y, 'rectangle' + '.y'); IPCC.ad.hL(value.width, 'rectangle' + '.width'); IPCC.ad.hL(value.height, 'rectangle' + '.height'); if (this.H && this.H !== null) { switch (this.aa) { case PCCViewer.Mark.Type.RectangleAnnotation: case PCCViewer.Mark.Type.RectangleRedaction: case PCCViewer.Mark.Type.TransparentRectangleRedaction: case PCCViewer.Mark.Type.EllipseAnnotation: case PCCViewer.Mark.Type.TextAnnotation: case PCCViewer.Mark.Type.TextRedaction: case PCCViewer.Mark.Type.StampAnnotation: case PCCViewer.Mark.Type.StampRedaction: case PCCViewer.Mark.Type.FreehandAnnotation: case PCCViewer.Mark.Type.FreehandSignature: case PCCViewer.Mark.Type.TextSignature: case PCCViewer.Mark.Type.TextInputSignature: case PCCViewer.Mark.Type.TextAreaSignature: case PCCViewer.Mark.Type.ImageStampAnnotation: case PCCViewer.Mark.Type.ImageStampRedaction: var ai = new IPCC.Web.UI.Rectangle(value.x, value.y, value.width, value.height); this.H.set_rectangle(ai); break; } } this.h = value; return this; }; if (R.h) { R.getRectangle = getRectangle; R.setRectangle = setRectangle; if (Object.defineProperties) { Object.defineProperties(R, { "rectangle": { enumerable: true, get: function () { return this.getRectangle(); }, set: function (value) { return this.setRectangle(value); } } }); } } function getPosition() { var cz = 0; if (this.H && this.H.cl) { cz = this.H.cl.length; } else if (this.H) { cz = IPCC.J.reduce([this.H].concat(this.dF || []), function (dg, H) { return dg + H.get_textLength(); }, 0); } return this.H ? { startIndex: this.H.bh, length: cz } : this.cF; }; function setPosition(value) { IPCC.ad.hL(value.startIndex, 'position.startIndex'); IPCC.ad.hL(value.length, 'position.length'); if (value.startIndex < 0) { throw new Error("The start index must be 0 or greater."); } if (value.length < 0) { throw new Error("The length must be 0 or greater."); } if (this.H === undefined || this.H === null) { throw new Error("The mark must be on a page."); } var bI; var aX; var aD = this.bp - 1; var ys = -value.startIndex; var ow = []; var cl = ""; var fF; while (true) { if (aD >= this.cs.get_length()) { throw new Error("The specified length is out of range."); } bI = this.cs.getPage(aD); if (bI.cv() && bI.cv().Ar() && bI.cv().mw() === true) { var apa = ys; var abC = bI.cv().FF(); ys += abC.length; if (ys < 0 || (ys === 0 && value.length !== 0)) { throw new Error("The specified start index is out of range for the specified page."); } var ZG = 0; if (aD === this.bp - 1) { ZG = value.startIndex; } if (ys >= value.length) { fF = value.startIndex + value.length - 1; if (apa >= 0) { fF = value.length - 1 - apa; } ow.push({ pageIndex: aD, endIndex: fF }); cl += abC.substring(ZG, fF + 1); break; } else { fF = bI.cv().FF().length - 1; ow.push({ pageIndex: aD, endIndex: fF }); cl += abC.substring(ZG, fF + 1); } } else { throw new Error("The text has not been retrieved for this page."); } aD++; } this.cE = IPCC.FA(); var G = 0; if (this.dF) { if (this.H) { this.H.cE = this.cE; aX = this.bq.hz(this.cs.getPage(this.H.aD)); if (this.H.get_type() === IPCC.Web.UI.MarkType.TextSelectionRedaction) { for (var Ws = this.H.bV.length - 1; Ws >= 0; Ws--) { aX.removeMark(this.H.bV[Ws]); this.H.bV.pop(); } } } for (G = this.dF.length - 1; G >= 0; G--) { var mN = this.dF[G]; aX = this.bq.hz(this.cs.getPage(mN.aD)); aX.removeMark(mN); this.dF.splice(G, 1); } } else { this.dF = []; } Ns.call(this, ow, fF, cl, value); this.cF = value; return this; }; function Ns(ow, fF, cl, value, acr) { var G, aD, bI, aX; acr = acr || {}; var bV; this.dF = this.dF || []; var agN = (this.H.get_type() === IPCC.Web.UI.MarkType.TextSelectionRedaction) ? aED : aDZ; for (G = 0; G < ow.length; G++) { aD = ow[G].pageIndex; bI = this.cs.getPage(aD); var ate = bI.cv().gl(); aX = this.bq.hz(bI); var fu; var bh = 0; fF = ow[G].endIndex; if (G === 0) { bh = value.startIndex; } aD = ow[G].pageIndex; bV = acr[aD] || IPCC.J.QF(ate, bh, fF); if (G === 0) { fu = agN(this.H, bh, fF - bh + 1, cl, bV, aD, this.cE, this.H.get_type(), aX); this.H.kr = true; } else { fu = agN(null, bh, fF - bh + 1, cl, bV, aD, this.cE, this.H.get_type(), aX); this.dF.push(fu); aX.addMark(fu); fu.set_selected(this.H.get_selected()); if (this.getFillColor) { fu.set_fillColor(this.H.get_fillColor()); } if (this.getColor) { fu.set_lineColor(this.H.get_lineColor()); } if (this.getThickness) { fu.set_lineWidth(this.H.get_lineWidth()); } if (this.getHref) { fu.set_href(this.H.get_href()); } if (this.getReason) { fu.set_text(this.H.get_text()); } } if (G === ow.length - 1) { fu.lF = true; } } }; if (R.cF) { R.getPosition = getPosition; R.setPosition = setPosition; R.Ns = Ns; if (Object.defineProperties) { Object.defineProperties(R, { "position": { enumerable: true, get: function () { return this.getPosition(); }, set: function (value) { return this.setPosition(value); } } }); } } function aDZ(R, bh, cz, cl, bV, aD, kW, bi, aX) { if (!R) { R = new IPCC.Web.UI.Mark(bi); } R.bh = bh; R.cg = cz; R.kz = 'y'; R.cE = kW; R.cl = cl; R.bV = bV || []; R.aD = aD; var aaB = IPCC.J.reduce(R.bV, function (HB, ai) { if (!HB) { return ai.clone(); } else { return HB.union(ai); } }, null); R.set_rectangle(aaB); return R; }; function aED(R, bh, cz, cl, bV, aD, kW, bi, aX) { if (!R) { R = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.TextSelectionRedaction); } R.bh = bh; R.cg = cz; R.cE = kW; R.cl = cl; R.aD = aD; R.bV = IPCC.J.map(bV, function (ai) { var Af = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.RectangleRedaction); Af.set_rectangle(ai); Af.mg(true); Af.set_fillColor('#000000'); Af.set_text(R.az); Af.set_lineWidth(0); Af.cE = kW; aX.addMark(Af); return Af; }); var aaB = IPCC.J.reduce(bV, function (HB, ai) { if (!HB) { return ai.clone(); } else { return HB.union(ai); } }, null); R.set_rectangle(aaB); return R; }; function getText() { if (this.H) { switch (this.aa) { case PCCViewer.Mark.Type.TextAnnotation: case PCCViewer.Mark.Type.TextRedaction: case PCCViewer.Mark.Type.TextSignature: case PCCViewer.Mark.Type.TextInputSignature: case PCCViewer.Mark.Type.TextAreaSignature: this.az = (typeof this.H.get_text() === "string") ? this.H.get_text() : this.az; break; case PCCViewer.Mark.Type.HighlightAnnotation: case PCCViewer.Mark.Type.TextSelectionRedaction: case PCCViewer.Mark.Type.TextHyperlinkAnnotation: case PCCViewer.Mark.Type.StrikethroughAnnotation: if (R.H.cl) { this.az = R.H.cl; } break; } } return this.az; }; function setText(value) { IPCC.ad.jt(value, 'text'); this.az = value; if (this.H) { switch (this.aa) { case PCCViewer.Mark.Type.TextAnnotation: case PCCViewer.Mark.Type.TextRedaction: case PCCViewer.Mark.Type.TextSignature: case PCCViewer.Mark.Type.TextInputSignature: case PCCViewer.Mark.Type.TextAreaSignature: this.H.set_text(value); break; } } return this; }; if (R.az !== undefined) { R.getText = getText; var bi = R.getType(); if (bi !== PCCViewer.Mark.Type.HighlightAnnotation && bi !== PCCViewer.Mark.Type.TextSelectionRedaction && bi !== PCCViewer.Mark.Type.TextHyperlinkAnnotation && bi !== PCCViewer.Mark.Type.StrikethroughAnnotation) { R.setText = setText; } if (Object.defineProperties) { var ahK = { enumerable: true, get: function () { return this.getText(); } }; if (R.setText !== undefined) { ahK.set = function (value) { return this.setText(value); }; } Object.defineProperties(R, { "text": ahK }); } } function getFontColor() { if (this.H) { switch (this.aa) { case PCCViewer.Mark.Type.TextAnnotation: case PCCViewer.Mark.Type.TextRedaction: case PCCViewer.Mark.Type.TextInputSignature: case PCCViewer.Mark.Type.RectangleRedaction: case PCCViewer.Mark.Type.TextAreaSignature: this.iF = this.H.get_textColor() || this.iF; break; } } return this.iF; }; function setFontColor(value) { IPCC.ad.dU(value, 'fontColor'); this.iF = value; if (this.H) { switch (this.aa) { case PCCViewer.Mark.Type.TextAnnotation: case PCCViewer.Mark.Type.TextRedaction: case PCCViewer.Mark.Type.TextInputSignature: case PCCViewer.Mark.Type.TextAreaSignature: case PCCViewer.Mark.Type.RectangleRedaction: this.H.set_textColor(value); break; } } return this; }; if (R.iF) { R.getFontColor = getFontColor; R.setFontColor = setFontColor; if (Object.defineProperties) { Object.defineProperties(R, { "fontColor": { enumerable: true, get: function () { return this.getFontColor(); }, set: function (value) { return this.setFontColor(value); } } }); } } function getFontName() { if (this.H) { switch (this.aa) { case PCCViewer.Mark.Type.TextAnnotation: case PCCViewer.Mark.Type.TextRedaction: case PCCViewer.Mark.Type.TextSignature: case PCCViewer.Mark.Type.TextInputSignature: case PCCViewer.Mark.Type.TextAreaSignature: this.gZ = this.H.get_fontName() || this.gZ; break; } } return this.gZ; }; function setFontName(value) { IPCC.ad.jt(value, 'fontName'); this.gZ = value; if (this.H) { switch (this.aa) { case PCCViewer.Mark.Type.TextAnnotation: case PCCViewer.Mark.Type.TextRedaction: case PCCViewer.Mark.Type.TextSignature: case PCCViewer.Mark.Type.TextInputSignature: case PCCViewer.Mark.Type.TextAreaSignature: this.H.set_fontName(value); break; } } return this; }; if (R.gZ !== undefined) { R.getFontName = getFontName; R.setFontName = setFontName; if (Object.defineProperties) { Object.defineProperties(R, { "fontName": { enumerable: true, get: function () { return this.getFontName(); }, set: function (value) { return this.setFontName(value); } } }); } } function getFontSize() { if (this.H) { switch (this.aa) { case PCCViewer.Mark.Type.TextAnnotation: case PCCViewer.Mark.Type.TextRedaction: this.cd = this.H.get_fontSize() || this.cd; break; } } return this.cd; }; function setFontSize(value) { IPCC.ad.mL(value, 'fontSize', 0.1, 288); this.cd = value; if (this.H) { switch (this.aa) { case PCCViewer.Mark.Type.TextAnnotation: case PCCViewer.Mark.Type.TextRedaction: this.H.set_fontSize(value); break; } } return this; }; if (R.cd) { R.getFontSize = getFontSize; R.setFontSize = setFontSize; if (Object.defineProperties) { Object.defineProperties(R, { "fontSize": { enumerable: true, get: function () { return this.getFontSize(); }, set: function (value) { return this.setFontSize(value); } } }); } } function getHorizontalAlignment() { if (this.H) { var Bg = this.H.get_textHorizontalAlignment(); switch (Bg) { case IPCC.Web.UI.HorizontalAlignment.Center: this.pa = "Center"; break; case IPCC.Web.UI.HorizontalAlignment.Left: this.pa = "Left"; break; case IPCC.Web.UI.HorizontalAlignment.Right: this.pa = "Right"; break; } } return this.pa; }; function setHorizontalAlignment(value) { IPCC.ad.jt(value, 'horizontalAlignment'); var sI = QV(value, PCCViewer.Mark.HorizontalAlignment); var Bg; switch (sI) { case 'Center': Bg = IPCC.Web.UI.HorizontalAlignment.Center; break; case 'Left': Bg = IPCC.Web.UI.HorizontalAlignment.Left; break; case 'Right': Bg = IPCC.Web.UI.HorizontalAlignment.Right; break; default: throw "Invalid value found for the Text horizontalAlignment."; } R.pa = sI; if (this.H && Bg !== undefined) { this.H.set_textHorizontalAlignment(Bg); this.pa = sI; } return this; }; if (R.pa) { R.getHorizontalAlignment = getHorizontalAlignment; R.setHorizontalAlignment = setHorizontalAlignment; if (Object.defineProperties) { Object.defineProperties(R, { "horizontalAlignment": { enumerable: true, get: function () { return this.getHorizontalAlignment(); }, set: function (value) { return this.setHorizontalAlignment(value); } } }); } } function auJ(aaH) { var Cv = []; for (var G = 0; G < aaH.length; G++) { switch (aaH[G]) { case "Bold": Cv.push(IPCC.Web.UI.FontStyle.Bold); break; case "Italic": Cv.push(IPCC.Web.UI.FontStyle.Italic); break; case "Strikeout": Cv.push(IPCC.Web.UI.FontStyle.Strikeout); break; case "Underline": Cv.push(IPCC.Web.UI.FontStyle.Underline); break; default: throw Error("An unknown font style was encountered: " + aaH[G]); } } if (Cv.length === 0) { Cv.push(IPCC.Web.UI.FontStyle.Regular); } return Cv; }; function getFontStyle() { if (this.H) { var qh = []; switch (this.aa) { case PCCViewer.Mark.Type.TextAreaSignature: case PCCViewer.Mark.Type.TextAnnotation: case PCCViewer.Mark.Type.TextRedaction: var yK = this.H.get_fontStyle(); if (yK & IPCC.Web.UI.FontStyle.Bold) { qh.push("Bold"); } if (yK & IPCC.Web.UI.FontStyle.Italic) { qh.push("Italic"); } if (yK & IPCC.Web.UI.FontStyle.Strikeout) { qh.push("Strikeout"); } if (yK & IPCC.Web.UI.FontStyle.Underline) { qh.push("Underline"); } if (qh.length > 0) { this.de = qh; } break; } } return this.de; }; function setFontStyle(value) { if (!(value instanceof Array)) { throw "invalid parameter. The parameter should be an array."; } var Si, G, aiq = []; for (G = 0; G < value.length; G++) { Si = QV(value[G], PCCViewer.Mark.FontStyles); if (Si === null) { throw new RangeError("The value of font styles " + value[G] + " is invalid."); } else { IPCC.ad.jt(Si, 'fontStyle'); aiq.push(Si); } } this.de = aiq; var yK = []; yK = auJ(this.de); var aO = this; function aCV(bj) { setTimeout(function () { aO.H.set_fontStyle(bj); }, 2); }; if (this.H) { switch (this.aa) { case PCCViewer.Mark.Type.TextAreaSignature: case PCCViewer.Mark.Type.TextAnnotation: case PCCViewer.Mark.Type.TextRedaction: var aeW = yK[0]; for (G = 1; G < yK.length; G++) { aeW |= yK[G]; } aCV(aeW); break; } } return this; }; if (R.de) { R.getFontStyle = getFontStyle; R.setFontStyle = setFontStyle; if (Object.defineProperties) { Object.defineProperties(R, { "fontStyle": { enumerable: true, get: function () { return this.getFontStyle(); }, set: function (value) { return this.setFontStyle(value); } } }); } } function getLabel() { if (this.H) { switch (this.aa) { case PCCViewer.Mark.Type.StampAnnotation: case PCCViewer.Mark.Type.StampRedaction: this.wU = this.H.get_text() || this.wU; break; } } return this.wU; }; function setLabel(value) { IPCC.ad.jt(value, 'label'); this.wU = value; if (this.H) { switch (this.aa) { case PCCViewer.Mark.Type.StampAnnotation: case PCCViewer.Mark.Type.StampRedaction: this.H.set_text(value); break; } } return this; }; if (typeof R.wU !== 'undefined') { R.getLabel = getLabel; R.setLabel = setLabel; if (Object.defineProperties) { Object.defineProperties(R, { "label": { enumerable: true, get: function () { return this.getLabel(); }, set: function (value) { return this.setLabel(value); } } }); } } function getReason() { if (this.H) { switch (this.aa) { case PCCViewer.Mark.Type.RectangleRedaction: case PCCViewer.Mark.Type.TextSelectionRedaction: this.fr = this.H.get_text() || this.fr; break; } } return this.fr; }; function setReason(value) { IPCC.ad.jt(value, 'text'); this.fr = value; if (this.H) { switch (this.aa) { case PCCViewer.Mark.Type.RectangleRedaction: this.H.set_text(value); break; case PCCViewer.Mark.Type.TextSelectionRedaction: this.H.set_text(value); if (this.dF && this.dF.length) { for (var G = 0; G < this.dF.length; G++) { this.dF[G].set_text(value); } } break; } } return this; }; if (typeof R.fr !== 'undefined') { R.getReason = getReason; R.setReason = setReason; if (Object.defineProperties) { Object.defineProperties(R, { "reason": { enumerable: true, get: function () { return this.getReason(); }, set: function (value) { return this.setReason(value); } } }); } } function getPath() { if (this.H) { return this.H.get_pathString(); } else { return this.cj; } }; function setPath(path) { if (path.match(/[^MLC0-9.,\s]/)) { throw new Error("The path string contains illegal characters."); } var vJ = IPCC.J.aay(path); this.cj = path; if (this.H) { this.H.set_pathString(path); this.H.set_pathWidth(vJ.width); this.H.set_pathHeight(vJ.height); } return this; }; if (R.cj) { R.setPath = setPath; R.getPath = getPath; if (Object.defineProperties) { Object.defineProperties(R, { "path": { enumerable: true, get: getPath, set: setPath } }); } } function getHref() { if (this.H) { return this.H.get_href(); } else { return this.qY; } }; function setHref(href) { if (href !== null) { var aa = typeof href; if (aa !== "undefined" && aa !== "number" && aa !== "string") { throw new Error("`href` can only be set to a value that is a Number, String, null, or undefined."); } } this.qY = href; if (this.H) { this.H.set_href(href); } if (this.dF) { IPCC.J.forEach(this.dF, function (H) { H.set_href(href); }); } return this; }; if (typeof R.qY !== 'undefined') { R.setHref = setHref; R.getHref = getHref; if (Object.defineProperties) { Object.defineProperties(R, { "href": { enumerable: true, get: getHref, set: setHref } }); } } function setMaxLength(maxLength) { if (typeof maxLength !== 'number' || maxLength < 0 || maxLength > Number.MAX_VALUE || Math.round(maxLength) !== maxLength) { throw new Error('`maxLength` can only be set to a value that is a positive integer.'); } this.gU = maxLength; if (this.H) { this.H.set_maxLength(this.gU); } return this; }; function getMaxLength() { if (this.H) { this.gU = this.H.get_maxLength(); } return this.gU; }; if (typeof R.gU !== 'undefined') { R.getMaxLength = getMaxLength; R.setMaxLength = setMaxLength; if (Object.defineProperties) { Object.defineProperties(R, { "maxLength": { enumerable: true, get: getMaxLength, set: setMaxLength } }); } } function setMaxFontSize(maxFontSize) { if (typeof maxFontSize !== 'number' || maxFontSize < 0 || maxFontSize > Number.MAX_VALUE || Math.round(maxFontSize) !== maxFontSize) { throw new Error('`maxFontSize` can only be set to a value that is a positive integer.'); } this.jA = maxFontSize; if (this.H) { this.H.set_maxFontSize(this.jA); } return this; }; function getMaxFontSize() { if (this.H) { this.jA = this.H.get_maxFontSize(); } return this.jA; }; if (typeof R.jA !== 'undefined') { R.getMaxFontSize = getMaxFontSize; R.setMaxFontSize = setMaxFontSize; if (Object.defineProperties) { Object.defineProperties(R, { "maxFontSize": { enumerable: true, get: getMaxFontSize, set: setMaxFontSize } }); } } function getMask() { return this.iJ; }; function setMask(mask) { if (mask === null || typeof mask === 'undefined') { this.iJ = null; if (this.H) { this.H.set_mask(this.iJ); } return this; } if (typeof mask !== 'object' || Array.isArray(mask)) { throw new Error('`mask` can only be set to a value that is an Object, null or undefined.'); } if (typeof mask.value !== 'string') { throw new Error('`mask.value` can only be set to a value that is a string.'); } if (typeof mask.translations !== 'object' || mask.translations === null || Array.isArray(mask.translations)) { throw new Error('`mask.translations` can only be set to a value that is an Object.'); } var afR = false; IPCC.J.forEach(mask.translations, function (val, key) { afR = true; if (key.length !== 1) { throw new Error('`' + key + '` does not have a string length of 1.'); } if (!(val instanceof RegExp) || !(/\/$/).exec(val.toString())) { throw new Error('`mask.translations[' + key + ']` must be a regular expression without flags.'); } }); if (!afR) { throw new Error('`mask.translations` must have at least one translation.'); } this.iJ = mask; if (this.H) { this.H.set_mask(this.iJ); } return this; }; if (typeof R.iJ !== 'undefined') { R.getMask = getMask; R.setMask = setMask; if (Object.defineProperties) { Object.defineProperties(R, { "mask": { enumerable: true, get: getMask, set: setMask } }); } } } })(PCCViewer || {}); (function (PCCViewer) { 'use strict'; function MouseTool(name, type) { this.dC = name; var HN = apx(type); if (HN === null) { throw new RangeError("The value of type was invalid."); } this.aa = HN; addPropertiesToMouseTool(this); }; MouseTool.prototype.getName = function () { return this.dC; }; MouseTool.prototype.getType = function () { return this.aa; }; if (Object.defineProperties) { Object.defineProperties(MouseTool.prototype, { "name": { enumerable: true, get: function () { return this.getName(); } }, "type": { enumerable: true, get: function () { return this.getType(); } } }); } function apx(Xg) { var abD = Xg.toLowerCase(); for (var standardType in PCCViewer.MouseTool.Type) { if (PCCViewer.MouseTool.Type.hasOwnProperty(standardType) && standardType.toLowerCase && standardType.toLowerCase() === abD) { return standardType; } } return null; }; function addPropertiesToMouseTool(mouseTool) { var aa = mouseTool.getType(); switch (aa) { case PCCViewer.MouseTool.Type.Magnifier: break; case PCCViewer.MouseTool.Type.SelectToZoom: break; case PCCViewer.MouseTool.Type.Pan: mouseTool.CS = false; break; case PCCViewer.MouseTool.Type.PanAndEdit: mouseTool.CS = true; break; case PCCViewer.MouseTool.Type.SelectText: break; case PCCViewer.MouseTool.Type.EditMarks: break; case PCCViewer.MouseTool.Type.LineAnnotation: mouseTool.ba = new PCCViewer.Mark({ type: PCCViewer.Mark.Type.LineAnnotation }); break; case PCCViewer.MouseTool.Type.RectangleAnnotation: mouseTool.ba = new PCCViewer.Mark({ type: PCCViewer.Mark.Type.RectangleAnnotation }); break; case PCCViewer.MouseTool.Type.EllipseAnnotation: mouseTool.ba = new PCCViewer.Mark({ type: PCCViewer.Mark.Type.EllipseAnnotation }); break; case PCCViewer.MouseTool.Type.TextAnnotation: mouseTool.ba = new PCCViewer.Mark({ type: PCCViewer.Mark.Type.TextAnnotation }); break; case PCCViewer.MouseTool.Type.StampAnnotation: mouseTool.ba = new PCCViewer.Mark({ type: PCCViewer.Mark.Type.StampAnnotation }); break; case PCCViewer.MouseTool.Type.HighlightAnnotation: mouseTool.ba = new PCCViewer.Mark({ type: PCCViewer.Mark.Type.HighlightAnnotation }); break; case PCCViewer.MouseTool.Type.TextHyperlinkAnnotation: mouseTool.ba = new PCCViewer.Mark({ type: PCCViewer.Mark.Type.TextHyperlinkAnnotation }); break; case PCCViewer.MouseTool.Type.FreehandAnnotation: mouseTool.ba = new PCCViewer.Mark({ type: PCCViewer.Mark.Type.FreehandAnnotation }); break; case PCCViewer.MouseTool.Type.RectangleRedaction: mouseTool.ba = new PCCViewer.Mark({ type: PCCViewer.Mark.Type.RectangleRedaction }); break; case PCCViewer.MouseTool.Type.TransparentRectangleRedaction: mouseTool.ba = new PCCViewer.Mark({ type: PCCViewer.Mark.Type.TransparentRectangleRedaction }); break; case PCCViewer.MouseTool.Type.TextRedaction: mouseTool.ba = new PCCViewer.Mark({ type: PCCViewer.Mark.Type.TextRedaction }); break; case PCCViewer.MouseTool.Type.TextInputSignature: mouseTool.ba = new PCCViewer.Mark({ type: PCCViewer.Mark.Type.TextInputSignature }); break; case PCCViewer.MouseTool.Type.TextAreaSignature: mouseTool.ba = new PCCViewer.Mark({ type: PCCViewer.Mark.Type.TextAreaSignature }); break; case PCCViewer.MouseTool.Type.StampRedaction: mouseTool.ba = new PCCViewer.Mark({ type: PCCViewer.Mark.Type.StampRedaction }); break; case PCCViewer.MouseTool.Type.PlaceSignature: mouseTool.ba = new PCCViewer.Mark({ type: 'PlaceSignature', CJ: true }); break; case PCCViewer.MouseTool.Type.TextSelectionRedaction: mouseTool.ba = new PCCViewer.Mark({ type: PCCViewer.Mark.Type.TextSelectionRedaction }); break; case PCCViewer.MouseTool.Type.ImageStampAnnotation: mouseTool.ba = new PCCViewer.Mark({ type: PCCViewer.Mark.Type.ImageStampAnnotation }); break; case PCCViewer.MouseTool.Type.ImageStampRedaction: mouseTool.ba = new PCCViewer.Mark({ type: PCCViewer.Mark.Type.ImageStampRedaction }); break; case PCCViewer.MouseTool.Type.PolylineAnnotation: mouseTool.ba = new PCCViewer.Mark({ type: PCCViewer.Mark.Type.PolylineAnnotation }); break; case PCCViewer.MouseTool.Type.StrikethroughAnnotation: mouseTool.ba = new PCCViewer.Mark({ type: PCCViewer.Mark.Type.StrikethroughAnnotation }); break; } if (mouseTool.ba) { mouseTool.getTemplateMark = function () { return this.ba; }; if (Object.defineProperties) { Object.defineProperties(mouseTool, { "templateMark": { enumerable: true, get: mouseTool.getTemplateMark } }); } } }; MouseTool.prototype.reset = function () { if (this.ba) { this.ba.reset(); } }; PCCViewer.MouseTools = { PP: {}, createMouseTool: function (name, type) { var Bz = name.toLowerCase(); var existingTool = this.PP[Bz]; if (existingTool) { if (existingTool.getType().toLowerCase() !== type.toLowerCase()) { throw new Error("If calling createMouseTool and providing the name of a mouse tool that already exists, then the type must be the same type as the existing mouse tool."); } existingTool.reset(); } else { this.PP[Bz] = new MouseTool(name, type); } return this.PP[Bz]; }, getMouseTool: function (name) { if (name && name.toLowerCase) { var Bz = name.toLowerCase(); return this.PP[Bz]; } return undefined; } }; PCCViewer.MouseTool = MouseTool; PCCViewer.MouseTool.Type = { Magnifier: "Magnifier", SelectToZoom: "SelectToZoom", Pan: "Pan", PanAndEdit: "PanAndEdit", SelectText: "SelectText", EditMarks: "EditMarks", LineAnnotation: "LineAnnotation", RectangleAnnotation: "RectangleAnnotation", EllipseAnnotation: "EllipseAnnotation", TextAnnotation: "TextAnnotation", StampAnnotation: "StampAnnotation", HighlightAnnotation: "HighlightAnnotation", TextHyperlinkAnnotation: "TextHyperlinkAnnotation", FreehandAnnotation: "FreehandAnnotation", RectangleRedaction: "RectangleRedaction", TransparentRectangleRedaction: "TransparentRectangleRedaction", TextRedaction: "TextRedaction", TextInputSignature: "TextInputSignature", TextAreaSignature: "TextAreaSignature", StampRedaction: "StampRedaction", PlaceSignature: "PlaceSignature", TextSelectionRedaction: "TextSelectionRedaction", ImageStampAnnotation: "ImageStampAnnotation", ImageStampRedaction: "ImageStampRedaction", PolylineAnnotation: "PolylineAnnotation", StrikethroughAnnotation: "StrikethroughAnnotation" }; PCCViewer.MouseTools.createMouseTool("AccusoftMagnifier", PCCViewer.MouseTool.Type.Magnifier); PCCViewer.MouseTools.createMouseTool("AccusoftSelectToZoom", PCCViewer.MouseTool.Type.SelectToZoom); PCCViewer.MouseTools.createMouseTool("AccusoftPan", PCCViewer.MouseTool.Type.Pan); PCCViewer.MouseTools.createMouseTool("AccusoftPanAndEdit", PCCViewer.MouseTool.Type.PanAndEdit); PCCViewer.MouseTools.createMouseTool("AccusoftSelectText", PCCViewer.MouseTool.Type.SelectText); PCCViewer.MouseTools.createMouseTool("AccusoftEditMarks", PCCViewer.MouseTool.Type.EditMarks); PCCViewer.MouseTools.createMouseTool("AccusoftLineAnnotation", PCCViewer.MouseTool.Type.LineAnnotation); PCCViewer.MouseTools.createMouseTool("AccusoftArrowAnnotation", PCCViewer.MouseTool.Type.LineAnnotation).getTemplateMark().setEndHeadType("FilledTriangle"); PCCViewer.MouseTools.createMouseTool("AccusoftRectangleAnnotation", PCCViewer.MouseTool.Type.RectangleAnnotation); PCCViewer.MouseTools.createMouseTool("AccusoftEllipseAnnotation", PCCViewer.MouseTool.Type.EllipseAnnotation); PCCViewer.MouseTools.createMouseTool("AccusoftTextAnnotation", PCCViewer.MouseTool.Type.TextAnnotation); PCCViewer.MouseTools.createMouseTool("AccusoftStampAnnotation", PCCViewer.MouseTool.Type.StampAnnotation); PCCViewer.MouseTools.createMouseTool("AccusoftHighlightAnnotation", PCCViewer.MouseTool.Type.HighlightAnnotation); PCCViewer.MouseTools.createMouseTool("AccusoftTextHyperlinkAnnotation", PCCViewer.MouseTool.Type.TextHyperlinkAnnotation); PCCViewer.MouseTools.createMouseTool("AccusoftFreehandAnnotation", PCCViewer.MouseTool.Type.FreehandAnnotation); PCCViewer.MouseTools.createMouseTool("AccusoftPlaceSignature", PCCViewer.MouseTool.Type.PlaceSignature); PCCViewer.MouseTools.createMouseTool("AccusoftTextSelectionRedaction", PCCViewer.MouseTool.Type.TextSelectionRedaction); PCCViewer.MouseTools.createMouseTool("AccusoftRectangleRedaction", PCCViewer.MouseTool.Type.RectangleRedaction); PCCViewer.MouseTools.createMouseTool("AccusoftTransparentRectangleRedaction", PCCViewer.MouseTool.Type.TransparentRectangleRedaction); PCCViewer.MouseTools.createMouseTool("AccusoftTextRedaction", PCCViewer.MouseTool.Type.TextRedaction); PCCViewer.MouseTools.createMouseTool("AccusoftTextInputSignature", PCCViewer.MouseTool.Type.TextInputSignature); PCCViewer.MouseTools.createMouseTool("AccusoftTextAreaSignature", PCCViewer.MouseTool.Type.TextAreaSignature); PCCViewer.MouseTools.createMouseTool("AccusoftStampRedaction", PCCViewer.MouseTool.Type.StampRedaction); PCCViewer.MouseTools.createMouseTool("AccusoftImageStampAnnotation", PCCViewer.MouseTool.Type.ImageStampAnnotation); PCCViewer.MouseTools.createMouseTool("AccusoftImageStampRedaction", PCCViewer.MouseTool.Type.ImageStampRedaction); PCCViewer.MouseTools.createMouseTool("AccusoftPolylineAnnotation", PCCViewer.MouseTool.Type.PolylineAnnotation); PCCViewer.MouseTools.createMouseTool("AccusoftStrikethroughAnnotation", PCCViewer.MouseTool.Type.StrikethroughAnnotation); })(PCCViewer || {}); (function (PCCViewer) { "use strict"; function ViewerControl(element, options) { if (!(this instanceof ViewerControl)) { return new ViewerControl(element, options); } if (!IPCC.J.yP(element)) { throw new Error("The 'element' argument is required."); } if (!options.documentID) { throw new Error("A valid value for 'options.documentID' is required"); } if (!options.imageHandlerUrl) { throw new Error("A valid value for 'options.imageHandlerUrl' is required"); } var K = this; IPCC.J.Sh(element); var me = document.createElement('div'); me.className = 'pccViewerControl'; me.id = 'pccViewerControl-' + IPCC.FA(); element.appendChild(me); this.aW = me; this.gc = element; var tF = document.createElement('div'); tF.className = 'pccPageListLoading'; me.appendChild(tF); this.tF = tF; PCCViewer.EventEmitter.extend(this); this.Az = false; this.aH = PCCViewer.BV.uQ({}, ViewerControl.Ct, options); this.aH.language = PCCViewer.BV.uQ({}, ViewerControl.awp, (options.language ? options.language : {})); if (options.language) { PCCViewer.Language.initializeData(options.language); } if (this.aH.pageLayout.toLowerCase() === "vertical") { this.aH.pageLayout = IPCC.PageLayout.VerticalScrollDirection; } else if (this.aH.pageLayout.toLowerCase() === "horizontal") { this.aH.pageLayout = IPCC.PageLayout.HorizontalScrollDirection; } else { throw new Error("The value of 'options.pageLayout' is invalid."); } if (this.aH.viewMode.toLowerCase() === "document") { this.aH.viewMode = IPCC.ViewMode.Document; } else if (this.aH.viewMode.toLowerCase() === "equalwidthpages") { this.aH.viewMode = IPCC.ViewMode.EqualWidthPages; } else if (this.aH.viewMode.toLowerCase() === "equalfitpages") { this.aH.viewMode = IPCC.ViewMode.EqualFitPages; } else if (this.aH.viewMode.toLowerCase() === "singlepage") { this.aH.viewMode = IPCC.ViewMode.SinglePage; } else { throw new Error("The value of 'options.viewMode' is invalid."); } function isValidSearchMethodType() { return -1 < ['auto', 'server', 'client'].indexOf(K.aH.searchMethodType.toLowerCase()); }; if (!isValidSearchMethodType()) { throw new Error("The value of 'options.searchMethodType' should be 'auto', 'server', or 'client'."); } if (isNaN(this.aH.searchMethodPageCountThreshold) && (typeof this.aH.searchMethodPageCountThreshold !== 'number') && this.aH.searchMethodPageCountThreshold <= 1) { throw new Error("The value of 'options.searchMethodPageCountThreshold' must be a number greater than 1."); } if (this.aH.redactionViewMode) { if (this.aH.redactionViewMode.toLowerCase() === "draft") { this.aH.redactionViewMode = PCCViewer.RedactionViewMode.Draft; } else if (this.aH.redactionViewMode.toLowerCase() === "normal") { this.aH.redactionViewMode = PCCViewer.RedactionViewMode.Normal; } } else { this.aH.redactionViewMode = PCCViewer.RedactionViewMode.Normal; } var ix = this.aH.pageRotation % 360; if (ix !== 0) { var zA = [90, 180, 270, -90, -180, -270]; if (Array.prototype.indexOf) { if (!ix || zA.indexOf(ix) === -1) { throw new Error("The value of 'options.pageRotation' is invalid."); } } else { if (!ix || IPCC.Web.hK(zA, ix) === -1) { throw new Error("The value of 'options.pageRotation' is invalid."); } } } this.aH.pageRotation = ix; if (this.aH.markHandleMode.toLowerCase() === "hidesidehandleswhenclose") { this.aH.markHandleMode = IPCC.Web.UI.MarkHandleMode.HideSideHandlesWhenClose; } else if (this.aH.markHandleMode.toLowerCase() === "hidecornerhandleswhenclose") { this.aH.markHandleMode = IPCC.Web.UI.MarkHandleMode.HideCornerHandlesWhenClose; } else { throw new Error("The value of 'options.markHandleMode' is invalid."); } if (isNaN(this.aH.serviceResponseTimeout) || typeof this.aH.serviceResponseTimeout !== 'number' || this.aH.serviceResponseTimeout < 0) { throw new Error("The value of 'options.serviceResponseTimeout' is invalid."); } if (typeof this.aH.debug !== 'boolean') { throw new Error("The value of 'options.debug' is invalid."); } if (typeof this.aH.viewerAssetsPath !== 'string') { throw new Error("The value of 'options.viewerAssetsPath' is invalid."); } this.ln = {}; this.am = ""; this.eD = 1; this.bq = undefined; this.alD = new PCCViewer.Deferred(); this.CF = this.alD.getPromise(); this.eF = false; this.bE = undefined; this.OV = 0; this.cs = undefined; this.bW = PCCViewer.MouseTools.getMouseTool("AccusoftPanAndEdit"); this.rj = false; this.Ad = false; this.Fx = false; this.Fh = []; this.TQ = new PCCViewer.Deferred(); this.awn = this.TQ.getPromise(); this.zS = []; this.dq = {}; this.TM = []; this.LV = []; this.bO = null; this.KE = {}; this.fY = null; this.rk = new PCCViewer.MarkupLayerCollection(this); this.AN = new PCCViewer.MarkupLayer(this); this.rk.addItem(this.AN); this.tu = true; setTimeout(function () { K.aqz(me, K.aH); }, 0); this.AC = null; this.dG = null; this.Ds = false; this.Oo = -1; this.Nc = {}; this.aiU = false; this.aAr = this.aH.printTemplate || (this.aH.template ? this.aH.template.print : ""); this.ki = null; this.yH = null; this.pE = function (df, dW, ahI) { var dR = document.createElement('div'), bH = dR.style; bH.position = 'absolute'; if (dW.isSelected) { bH.backgroundColor = 'white'; } else { bH.backgroundColor = 'lightgray'; } bH.left = '10px'; bH.right = '0'; bH.textAlign = 'left'; IPCC.J.forEach(df.getComments(), function (pJ, G) { var aaX = document.createElement('div'), TI = aaX.style; TI.position = 'relative'; TI.padding = '5px'; TI.border = '1px solid gray'; if (G > 0) { TI.borderTop = 'none'; } aaX.appendChild(document.createTextNode(pJ.getText())); dR.appendChild(aaX); }); return dR; }; return K; }; PCCViewer.ViewerControl = ViewerControl; ViewerControl.Ct = { encryption: false, viewMode: "Document", debug: false, pageLayout: "Vertical", resourcePath: "img", serviceResponseTimeout: 60 * 1000, printTemplate: "", pageRotation: 0, markHandleMode: "HideSideHandlesWhenClose", debugErrorLevel: IPCC.Web.UI.DebugErrorLevel.Detailed, maxPrefetch: 3, displayPagesWhenScrolling: true, maxOutOfViewDisplay: 0, scrollDisplayThreshold: 0.5, requireRequestsOptimize: true, loadingContent: "", redactionViewMode: "Normal", searchMethodType: 'auto', searchMethodPageCountThreshold: 80, viewerAssetsPath: 'viewer-assets' }; ViewerControl.awp = { pageLoadFailed: "Page Load Failed", pageLoadFailedPassword: "Page Load Failed - Password Required", pageLoadFailedRetry: "Retry" }; ViewerControl.prototype.aqz = function (element, options) { if (this.Az) { return; } var K = this; var YZ = function () { if (K.aH.viewMode === IPCC.ViewMode.SinglePage || K.Az) { return; } var axP = K.bq.get_pageNodeId(K.getPageNumber() - 1); var bk = document.getElementById(axP); var BG = K.aW.childNodes[0].childNodes[0].childNodes[0].childNodes; if (!bk) { return; } IPCC.J.forEach(BG, function (jZ) { if (bk !== jZ) { if (document.documentMode === 8 && jZ.style.outline) { jZ.style.outline = ''; } else if (jZ.style.boxShadow) { jZ.style.boxShadow = ''; } } }); if (document.documentMode === 8) { bk.style.outline = '2px solid #aaa'; } else { bk.style.boxShadow = '0 0 4px 1px rgba(0,0,0,.4)'; } }; var aqw = function () { if (K.tF.parentNode) { K.tF.parentNode.removeChild(K.tF); } K.bq.remove_pageOpenFailed(Yu); K.bq.remove_pageDisplayed(aqw); var aga = arguments[1]; setTimeout(function () { K.trigger("PageDisplayed", { pageNumber: (aga.pageIndex + 1) }); YZ(); }, 10); if (aga.pageIndex !== 0) { return; } function fa(bF) { if (K.Az) { return; } var bM; if (bF.status === 200) { if (typeof JSON !== 'undefined') { bM = JSON.parse(bF.responseText); } else { bM = IPCC.ct.pG(bF.responseText); } if (bM.pageCountConfidence < 100) { var am; if (!(/^[\x00-\x7F]*$/.test(sU))) { am = K.aH.imageHandlerUrl + '/Document/q/Attributes?DocumentID=e' + sU + '&DesiredPageCountConfidence=100'; } else { am = K.aH.imageHandlerUrl + '/Document/q/Attributes?DocumentID=u' + encodeURIComponent(K.aH.documentID) + '&DesiredPageCountConfidence=100'; } PCCViewer.Ajax.dZ({ method: 'GET', url: am, headers: { 'Content-Type': 'application/json' } }).then(fa, eZ); K.eD = bM.pageCount; K.bE.eD = bM.pageCount; K.Fx = true; setTimeout(function () { K.trigger("EstimatedPageCountReady", { pageCount: bM.pageCount }); }, 10); ajA(); } else { if (K.eD > 1) { K.bE.eD = bM.pageCount; setTimeout(function () { var G; if (bM.pageCount < K.eD) { for (G = K.eD - 1; G >= bM.pageCount; G--) { K.cs.removePage(G); } } else if (bM.pageCount > K.eD) { for (G = K.eD; G < bM.pageCount; G++) { var acR = new IPCC.Web.UI.ImGearPage({ pageNumber: G }); K.cs.addPage(acR); } } K.eD = bM.pageCount; if (K.eF === true) { K.rj = true; K.Ad = true; setTimeout(function () { K.trigger("PageCountReady", { pageCount: bM.pageCount }); }, 30); } }, 30); } else { K.eD = bM.pageCount; K.bE.eD = bM.pageCount; if (K.eF === true) { ajA(function () { K.rj = true; K.Ad = true; setTimeout(function () { K.trigger("PageCountReady", { pageCount: bM.pageCount }); }, 0); }); } } } } }; function eZ(bM) { if (K.Az) { return; } var ZY = "None", ahX, aaz; var agt = bM.response.getResponseHeader('Accusoft-Status-Message'); if (agt) { ZY = agt; aaz = bM.response.getResponseHeader('Accusoft-Status-Number'); if (IPCC.Web.vo(aaz)) { ahX = parseInt(aaz, 10); } } else if (bM.response.statusText) { ZY = bM.response.statusText; } setTimeout(function () { K.trigger("PageLoadFailed", { statusCode: bM.response.status, errorMessage: ZY, accusoftErrorNumber: ahX }); }, 1); throw ("Unable to obtain document information from the server"); }; var sU = IPCC.gB.sv(K.aH.documentID); if (!sU || sU === "") { throw ("Invalid encoded Identifier"); } if (!(/^[\x00-\x7F]*$/.test(sU))) { K.am = K.aH.imageHandlerUrl + '/Document/q/Attributes?DocumentID=e' + sU + '&DesiredPageCountConfidence=50'; } else { K.am = K.aH.imageHandlerUrl + '/Document/q/Attributes?DocumentID=u' + encodeURIComponent(K.aH.documentID) + '&DesiredPageCountConfidence=50'; } PCCViewer.Ajax.dZ({ method: 'GET', url: K.am, headers: { 'Content-Type': 'application/json' } }).then(fa, eZ); }; function ajA(sh) { sh = sh || function () { }; var anS = K.eD; function aiL() { K.bq.remove_allPagesAdded(aiL); sh(); }; if (anS > 1) { K.bq.add_allPagesAdded(aiL); if (!K.agp) { K.bq.add_currentPageChanged(function () { if (arguments.length < 2) { throw ("Controls currentPageChanged event did not provide any expected information"); } var dm = arguments[1]; setTimeout(function () { K.trigger('PageChanged', { pageNumber: dm.pageIndex + 1 }); YZ(); }, 0); }); K.bq.add_pageDisplayed(function () { if (arguments.length < 2) { throw ("Controls pageDisplayed event did not provide any expected information"); } var dm = arguments[1]; if (K.ki) { K.ki(); K.ki = null; if (K.fY) { K.fY.resolve(); } K.fY = null; } setTimeout(function () { K.trigger('PageDisplayed', { pageNumber: dm.pageIndex + 1 }); YZ(); }, 0); setTimeout(function () { K.requestPageText(dm.pageIndex + 1).then(function Fv() { K.acC(dm.pageIndex + 1, K.Oo); }); }, 10); }); K.bq.add_pageOpenFailed(function () { ajG(arguments); }); K.agp = true; } for (var G = K.OV; G < anS; G++) { K.cs.addPage(new IPCC.Web.UI.ImGearPage({ pageNumber: G })); K.OV++; } } else { sh(); } }; var arD = function (dm) { var bk = document.getElementById(dm.pageNodeID), bL = document.createElement('div'), AZ = document.createElement('button'), aop = 'pccPageLoadFailRetry' + dm.pageIndex, aeG = function () { K.bq.Fj(dm.pageIndex); }, asB = PCCViewer.Language.data.pageLoadFailed, asS = PCCViewer.Language.getValue("pageLoadFailedPassword"), arB = PCCViewer.Language.data.pageLoadFailedRetry, aIA = dm.exception.statusCode === 480 && dm.exception.customErrorCode === 4001; if (bk === null) { return; } AZ.id = aop; AZ.innerHTML = arB; bL.className = 'pccPageLoadFail'; if (aIA) { bL.innerHTML = asS + '<br>'; bk.appendChild(bL); } else { bL.innerHTML = asB + '<br>'; bL.appendChild(AZ); bk.appendChild(bL); AZ = document.getElementById(aop); if (!AZ.addEventListener) { AZ.attachEvent('onclick', aeG); } else { AZ.addEventListener('click', aeG, false); } } }; function ajG(GO) { if (GO.length < 2) { throw ("controls PageOpenFailed event did not provide any expected information"); } var ajn, ahH, dm = GO[1]; if (GO[1].exception.customErrorCode !== undefined) { ahH = GO[1].exception.customErrorCode; } if (GO[1].exception.message !== undefined) { ajn = GO[1].exception.message; } setTimeout(function () { K.trigger('PageLoadFailed', { statusCode: dm.exception.statusCode, pageNumber: dm.pageIndex + 1, errorMessage: ajn, accusoftErrorNumber: ahH }); arD(dm); }, 0); }; function ays() { if (K.bq && typeof K.bq.dispose === "function") { K.bq.dispose(); } K.am = ""; K.bq = undefined; while (K.aW.firstChild) { K.aW.removeChild(K.aW.firstChild); } }; function aKe(anb) { var aT = new PCCViewer.Deferred(); if (typeof anb === "string") { PCCViewer.Ajax.dZ({ url: K.aH.imageHandlerUrl + '/ViewingSession/u' + K.aH.documentID + '/Replacement', body: JSON.stringify({ password: anb }), method: 'POST', headers: { 'Content-Type': 'application/json;charset=utf-8' } }).then(function aLX(bF) { var result = JSON.parse(bF.responseText); var apB = result.viewingSessionId; K.aH.documentID = apB; ays(); K.aqz(K.aW, K.aH); aT.resolve(apB); }, function aLO(err) { aT.reject(new PCCViewer.Error("AjaxError", "The call to replace the viewing session failed.")); }); } else { aT.reject(new PCCViewer.Error("InvalidArgument", "The value of the 'password' parameter must be a string.")); } return aT.getPromise(); }; function Yu() { K.bq.remove_pageOpenFailed(Yu); ajG(arguments); }; var arF = function (aB, L) { K.vN = true; var YO = { width: L.width, height: L.height, pageNumber: L.pageNumber }; K.trigger("PageOpening", YO); }; function akW() { K.alD.resolve(K.bq); K.bq.remove_pageOpened(akW); K.eF = true; var aO = K; setTimeout(function () { K.trigger("ViewerReady", {}); if (aO.rj === true && aO.Ad === false) { aO.Ad = true; setTimeout(function () { K.trigger("PageCountReady", { pageCount: aO.getPageCount() }); }, 10); } }, 10); K.setCurrentMouseTool("AccusoftPanAndEdit"); }; var aqv = function (aB, L) { if (L.containsText === true) { K.TQ.resolve(true); } var Bj = -1; if (Array.prototype.indexOf) { Bj = (K.zS.indexOf(L.pageIndex) >= 0); } else { Bj = (IPCC.Web.hK(K.zS, L.pageIndex) >= 0); } if (Bj === false) { K.zS.push(L.pageIndex); if (K.zS.length === K.eD) { K.TQ.resolve(false); } } setTimeout(function () { K.trigger("PageTextReady", { pageNumber: L.pageIndex + 1 }); }, 0); }; var aqH = function (aB, L) { var Bj = -1; if (Array.prototype.indexOf) { Bj = (K.zS.indexOf(L.pageIndex) >= 0); } else { Bj = (IPCC.Web.hK(K.zS, L.pageIndex) >= 0); } if (Bj === false) { K.zS.push(L.pageIndex); if (K.zS.length === K.eD) { K.TQ.resolve(false); } } }; function aEn(sender, eventArgs) { if (!eventArgs.text || (eventArgs.text.length === 0)) { return; } var ka = []; for (var i = 0; i < eventArgs.pageNumbers.length; i++) { ka.push(eventArgs.pageNumbers[i] + 1); } var gp = [], ys = -eventArgs.startIndex, bh, fF, kH, bV, j, k; for (j = 0; j < ka.length; j++) { kH = K.cs.jb(ka[j] - 1).cv().gl(); ys += kH.fb(); bh = 0; if (j === 0) { bh = eventArgs.startIndex; } if (ys >= eventArgs.text.length) { fF = ys - eventArgs.text.length - 1; } else { fF = kH.fb() - 1; } bV = IPCC.J.QF(kH, bh, fF); for (k = 0; k < bV.length; k++) { gp.push({ x: bV[k].x, y: bV[k].y, width: bV[k].width, height: bV[k].height, pageNumber: ka[j] }); } } K.bO = { pageNumber: ka[0], length: eventArgs.text.length, text: eventArgs.text, startIndex: eventArgs.startIndex, rectangles: gp }; var R, alj = { selectedText: eventArgs.text, pageNumbers: ka, clientX: eventArgs.clientX, clientY: eventArgs.clientY, handleClientX: eventArgs.handleClientX, handleClientY: eventArgs.handleClientY, textSelection: K.bO }; function aHW() { var vF = K.ld; K.amc = true; K.ld = function (sender, args) { K.ld = vF; setTimeout(function () { K.trigger(PCCViewer.EventType.MarkCreated, { mark: R, pageNumber: ka[0], clientX: eventArgs.clientX, clientY: eventArgs.clientY }); }, 0); }; }; if (eventArgs.previousFirstMark) { R = K.dq[eventArgs.previousFirstMark.get_markID()]; K.bq.remove_markRemoved(K.Ed); K.bq.remove_markSelectionChanged(K.Ev); if (eventArgs.pageNumbers[0] !== eventArgs.previousFirstMark.aD) { var ayV = R.H.aaI; var Wz; if (R.getReason) { Wz = R.H.get_text(); } var XV; if (R.getFillColor) { XV = R.H.get_fillColor(); } var Wg; if (R.getColor) { Wg = R.H.get_lineColor(); } var Xb; if (R.getThickness) { Xb = R.H.get_lineWidth(); } var Xa; if (R.getHref) { Xa = R.H.get_href(); } var azc = new PCCViewer.Conversation(R); var aX = K.bq.hz(K.cs.getPage(R.H.aD)); aX.removeMark(R.H); for (var G = R.dF.length - 1; G >= 0; G--) { var mN = R.dF[G]; aX = K.bq.hz(K.cs.getPage(mN.aD)); aX.removeMark(mN); R.dF.splice(G, 1); } R.H = new IPCC.Web.UI.Mark(eventArgs.previousFirstMark.get_type()); R.H.aD = eventArgs.pageNumbers[0]; R.bp = eventArgs.pageNumbers[0] + 1; R.H.kr = true; R.H.aaI = ayV; var vF = K.ld; K.ld = null; K.bq.remove_markChanged(K.sZ); aX = K.bq.hz(K.cs.getPage(R.H.aD)); aX.addMark(R.H); if (Wz) { R.H.set_text(Wz); } if (XV) { R.H.set_fillColor(XV); } if (Wg) { R.H.set_lineColor(Wg); } if (Xb) { R.H.set_lineWidth(Xb); } if (Xa) { R.H.set_href(Xa); } R.df = new PCCViewer.Conversation(R); PCCViewer.Conversation.rD(azc, R.df); K.bq.add_markChanged(K.sZ); K.ld = vF; } R.H.set_selected(true); R.H.set_visible(true); R.setPosition({ startIndex: eventArgs.startIndex, length: eventArgs.text.length }); K.bq.add_markRemoved(K.Ed); K.bq.add_markSelectionChanged(K.Ev); K.qX(R, eventArgs.pageNumbers[0]); return; } var BX = null; switch (eventArgs.mouseTool) { case IPCC.Web.UI.MouseTool.CreateHighlightTextMark: BX = 'HighlightAnnotation'; break; case IPCC.Web.UI.MouseTool.CreateTextSelectionRedaction: BX = 'TextSelectionRedaction'; break; case IPCC.Web.UI.MouseTool.CreateTextHyperlinkMark: BX = 'TextHyperlinkAnnotation'; break; case IPCC.Web.UI.MouseTool.CreateStrikethroughMark: BX = 'StrikethroughAnnotation'; break; case IPCC.Web.UI.MouseTool.SelectText: azq(eventArgs.text); K.KE[ka[0]] = 'selectText'; break; } var bW = PCCViewer.MouseTools.getMouseTool(K.getCurrentMouseTool()); var ba = (bW && bW.getTemplateMark) ? bW.getTemplateMark() : undefined; var atU = ba ? ba.getType() : ""; if (BX) { aHW(); K.trigger(PCCViewer.EventType.TextSelected, alj); R = K.addMark(ka[0], BX); if (K.tu) { K.AN.addMarks(R); } R.H.kr = true; R.setPosition({ startIndex: eventArgs.startIndex, length: eventArgs.text.length }); if (atU === BX) { if (ba.getFillColor) { R.setFillColor(ba.getFillColor()); } if (ba.getReason) { R.setReason(ba.getReason()); } if (ba.getHref) { R.setHref(ba.getHref()); } if (ba.getColor) { R.setColor(ba.getColor()); } if (ba.getThickness) { R.setThickness(ba.getThickness()); } PCCViewer.Data.qH(ba, R); } return; } setTimeout(function () { K.trigger(PCCViewer.EventType.TextSelected, alj); }, 0); }; function atD() { var bk = K.aW, bL = document.createElement('div'); bL.className = 'pccCopyText'; bk.appendChild(bL); K.Ru = bL; }; function azq(az) { var oZ, aJU = az.split('\n'), NB = document.createDocumentFragment(), GH, jT; oZ = document.createTextNode(az); NB.appendChild(oZ); IPCC.J.Sh(K.Ru); K.Ru.appendChild(NB); if (document.body.createTextRange) { GH = document.body.createTextRange(); GH.moveToElementText(K.Ru); GH.select(); } else if (window.getSelection) { jT = window.getSelection(); GH = document.createRange(); GH.selectNodeContents(K.Ru); jT.removeAllRanges(); jT.addRange(GH); } }; this.bE = new IPCC.Web.UI.ImGearDocument({ documentIdentifier: this.aH.documentID, imageServicePath: this.aH.imageHandlerUrl }); this.bE.set_encryption(this.aH.encryption || false); var acR = new IPCC.Web.UI.ImGearPage({ pageNumber: 0 }); this.bE.get_pages().addPage(acR); this.cs = this.bE.get_pages(); this.bq = IPCC.initializePageListPlugin(element, options); this.bq.get_documents().addDocument(this.bE); this.OV = 1; this.bq.add_pageDisplayed(aqw); this.bq.add_pageOpenFailed(Yu); this.bq.add_pageOpening(arF); this.bq.add_pageOpened(akW); this.bq.add_textPageReady(aqv); this.bq.add_textExtractionFailed(aqH); this.bq.set_conversationDOMFactory(function (H, dW, ahI) { var R = K.dq[H.get_markID()]; if (R) { return K.pE(R.getConversation(), dW, ahI); } }); atD(); this.bq.add_selectTextMouseToolCompleted(aEn); this.bq.add_propertyChanged(function (yV, cA) { var proprtyName = cA.aGt(); if (proprtyName === "mouseTool") { setTimeout(function () { K.trigger(PCCViewer.EventType.MouseToolChanged, { mouseToolName: K.bW.getName() }); }, 0); } }); this.bq.add_markAdded(function (sender, eventArgs) { if ((eventArgs.mark.get_type() === IPCC.Web.UI.MarkType.HighlightText || eventArgs.mark.get_type() === IPCC.Web.UI.MarkType.TextSelectionRedaction || eventArgs.mark.get_type() === IPCC.Web.UI.MarkType.Strikethrough || eventArgs.mark.get_type() === IPCC.Web.UI.MarkType.TextHyperlinkAnnotation) && K.dq[eventArgs.mark.get_markID()] === undefined && eventArgs.mark.cE !== undefined) { K.qX(eventArgs.mark, eventArgs.pageIndex); } if (K.ld) { var bi = eventArgs.mark.get_type(); if (bi !== IPCC.Web.UI.MarkType.Highlight && !(bi === IPCC.Web.UI.MarkType.RectangleRedaction && eventArgs.mark.cE !== undefined)) { K.ld(sender, eventArgs); } } }); this.bq.add_markCreating(function (sender, eventArgs) { if (K.Mn) { K.Mn(sender, eventArgs); } }); this.bq.BS(function (sender, eventArgs) { var Dv = 0; var Bs = 0; var aey = 0; var xk = 0; var xO = 0; var QW = 0; var awt = K.bW.getName().toLowerCase(), ayj = K.bW.getType(); if (ayj === PCCViewer.MouseTool.Type.PlaceSignature) { var bW = K.bW; var ba = bW.getTemplateMark(), nn = ba.getSignature(), akb = ba.getRectangle(), R, h = {}; if (!nn) { return; } K.requestPageAttributes(eventArgs.pageIndex + 1).then(function (attributes) { var vJ; if (attributes.width > 0) { Bs = akb.width || (attributes.width / 5); } if (nn.path && nn.path.length > 0) { vJ = IPCC.J.aay(nn.path); h = { x: 0, y: 0, width: vJ.width, height: vJ.height }; R = K.addMark(eventArgs.pageIndex + 1, PCCViewer.Mark.Type.FreehandSignature); R.setPath(nn.path); R.setThickness(nn.thickness || 4); } if (nn.text && nn.text.length) { vJ = IPCC.J.wZ(nn.text, nn.fontName); R = K.addMark(eventArgs.pageIndex + 1, PCCViewer.Mark.Type.TextSignature); h = { x: 0, y: 0, width: vJ.width, height: vJ.height }; R.setText(nn.text); R.setFontName(nn.fontName); } aey = (h.width / Bs); Dv = akb.height || (h.height / aey); xk = (eventArgs.imagePoint.x - (Bs / 2)); xO = (eventArgs.imagePoint.y - (Dv / 2)); if (xk <= 0) { xk = 0; } if (xO <= 0) { xO = 0; } if ((xk + Bs) >= attributes.width) { QW = (xk + Bs) - attributes.width; xk = xk - QW; } if ((xO + Dv) >= attributes.height) { QW = (xO + Dv) - attributes.height; xO = xO - QW; } h = { x: xk, y: xO, width: Bs, height: Dv }; R.setRectangle({ x: xk, y: xO, width: Bs, height: Dv }); PCCViewer.Data.qH(ba, R); PCCViewer.Conversation.rD(ba.getConversation(), R.getConversation()); }); K.setCurrentMouseTool(awt); } }); function MouseEvent(au) { var K = this; for (var i in au) { if (i) { K[i] = au[i]; } } }; this.bq.Eu(function (sender, eventArgs) { var bO = null, eg = null, R = null, iH = null, AS = false, QB = eventArgs.upTarget.type, OT = false; if (eventArgs.domEvent.ctrlKey === true || eventArgs.domEvent.shiftKey === true) { OT = true; } if (eventArgs.upTarget.type === 'page' && eventArgs.downTarget.type === 'page' && eventArgs.upTarget.pageIndex === eventArgs.downTarget.pageIndex || eventArgs.upTarget.type === 'comments' && eventArgs.downTarget.element === eventArgs.upTarget.element) { AS = true; if (eventArgs.upTarget.type === 'page' && eventArgs.downTarget.type === 'page' && OT === false) { K.deselectAllMarks(); } } else if (eventArgs.upMark && typeof eventArgs.downMark !== 'undefined') { if ((eventArgs.upMark.get_type() === IPCC.Web.UI.MarkType.DocumentHyperlink) && (eventArgs.upMark === eventArgs.downMark)) { iH = K.axy(eventArgs.upMark); AS = iH !== null; QB = "documentHyperlink"; } else { R = K.dq[eventArgs.upMark.get_markID()]; if (R === undefined) { for (var ic in K.dq) { if (K.dq.hasOwnProperty(ic)) { if (K.dq[ic].H.cE === eventArgs.upMark.cE && K.dq[ic].H.cE === eventArgs.downMark.cE) { R = K.dq[ic]; eventArgs.pageIndex = R.bp - 1; AS = true; var aud = K.getCurrentMouseTool(); var auN = PCCViewer.MouseTools.getMouseTool(aud); var aiC = auN.getType(); if (OT === false && eventArgs.domEvent.button === 0) { if (aiC === PCCViewer.MouseTool.Type.PanAndEdit || aiC === PCCViewer.MouseTool.Type.EditMarks) { K.deselectAllMarks(); R.H.set_selected(true); } } break; } } } } else if (typeof eventArgs.downMark !== 'undefined' && typeof eventArgs.upMark !== 'undefined' && eventArgs.downMark.jf() === eventArgs.upMark.jf()) { AS = true; if (OT === false && eventArgs.downTarget.alreadySelected === false) { K.deselectAllMarks(); R.H.set_selected(true); } } if (R === undefined) { if (K.dG && K.KE[eventArgs.upTarget.pageIndex + 1] === 'search') { var fc = K.dG.getResults(); for (var G = 0; G < fc.length; G++) { if (fc[G].bp === eventArgs.upTarget.pageIndex + 1 && typeof eventArgs.downMark.bh !== 'undefined' && typeof eventArgs.upMark.bh !== 'undefined' && typeof eventArgs.downMark.cg !== 'undefined' && typeof eventArgs.upMark.cg !== 'undefined' && eventArgs.downMark.bh >= fc[G].getStartIndexInPage() && eventArgs.downMark.bh + eventArgs.downMark.cg <= fc[G].getStartIndexInPage() + fc[G].getText().length && eventArgs.upMark.bh >= fc[G].getStartIndexInPage() && eventArgs.upMark.bh + eventArgs.upMark.cg <= fc[G].getStartIndexInPage() + fc[G].getText().length) { QB = 'searchResult'; eg = fc[G]; eventArgs.upTarget.pageIndex = eg.bp - 1; AS = true; break; } } } } if (AS === false && R === undefined && K.KE[eventArgs.upTarget.pageIndex + 1] === 'selectText' && typeof eventArgs.downMark.bh !== 'undefined' && typeof eventArgs.upMark.bh !== 'undefined' && eventArgs.downMark.bh >= K.bO.startIndex && eventArgs.downMark.bh + eventArgs.downMark.cg <= K.bO.startIndex + K.bO.length && eventArgs.upMark.bh >= K.bO.startIndex && eventArgs.upMark.bh + eventArgs.upMark.cg <= K.bO.startIndex + K.bO.length) { QB = 'textSelection'; bO = K.bO; AS = true; } } } var acO = new MouseEvent(eventArgs.originalEvent); setTimeout(function () { var asy = (isNaN(eventArgs.upTarget.pageIndex)) ? null : eventArgs.upTarget.pageIndex + 1; var L = { pageNumber: asy, targetType: QB, textSelection: bO, searchResult: eg, mark: R, originalEvent: acO, hyperlink: iH, clientX: eventArgs.clientX, clientY: eventArgs.clientY }; if (AS === true) { K.trigger('Click', L); } }, 0); }); (function () { var BA = null; K.bq.Dg(function (sender, eventArgs) { var acO = new MouseEvent(eventArgs.domEvent); var L = { originalEvent: acO, clientX: eventArgs.windowPoint.x, clientY: eventArgs.windowPoint.y }; if (!(eventArgs.mark instanceof IPCC.Web.UI.Mark)) { if (BA !== null) { L.mark = K.dq[BA]; BA = null; setTimeout(function () { K.trigger('MarkMouseLeave', L); }, 0); } } else { L.mark = K.dq[eventArgs.mark.get_markID()]; if (L.mark === undefined) { for (var ic in K.dq) { if (K.dq.hasOwnProperty(ic)) { if (K.dq[ic].H.cE === eventArgs.mark.cE) { L.mark = K.dq[ic]; break; } } } } if (!L.mark) { return; } setTimeout(function () { if (BA !== L.mark.getId()) { if (BA !== null) { K.trigger('MarkMouseLeave', IPCC.J.extend({}, L, { mark: K.dq[BA] })); } BA = L.mark.getId(); K.trigger('MarkMouseEnter', L); } K.trigger('MarkMouseOver', L); }, 0); } }); })(); this.bq.add_hyperlinkPageReady(function (sender, eventArgs) { if (K.TM[eventArgs.pageIndex] !== undefined) { return; } var aD = eventArgs.pageIndex, bI = K.cs.getPage(aD), JK = bI.get_hyperlinkPage().GX(), zB = K.TM[aD] = []; JK.mR(function (Ce) { zB.push(new PCCViewer.DocumentHyperlink({ bp: aD + 1, Ce: Ce })); }); if (!K.LV[aD]) { K.LV[aD] = new PCCViewer.Deferred(); } K.LV[aD].resolve(zB); }); this.qX = function (R, jw) { var YB = false; function Vb() { var nU = false; var cc = K.bq.get_displayedPages(); for (var G = 0; G < cc.get_length() ; G++) { var bI = cc.getPage(G); if (bI.get_pageNumber() === jw) { nU = true; break; } } return nU; }; function Sn(eo) { if (K.bq) { K.bq.cn(eo); } }; if (Vb()) { if (Array.prototype.indexOf) { if (IPCC.Web.hK(K.Fh, jw) >= 0) { YB = true; } } else { if (IPCC.Web.hK(K.Fh, jw) >= 0) { YB = true; } } if (!YB) { K.Fh.push(jw); setTimeout(function () { var dg = K.Fh.length; if (dg > 0) { for (var G = 0; G < dg; G++) { Sn(K.Fh[G]); } K.Fh.splice(0, dg); } }, 10); } } }; var Kn = { FreehandSignature: { lineColor: 'color', lineWidth: 'thickness', pathWidth: false, pathHeight: false }, FreehandAnnotation: { lineColor: 'color', lineWidth: 'thickness', pathWidth: false, pathHeight: false }, LineAnnotation: { lineColor: 'color', lineWidth: 'thickness' }, PolylineAnnotation: { lineColor: 'color', lineWidth: 'thickness' }, TextSignature: { textColor: false, fillColor: 'color' }, TextInputSignature: { lineVisible: false }, StampAnnotation: { text: 'label', fillColor: 'color' }, StampRedaction: { text: 'label' }, StrikethroughAnnotation: { lineColor: 'color', lineWidth: 'thickness', rectangle: 'position' }, RectangleRedaction: { text: 'reason' }, TextRedaction: { opacity: false }, HighlightAnnotation: { rectangle: 'position' }, TextSelectionRedaction: { rectangle: 'position', text: 'reason' }, TextHyperlinkAnnotation: { rectangle: 'position' } }; var TL = { lineColor: "borderColor", lineWidth: "borderThickness", pathString: "path", textColor: "fontColor", textHorizontalAlignment: "horizontalAlignment" }; this.sZ = function (aB, L) { var R = K.dq[L.mark.get_markID()]; var aa; if (R) { aa = R.aa; } if (aa && Kn[aa] && Kn[aa][L.propertyName] === false) { return; } var cr; if (aa) { cr = Kn[aa] && Kn[aa][L.propertyName] ? Kn[aa][L.propertyName] : TL[L.propertyName] ? TL[L.propertyName] : L.propertyName; } else { cr = TL[L.propertyName] ? TL[L.propertyName] : L.propertyName; } if (L.mark.get_type() === IPCC.Web.UI.MarkType.HighlightText || L.mark.get_type() === IPCC.Web.UI.MarkType.Highlight || L.mark.get_type() === IPCC.Web.UI.MarkType.TextSelectionRedaction || L.mark.get_type() === IPCC.Web.UI.MarkType.TextHighlightAnnotation || L.mark.get_type() === IPCC.Web.UI.MarkType.TextHyperlinkAnnotation || L.mark.get_type() === IPCC.Web.UI.MarkType.Strikethrough || (L.mark.get_type() === IPCC.Web.UI.MarkType.RectangleRedaction && L.mark.cE !== undefined)) { if (R) { setTimeout(function () { K.trigger('MarkChanged', { mark: R, pageNumber: L.pageIndex + 1, propertyName: cr }); }, 0); } else { for (var ic in K.dq) { if (K.dq.hasOwnProperty(ic)) { R = K.dq[ic]; if (R.cE === L.mark.cE) { break; } } } } K.qX(R, L.pageIndex); } else if (R && L.mark.get_type() === IPCC.Web.UI.MarkType.Polyline && cr === 'points') { if (R.aaq) { clearTimeout(R.aaq); } R.aaq = setTimeout(function () { R.aaq = undefined; K.qX(R, L.pageIndex); K.trigger('MarkChanged', { mark: R, pageNumber: L.pageIndex + 1, propertyName: cr }); }, 1); } else if (R) { K.qX(R, L.pageIndex); setTimeout(function () { K.trigger('MarkChanged', { mark: R, pageNumber: L.pageIndex + 1, propertyName: cr }); }, 0); } if (R && R.type === PCCViewer.Mark.Type.TextRedaction) { R.H.set_opacity(0); } if (R && (R.aa === PCCViewer.Mark.Type.TextInputSignature || R.aa === PCCViewer.Mark.Type.TextAreaSignature)) { R.H.set_lineVisible(false); } }; this.bq.add_markChanged(K.sZ); this.bq.add_markReordered(function (sender, eventArgs) { var R = K.dq[eventArgs.mark.get_markID()]; setTimeout(function () { K.trigger('MarkReordered', { mark: R, pageNumber: eventArgs.pageIndex + 1, index: eventArgs.zIndex, oldIndex: eventArgs.oldZIndex }); }, 0); }); this.Ev = function (sender, eventArgs) { if (eventArgs.mark.get_type() === IPCC.Web.UI.MarkType.TextSelectionRedaction || eventArgs.mark.get_type() === IPCC.Web.UI.MarkType.TextHyperlinkAnnotation || eventArgs.mark.get_type() === IPCC.Web.UI.MarkType.Strikethrough || eventArgs.mark.get_type() === IPCC.Web.UI.MarkType.HighlightText) { var R; for (var Nt in K.dq) { if (K.dq.hasOwnProperty(Nt)) { R = K.dq[Nt]; if (R.H.cE === eventArgs.mark.cE) { R.H.set_selected(eventArgs.mark.get_selected()); K.qX(R.H, R.H.aD); for (var G = 0; G < R.dF.length; G++) { R.dF[G].set_selected(eventArgs.mark.get_selected()); K.qX(R.dF[G], R.dF[G].aD); } } } } } setTimeout(function () { K.trigger('MarkSelectionChanged', { pageNumber: eventArgs.pageIndex + 1 }); }, 0); }; this.bq.add_markSelectionChanged(K.Ev); this.bq.add_markTextSelectionChanged(function (sender, eventArgs) { K.qX(eventArgs.mark, eventArgs.pageIndex); }); this.Ed = function (sender, eventArgs) { var R; if (eventArgs.mark) { R = K.dq[eventArgs.mark.get_markID()]; if ((eventArgs.mark.get_type() === IPCC.Web.UI.MarkType.HighlightText || eventArgs.mark.get_type() === IPCC.Web.UI.MarkType.TextSelectionRedaction || eventArgs.mark.get_type() === IPCC.Web.UI.MarkType.Strikethrough || eventArgs.mark.get_type() === IPCC.Web.UI.MarkType.TextHyperlinkAnnotation) && R === undefined && eventArgs.mark.cE !== undefined) { K.qX(eventArgs.mark, eventArgs.pageIndex); } else if (R) { setTimeout(function () { K.trigger(PCCViewer.EventType.MarkRemoved, { mark: R, pageNumber: eventArgs.pageIndex }); }, 0); } } }; this.bq.add_markRemoved(K.Ed); this.bq.add_commentAdding(function (sender, eventArgs) { var R = K.dq[eventArgs.mark.get_markID()]; if (eventArgs.comment.HI.iR === undefined) { eventArgs.comment.HI.iR = K.getActiveMarkupLayer(); } }); this.bq.add_commentAdded(function (sender, eventArgs) { var R = K.dq[eventArgs.mark.get_markID()]; K.trigger(PCCViewer.EventType.CommentCreated, { conversation: R.getConversation(), comment: eventArgs.comment.HI }); }); this.bq.add_commentRemoved(function (sender, eventArgs) { var R = K.dq[eventArgs.mark.get_markID()]; K.trigger(PCCViewer.EventType.CommentRemoved, { conversation: R.getConversation(), comment: eventArgs.comment.HI }); }); this.bq.add_commentChanged(function (sender, eventArgs) { var R = K.dq[eventArgs.mark.get_markID()]; K.trigger(PCCViewer.EventType.CommentChanged, { conversation: R.getConversation(), comment: eventArgs.comment.HI }); }); this.bq.add_scaleChanged(function (sender, eventArgs) { var fA; switch (eventArgs.fitType) { case 0: fA = PCCViewer.FitType.FullWidth; break; case 1: fA = PCCViewer.FitType.ShrinkToWidth; break; case 2: fA = PCCViewer.FitType.ActualSize; break; case 3: fA = PCCViewer.FitType.FullHeight; break; case 4: fA = PCCViewer.FitType.FullPage; break; default: break; } K.trigger(PCCViewer.EventType.ScaleChanged, { scaleType: eventArgs.scaleType, trigger: eventArgs.scaleTrigger, fitType: fA, scaleFactor: eventArgs.scaleFactor }); }); }; PCCViewer.ViewerControl.prototype.getPageCount = function () { return this.eD; }; PCCViewer.ViewerControl.prototype.getPageNumber = function () { return (this.bq) ? (this.bq.ajl().get_pageNumber() + 1) : 1; }; PCCViewer.ViewerControl.prototype.setPageNumber = function (pageNumber) { var bp; if (typeof (pageNumber) === 'number') { bp = pageNumber; } else { if (isNaN(+pageNumber)) { throw "The parameter pageNumber is not a number."; } else { bp = Number(pageNumber); } } if (parseInt(bp, 10) !== bp) { throw new Error("The 'pageNumber' value " + bp + " is not an integer page number."); } if (bp < 1 || bp > this.getPageCount() || !isFinite(bp)) { throw "The parameter pageNumber is out of range."; } if (this.getPageNumber() === bp) { return this; } if (this.bq) { this.bq.scrollToPage(bp - 1); } return this; }; PCCViewer.ViewerControl.prototype.changeToFirstPage = function () { if (this.bq) { if (this.Fx || this.rj) { this.bq.scrollToFirstPage(); } } return this; }; PCCViewer.ViewerControl.prototype.changeToLastPage = function () { if (this.bq) { if (this.Fx || this.rj) { this.bq.scrollToLastPage(); } } return this; }; PCCViewer.ViewerControl.prototype.changeToNextPage = function () { if (this.bq) { if (this.Fx || this.rj) { this.bq.scrollToNextPage(); } } return this; }; PCCViewer.ViewerControl.prototype.changeToPrevPage = function () { if (this.bq) { if (this.Fx || this.rj) { this.bq.scrollToPreviousPage(); } } return this; }; PCCViewer.ViewerControl.prototype.scrollBy = function (offsetX, offsetY) { if (!this.eF) { throw new Error("The method scrollTo requires the viewer to be in a 'ViewerReady' state."); } var K = this; if (typeof offsetX === 'number' && typeof offsetY === 'number') { K.bq.scrollBy(offsetX, offsetY); } else { if (isNaN(+offsetX) || isNaN(+offsetY)) { throw new PCCViewer.Error('InvalidArgument', 'Please provide integer values for offsetX and offsetY properties.'); } else { K.bq.scrollBy(Number(+offsetX), Number(+offsetY)); } } return this; }; PCCViewer.ViewerControl.prototype.scrollTo = function (target) { if (!this.eF) { throw new Error("The method scrollTo requires the viewer to be in a 'ViewerReady' state."); } if (this.fY) { this.fY.reject(new PCCViewer.Error("Error", "The scrollTo method was called before this scrollToAsync method completed scrolling, so scrolling for this scrollToAsync method has been cancelled.")); this.fY = null; this.ki = null; } var K = this; var MB = function () { K.bq.scrollConversationIntoView(target.getMark().H.get_conversation()); if (K.fY) { K.fY.resolve(); } K.fY = null; K.ki = null; }; var ww = function (ev) { if (ev.target.yH === target) { K.off(PCCViewer.EventType.CommentCreated, ww); K.yH = null; K.scrollTo(target); } else if (ev.target.yH === null) { K.off(PCCViewer.EventType.CommentCreated, ww); } if (K.fY) { K.fY.resolve(); } K.fY = null; K.ki = null; }; var LX = function (bp, hg) { K.bq.scrollRegionIntoView(bp - 1, hg); if (K.fY) { K.fY.resolve(); } K.fY = null; K.ki = null; }; agz(K, target, ww, MB, LX); return this; }; PCCViewer.ViewerControl.prototype.scrollToAsync = function (target) { if (this.fY) { this.fY.reject(new PCCViewer.Error("Error", "The scrollToAsync method was called before this scrollToAsync method completed scrolling, so scrolling for this scrollToAsync method has been cancelled.")); this.fY = null; this.ki = null; } var aT = PCCViewer.Deferred(); var cZ = aT.getPromise(); var K = this; K.fY = aT; try { var MB = function () { K.bq.scrollConversationIntoView(target.getMark().H.get_conversation()); if (K.fY) { K.fY.resolve(); } K.fY = null; K.ki = null; }; var ww = function (ev) { if (ev.target.yH === target) { K.off(PCCViewer.EventType.CommentCreated, ww); K.yH = null; K.scrollTo(target); } else if (ev.target.yH === null) { K.off(PCCViewer.EventType.CommentCreated, ww); } if (K.fY) { K.fY.resolve(); } K.fY = null; K.ki = null; }; var LX = function (bp, hg) { K.bq.scrollRegionIntoView(bp - 1, hg); if (K.fY) { K.fY.resolve(); } K.fY = null; K.ki = null; }; if (agz(K, target, ww, MB, LX) === true) { aT.resolve(); } } catch (e) { K.fY = null; K.ki = null; aT.reject(new PCCViewer.Error("Error", e)); } return cZ; }; function agz(cL, cD, ww, MB, LX) { var hg, bp, ai; cL.yH = null; if (cD instanceof PCCViewer.Conversation) { if (cL.dq[cD.getMark().getId()] === undefined) { throw new Error("The parameter target is a conversation of a mark unknown to the viewer control."); } var afE = cL.bq.scrollConversationIntoView(cD.getMark().H.get_conversation()); if (afE === "PageOutOfView") { cL.ki = MB; cL.setPageNumber(cD.getMark().getPageNumber()); return false; } else if (afE === "ConversationDivDoesNotExist" && cD.getMark().H.get_conversation().get_length() > 0) { cL.yH = cD; cL.on(PCCViewer.EventType.CommentCreated, ww); return false; } else { cL.ki = null; return true; } } else if (cD instanceof PCCViewer.SearchResult) { if (cD.KH !== cL.bE.get_documentIdentifier()) { throw new Error("The parameter target is a SearchResult that was not created using the current document viewing session."); } ai = cD.getBoundingRectangle(); hg = new IPCC.Web.UI.Rectangle(ai.x, ai.y, ai.width, ai.height); bp = cD.getPageNumber(); } else if (cD instanceof PCCViewer.Mark) { if (cL.dq[cD.getId()] === undefined) { throw new Error("The parameter target is a mark unknown to the viewer control."); } ai = cD.getBoundingRectangle(); hg = new IPCC.Web.UI.Rectangle(ai.x, ai.y, ai.width, ai.height); bp = cD.getPageNumber(); } else if (cD !== undefined && cD !== null) { if (typeof cD.x === 'number' && typeof cD.y === 'number') { hg = new IPCC.Web.UI.Rectangle(+cD.x, +cD.y, 0, 0); } else { if (isNaN(+cD.x) || isNaN(+cD.y)) { throw new Error('The parameter target does not contain a valid x and y values.'); } else { hg = new IPCC.Web.UI.Rectangle(Number(+cD.x), Number(+cD.y), 0, 0); } } if (cD.width) { if (typeof cD.width === 'number') { hg.width = cD.width; } else { if (isNaN(+cD.width)) { throw new Error('The parameter target does not contain a valid width value.'); } else { hg.width = Number(+cD.width); } } } if (cD.height) { if (typeof cD.height === 'number') { hg.height = cD.height; } else { if (isNaN(+cD.height)) { throw new Error('The parameter target does not contain a valid height value.'); } else { hg.height = Number(+cD.height); } } } if (typeof cD.pageNumber === 'number') { bp = +cD.pageNumber; } else { if (isNaN(+cD.pageNumber)) { throw new Error('The parameter target does not contain a valid pageNumber value.'); } else { bp = Number(+cD.pageNumber); } } } else { throw new Error('The target parameter must be a Mark, SearchResult, or Point.'); } if (bp < 1 || bp > cL.getPageCount() || !isFinite(bp)) { throw new RangeError("The parameter pageNumber is out of range."); } if (cL.bq.scrollRegionIntoView(bp - 1, hg) === false) { cL.ki = function () { LX(bp, hg); }; cL.setPageNumber(bp); return false; } else { cL.ki = null; return true; } }; PCCViewer.ViewerControl.prototype.rotatePage = function (degreesClockwise) { if (!this.eF) { throw "The method rotatePage requires the viewer to be in a 'ViewerReady' state."; } if (DC(this.getPageNumber() - 1, this) === false) { this.bq.cn(this.getPageNumber() - 1); } var ix = degreesClockwise % 360, K = this; if (ix !== 0) { var zA = [90, 180, 270, -90, -180, -270]; if (Array.prototype.indexOf) { if (!ix || zA.indexOf(ix) === -1) { throw new RangeError("The value of degreesClockwise (" + degreesClockwise + ") is not valid."); } } else { if (!ix || IPCC.Web.hK(zA, ix) === -1) { throw new RangeError("The value of degreesClockwise (" + degreesClockwise + ") is not valid."); } } this.bq.rotate(ix); } setTimeout(function () { K.trigger("PageRotated", { degreesClockwise: ix, pageNumber: (K.getPageNumber()) }); }, 0); return this; }; PCCViewer.ViewerControl.prototype.rotateDocument = function (degreesClockwise) { if (!this.eF) { throw "The method rotateDocument requires the viewer to be in a 'ViewerReady' state."; } if (DC(this.getPageNumber() - 1, this) === false) { this.bq.cn(this.getPageNumber() - 1); } var ix = degreesClockwise % 360, K = this; if (ix !== 0) { var zA = [90, 180, 270, -90, -180, -270]; if (Array.prototype.indexOf) { if (!ix || zA.indexOf(ix) === -1) { throw new RangeError("The value of degreesClockwise (" + degreesClockwise + ") is not valid."); } } else { if (!ix || IPCC.Web.hK(zA, ix) === -1) { throw new RangeError("The value of degreesClockwise (" + degreesClockwise + ") is not valid."); } } this.bq.agP(ix); } setTimeout(function () { K.trigger("DocumentRotated", { degreesClockwise: ix }); }, 0); return this; }; PCCViewer.ViewerControl.prototype.getScaleFactor = function () { if (!this.vN) { throw "The getScaleFactor method cannot be called before the initial PageOpening event."; } return this.bq.get_scaleFactor(); }; PCCViewer.ViewerControl.prototype.setScaleFactor = function (scaleFactor) { if (!this.vN) { throw "The setScaleFactor method cannot be called before the initial PageOpening event."; } if (isNaN(+scaleFactor) || (+scaleFactor < this.getMinScaleFactor()) || (+scaleFactor > this.getMaxScaleFactor())) { throw new IPCC.Web.UI.ImGearArgumentOutOfRangeException('scaleFactor', scaleFactor, 'The value must be a number between the values returned by the getMinScaleFactor and getMaxScaleFactor methods.'); } this.bq.set_scaleFactor(+scaleFactor); return this; }; PCCViewer.ViewerControl.prototype.getMinScaleFactor = function () { if (!this.vN) { throw "The getMinScaleFactor method cannot be called before the initial PageOpening event."; } return this.bq.getMinMaxZoom().minFactor; }; PCCViewer.ViewerControl.prototype.getMaxScaleFactor = function () { if (!this.vN) { throw "The getMaxScaleFactor method cannot be called before the initial PageOpening event."; } return this.bq.getMinMaxZoom().maxFactor; }; PCCViewer.ViewerControl.prototype.zoomIn = function (zoomFactor) { if (!this.vN) { throw "The zoomIn method cannot be called before the initial PageOpening event."; } if (isNaN(+zoomFactor) || (+zoomFactor < 1.01) || (+zoomFactor > 20)) { throw new IPCC.Web.UI.ImGearArgumentOutOfRangeException('zoomFactor', zoomFactor, 'The value must be a number between 1.01 and 20 inclusive.'); } if (this.bq) { this.bq.zoomIn(+zoomFactor); } return this; }; PCCViewer.ViewerControl.prototype.zoomOut = function (zoomFactor) { if (!this.vN) { throw "The zoomOut method cannot be called before the initial PageOpening event."; } if (isNaN(+zoomFactor) || (+zoomFactor < 1.01) || (+zoomFactor > 20)) { throw new IPCC.Web.UI.ImGearArgumentOutOfRangeException('zoomFactor', zoomFactor, 'The value must be a number between 1.01 and 20 inclusive.'); } if (this.bq) { this.bq.zoomOut(+zoomFactor); } return this; }; PCCViewer.ViewerControl.prototype.getViewMode = function () { var oh; if (this.bq && this.bq.get_viewMode) { oh = this.bq.get_viewMode(); } else { oh = this.aH.viewMode; } if (oh === IPCC.ViewMode.EqualWidthPages) { return PCCViewer.ViewMode.EqualWidthPages; } else if (oh === IPCC.ViewMode.EqualFitPages) { return PCCViewer.ViewMode.EqualFitPages; } else if (oh === IPCC.ViewMode.SinglePage) { return PCCViewer.ViewMode.SinglePage; } else { return PCCViewer.ViewMode.Document; } }; PCCViewer.ViewerControl.prototype.setViewMode = function (viewMode) { var oh; switch (viewMode) { case PCCViewer.ViewMode.Document: oh = IPCC.ViewMode.Document; break; case PCCViewer.ViewMode.EqualWidthPages: oh = IPCC.ViewMode.EqualWidthPages; break; case PCCViewer.ViewMode.EqualFitPages: oh = IPCC.ViewMode.EqualFitPages; break; case PCCViewer.ViewMode.SinglePage: oh = IPCC.ViewMode.SinglePage; break; default: throw new RangeError("The value of viewMode is not a supported value."); } if (this.bq && this.bq.set_viewMode) { var HZ = this.bq.get_viewMode(); if (HZ !== oh) { if (HZ === IPCC.ViewMode.SinglePage) { throw new Error("The view mode may not be changed from SinglePage to another view mode after initializing the viewer."); } else if (oh === IPCC.ViewMode.SinglePage) { throw new Error("The view mode may not be changed to SinglePage after initializing the viewer. Please use the viewMode viewer parameter instead."); } this.bq.set_viewMode(oh); } } else { this.aH.viewMode = oh; } return this; }; PCCViewer.ViewerControl.prototype.getPageLayout = function () { var yN; if (this.bq && this.bq.get_pageLayout) { yN = this.bq.get_pageLayout(); } else { yN = this.aH.pageLayout; } if (yN === IPCC.PageLayout.HorizontalScrollDirection) { return PCCViewer.PageLayout.Horizontal; } else { return PCCViewer.PageLayout.Vertical; } }; PCCViewer.ViewerControl.prototype.setPageLayout = function (pageLayout) { var yN; if (this.aH.viewMode !== IPCC.ViewMode.SinglePage) { switch (pageLayout) { case PCCViewer.PageLayout.Vertical: yN = IPCC.PageLayout.VerticalScrollDirection; break; case PCCViewer.PageLayout.Horizontal: if (this.bq && this.bq.closeCommentsPanel) { this.bq.closeCommentsPanel(); var K = this; setTimeout(function () { K.trigger("CommentsPanelToggled", { isOpen: false }); }, 10); } yN = IPCC.PageLayout.HorizontalScrollDirection; break; default: throw new RangeError("The value of pageLayout is not a supported value."); } } if (this.bq && this.bq.set_pageLayout) { this.bq.set_pageLayout(yN); } else { this.aH.pageLayout = yN; } return this; }; PCCViewer.ViewerControl.prototype.getAtMaxScale = function () { if (!this.vN) { throw "The getAtMaxScale method cannot be called before the initial PageOpening event."; } return this.bq.getMinMaxZoom().atMax; }; PCCViewer.ViewerControl.prototype.getAtMinScale = function () { if (!this.vN) { throw "The getAtMinScale method cannot be called before the initial PageOpening event."; } return this.bq.getMinMaxZoom().atMin; }; PCCViewer.ViewerControl.prototype.fitContent = function (fitType) { if (!this.vN) { throw "The fitContent method cannot be called before the initial PageOpening event."; } var EF; switch (fitType) { case PCCViewer.FitType.FullWidth: EF = IPCC.FitType.FitToWidth; break; case PCCViewer.FitType.ShrinkToWidth: EF = IPCC.FitType.ShrinkToWidth; break; case PCCViewer.FitType.ActualSize: if (this.getViewMode() === PCCViewer.ViewMode.EqualWidthPages || this.getViewMode() === PCCViewer.ViewMode.EqualFitPages) { throw new Error("Fitting content actual size is not supported when in EqualFitPages view mode."); } EF = IPCC.FitType.ActualSize; break; case PCCViewer.FitType.FullHeight: EF = IPCC.FitType.FitToHeight; break; case PCCViewer.FitType.FullPage: EF = IPCC.FitType.BestFit; break; default: throw new RangeError("The value of fitType is not a supported value."); } this.CF.then(function (yV) { yV.fitPages(EF); }); return this; }; PCCViewer.ViewerControl.prototype.getPageRotation = function (pageNumber) { if (!this.eF) { throw new Error("The method getPageRotation requires the viewer to be in a 'ViewerReady' state."); } var bp; if (arguments.length > 0) { if (typeof (pageNumber) === 'number') { bp = pageNumber; } else { if (isNaN(+pageNumber)) { throw new Error("The parameter pageNumber is not a number."); } else { bp = Number(pageNumber); } } if (parseInt(bp, 10) !== bp) { throw new Error("The 'pageNumber' value " + bp + " is not an integer page number."); } if (bp < 1 || bp > this.getPageCount() || !isFinite(bp)) { throw new Error("The parameter pageNumber is out of range."); } return this.bq.Zo(bp - 1); } else { return this.bq.Zo(); } }; PCCViewer.ViewerControl.prototype.search = function (dX) { var aH = this.aH; var aBN = aH.searchMethodType.toLowerCase(); var apD = aH.searchMethodPageCountThreshold; var K = this; var ZT; var kN; var Jy = new PCCViewer.SearchRequest(true); if (Object.defineProperties) { Object.defineProperties(Jy, { "searchQuery": { enumerable: true, get: function () { return kN.getSearchQuery(); } }, "results": { enumerable: true, get: function () { return kN.getResults(); } }, "isComplete": { enumerable: true, get: function () { return kN.getIsComplete(); } }, "errorCode": { enumerable: true, get: function () { return kN.getErrorCode(); } }, "errorMessage": { enumerable: true, get: function () { return kN.getErrorMessage(); } } }); } function LF(dC) { return function () { Jy.trigger.apply(Jy, [dC].concat([].slice.call(arguments))); }; }; var alH = LF(PCCViewer.EventType.SearchCompleted); var anj = LF(PCCViewer.EventType.SearchCancelled); var alQ = LF(PCCViewer.EventType.SearchResultsAvailable); var alY = LF(PCCViewer.EventType.PartialSearchResultsAvailable); var amr = function (au) { var je = ZT.getErrorCode(); if (je === 'ServerSearchUnavailable') { K.aiU = true; K.Ds = false; aEk(); kN = K.clientSearch(dX); amV(); } else { LF(PCCViewer.EventType.SearchFailed).apply(null, arguments); } }; var amV = function () { kN.on(PCCViewer.EventType.SearchCompleted, alH); kN.on(PCCViewer.EventType.SearchFailed, amr); kN.on(PCCViewer.EventType.SearchCancelled, anj); kN.on(PCCViewer.EventType.SearchResultsAvailable, alQ); kN.on(PCCViewer.EventType.PartialSearchResultsAvailable, alY); }; var aEk = function () { kN.off(PCCViewer.EventType.SearchCompleted, alH); kN.off(PCCViewer.EventType.SearchFailed, amr); kN.off(PCCViewer.EventType.SearchCancelled, anj); kN.off(PCCViewer.EventType.SearchResultsAvailable, alQ); kN.off(PCCViewer.EventType.PartialSearchResultsAvailable, alY); }; var Gk = function () { if (K.aiU === false) { ZT = K.serverSearch(dX); kN = ZT; amV(); IPCC.J.forEach(['getSearchQuery', 'getResults', 'getIsComplete', 'getErrorCode', 'getErrorMessage', 'cancel', 'getPagesWithoutText'], function (dC) { Jy[dC] = function () { return kN[dC].apply(kN, arguments); }; }); return Jy; } else { return K.clientSearch(dX); } }; switch (aBN) { case ('auto'): if (apD >= this.eD) { return this.clientSearch(dX); } else { return Gk(); } break; case ('client'): return this.clientSearch(dX); case ('server'): return Gk(); default: throw new Error("The value of 'options.searchMethodType' should be 'auto', 'server', or 'client'."); } }; PCCViewer.ViewerControl.prototype.akl = function (dX, aDW) { var K = this; var dB = new PCCViewer._Search(); this.dG = dB.aAm(); PCCViewer.SearchTask.prototype.afS(dX); if (aDW === true) { if (K.Ad !== true) { K.CF.then(function (yV) { var Hx = function () { K.off('PageCountReady', Hx); K.clientSearch(dX); }; K.on('PageCountReady', Hx); return K.dG; }); } if (!this.bE.acq()) { this.bE.Mp(0, this.bE.eD - 1, this.bE.eD); } } this.AC = null; this.Nc = {}; this.bq.clearAllSelectedText(); return dB; }; PCCViewer.ViewerControl.prototype.afW = function () { var aO = this; this.dG.on('PartialSearchResultsAvailable', function (cA) { if (aO.Az) { return; } var IL = []; var QQ = {}; IL = cA.partialSearchResults; var bM = IL[0]; if (aO.Nc[bM.getPageNumber()] !== undefined) { QQ = aO.Nc[bM.getPageNumber()]; } else { QQ.bh = bM.getId(); } bM = IL[IL.length - 1]; QQ.fF = bM.getId(); aO.Nc[bM.getPageNumber()] = QQ; function Fv(bI) { if (aO.Az) { return; } aO.aiW(bI.get_pageNumber(), IL); }; var cc = aO.bq.get_displayedPages(); for (var G = 0; G < cc.get_length() ; G++) { var bI = cc.getPage(G); if (bI.get_pageNumber() + 1 === bM.getPageNumber()) { aO.requestPageText(bI.get_pageNumber() + 1).then(Fv.bind(null, bI)); } } }); this.dG.on('SearchCompleted', function (cA) { aO.Ds = false; }); this.dG.on('SearchCancelled', function (cA) { aO.Ds = false; }); this.trigger('SearchPerformed', { searchRequest: this.dG }); }; PCCViewer.ViewerControl.prototype.clientSearch = function (searchQuery) { var aO = this; var dB = aO.akl(searchQuery, true); searchQuery = dB.Vj(searchQuery); if (this.Ds === false) { aO.bq.set_retainPageText(true); this.dG = dB.xe(searchQuery, this.bE); this.Ds = true; } else { throw new Error("You cannot run multiple searches concurrently. Retry after the current search is completed."); } aO.afW(); return this.dG; }; PCCViewer.ViewerControl.prototype.serverSearch = function (searchQuery) { var aO = this; var dB = aO.akl(searchQuery, false); searchQuery = dB.Vj(searchQuery); if (this.Ds === false) { this.dG = dB.Gk(searchQuery, this.bE); this.Ds = true; } else { throw new Error("You cannot run multiple searches concurrently. Retry after the current search is completed."); } aO.afW(); return this.dG; }; PCCViewer.ViewerControl.prototype.getSearchRequest = function () { return this.dG; }; PCCViewer.ViewerControl.prototype.clearSearch = function () { if (!this.eF) { throw "The clearSearch method requires the viewer to be in a 'ViewerReady' state."; } var K = this; if (this.getSelectedSearchResult()) { this.AC = null; setTimeout(function () { K.trigger(PCCViewer.EventType.SearchResultSelectionChanged, {}); }, 0); } this.bq.clearAllSelectedText(); this.dG = null; setTimeout(function () { K.trigger(PCCViewer.EventType.SearchCleared, {}); }, 0); return this; }; PCCViewer.ViewerControl.prototype.validateSearch = function (dX) { var dY = { errorsExist: false }; var searchTermObj, alv, G, aj, aav, Pw, RF; if (typeof dX !== 'object' && typeof dX !== 'string') { dY.errorsExist = true; dY.summaryMsg = "Search query must be either an object or string."; return dY; } if (typeof dX === 'string' && dX.length < 0) { dY.errorsExist = true; dY.summaryMsg = "Search term must contain at least 3 characters."; return dY; } else if (typeof dX === 'string') { return dY; } if (!dX.hasOwnProperty('searchTerms')) { dY.errorsExist = true; dY.summaryMsg = "Search options must have a 'searchTerms' key."; return dY; } if (Object.prototype.toString.call(dX.searchTerms) !== '[object Array]') { dY.errorsExist = true; dY.summaryMsg = "Search terms value must be an array."; return dY; } if (!dX.searchTerms.length) { dY.errorsExist = true; dY.summaryMsg = "Search terms array must contain at least one value."; return dY; } dY.searchTerms = []; IPCC.J.forEach(dX.searchTerms, function (searchTermObj) { var Mr = aok(searchTermObj); if (Mr.errorsExist) { dY.errorsExist = true; } dY.searchTerms = dY.searchTerms.concat(Mr.searchTerms); }); return dY; }; function aok(jG) { var dY = { errorsExist: false, searchTerms: [] }; var aAa = jG.type ? IPCC.J.trim(jG.type).toLowerCase() : undefined; if (aAa === 'proximity') { if (Object.prototype.toString.call(jG.terms) !== '[object Array]') { dY.searchTerms.push({ isValid: false, message: "Proximity search terms property must be an array" }); dY.errorsExist = true; return dY; } if (jG.terms.length < 2) { dY.searchTerms.push({ isValid: false, message: "Proximity search terms array must contain at least two values" }); dY.errorsExist = true; return dY; } if (!jG.distance) { dY.searchTerms.push({ isValid: false, message: "Proximity search term must have a distance specified" }); dY.errorsExist = true; return dY; } IPCC.J.forEach(jG.terms, function (aBy) { var Mr = aok(aBy); if (Mr.errorsExist) { dY.errorsExist = true; } dY.searchTerms = dY.searchTerms.concat(Mr.searchTerms); }); return dY; } var aav, RF; var Pw = (typeof jG.matchingOptions !== 'undefined' && jG.matchingOptions.hasOwnProperty('matchCase')) ? jG.matchingOptions.matchCase : false; if (typeof jG.searchTerm === 'undefined' || typeof jG.searchTerm !== 'string' || (jG.searchTermIsRegex === true && !aAh(jG.searchTerm, Pw))) { dY.errorsExist = true; dY.searchTerms.push({ isValid: false, message: "Search term must be a string containing either plain text or a valid regular expression." }); return dY; } aav = (typeof jG.matchingOptions !== 'undefined' && jG.matchingOptions.hasOwnProperty('exactPhrase')) ? jG.matchingOptions.exactPhrase : false; if (aav) { if (jG.searchTerm.length < 0) { dY.errorsExist = true; dY.searchTerms.push({ isValid: false, message: "Search term must contain at least 3 characters." }); return dY; } } else { var alv = jG.searchTerm.split(' '); IPCC.J.forEach(alv, function (RF) { if (RF.length > 0 && RF.length < 0) { dY.errorsExist = true; dY.searchTerms.push({ isValid: false, message: "Search term must contain at least 3 characters." }); } }); } if (!dY.searchTerms.length) { dY.searchTerms.push({ isValid: true, message: null }); } return dY; }; var aAh = function (Xt, Pw) { var awI, abH, VC; if (Pw) { abH = 'gm'; } else { abH = 'igm'; } if (!Xt && Xt !== null) { VC = false; } else { try { awI = new RegExp(Xt, abH); VC = true; } catch (err) { VC = false; } } return VC; }; PCCViewer.ViewerControl.prototype.getDownloadDocumentURL = function () { var am; if (!(/^[\x00-\x7F]*$/.test(this.bE))) { am = this.aH.imageHandlerUrl + '/SaveDocument/q?DocumentID=e' + this.aH.documentID + '/SourceFile'; } else { am = this.aH.imageHandlerUrl + '/SaveDocument/q?DocumentID=u' + encodeURIComponent(this.aH.documentID); } return am; }; PCCViewer.ViewerControl.prototype.setRedactionViewMode = function (redactionViewMode) { var Oi, UD; switch (redactionViewMode) { case PCCViewer.RedactionViewMode.Draft: Oi = true; UD = PCCViewer.RedactionViewMode.Draft; break; case PCCViewer.RedactionViewMode.Normal: Oi = false; UD = PCCViewer.RedactionViewMode.Normal; break; default: throw new RangeError("The value of RedactionViewMode is not a supported value."); } if (this.bq && this.bq.set_redactionDraftMode) { var awa = this.bq.get_redactionDraftMode(); if (awa !== Oi) { this.bq.set_redactionDraftMode(Oi); } } else { this.aH.redactionViewMode = UD; } return this; }; PCCViewer.ViewerControl.prototype.getRedactionViewMode = function () { var aed; if (this.bq && this.bq.get_redactionDraftMode) { aed = this.bq.get_redactionDraftMode(); if (aed === true) { return PCCViewer.RedactionViewMode.Draft; } else { return PCCViewer.RedactionViewMode.Normal; } } else { return this.aH.redactionViewMode; } }; PCCViewer.ViewerControl.prototype.convertToRedaction = function (searchResult) { var K = this; var eg = searchResult; if (this.eF === false) { throw "The convertToRedaction method can not be used until 'ViewerReady' state is reached."; } else if (eg instanceof Array) { throw new Error("Argument for this method cannot be an array."); } else if (eg instanceof PCCViewer.SearchResult === false) { throw new Error("The argument is not an instance of SearchResult."); } else if (eg.KH !== this.bE.get_documentIdentifier()) { throw new Error("The SearchResult argument was not created using the current document viewing session."); } var bI = K.cs.getPage(eg.getPageNumber() - 1); if (!(bI.cv() && bI.cv().Ar() && bI.cv().mw() === true)) { throw new Error("The text has not been retrieved for this page."); } var iO = eg.getStartIndexInPage(); var ec = eg.getStartIndexInPage() + eg.getText().length; var kW = IPCC.FA(); var aX = K.bq.hz(bI); var gP = bI.cv().gl(); var fu = arh(aX, gP, iO, ec, kW, eg.getPageNumber() - 1); var R = new PCCViewer.Mark({ type: 'TextSelectionRedaction', igMark: fu, pageNumber: eg.getPageNumber() }); R.H = fu; R.dF = []; this.dq[fu.get_markID()] = R; var vF = K.ld; K.ld = function (sender, eventArgs) { if (K.tu) { K.AN.addMarks(R); } setTimeout(function () { K.trigger('MarkCreated', { mark: R, pageNumber: eventArgs.pageIndex + 1, clientX: eventArgs.clientX, clientY: eventArgs.clientY }); }, 0); }; aX.addMark(fu); K.ld = vF; K.bq.display(eg.getPageNumber() - 1); return R; }; var arh = function (aX, gP, iO, ec, kW, aoy) { var fu = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.TextSelectionRedaction); fu.cE = kW; fu.aD = aoy; var R = null; var nj = { ip: Number.MAX_VALUE, iG: 0, _top: Number.MAX_VALUE, jY: 0 }; for (var aj = iO; aj < ec; aj++) { var gw = gP.jN(aj); if (R) { var zk = R.get_rectangle(); if (Math.abs(gw.av.y - zk.y) < 1 && Math.abs(gw.av.height - zk.height) < 1 && gw.av.x + gw.av.width >= zk.x + zk.width) { R.set_rectangle(new IPCC.Web.UI.Rectangle(zk.x, zk.y, gw.av.x + gw.av.width - zk.x, zk.height)); } else { ald(aX, fu, R, nj); R = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.RectangleRedaction); R.set_rectangle(gw.av); R.mg(true); R.set_fillColor('#000000'); R.set_text(fu.az); R.set_lineWidth(0); R.cE = kW; } } else { R = new IPCC.Web.UI.Mark(IPCC.Web.UI.MarkType.RectangleRedaction); R.set_rectangle(gw.av); R.mg(true); R.set_fillColor('#000000'); R.set_text(fu.az); R.set_lineWidth(0); R.cE = kW; } R.aD = aoy; } if (R !== null) { ald(aX, fu, R, nj); } fu.set_rectangle(new IPCC.Web.UI.Rectangle(nj.ip, nj._top, nj.iG - nj.ip, nj.jY - nj._top)); return fu; }; var ald = function (aX, fu, R, nj) { var h = R.get_rectangle(); if (h.x < nj.ip) { nj.ip = h.x; } if (h.y < nj._top) { nj._top = h.y; } if (h.x + h.width > nj.iG) { nj.iG = h.x + h.width; } if (h.y + h.height > nj.jY) { nj.jY = h.y + h.height; } aX.addMark(R); fu.bV.push(R); }; PCCViewer.ViewerControl.prototype.convertToHighlight = function (searchResult) { var eg = searchResult; if (this.eF === false) { throw "The convertToHighlight method can not be used until 'ViewerReady' state is reached."; } if (eg instanceof Array) { throw new Error("Argument for this method cannot be an array."); } if (eg instanceof PCCViewer.SearchResult === false) { throw new Error("The argument is not an instance of SearchResult."); } if (eg.KH !== this.bE.get_documentIdentifier()) { throw new Error("The SearchResult argument was not created using the current document viewing session."); } var fu; var afy; var aX; var bM = eg; var iO = bM.getStartIndexInPage(); var ec = bM.getStartIndexInPage() + bM.getText().length; var kW = IPCC.FA(); var K = this; var R; aX = this.bq.hz(this.cs.getPage(bM.getPageNumber() - 1)); fu = aiP(IPCC.Web.UI.MarkType.HighlightText, bM, iO, kW); R = new PCCViewer.Mark({ type: 'HighlightAnnotation', igMark: fu, pageNumber: bM.getPageNumber() }); for (iO; iO < ec; iO++) { afy = aiP(IPCC.Web.UI.MarkType.Highlight, bM, iO, kW); aX.addMark(afy); } this.dq[fu.get_markID()] = R; var vF = this.ld; this.ld = function (sender, eventArgs) { if (K.tu) { K.AN.addMarks(R); } setTimeout(function () { K.trigger('MarkCreated', { mark: R, pageNumber: eventArgs.pageIndex + 1, clientX: eventArgs.clientX, clientY: eventArgs.clientY }); }, 0); }; aX.addMark(fu); K.ld = vF; this.bq.display(bM.getPageNumber() - 1); R.fillColor = bM.getHighlightColor(); return R; }; var aiP = function (bi, bM, aEH, kW) { var R = new IPCC.Web.UI.Mark(bi); if (bi === IPCC.Web.UI.MarkType.HighlightText) { R.cl = bM.getText(); } R.bh = aEH; R.set_rectangle({ x: 0, y: 0, width: 0, height: 0 }); R.cg = bM.getText().length; R.aJS = bM.getStartIndexInPage() + bM.getText().length; R.dI = 127; R.cK = bM.getHighlightColor(); R.kz = 'y'; R.cE = kW; return R; }; PCCViewer.ViewerControl.prototype.aiW = function (aD, fc) { var bM = {}; for (var aj = 0; aj < fc.length; aj++) { bM = fc[aj]; this.bq.selectText(bM.getPageNumber() - 1, bM.getStartIndexInPage(), bM.getText().length, bM.getHighlightColor()); } this.bq.display(bM.getPageNumber() - 1); this.KE[bM.getPageNumber()] = 'search'; }; PCCViewer.ViewerControl.prototype.acC = function (aD, searchResult) { var bM = {}; if (this.dG === null || typeof this.dG.getResults !== 'function') { return; } var fc = this.dG.getResults(); this.bq.clearSelectedText(aD - 1); var abA = this.Nc[aD]; if (!abA) { return; } for (var aj = abA.bh; aj < abA.fF + 1; aj++) { bM = fc[aj]; if (bM.getPageNumber() === aD) { this.bq.selectText(bM.getPageNumber() - 1, bM.getStartIndexInPage(), bM.getText().length, bM.getHighlightColor()); if (searchResult === bM.getId()) { this.bq.selectText(bM.getPageNumber() - 1, bM.getStartIndexInPage(), bM.getText().length, bM.getHighlightColor()); } } } this.bq.display(bM.getPageNumber() - 1); this.KE[bM.getPageNumber()] = 'search'; }; PCCViewer.ViewerControl.prototype.setSelectedSearchResult = function (searchResult, scrollTo) { if (!this.eF) { throw "The setSelectedSearchResult method requires the viewer to be in a 'ViewerReady' state."; } if (searchResult === null) { this.Oo = -1; } else { if (!(searchResult instanceof PCCViewer.SearchResult)) { throw "The parameter searchResult is not an instance of PCCViewer.SearchResult."; } if (!this.dG) { throw "There is no current SearchRequest object available."; } var alz = this.dG.getResults(); if (alz[searchResult.getId()].nT !== searchResult.nT) { throw "The parameter searchResult is not current. There is a newer version of search result available."; } alz = null; this.Oo = searchResult.getId(); if (scrollTo) { var ai = searchResult.getBoundingRectangle(); var hg = new IPCC.Web.UI.Rectangle(ai.x, ai.y, ai.width, ai.height); if (this.bq.scrollRegionIntoView(searchResult.getPageNumber() - 1, hg) === false) { this.ki = function () { K.bq.scrollRegionIntoView(searchResult.getPageNumber() - 1, hg); }; this.setPageNumber(searchResult.getPageNumber()); } else { this.ki = null; } } } var K = this; var asR = searchResult !== null ? searchResult.getPageNumber() : -1; if (this.AC && this.AC.getPageNumber() !== asR) { K.requestPageText(K.AC.getPageNumber()).then(function Fv() { K.acC(K.AC.getPageNumber(), K.Oo); }); } if (searchResult) { K.requestPageText(searchResult.getPageNumber()).then(function Fv() { K.acC(searchResult.getPageNumber(), K.Oo); }); } this.AC = searchResult; setTimeout(function () { K.trigger(PCCViewer.EventType.SearchResultSelectionChanged, {}); }, 0); return this; }; PCCViewer.ViewerControl.prototype.clearSelectedSearchResult = function () { if (!this.eF) { throw "The clearSelectedSearchResult method requires the viewer to be in a 'ViewerReady' state."; } this.setSelectedSearchResult(null); return this; }; PCCViewer.ViewerControl.prototype.getSelectedSearchResult = function () { return this.AC; }; PCCViewer.ViewerControl.prototype.requestPageText = function (pageNumber) { var bp; var aT = PCCViewer.Deferred(); var cZ = aT.getPromise(); var K = this; try { if (typeof (pageNumber) === 'number') { bp = pageNumber; } else { if (isNaN(+pageNumber)) { throw "The parameter pageNumber is not a number."; } else { bp = parseInt(pageNumber, 10); } } if (bp < 1 || bp > this.getPageCount() || !isFinite(pageNumber)) { throw "The specified page is out of range."; } this.CF.then(function (yV) { var bI = K.cs.getPage(bp - 1); var gs = bI.cv(); gs.acS(true); if (gs && gs.Ar()) { if (gs.mw() === true) { var az = bI.cv().FF(); aT.resolve(az); } else { aT.resolve(""); } } else { var Or = function (aB, dm) { if (dm.containsText === true) { var az = gs.FF(); aT.resolve(az); } else { aT.resolve(""); } bI.yI(Or); bI.EU(NJ); }; var NJ = function (aB, dm) { if (dm.exception && dm.exception.message) { aT.reject(new PCCViewer.Error("TextExtractionFailed", dm.exception.message)); } else { aT.reject(new PCCViewer.Error("TextExtractionFailed", "Text extraction failed.")); } bI.yI(Or); bI.EU(NJ); }; bI.xq(Or); bI.Cg(NJ); bI.Bx(); } }); } catch (e) { aT.reject(new PCCViewer.Error("Error", e)); } return cZ; }; PCCViewer.ViewerControl.prototype.disposePageText = function (pageNumber) { var bp; var K = this; if (!this.eF) { throw new Error("The disposePageText method requires the viewer to be in a 'ViewerReady' state."); } if (K.bq.get_retainPageText() === true) { return this; } if (typeof (pageNumber) === 'number') { bp = pageNumber; } else { if (isNaN(+pageNumber)) { throw new Error("The parameter pageNumber is not a number."); } else { bp = parseInt(pageNumber, 10); } } if (bp < 1 || bp > this.getPageCount() || !isFinite(pageNumber)) { throw new Error("The specified page is out of range."); } var cc = K.bq.get_displayedPages(); for (var G = 0; G < cc.get_length() ; G++) { var ajy = cc.getPage(G); if (ajy.get_pageNumber() === bp - 1) { ajy.cv().acS(false); return this; } } var bI = K.cs.getPage(bp - 1); bI.ajp(); return this; }; PCCViewer.ViewerControl.prototype.isPageTextReady = function (pageNumber) { IPCC.ad.ps(pageNumber, "pageNumber", 1, this.getPageCount()); var bI; return (this.bq && this.cs && (bI = this.cs.getPage(pageNumber - 1)) && bI.cv() && bI.cv().Ar()) === true; }; PCCViewer.ViewerControl.prototype.documentHasText = function () { return this.awn; }; PCCViewer.ViewerControl.prototype.requestPageAttributes = function (pageNumber) { var bp; var aT = PCCViewer.Deferred(); var cZ = aT.getPromise(); var K = this; try { if (typeof (pageNumber) === 'number') { bp = pageNumber; } else { if (isNaN(+pageNumber)) { throw "The parameter pageNumber is not a number."; } else { bp = parseInt(pageNumber, 10); } } if (bp < 1 || bp > this.getPageCount() || !isFinite(pageNumber)) { throw "The specified page is out of range."; } this.CF.then(function (yV) { var bI = K.cs.getPage(bp - 1); if (bI.kO() > 0 || bI.iE() > 0) { aT.resolve({ 'width': bI.kO(), 'height': bI.iE() }); } else { var Bp = function (ax, cR) { aT.resolve({ 'width': ax, 'height': cR }); }; var Bh = function (errorMessage) { aT.reject(new PCCViewer.Error("RequestPageAttributesFailed", errorMessage)); }; yV.requestPageAttributes(bI, Bp, Bh); } }); } catch (e) { aT.reject(new PCCViewer.Error("Error", e)); } return cZ; }; PCCViewer.ViewerControl.prototype.destroy = function () { if (!this.Az) { if (this.bq && typeof this.bq.dispose === "function") { this.bq.dispose(); } this.am = ""; this.eD = 0; delete this.bq; this.bE = undefined; this.OV = 0; this.cs = undefined; this.agp = false; if (this.gc) { IPCC.J.Sh(this.gc); this.gc = this.aW = undefined; } this.rj = false; this.Ad = false; this.Fx = false; this.bq = undefined; this.eF = false; this.Az = true; this.trigger = function Zl() { }; this.ln = undefined; this.ln = {}; } }; PCCViewer.ViewerControl.prototype.getMarkById = function (markId) { var K = this; if (!isNaN(markId)) { markId = parseInt(markId, 10); } else { throw "The parameter, markId, contains a value that is not a number."; } if (K.dq[markId]) { return K.dq[markId]; } else { return null; } }; PCCViewer.ViewerControl.prototype.getMarksByType = function (markType) { var abe = []; if (typeof markType !== "string") { throw "The parameter, markType, is not a String."; } afX(markType); if (!this.bq) { return abe; } var G = 0; var cz = this.cs.get_length(); var K = this; function ayx(H) { var R = K.dq[H.get_markID()]; if (R && R.getType().toLowerCase() === markType.toLowerCase()) { abe.push(R); } }; for (G = 0; G < cz; G++) { var aX = this.bq.hz(this.cs.getPage(G)); if (aX) { aX.forEachMark(ayx); } } return abe; }; PCCViewer.ViewerControl.prototype.getAllMarks = function () { var Fn = []; if (!this.bq) { return Fn; } var cz = this.cs.get_length(); var K = this; var G = 0; var R; function Rj(H) { var R = K.dq[H.get_markID()]; if (typeof R !== 'undefined') { Fn.push(R); } }; for (G = 0; G < cz; G++) { var aX = this.bq.hz(this.cs.getPage(G)); if (aX) { aX.forEachMark(Rj); } } return Fn; }; function afX(markType) { var fo; switch (markType.toLowerCase()) { case "lineannotation": fo = IPCC.Web.UI.MarkType.Line; break; case "rectangleannotation": fo = IPCC.Web.UI.MarkType.Rectangle; break; case "ellipseannotation": fo = IPCC.Web.UI.MarkType.Ellipse; break; case "textannotation": fo = IPCC.Web.UI.MarkType.Text; break; case "stampannotation": fo = IPCC.Web.UI.MarkType.Stamp; break; case "highlightannotation": fo = IPCC.Web.UI.MarkType.HighlightText; break; case "texthyperlinkannotation": fo = IPCC.Web.UI.MarkType.TextHyperlinkAnnotation; break; case "freehandannotation": fo = IPCC.Web.UI.MarkType.Freehand; break; case "rectangleredaction": fo = IPCC.Web.UI.MarkType.RectangleRedaction; break; case "transparentrectangleredaction": fo = IPCC.Web.UI.MarkType.Rectangle; break; case "textredaction": fo = IPCC.Web.UI.MarkType.Text; break; case "stampredaction": fo = IPCC.Web.UI.MarkType.Stamp; break; case "freehandsignature": fo = IPCC.Web.UI.MarkType.SignaturePath; break; case "textsignature": fo = IPCC.Web.UI.MarkType.SignatureText; break; case "textinputsignature": fo = IPCC.Web.UI.MarkType.TextLine; break; case "textareasignature": fo = IPCC.Web.UI.MarkType.TextAreaSignature; break; case "textselectionredaction": fo = IPCC.Web.UI.MarkType.TextSelectionRedaction; break; case "imagestampannotation": fo = IPCC.Web.UI.MarkType.ImageStampAnnotation; break; case "imagestampredaction": fo = IPCC.Web.UI.MarkType.ImageStampRedaction; break; case "polylineannotation": fo = IPCC.Web.UI.MarkType.Polyline; break; case "strikethroughannotation": fo = IPCC.Web.UI.MarkType.Strikethrough; break; default: throw "The parameter, markType, does not specify a valid mark type."; } return fo; }; PCCViewer.ViewerControl.prototype.addMarkFromSearchResult = function (searchResult, markType) { var K = this, gT; if (K.eF === false) { throw "The method addMarkFromSearchResult is not available until 'ViewerReady' state is reached."; } if (!(searchResult instanceof PCCViewer.SearchResult)) { throw new PCCViewer.Error("InvalidArgument", "searchResult is not a valid instance of PCCViewer.SearchResult"); } if ([PCCViewer.Mark.Type.TextSelectionRedaction, PCCViewer.Mark.Type.HighlightAnnotation, PCCViewer.Mark.Type.TextHyperlinkAnnotation, PCCViewer.Mark.Type.StrikethroughAnnotation].indexOf(markType) === -1) { throw new PCCViewer.Error("InvalidArgument", "The mark type must be: 'TextSelectionRedaction', 'HighlightAnnotation', 'TextHyperlinkAnnotation' or 'StrikethroughAnnotation'."); } if (searchResult.gT.width === 0) { var KF = K.bE.dP.jb(0); gT = { width: KF.kO(), height: KF.iE() }; } else { gT = searchResult.gT; } var markInfo = [{ conversation: { comments: [], data: {} }, creationDateTime: Date.now(), data: {}, interactionMode: 'Full', lineGroups: [{ lines: searchResult.bV, pageData: gT, pageNumber: searchResult.pageNumber, startIndex: searchResult.startIndexInPage, textLength: searchResult.text.length }], modificationDateTime: Date.now(), pageNumber: searchResult.pageNumber, pageData: gT, reason: "", selectedText: searchResult.text, startIndex: searchResult.startIndexInPage, textLength: searchResult.text.length, type: markType }]; var Tm = K.deserializeMarks(markInfo); return Tm[0]; }; PCCViewer.ViewerControl.prototype.addMark = function (pageNumber, markType) { if (this.eF === false) { throw "The method addMark is not available until 'ViewerReady' state is reached."; } var bp; if (typeof (pageNumber) === 'number') { bp = pageNumber; } else { if (isNaN(+pageNumber)) { throw "The parameter, pageNumber, contains a value that is not a number."; } else { bp = parseInt(pageNumber, 10); } } if (bp < 1 || bp > this.cs.get_length() || !isFinite(bp)) { throw "The specified page is out of range."; } if (typeof markType !== "string") { throw "The parameter, markType, is not a String."; } var R = this.aks(bp, markType); return this.apT(R); }; PCCViewer.ViewerControl.prototype.aks = function (bp, bi, aH) { var K = this; aH = aH || {}; var fo = afX(bi); var H = new IPCC.Web.UI.Mark(fo); H.aD = bp - 1; var aaV = { type: bi, igMark: H, pageNumber: bp, uid: aH.uid, viewerControl: this }; if (bi.toLowerCase() === "highlightannotation" || bi.toLowerCase() === "textselectionredaction" || bi.toLowerCase() === "strikethroughannotation" || bi.toLowerCase() === "texthyperlinkannotation") { aaV.cs = K.cs; aaV.bq = K.bq; } var R = new PCCViewer.Mark(aaV); return R; }; PCCViewer.ViewerControl.prototype.apT = function (R) { var K = this; if (K.amc === true) { K.amc = false; } else { var vF = K.ld; K.ld = function (sender, eventArgs) { K.ld = vF; if (K.tu) { K.AN.addMarks(R); } setTimeout(function () { K.trigger('MarkCreated', { mark: R, pageNumber: eventArgs.pageIndex + 1, clientX: eventArgs.clientX, clientY: eventArgs.clientY }); }, 0); }; } var aX = this.bq.hz(this.cs.getPage(R.bp - 1)); aX.addMark(R.H); K.dq[R.H.get_markID()] = R; K.qX(R, R.bp - 1); return R; }; PCCViewer.ViewerControl.prototype.deleteMarks = function (marks) { var K = this; var G = 0; var R; if (!this.eF) { throw "The method deleteMarks can not be used until 'ViewerReady' state is reached."; } function KG(rY) { var aD = rY.getPageNumber() - 1; var cE = ''; var aa = ''; var JE = aD; var aX = K.bq.hz(K.cs.getPage(aD)); aX.removeMark(rY.H); if (K.dq[rY.getId()]) { cE = rY.H.cE; aa = rY.getType(); delete K.dq[rY.getId()]; } var Nr = aa.toLowerCase(); if ((Nr === 'highlightannotation' || Nr === 'textselectionredaction' || Nr === 'strikethroughannotation' || Nr === 'texthyperlinkannotation') && (rY.dF && rY.dF.length)) { for (var G = 0; G < rY.dF.length; G++) { var mN = rY.dF[G]; aX = K.bq.hz(K.cs.getPage(mN.aD)); aX.removeMark(mN); K.qX(mN, mN.aD); } } K.rk.forEach(function (gI) { if (gI.hasMark(rY.getId())) { gI.removeMarks(rY); } }); }; if (marks instanceof Array) { for (G = 0; G < marks.length; G++) { R = marks[G]; if (!(R instanceof PCCViewer.Mark)) { throw "The parameter, marks, contains an item that is not a Mark."; } if (!(K.dq[R.getId()])) { throw "The parameter, marks, contains a Mark that is not on the document."; } } for (G = 0; G < marks.length; G++) { KG(marks[G]); K.qX(marks[G], marks[G].getPageNumber() - 1); } } else { if (marks instanceof PCCViewer.Mark) { if (!(K.dq[marks.getId()])) { throw "The parameter, marks, contains a Mark that is not on the document."; } KG(marks); K.qX(marks, marks.getPageNumber() - 1); } else { throw "The parameter, marks, is not an Array of Marks or a single Mark."; } } return this; }; PCCViewer.ViewerControl.prototype.deleteAllMarks = function () { var Fn = this.getAllMarks(); if (Fn.length > 0) { return this.deleteMarks(Fn); } return this; }; PCCViewer.ViewerControl.prototype.hideMarks = function (marks) { afg(this, marks, false, 'hideMarks'); return this; }; PCCViewer.ViewerControl.prototype.showMarks = function (marks) { afg(this, marks, true, 'showMarks'); return this; }; function afg(cL, bN, zx, avA) { var G = 0; var R; if (!cL.eF) { throw new PCCViewer.Error("InvalidArgument", "The method " + avA + " can not be used until 'ViewerReady' state is reached."); } if (bN instanceof Array) { for (G = 0; G < bN.length; G++) { R = bN[G]; if (!(R instanceof PCCViewer.Mark)) { throw new PCCViewer.Error("InvalidArgument", "The parameter, marks, contains an item that is not a Mark."); } if (!(cL.dq[R.getId()])) { throw new PCCViewer.Error("InvalidArgument", "The parameter, marks, contains a Mark that is not on the document."); } } for (G = 0; G < bN.length; G++) { bN[G].setVisible(zx); } } else { if (bN instanceof PCCViewer.Mark) { if (!(cL.dq[bN.getId()])) { throw new PCCViewer.Error("InvalidArgument", "The parameter, marks, contains a Mark that is not on the document."); } bN.setVisible(zx); } else { throw new PCCViewer.Error("InvalidArgument", "The parameter, marks, is not an Array of Marks or a single Mark."); } } }; function DC(aCa, ma) { var nU = false; var cc = ma.bq.get_displayedPages(); for (var G = 0; G < cc.get_length() ; G++) { var bI = cc.getPage(G); if (bI.get_pageNumber() === aCa) { nU = true; break; } } return nU; }; PCCViewer.ViewerControl.prototype.moveMarkToFront = function (mark) { var aX; var jw; if (!this.eF) { throw "The method moveMarkToFront is not available until ViewerReady state is reached."; } if (mark instanceof PCCViewer.Mark) { jw = mark.getPageNumber(); if (mark.getPageNumber() > 0) { aX = this.bq.hz(this.cs.getPage(jw - 1)); } else { throw "The mark object has not been added to any page yet"; } } else { throw "The parameter, mark object is not a PCCViewer.Mark object"; } if (!mark.H) { throw "The parameter, mark object is probably a templateMark or has not been initialized"; } if (aX) { if (mark.H instanceof IPCC.Web.UI.Mark) { mark.H.moveToFront(); if (DC(jw - 1, this) === true) { var ma = this; setTimeout(function () { ma.bq.cn(jw - 1); }, 1); } } else { throw "The mark object has not been initialized yet"; } } return this; }; PCCViewer.ViewerControl.prototype.moveMarkToBack = function (mark) { var aX; var jw; if (!this.eF) { throw "The method moveMarkToBack is not available until ViewerReady state is reached."; } if (!(mark instanceof PCCViewer.Mark)) { throw "The parameter, mark object is not a PCCViewer.Mark object"; } jw = mark.getPageNumber(); if (jw >= 1) { aX = this.bq.hz(this.cs.getPage(mark.getPageNumber() - 1)); } else { throw "The mark object has not been added to any page yet"; } if (!mark.H) { throw "The parameter, mark may be a templateMark or has not been initialized"; } if (aX) { if (mark.H instanceof IPCC.Web.UI.Mark) { mark.H.moveToBack(); if (DC(jw - 1, this) === true) { var ma = this; setTimeout(function () { ma.bq.cn(jw - 1); }, 1); } } else { throw "The mark object has not been initialized yet"; } } return this; }; PCCViewer.ViewerControl.prototype.moveMarkForward = function (mark) { var aX, jw; if (!this.eF) { throw "The method moveMarkForward is not available until 'ViewerReady' state is reached."; } if (!(mark instanceof PCCViewer.Mark)) { throw "The parameter, mark object is not a PCCViewer.Mark object"; } jw = mark.getPageNumber(); if (jw >= 1) { aX = this.bq.hz(this.cs.getPage(mark.getPageNumber() - 1)); } else { throw "The mark object has not been added to any page yet"; } if (!mark.H) { throw "The parameter, mark object is probably a templateMark or has not been initialized"; } if (aX) { if (mark.H instanceof IPCC.Web.UI.Mark) { mark.H.moveForward(); if (DC(jw - 1, this) === true) { var ma = this; setTimeout(function () { ma.bq.cn(jw - 1); }, 1); } } else { throw "The mark object has not been initialized yet"; } } return this; }; PCCViewer.ViewerControl.prototype.moveMarkBackward = function (mark) { var aX, jw; if (!this.eF) { throw "The method moveMarkBackward is not available until ViewerReady state is reached."; } if (!(mark instanceof PCCViewer.Mark)) { throw "The parameter, mark object is not a PCCViewer.Mark object"; } jw = mark.getPageNumber(); if (jw >= 1) { aX = this.bq.hz(this.cs.getPage(mark.getPageNumber() - 1)); } else { throw "The mark object has not been added to any page yet"; } if (!mark.H) { throw "The parameter, mark object is probably a templateMark or has not been initialized"; } if (aX) { if (mark.H instanceof IPCC.Web.UI.Mark) { mark.H.moveBackward(); if (DC(jw - 1, this) === true) { var ma = this; setTimeout(function () { ma.bq.cn(jw - 1); }, 1); } } else { throw "The mark object has not been initialized yet"; } } return this; }; PCCViewer.ViewerControl.prototype.getSelectedMarks = function () { var bN = []; var acc = []; if (this.eF === false) { return bN; } var cz = this.cs.get_length(), aX, hy; var K = this; function atm(Tx) { if (Tx) { var SK = Tx.get_type(); if (SK === IPCC.Web.UI.MarkType.HighlightText || SK === IPCC.Web.UI.MarkType.TextSelectionRedaction || SK === IPCC.Web.UI.MarkType.Strikethrough || SK === IPCC.Web.UI.MarkType.TextHyperlinkAnnotation) { for (var ic in K.dq) { if (K.dq.hasOwnProperty(ic)) { hy = K.dq[ic]; if (Tx.cE === hy.H.cE) { for (var G = 0; G < acc.length; G++) { if (hy.H.cE === acc[G]) { return; } } acc.push(hy.H.cE); break; } } } } else { hy = K.dq[Tx.get_markID()]; } if (hy && hy instanceof PCCViewer.Mark) { bN.push(hy); } else { return bN; } } }; for (var G = 0; G < cz; G++) { aX = this.bq.hz(this.cs.getPage(G)); if (aX) { aX.get_selectedMarks().forEach(atm, {}); } } return bN; }; function akc(bN, asE, ma) { var hy, G; function Vb(eo) { var nU = false; var cc = ma.bq.get_displayedPages(); for (var G = 0; G < cc.get_length() ; G++) { var bI = cc.getPage(G); if (bI.get_pageNumber() === eo) { nU = true; break; } } return nU; }; if (!bN.length) { return; } for (G = 0; G < bN.length; G++) { if (bN[G] instanceof PCCViewer.Mark) { hy = ma.dq[parseInt(bN[G].getId(), 10)]; if (hy && hy instanceof PCCViewer.Mark) { if (hy.H && hy.H instanceof IPCC.Web.UI.Mark) { if (hy.getId() !== hy.H.get_markID().toString()) { throw "The mark ID does not match the ID of the mark loaded in the viewer"; } } else { throw "The mark provided may not have been added to the document pages in the viewer"; } } else { throw "The parameter, marks, contains a Mark that is not on the document."; } } else { throw "The mark provided in the position : " + (G + 1) + " is invalid"; } } var qM = []; var wF = false; for (G = 0; G < bN.length; G++) { hy = ma.dq[parseInt(bN[G].getId(), 10)]; wF = false; if (hy) { if (hy.getId() === hy.H.get_markID().toString()) { hy.H.set_selected(asE); if (Array.prototype.IndexOf) { wF = (qM.IndexOf(hy.getPageNumber()) >= 0); } else { wF = (IPCC.Web.hK(qM, hy.getPageNumber()) >= 0); } } if (!wF) { var cO = hy.getPageNumber(); if (Vb(cO - 1)) { qM.push(cO); } } } } if (qM.length > 0) { setTimeout(function () { for (G = 0; G < qM.length; G++) { ma.bq.cn(qM[G] - 1); } }, 1); } }; PCCViewer.ViewerControl.prototype.selectMarks = function (marks) { if (this.eF === false) { throw "The method selectMarks is not available until 'ViewerReady' state is reached."; } var bN = []; if (marks === undefined) { return this; } if (marks && !(marks instanceof Array)) { if (marks instanceof PCCViewer.Mark) { bN.push(marks); } } else { bN = marks; } if (bN.length === 0) { return this; } akc(bN, true, this); return this; }; PCCViewer.ViewerControl.prototype.deselectMarks = function (marks) { if (this.eF === false) { throw "The method deselectMarks is not available until 'ViewerReady' state is reached."; } var bN = []; if (marks === undefined) { return this; } if (marks && !(marks instanceof Array)) { if (marks instanceof PCCViewer.Mark) { bN.push(marks); } } else { bN = marks; } if (bN.length === 0) { return this; } akc(bN, false, this); return this; }; PCCViewer.ViewerControl.prototype.deselectAllMarks = function () { var qM = []; var bN = this.getSelectedMarks(); var wF = false, G, hy; for (G = 0; G < bN.length; G++) { hy = this.dq[parseInt(bN[G].getId(), 10)]; wF = false; if (hy) { if (hy.getId() === hy.H.get_markID().toString()) { hy.H.set_selected(false); if (Array.prototype.IndexOf) { wF = (qM.IndexOf(hy.getPageNumber()) >= 0); } else { wF = (IPCC.Web.hK(qM, hy.getPageNumber()) >= 0); } } if (!wF) { var cO = hy.getPageNumber(); if (DC(cO - 1, this) === true) { qM.push(cO); } } } } if (qM.length > 0) { var ma = this; setTimeout(function () { for (G = 0; G < qM.length; G++) { ma.bq.cn(qM[G] - 1); } }, 1); } return this; }; PCCViewer.ViewerControl.prototype.copyMarks = function (marks) { var cL = this, Tm; if (marks instanceof PCCViewer.Mark) { marks = [marks]; } if (marks instanceof Array === false) { throw new PCCViewer.Error("InvalidArgument", "The parameter, marks, is not an Array of Marks or a single Mark."); } var bN = []; IPCC.J.forEach(marks, function (R) { if (R instanceof PCCViewer.Mark) { if (cL.dq[R.getId()] === undefined) { throw new PCCViewer.Error("InvalidArgument", "The parameter, marks, contains a Mark that is not on the document."); } bN.push(R); } else { throw new PCCViewer.Error("InvalidArgument", "The parameter, marks, contains an item that is not a Mark."); } }); var uu = []; IPCC.J.forEach(bN, function (R, ak) { PCCViewer.fG[R.getType()]({ mark: R }, function (bX, dc) { dc.uid = undefined; uu[ak] = dc; }); }); this.tu = false; Tm = cL.deserializeMarks(uu); this.tu = true; return Tm; }; PCCViewer.ViewerControl.prototype.enterTextMarkEditingMode = function (R) { var cL = this, bq = this.bq; var aoT = function (auo) { var Qe = false, cc = bq.get_displayedPages(); for (var G = 0; G < cc.get_length() ; G++) { var bI = cc.getPage(G); if (bI.get_pageNumber() === auo) { Qe = true; } bq.sm(bI.get_pageNumber()); } return Qe; }; if (typeof R === "undefined" || R === null) { aoT(-1); } else { if (this.eF === false) { throw PCCViewer.Error("ViewerNotReady", "The method selectMarks is not available until 'ViewerReady' state is reached."); } if (!(R instanceof PCCViewer.Mark)) { throw new PCCViewer.Error("InvalidArgument", "The argument 'mark' must be an instance of PCCViewer.Mark."); } var afx = this.dq[parseInt(R.getId(), 10)]; if (!(afx && afx instanceof PCCViewer.Mark)) { throw new PCCViewer.Error("InvalidArgument", "The provided mark is not on the document."); } if (!(R.H && R.H instanceof IPCC.Web.UI.Mark)) { throw new PCCViewer.Error("InvalidArgument", "The provided mark may not have been added to the document pages in the viewer"); } if (R.getId() !== R.H.get_markID().toString()) { throw new PCCViewer.Error("InvalidArgument", "The mark ID does not match the ID of the mark loaded in the viewer"); } var bi = R.getType(); if (bi !== PCCViewer.Mark.Type.TextAnnotation && bi !== PCCViewer.Mark.Type.TextRedaction && bi !== PCCViewer.Mark.Type.TextInputSignature && bi !== PCCViewer.Mark.Type.TextAreaSignature) { throw new PCCViewer.Error("InvalidArgument", "The mark type must be: 'TextAnnotation', 'TextRedaction', 'TextInputSignature', or 'TextAreaSignature'."); } var Qe = aoT(R.getPageNumber() - 1); if (Qe) { cL.bq.xh(R.getPageNumber() - 1, R.H); } } return this; }; PCCViewer.ViewerControl.prototype.getCharacterIndex = function (sortableObject) { if (this.eF === false) { throw new Error("The getCharacterIndex method can not be used until 'ViewerReady' state is reached."); } var Lo = -1; var cS; var ai; var bp = 0; if (sortableObject instanceof PCCViewer.Mark) { if (sortableObject.getStartPoint) { cS = sortableObject.getStartPoint(); } else { ai = (sortableObject.H) ? sortableObject.H.get_boundingRectangle() : sortableObject.getRectangle(); cS = { x: ai.x, y: ai.y }; } bp = sortableObject.getPageNumber(); } else if (sortableObject instanceof PCCViewer.SearchResult) { return sortableObject.startIndexInPage; } else if (sortableObject !== undefined && sortableObject !== null) { if (typeof sortableObject.x === 'number' && typeof sortableObject.y === 'number') { cS = { x: +sortableObject.x, y: +sortableObject.y }; } else { if (isNaN(+sortableObject.x) || isNaN(+sortableObject.y)) { throw new Error('The parameter sortableObject does not contain valid x and y values.'); } else { cS = { x: Number(+sortableObject.x), y: Number(+sortableObject.y) }; } } if (typeof sortableObject.pageNumber === 'number') { bp = +sortableObject.pageNumber; } else { if (isNaN(+sortableObject.pageNumber)) { throw new Error('The parameter sortableObject does not contain a valid pageNumber value.'); } else { bp = Number(+sortableObject.pageNumber); } } } else { throw new Error('The sortableObject parameter must be a Mark, SearchResult, or Point.'); } if (bp < 1 || bp > this.getPageCount() || !isFinite(bp)) { throw new RangeError("The parameter pageNumber is out of range."); } if (!this.isPageTextReady(bp)) { return -2; } var bI = this.cs.getPage(bp - 1); var wN = bI.cv().adw(); var gP = bI.cv().gl(); function alA(bbox, point) { if (point.x > bbox.x && point.x < bbox.x + bbox.width && point.y > bbox.y && point.y < bbox.y + bbox.height) { return true; } return false; }; function aeu(dH, fC) { var aY = Math.max(Math.min(fC.x, dH.x + dH.width), dH.x); var fJ = Math.max(Math.min(fC.y, dH.y + dH.height), dH.y); return (fC.x - aY) * (fC.x - aY) + (fC.y - fJ) * (fC.y - fJ); }; var DI; var Rv = Number.MAX_VALUE; for (var G = 0; G < wN.fb() ; G++) { var iM = wN.azV(G); if (alA(iM.fD(), cS)) { for (var aj = iM.acQ() ; aj < iM.ahR() ; aj++) { var VR = gP.jN(aj); var xd = VR.wz(); if (alA(xd, cS)) { return aj; } DI = aeu(xd, cS); if (DI < Rv) { Lo = aj; Rv = DI; } } return Lo; } DI = aeu(iM.fD(), cS); if (DI < Rv) { if (iM.fD().y > cS.y) { Lo = iM.acQ() - 1; } else { Lo = iM.ahR(); } Rv = DI; } } return Lo; }; PCCViewer.ViewerControl.prototype.getCurrentMouseTool = function () { return this.bW.getName(); }; PCCViewer.ViewerControl.prototype.setCurrentMouseTool = function (name) { var K = this; if (this.eF === false) { throw "The method setCurrentMouseTool is not available until 'ViewerReady' state is reached."; } var Bz = name.toLowerCase(); var bW = PCCViewer.MouseTools.getMouseTool(Bz); if (!bW) { throw new Error("The name argument for setCurrentMouseTool(name) must be the name of a known mouse tool."); } var ih, gg; switch (bW.getType()) { case PCCViewer.MouseTool.Type.Magnifier: ih = IPCC.Web.UI.MouseTool.Magnifier; break; case PCCViewer.MouseTool.Type.SelectToZoom: ih = IPCC.Web.UI.MouseTool.RectangleZoom; break; case PCCViewer.MouseTool.Type.PanAndEdit: case PCCViewer.MouseTool.Type.Pan: ih = IPCC.Web.UI.MouseTool.HandPan; break; case PCCViewer.MouseTool.Type.SelectText: ih = IPCC.Web.UI.MouseTool.SelectText; break; case PCCViewer.MouseTool.Type.EditMarks: ih = IPCC.Web.UI.MouseTool.EditMarks; break; case PCCViewer.MouseTool.Type.LineAnnotation: ih = IPCC.Web.UI.MouseTool.CreateLineMark; gg = atz(bW.getTemplateMark()); break; case PCCViewer.MouseTool.Type.RectangleAnnotation: ih = IPCC.Web.UI.MouseTool.CreateRectangleMark; gg = aht(bW.getTemplateMark()); break; case PCCViewer.MouseTool.Type.RectangleRedaction: ih = IPCC.Web.UI.MouseTool.CreateRectangleRedactionMark; gg = aAU(bW.getTemplateMark()); break; case PCCViewer.MouseTool.Type.TransparentRectangleRedaction: ih = IPCC.Web.UI.MouseTool.CreateRectangleMark; gg = aBc(bW.getTemplateMark()); break; case PCCViewer.MouseTool.Type.EllipseAnnotation: ih = IPCC.Web.UI.MouseTool.CreateEllipseMark; gg = aht(bW.getTemplateMark()); break; case PCCViewer.MouseTool.Type.TextAnnotation: ih = IPCC.Web.UI.MouseTool.CreateTextMark; gg = aBT(bW.getTemplateMark()); break; case PCCViewer.MouseTool.Type.TextRedaction: ih = IPCC.Web.UI.MouseTool.CreateTextMark; gg = XD(bW.getTemplateMark()); break; case PCCViewer.MouseTool.Type.TextInputSignature: ih = IPCC.Web.UI.MouseTool.CreateTextInputSignatureMark; gg = XD(bW.getTemplateMark()); break; case PCCViewer.MouseTool.Type.TextAreaSignature: ih = IPCC.Web.UI.MouseTool.CreateTextAreaSignatureMark; gg = XD(bW.getTemplateMark()); break; case PCCViewer.MouseTool.Type.StampAnnotation: case PCCViewer.MouseTool.Type.StampRedaction: ih = IPCC.Web.UI.MouseTool.CreateStampMark; gg = aBf(bW.getTemplateMark()); break; case PCCViewer.MouseTool.Type.HighlightAnnotation: ih = IPCC.Web.UI.MouseTool.CreateHighlightTextMark; gg = Uf(bW.getTemplateMark()); break; case PCCViewer.MouseTool.Type.TextHyperlinkAnnotation: ih = IPCC.Web.UI.MouseTool.CreateTextHyperlinkMark; gg = Uf(bW.getTemplateMark()); break; case PCCViewer.MouseTool.Type.FreehandAnnotation: ih = IPCC.Web.UI.MouseTool.CreateFreehandMark; gg = avZ(bW.getTemplateMark()); break; case PCCViewer.MouseTool.Type.TextSelectionRedaction: ih = IPCC.Web.UI.MouseTool.CreateTextSelectionRedaction; gg = Uf(bW.getTemplateMark()); break; case PCCViewer.MouseTool.Type.PlaceSignature: var aES = this.aH.resourcePath + '/placeSignatureCursor.cur'; this.bq.set_mouseTool(IPCC.Web.UI.MouseTool.None); this.bq.set_allowMarkEdits(false); this.bq.set_mouseCursor('url(' + aES + '), pointer'); this.bW = bW; return this; case PCCViewer.MouseTool.Type.ImageStampAnnotation: ih = IPCC.Web.UI.MouseTool.CreateImageStampAnnotationMark; gg = akO(bW.getTemplateMark()); break; case PCCViewer.MouseTool.Type.ImageStampRedaction: ih = IPCC.Web.UI.MouseTool.CreateImageStampRedactionMark; gg = akO(bW.getTemplateMark()); break; case PCCViewer.MouseTool.Type.PolylineAnnotation: ih = IPCC.Web.UI.MouseTool.CreatePolylineMark; gg = aze(bW.getTemplateMark()); break; case PCCViewer.MouseTool.Type.StrikethroughAnnotation: ih = IPCC.Web.UI.MouseTool.CreateStrikethroughMark; gg = Uf(bW.getTemplateMark()); break; default: throw new Error("An unexpected error occurred. The MouseTool type is not known."); } var awM = this.bq.get_mouseTool(); if (this.bW !== bW && awM === ih) { setTimeout(function () { K.trigger(PCCViewer.EventType.MouseToolChanged, { mouseToolName: K.bW.getName() }); }, 0); } this.bW = bW; if (gg) { this.Mn = gg.onCreating; this.ld = gg.onAdded; } else { this.Mn = undefined; this.ld = undefined; } this.bq.set_mouseTool(ih); this.bq.set_allowMarkEdits((bW.getType() === PCCViewer.MouseTool.Type.PanAndEdit)); return this; }; function YK(cL, UO, nD) { if (cL.Ad !== true) { var Hx = function () { cL.off('PageCountReady', Hx); YK(cL, UO, nD); }; cL.on('PageCountReady', Hx); return; } var aO = cL; var AP; var jL = {}, vC = {}, tk = []; var hn = aO.eD; var lL; var aH; if (UO) { aH = UO; } var apw = []; var Yy = aO.bE.get_pages(); var aGf = function (bI, done) { var aKj = false; var jb = bI; var bp = bI.get_pageNumber(); var di = jb.get_pageWidth(); var cB = jb.get_pageHeight(); try { if (jb) { var hz = aO.bq.hz(jb), GB = 0, GJ = 0, fr = "", aJB = false; var getArt = function getArt() { var Nl; if (aH && aH.Dh && aH.Dh[bp]) { Nl = IPCC.J.extend({}, aH); Nl.Dh = aH.Dh[bp]; } else { Nl = aH; } var aj, YR; var Ko = hz.azJ(bp, GB, GJ, Nl); if (Ko.jL) { jL[bp] = Ko.jL; } else { var ayw = aGC(bp, lL, GJ, GB); jL[bp] = ayw; } if (Ko.tk) { for (aj = 0; aj < Ko.tk.length; aj++) { YR = Ko.tk[aj]; vC[YR.bu.imageStampId] = YR; } } done(); }; if (hz) { if (!di || !cB) { if (hz.get_markCount() > 0) { aO.bq.SA(bI, function (ax, cR) { GB = ax; if (GB) { jb.FX(GB); } GJ = cR; if (GJ) { jb.FM(GJ); } getArt(); }, function (pD) { done(pD); }); } else { getArt(); } } else { GB = di; GJ = cB; getArt(); } } else { done(new Error("No art page was found")); } } } catch (ex) { done(new Error("Error while saving annotation, error:" + ex.message)); } }; Yy.forEach(function (bI, dJ, kl) { apw.push(function (done) { aGf(bI, done); }); }); var XP = function (bk, bI) { var Al = ""; var G; if (!bk.fZ) { if (bk.toString()) { return bk.toString(); } else { return '<![CDATA[]]>'; } } if ((hn === 1 || bI === 0 || (bI > 0 && bk.fZ !== "documentAnnotations" && bk.fZ !== "pages")) && bk.fZ !== "highlights") { Al = '<' + bk.fZ; for (var CQ in bk.bu) { if (bk.bu.hasOwnProperty(CQ)) { var aaa = bk.bu[CQ]; if (aaa === undefined || aaa === null) { continue; } var bu = aaa.toString(); bu = bu.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;'); Al = Al + ' ' + CQ + '="' + bu + '"'; } } Al += '>'; } for (G = 0; G < bk.dO.length; G++) { Al += XP(bk.dO[G], bI); } if (hn === 1 || (bI === hn - 1) || (bI !== hn - 1 && bk.fZ !== "documentAnnotations" && bk.fZ !== "pages" && bk.fZ !== "highlights")) { if (bk.fZ !== "highlights") { Al += '</' + bk.fZ + '>'; } else { Al += '<' + bk.fZ + ' />'; } } return Al; }; IPCC.J.YY(apw, function (bX) { if (bX) { nD(bX); return; } AP = '<?xml version="1.0"?>'; for (var G = 0; G < (aO.eD) ; G++) { AP = AP + XP(jL[G], G); } var stampImageXml = ''; for (var Hh in vC) { if (vC.hasOwnProperty(Hh)) { stampImageXml += XP(vC[Hh], 1); } } if (stampImageXml.length) { var stampImagesXml = '<stampImages>' + stampImageXml + '</stampImages></documentAnnotations>'; AP = AP.replace('</documentAnnotations>', stampImagesXml); } nD(undefined, AP); }); }; PCCViewer.ViewerControl.prototype.saveMarkup = function (recordName, options) { var aT = PCCViewer.Deferred(); var cZ = aT.getPromise(); var aH; if (options) { aH = options; } else { aH = { includeAnnotations: true, includeRedactions: true, includeSignatures: false }; } try { if (typeof recordName !== "string") { aT.reject(new PCCViewer.Error("InvalidArgument", "The parameter, recordName, is not a String.")); return cZ; } if (!auB(recordName)) { aT.reject(new PCCViewer.Error("InvalidCharactersFilename", 'Invalid characters in the annotations filename.')); return cZ; } var aO = this; this.CF.then(function (yV) { var BO = recordName; YK(aO, aH, function (err, AP) { if (err) { aT.reject(new PCCViewer.Error("Error", err)); return cZ; } var Qq = IPCC.gB.sv(BO); var am; if (!(/^[\x00-\x7F]*$/.test(aO.bE.get_documentIdentifier()))) { am = aO.aH.imageHandlerUrl + '/Document/q/Art/q?DocumentID=e' + aO.aH.documentID + '&AnnotationID=e' + Qq; } else { am = aO.aH.imageHandlerUrl + '/Document/q/Art/q?DocumentID=u' + encodeURIComponent(aO.aH.documentID) + '&AnnotationID=u' + encodeURIComponent(BO); } function fa(bF) { aT.resolve(BO); setTimeout(function () { aO.trigger('MarkupSaved', { name: BO }); }, 0); }; function eZ(bM) { aT.reject(new PCCViewer.Error("AjaxError", "Status Code " + bM.response.status + " " + bM.response.statusText)); }; PCCViewer.Ajax.dZ({ method: 'POST', url: am, headers: { 'Content-Type': 'application/xml' }, body: AP }).then(fa, eZ); }); }); } catch (e) { aT.reject(new PCCViewer.Error("Error", e.message)); } return cZ; }; var auB = function (recordName) { return !/[\\\/:*?"<>|\x00-\x1f]/.test(recordName); }; var Vg = function (jQ) { var aY = jQ.firstChild; while (aY.nodeType !== 1) { aY = aY.nextSibling; } return aY; }; var aGC = function (cO, lL, cB, di) { var jL = { fZ: 'documentAnnotations', dO: [], bu: {} }; var aoQ = { fZ: 'pages', dO: [], bu: {} }; jL.dO.push(aoQ); var mO = { fZ: 'highlights', dO: [], bu: {} }; var bI = { fZ: 'page', dO: [], bu: { id: (cO + 1).toString(), pageWidth: di, pageHeight: cB } }; jL.dO.push(mO); try { if (lL) { var aY = lL.getElementsByTagName("documentAnnotations"); if (aY.length > 1) { throw 'ERROR: Invalid PCC annotations XML'; } var TX; var Eo; if (document.documentMode < 9) { var UC = lL.firstChild.nodeName; if (UC.toLowerCase() === 'xml') { TX = lL.firstChild.nextSibling; } else { TX = lL.firstChild; } } else { TX = lL.firstChild; } var dP = Vg(TX); if (dP.nodeName !== 'pages') { throw 'ERROR: Problem with pages node in the PCC annotations XML'; } if (dP.hasChildNodes()) { var G; var nm = false; for (G = 0; G < dP.childNodes.length; G++) { Eo = dP.childNodes[G]; if (Eo.nodeName !== 'page') { continue; } var Dy = Eo.getAttribute('id'); nm = false; if (Dy && parseFloat(Dy) === cO + 1) { nm = true; for (var aj = 0; aj < Eo.childNodes.length; aj++) { var aF = Eo.childNodes[aj]; var aN = { fZ: 'annotation', dO: [], bu: {} }; if (aF.nodeName !== 'annotation') { continue; } var Pm = Eo.childNodes[aj].attributes; if (Pm.length > 0) { for (var dh = 0; dh < Pm.length; dh++) { aN.bu[Pm[dh].name] = Pm[dh].value; } } if (aF.childNodes[0].data) { aN.dO.push('<![CDATA[' + aF.childNodes[0].data + ']]>'); } else { aN.dO.push(''); } bI.dO.push(aN); } break; } } } } aoQ.dO.push(bI); return jL; } catch (e) { throw (e.message); } }; PCCViewer.ViewerControl.prototype.loadMarkup = function (recordName, options) { var Ld = recordName; var aT = PCCViewer.Deferred(), cZ = aT.getPromise(), aO = this; var aH = options || {}; var yS = aH.retainExistingMarks; var iR = aH.markupLayer; var wD = aH.loadAsHidden; this.CF.then(function (yV) { var am, Qq, bq = aO.bq, cs = aO.cs; if (typeof Ld !== "string") { aT.reject(new PCCViewer.Error("InvalidArgument", "The parameter, recordName, is not a String.")); } if (yS !== undefined) { if (typeof yS !== 'boolean') { aT.reject(new PCCViewer.Error('InvalidArgument', 'The parameter `retainExistingMarks` must be a boolean value if it is specified.')); } } if (iR !== undefined) { if (!(iR instanceof PCCViewer.MarkupLayer)) { aT.reject(new PCCViewer.Error('InvalidArgument', 'The parameter `markupLayer` must be an instance of PCCViewer.MarkupLayer if it is specified.')); } if (aO.rk.getItem(iR.getId()) === undefined) { aT.reject(new PCCViewer.Error('InvalidArgument', 'The parameter `markupLayer` is a markup layer unknown to the viewer.')); } } function fa(bF) { var abL, Pp = bF.responseText, Nu; if (Pp.indexOf('xml') === -1) { aT.reject(new PCCViewer.Error("InvalidAnnotationRecord", "Did not receive valid annotation record from web server.")); return; } Pp = Pp.replace(/(comment\s+text=")((?:.|[\r\n])*?)("\s+created=")/g, function (match, p1, p2, p3) { return p1 + IPCC.J.rm(p2) + p3; }); if (window.DOMParser) { Nu = function (xmlStr) { return (new window.DOMParser()).parseFromString(xmlStr, "text/xml"); }; } else if (typeof window.ActiveXObject !== "undefined" && new window.ActiveXObject("Microsoft.XMLDOM")) { Nu = function (xmlStr) { var xmlDoc = new window.ActiveXObject("Microsoft.XMLDOM"); xmlDoc.async = "false"; xmlDoc.loadXML(xmlStr); return xmlDoc; }; } else { Nu = function () { return null; }; } abL = Nu(Pp); var apd = abL.getElementsByTagName('stampImage'); var tk = {}; var abk = function (ak) { R.ag.push(aeQ.getPoint(ak)); }; for (var G = 0; G < apd.length; G++) { var Uv = apd[G]; tk[Uv.getAttribute('imageStampId')] = { imageStampId: Uv.getAttribute('imageStampId'), base64format: Uv.getAttribute('base64format') }; } bq.set_annotationXmlDom(abL, tk, yS === true, wD === true); if (yS !== true) { aO.dq = {}; } var cz = aO.cs.get_length(); var R; var bi, fo; var xU = {}; var Mc = []; for (G = 0; G < cz; G++) { var aX = aO.bq.hz(aO.cs.getPage(G)); if (aX) { var Fo = {}; var aj = 0; for (aj = 0; aj < aX.get_markCount() ; aj++) { var H = aX.getMark(aj); if (aO.dq[H.get_markID()] !== undefined) { continue; } fo = H.get_type(); switch (fo) { case IPCC.Web.UI.MarkType.Rectangle: if (H.lh() === true) { if (H.get_opacity() === 255) { bi = PCCViewer.Mark.Type.RectangleRedaction; } else { bi = PCCViewer.Mark.Type.TransparentRectangleRedaction; } R = new PCCViewer.Mark({ type: bi, igMark: H, pageNumber: G + 1, uid: H.bu.kf }); } else { bi = PCCViewer.Mark.Type.RectangleAnnotation; R = new PCCViewer.Mark({ type: bi, igMark: H, pageNumber: G + 1, uid: H.bu.kf }); R.ov = H.get_lineWidth(); R.cK = H.get_fillColor(); R.pw = H.get_lineColor(); R.dI = H.get_opacity(); } break; case IPCC.Web.UI.MarkType.Ellipse: bi = PCCViewer.Mark.Type.EllipseAnnotation; R = new PCCViewer.Mark({ type: bi, igMark: H, pageNumber: G + 1, uid: H.bu.kf }); R.ov = H.get_lineWidth(); R.cK = H.get_fillColor(); R.pw = H.get_lineColor(); R.dI = H.get_opacity(); break; case IPCC.Web.UI.MarkType.Line: bi = PCCViewer.Mark.Type.LineAnnotation; R = new PCCViewer.Mark({ type: bi, igMark: H, pageNumber: G + 1, uid: H.bu.kf }); R.qD = H.get_lineWidth(); R.dU = H.get_lineColor(); R.dI = H.get_opacity(); if (H.get_endHeadType() === IPCC.Web.UI.LineHeadType.Solid) { R.mW = "FilledTriangle"; } else { R.mW = "None"; } break; case IPCC.Web.UI.MarkType.Stamp: if (H.lh() === true) { bi = PCCViewer.Mark.Type.StampRedaction; R = new PCCViewer.Mark({ type: bi, igMark: H, pageNumber: G + 1, uid: H.bu.kf }); } else { bi = PCCViewer.Mark.Type.StampAnnotation; R = new PCCViewer.Mark({ type: bi, igMark: H, pageNumber: G + 1, uid: H.bu.kf }); R.dU = H.get_fillColor(); } R.wU = H.get_text(); break; case IPCC.Web.UI.MarkType.Text: if (H.lh() === true) { bi = PCCViewer.Mark.Type.TextRedaction; R = new PCCViewer.Mark({ type: bi, igMark: H, pageNumber: G + 1, uid: H.bu.kf }); } else { bi = PCCViewer.Mark.Type.TextAnnotation; R = new PCCViewer.Mark({ type: bi, igMark: H, pageNumber: G + 1, uid: H.bu.kf }); R.ov = H.get_lineWidth(); R.cK = H.get_fillColor(); R.pw = H.get_lineColor(); R.dI = H.get_opacity(); } R.gU = H.get_maxLength(); R.gZ = H.get_fontName(); R.iF = H.get_textColor(); R.cd = H.get_fontSize(); var de = H.get_fontStyle(); var ub = []; if ((de & IPCC.Web.UI.FontStyle.Bold) === IPCC.Web.UI.FontStyle.Bold) { ub.push("Bold"); } if ((de & IPCC.Web.UI.FontStyle.Italic) === IPCC.Web.UI.FontStyle.Italic) { ub.push("Italic"); } if ((de & IPCC.Web.UI.FontStyle.Strikeout) === IPCC.Web.UI.FontStyle.Strikeout) { ub.push("Strikeout"); } if ((de & IPCC.Web.UI.FontStyle.Underline) === IPCC.Web.UI.FontStyle.Underline) { ub.push("Underline"); } R.de = ub; var sI; switch (H.get_textHorizontalAlignment()) { case IPCC.Web.UI.HorizontalAlignment.Center: sI = "center"; break; case IPCC.Web.UI.HorizontalAlignment.Left: sI = "left"; break; case IPCC.Web.UI.HorizontalAlignment.Right: sI = "right"; break; } R.pa = sI; break; case IPCC.Web.UI.MarkType.TextAreaSignature: bi = PCCViewer.Mark.Type.TextAreaSignature; R = new PCCViewer.Mark({ type: bi, igMark: H, pageNumber: G + 1, uid: H.bu.kf }); R.ov = H.get_lineWidth(); R.gU = H.get_maxLength(); R.gZ = H.get_fontName(); R.iF = H.get_textColor(); R.jA = H.get_maxFontSize(); de = H.get_fontStyle(); ub = []; if ((de & IPCC.Web.UI.FontStyle.Bold) === IPCC.Web.UI.FontStyle.Bold) { ub.push("Bold"); } if ((de & IPCC.Web.UI.FontStyle.Italic) === IPCC.Web.UI.FontStyle.Italic) { ub.push("Italic"); } if ((de & IPCC.Web.UI.FontStyle.Strikeout) === IPCC.Web.UI.FontStyle.Strikeout) { ub.push("Strikeout"); } if ((de & IPCC.Web.UI.FontStyle.Underline) === IPCC.Web.UI.FontStyle.Underline) { ub.push("Underline"); } R.de = ub; switch (H.get_textHorizontalAlignment()) { case IPCC.Web.UI.HorizontalAlignment.Center: sI = "center"; break; case IPCC.Web.UI.HorizontalAlignment.Left: sI = "left"; break; case IPCC.Web.UI.HorizontalAlignment.Right: sI = "right"; break; } R.pa = sI; break; case IPCC.Web.UI.MarkType.HighlightText: case IPCC.Web.UI.MarkType.TextHyperlinkAnnotation: case IPCC.Web.UI.MarkType.TextSelectionRedaction: case IPCC.Web.UI.MarkType.Strikethrough: bi = (fo === IPCC.Web.UI.MarkType.HighlightText) ? PCCViewer.Mark.Type.HighlightAnnotation : (fo === IPCC.Web.UI.MarkType.TextHyperlinkAnnotation) ? PCCViewer.Mark.Type.TextHyperlinkAnnotation : (fo === IPCC.Web.UI.MarkType.Strikethrough) ? PCCViewer.Mark.Type.StrikethroughAnnotation : PCCViewer.Mark.Type.TextSelectionRedaction; var adi = H.cE; if (typeof xU[adi] === 'undefined') { R = new PCCViewer.Mark({ type: bi, igMark: H, pageNumber: G + 1, cs: cs, bq: bq, uid: H.bu.kf }); R.dF = []; if (bi === PCCViewer.Mark.Type.HighlightAnnotation) { R.cK = H.get_fillColor(); } xU[adi] = R; H.aD = G; H.kr = true; } else { H.aD = G; xU[adi].dF.push(H); } break; case IPCC.Web.UI.MarkType.Freehand: bi = PCCViewer.Mark.Type.FreehandAnnotation; R = new PCCViewer.Mark({ type: bi, igMark: H, pageNumber: G + 1, uid: H.bu.kf }); R.qD = H.get_lineWidth(); R.dU = H.get_lineColor(); R.dI = H.get_opacity(); break; case IPCC.Web.UI.MarkType.SignaturePath: bi = PCCViewer.Mark.Type.FreehandSignature; R = new PCCViewer.Mark({ type: bi, igMark: H, pageNumber: G + 1, uid: H.bu.kf }); R.qD = H.get_lineWidth(); R.dU = H.get_lineColor(); break; case IPCC.Web.UI.MarkType.SignatureText: bi = PCCViewer.Mark.Type.TextSignature; R = new PCCViewer.Mark({ type: bi, igMark: H, pageNumber: G + 1, uid: H.bu.kf }); R.gZ = H.get_fontName(); R.dU = H.get_fillColor(); R.az = H.get_text(); break; case IPCC.Web.UI.MarkType.TextLine: bi = PCCViewer.Mark.Type.TextInputSignature; R = new PCCViewer.Mark({ type: bi, igMark: H, pageNumber: G + 1, uid: H.bu.kf }); R.gZ = H.get_fontName(); R.iF = H.get_textColor(); R.az = H.get_text(); R.gU = H.get_maxLength(); R.iJ = H.get_mask(); break; case IPCC.Web.UI.MarkType.RectangleRedaction: if (!H.cE) { bi = PCCViewer.Mark.Type.RectangleRedaction; R = new PCCViewer.Mark({ type: bi, igMark: H, pageNumber: G + 1, cs: cs, bq: bq, uid: H.bu.kf }); R.ov = H.get_lineWidth(); R.cK = H.get_fillColor(); R.pw = H.get_lineColor(); R.dI = H.get_opacity(); } else { if (Fo[H.cE] === undefined) { Fo[H.cE] = []; } Fo[H.cE].push(H); } break; case IPCC.Web.UI.MarkType.ImageStampAnnotation: case IPCC.Web.UI.MarkType.ImageStampRedaction: bi = (fo === IPCC.Web.UI.MarkType.ImageStampAnnotation) ? PCCViewer.Mark.Type.ImageStampAnnotation : PCCViewer.Mark.Type.ImageStampRedaction; R = new PCCViewer.Mark({ type: bi, igMark: H, pageNumber: G + 1, uid: H.bu.kf }); R.setImage({ dataUrl: H.get_image(), id: H.sc }); break; case IPCC.Web.UI.MarkType.Polyline: bi = PCCViewer.Mark.Type.PolylineAnnotation; R = new PCCViewer.Mark({ type: bi, igMark: H, pageNumber: G + 1, uid: H.bu.kf }); R.qD = H.get_lineWidth(); R.dU = H.get_lineColor(); R.dI = H.get_opacity(); var aeQ = H.get_points(); R.ag = []; for (var ar = 0; ar < aeQ.get_length() ; ar++) { abk(ar); } break; default: R = undefined; continue; } if (typeof R !== 'undefined' && fo !== IPCC.Web.UI.MarkType.HighlightText && !(fo === IPCC.Web.UI.MarkType.RectangleRedaction && H.cE !== undefined) && fo !== IPCC.Web.UI.MarkType.TextSelectionRedaction && fo !== IPCC.Web.UI.MarkType.TextHyperlinkAnnotation && fo !== IPCC.Web.UI.MarkType.Strikethrough) { aO.dq[H.get_markID()] = R; Mc.push(R); } } for (var TS in Fo) { if (Fo.hasOwnProperty(TS) && xU[TS]) { var FG = xU[TS]; var aod = FG.H; if (FG.dF && FG.dF.length > 0) { for (var PH = 0; PH < FG.dF.length; PH++) { if (FG.dF[PH].aD === G) { aod = FG.dF[PH]; } } } var bV = Fo[TS]; for (var WL = 0; WL < bV.length; WL++) { aod.bV.push(bV[WL]); } } } } } for (var pO in xU) { if (xU.hasOwnProperty(pO)) { var xI = xU[pO]; aO.dq[xI.H.get_markID()] = xI; Mc.push(xI); if (xI.dF && xI.dF.length > 0) { xI.dF[xI.dF.length - 1].lF = true; } else { xI.H.lF = true; } } } aT.resolve(Ld); if (iR !== undefined) { iR.addMarks(Mc); } else { aO.getActiveMarkupLayer().addMarks(Mc); } aO.trigger('MarkupLoaded', { name: Ld, loadedMarks: Mc }); }; function eZ(bM) { aT.reject(new PCCViewer.Error("Error", "Status Code " + bM.response.status + " " + bM.response.statusText)); }; Qq = IPCC.gB.sv(Ld); if (!(/^[\x00-\x7F]*$/.test(aO.bE.get_documentIdentifier()))) { am = aO.aH.imageHandlerUrl + '/Document/q/Art/q?DocumentID=e' + aO.aH.documentID + '&AnnotationID=e' + Qq; } else { am = aO.aH.imageHandlerUrl + '/Document/q/Art/q?DocumentID=u' + encodeURIComponent(aO.aH.documentID) + '&AnnotationID=u' + encodeURIComponent(Ld); } PCCViewer.Ajax.dZ({ method: 'GET', url: am, headers: { 'Content-Type': 'application/x-www-form-urlencoded' } }).then(fa, eZ); }); return cZ; }; PCCViewer.ViewerControl.prototype.getSavedMarkupNames = function () { var aT = PCCViewer.Deferred(); var cZ = aT.getPromise(); try { var G = 0, KA = 0; var BO = ''; var am = this.aH.imageHandlerUrl + '/AnnotationList/q/Art/q?DocumentID=u' + encodeURIComponent(this.aH.documentID) + '&AnnotationID=u' + encodeURIComponent(BO); var fa = function (bF) { var tn; if (typeof bF.responseText !== 'unknown' && bF.responseText.length > 0) { try { tn = JSON.parse(bF.responseText); } catch (e) { } } var aaN = [], KA = 0; for (var G = 0, dg = tn.annotationFiles.length; G < dg; G++) { if (tn.annotationFiles[G].annotationLabel) { aaN[KA] = {}; aaN[KA].name = tn.annotationFiles[G].annotationLabel; KA++; } } aT.resolve(aaN); }; var eZ = function (bM) { aT.reject(new PCCViewer.Error("MarkupListFail", "Unable to retrieve markup list from server.")); }; PCCViewer.Ajax.dZ({ method: 'GET', url: am }).then(fa, eZ); } catch (e) { aT.reject(new PCCViewer.Error("Error", e.message)); } return cZ; }; PCCViewer.ViewerControl.prototype.getMarkupLayerCollection = function () { if (!this.rk) { this.rk = new PCCViewer.MarkupLayerCollection(this); } return this.rk; }; PCCViewer.ViewerControl.prototype.requestMarkupLayerNames = function (metadata) { var aT = PCCViewer.Deferred(), cZ = aT.getPromise(), am, axc = function (obj) { var parts = []; for (var key in obj) { if (obj.hasOwnProperty(key) && (typeof obj[key] === 'string' || typeof obj[key] === 'boolean' || typeof obj[key] === 'number')) { parts.push(encodeURIComponent(key) + '=' + encodeURIComponent(obj[key])); } } return "?" + parts.join('&'); }; if (!(/^[\x00-\x7F]*$/.test(this.bE.get_documentIdentifier()))) { am = this.aH.imageHandlerUrl + '/MarkupLayers/e' + this.aH.documentID + '/'; } else { am = this.aH.imageHandlerUrl + '/MarkupLayers/u' + encodeURIComponent(this.aH.documentID) + '/'; } if (metadata) { var aCg = axc(metadata); am += aCg; } am += '?nocache=' + new Date().getTime(); PCCViewer.Ajax.dZ({ url: am, method: 'GET' }).then(function fa(bF) { var aFg = JSON.parse(bF.responseText); aT.resolve(aFg); }, function eZ(bM) { aT.reject(bM.error); }); return cZ; }; PCCViewer.ViewerControl.prototype.getActiveMarkupLayer = function () { return this.AN; }; PCCViewer.ViewerControl.prototype.setActiveMarkupLayer = function (markupLayer) { if (!(markupLayer instanceof PCCViewer.MarkupLayer)) { throw new PCCViewer.Error('InvalidArgument', 'The parameter `markupLayer` must be an instance of PCCViewer.MarkupLayer.'); } if (this.rk.getItem(markupLayer.getId()) === undefined) { throw new PCCViewer.Error('InvalidArgument', 'The parameter `markupLayer` is a markup layer unknown to the viewer.'); } this.AN = markupLayer; }; PCCViewer.ViewerControl.prototype.loadMarkupLayers = function (layerRecordIds, options) { var Zv, K = this; Zv = new PCCViewer.LoadMarkupLayersRequest(layerRecordIds, this, options || {}); function zb() { setTimeout(function () { Zv.DG(); }, 20); }; function tJ() { K.off(PCCViewer.EventType.PageCountReady, tJ); zb(); }; if (this.rj === false) { K.on(PCCViewer.EventType.PageCountReady, tJ); } else { zb(); } return Zv; }; PCCViewer.ViewerControl.prototype.saveMarkupLayer = function (id) { var aT = PCCViewer.Deferred(); var cZ = aT.getPromise(); var K = this; if (typeof id !== 'string' || !id) { aT.reject(new PCCViewer.Error('InvalidArgument', 'The parameter `id` is not a string.')); return cZ; } var gI = this.rk ? this.rk.getItem(id) : undefined; if (!gI) { aT.reject(new PCCViewer.Error('UnknownLayerRecord', 'The layer record ' + id + ' is not known to ViewerControl')); return cZ; } function aCq(sh) { var Nq = gI.getMarks(); if (!Nq.length) { sh(undefined, []); } else { K.serializeMarks(Nq).then(function jq(bN) { sh(undefined, IPCC.J.map(bN, function (R) { if (R.conversation && R.conversation.comments) { delete R.conversation.comments; } return R; })); }, function _f(fr) { sh(fr); }); } }; function aCN(sh) { var Nq = gI.getMarks(); var Yd = function (eb, hd, mD) { var UG = IPCC.J.filter(hd, function (pJ) { return !pJ.iR || pJ.iR === gI; }); IPCC.J.forEach(UG, function (cC) { var aC = PCCViewer.fG.Comment(cC); aC.markUid = mD; eb.push(aC); }); return eb; }; var VV = IPCC.J.reduce(Nq, function (eb, R) { var df = R.getConversation(); var hd = df.getComments(); return hd.length ? Yd(eb, hd, R.getUid()) : eb; }, []); sh(undefined, VV); }; function aDq(sh) { var asn = IPCC.J.reduce(K.rk.getAll(), function (eb, ank) { return eb.concat(gI === ank ? [] : ank.getMarks()); }, []); var Yd = function (eb, hd, mD) { var UG = IPCC.J.filter(hd, function (pJ) { return pJ.iR === gI; }); IPCC.J.forEach(UG, function (pJ) { var aC = PCCViewer.fG.Comment(pJ); aC.markUid = mD; eb.push(aC); }); return eb; }; var VV = IPCC.J.reduce(asn, function (eb, R) { var df = R.getConversation(); var hd = df.getComments(); return hd.length ? Yd(eb, hd, R.getUid()) : eb; }, []); sh(undefined, VV); }; var afh = [], aAT = function (pS) { if (pS.markupLayer === gI) { afh.push({ text: pS.text, data: pS.data, creationDateTime: pS.creationDateTime, markUid: pS.markUid }); } }; for (var ahp in this.rk.iX) { if (this.rk.iX.hasOwnProperty(ahp)) { IPCC.J.forEach(this.rk.iX[ahp], aAT); } } var AW = { layerRecordId: gI.getRecordId(), name: gI.getName(), originalXmlName: gI.getOriginalXmlName(), comments: afh, data: PCCViewer.fG.Data(gI) }; var Aq; IPCC.J.YY([function (mY) { aCq(function (bX, dc) { if (bX && !Aq) { Aq = bX; } else { AW.marks = dc; } mY(); }); }, function (mY) { aCN(function (bX, dc) { if (bX && !Aq) { Aq = bX; } else { AW.comments = AW.comments.concat(dc); } mY(); }); }, function (mY) { aDq(function (bX, dc) { if (bX && !Aq) { Aq = bX; } else { AW.comments = AW.comments.concat(dc); } mY(); }); }], function () { if (!Aq) { aAu(AW); } else { aT.reject(new PCCViewer.Error('SerializationError', Aq.message)); } }); function aAu(aIW) { var NF, hc = { method: 'POST', body: JSON.stringify(AW), headers: { 'Content-Type': 'application/json' } }; if (!(/^[\x00-\x7F]*$/.test(K.bE.get_documentIdentifier()))) { NF = K.aH.imageHandlerUrl + '/MarkupLayers/e' + K.aH.documentID + '/'; } else { NF = K.aH.imageHandlerUrl + '/MarkupLayers/u' + encodeURIComponent(K.aH.documentID) + '/'; } if (gI.getRecordId()) { hc.url = NF + gI.getRecordId(); hc.headers['X-HTTP-Method-Override'] = 'PUT'; } else { hc.url = NF; } PCCViewer.Ajax.dZ(hc).then(fa, eZ); }; function fa(bF) { if (bF.responseText && typeof bF.responseText === 'string') { var So; try { So = JSON.parse(bF.responseText); } catch (e) { } if (So && So.layerRecordId) { gI.Wp = So.layerRecordId; } } aT.resolve({ layerRecordId: gI.getRecordId() }); }; function eZ(bM) { aT.reject(new PCCViewer.Error('AjaxError', bM.error.message || 'An unknown server error occured.')); }; return cZ; }; PCCViewer.ViewerControl.prototype.burnMarkup = function (burnOptions) { var mV = { burnSignatures: true, burnRedactions: true, burnAnnotations: false }; var NG; var aiy; var Vy; var aKn = false; if (burnOptions) { if (typeof burnOptions.marks === 'object') { if (burnOptions.marks instanceof PCCViewer.Mark) { NG = [burnOptions.marks]; } else if (burnOptions.marks instanceof Array) { NG = burnOptions.marks; } mV = { marks: NG }; } else { mV.burnSignatures = (burnOptions.burnSignatures !== undefined) ? ! !burnOptions.burnSignatures : mV.burnSignatures; mV.burnRedactions = (burnOptions.burnRedactions !== undefined) ? ! !burnOptions.burnRedactions : mV.burnRedactions; mV.burnAnnotations = (burnOptions.burnAnnotations !== undefined) ? ! !burnOptions.burnAnnotations : mV.burnAnnotations; } if (typeof burnOptions.filename === 'string') { mV.filename = burnOptions.filename; } if (burnOptions.removeFormFields !== undefined) { if (burnOptions.removeFormFields instanceof Array) { if (burnOptions.removeFormFields.length > 0) { var Sc, KD = true; for (Sc = 0; Sc < burnOptions.removeFormFields.length; Sc++) { if (burnOptions.removeFormFields[Sc] !== 'acroform') { KD = false; } } if (KD) { mV.removeFormFields = ['acroform']; } else { mV.pD = { code: 'InvalidArgument', message: 'The burnOptions.removeFormFields parameter contains an invalid form type.' }; } } else { mV.pD = { code: 'InvalidArgument', message: 'The burnOptions.removeFormFields parameter must specify a valid form type.' }; } } else { mV.pD = { code: 'InvalidArgument', message: 'The burnOptions.removeFormFields parameter must be an Array if defined.' }; } } } var CZ = new PCCViewer.BurnRequest(mV), K = this; if (NG) { var fE = []; for (var G = 0, dg = this.getPageCount() ; G < dg; G++) { fE[G] = []; } fE = IPCC.J.reduce(NG, function (bN, bL) { var bp = bL.getPageNumber() - 1; if (!(typeof bL === 'object' && bL instanceof PCCViewer.Mark && bL.H)) { CZ.Zq(new Error('The burnOptions.marks parameter is an invalid object.')); return bN; } if (!K.getMarkById(bL.fg)) { CZ.Zq(new Error('The burnOptions.marks parameter contains a mark not known to Viewer Control.')); return bN; } bN[bp].push(bL.H); if (bL.H.bV) { for (var G = 0, dg = bL.H.bV.length; G < dg; G++) { if (bL.H.bV[G] instanceof IPCC.Web.UI.Mark) { bN[bp].push(bL.H.bV[G]); } } } if (bL.dF) { for (var aj = 0, aFe = bL.dF.length; aj < aFe; aj++) { bN[bp + 1 + aj].push(bL.dF[aj]); if (bL.dF[aj].bV) { for (var dh = 0, aFn = bL.dF[aj].bV.length; dh < aFn; dh++) { if (bL.dF[aj].bV[dh] instanceof IPCC.Web.UI.Mark) { bN[bp + 1 + aj].push(bL.dF[aj].bV[dh]); } } } } } return bN; }, fE); Vy = { Dh: fE, wd: true }; } else { Vy = { includeAnnotations: mV.burnAnnotations, includeRedactions: mV.burnRedactions, includeSignatures: mV.burnSignatures, wd: true }; } function acw() { YK(K, Vy, function (bX, aiy) { if (bX) { setTimeout(function () { CZ.Zq(bX); }, 20); } else { CZ.Qz({ bE: K.bE, aH: K.aH }); CZ.aGs(aiy); setTimeout(function () { CZ.DG(); }, 20); } }); }; function tJ() { K.off(PCCViewer.EventType.PageCountReady, tJ); acw(); }; if (this.rj === false) { K.on(PCCViewer.EventType.PageCountReady, tJ); } else { acw(); } return CZ; }; PCCViewer.ViewerControl.prototype.convertDocument = function (acp) { var xC, K = this, Ct = { targetExtension: 'pdf', filename: 'document' }, aH = {}; PCCViewer.BV.uQ(aH, Ct, acp); aH.wX = 1; xC = new PCCViewer.ConversionRequest(aH); function zb() { xC.Qz({ bE: K.bE, aH: K.aH }); setTimeout(function () { xC.DG(aH); }, 20); }; function tJ() { K.off(PCCViewer.EventType.PageCountReady, tJ); zb(); }; if (this.rj === false) { K.on(PCCViewer.EventType.PageCountReady, tJ); } else { zb(); } return xC; }; PCCViewer.ViewerControl.prototype.requestDocumentConversion = function (acp) { var xC, K = this, Ct = { targetExtension: 'pdf', filename: 'document' }, aH = {}; PCCViewer.BV.uQ(aH, Ct, acp); aH.wX = 2; xC = new PCCViewer.ConversionRequest(aH); function zb() { xC.Qz({ bE: K.bE, aH: K.aH }); setTimeout(function () { xC.DG(aH); }, 20); }; function tJ() { K.off(PCCViewer.EventType.PageCountReady, tJ); zb(); }; if (this.rj === false) { K.on(PCCViewer.EventType.PageCountReady, tJ); } else { zb(); } return xC; }; PCCViewer.ViewerControl.prototype.loadAttachments = function () { var aT = PCCViewer.Deferred(); var cZ = aT.getPromise(); try { var G = 0, KA = 0; var BO = ''; var am = this.aH.imageHandlerUrl + '/ViewingSession/u' + encodeURIComponent(this.aH.documentID) + '/Attachments'; var aBp = function (bF) { var Ji = JSON.parse(bF.responseText); if (Ji === null || Ji.status !== 'complete') { setTimeout(afA, 500); return; } aT.resolve(Ji.attachments || []); }; var eZ = function (bM) { aT.reject(new PCCViewer.Error("AttachmentListFail", "Unable to retrieve attachment list from server.")); }; var afA = function () { PCCViewer.Ajax.dZ({ method: 'GET', url: am }).then(aBp, eZ); }; afA(); } catch (e) { aT.reject(new PCCViewer.Error("Error", e.message)); } return cZ; }; function rv() { return function (sender, eventArgs) { var K = this; var R = K.dq[eventArgs.mark.get_markID()]; if (K.tu) { K.AN.addMarks(R); } setTimeout(function () { if (R) { K.trigger('MarkCreated', { mark: R, pageNumber: eventArgs.pageIndex + 1, clientX: eventArgs.clientX, clientY: eventArgs.clientY }); } }, 0); }; }; function atz(ba) { return { onCreating: function (aB, L) { var R = new PCCViewer.Mark({ type: ba.getType(), igMark: L.mark, pageNumber: L.pageIndex + 1 }); this.dq[L.mark.get_markID()] = R; R.setThickness(ba.getThickness()); R.setColor(ba.getColor()); R.setOpacity(ba.getOpacity()); R.setEndHeadType(ba.getEndHeadType()); PCCViewer.Data.qH(ba, R); PCCViewer.Conversation.rD(ba.getConversation(), R.getConversation()); }, onAdded: rv() }; }; function aht(ba) { return { onCreating: function (aB, L) { var R = new PCCViewer.Mark({ type: ba.getType(), igMark: L.mark, pageNumber: L.pageIndex + 1 }); this.dq[L.mark.get_markID()] = R; R.setBorderThickness(ba.getBorderThickness()); R.setFillColor(ba.getFillColor()); R.setBorderColor(ba.getBorderColor()); R.setOpacity(ba.getOpacity()); PCCViewer.Data.qH(ba, R); PCCViewer.Conversation.rD(ba.getConversation(), R.getConversation()); }, onAdded: rv() }; }; function aBc(ba) { return { onCreating: function (aB, L) { var R = new PCCViewer.Mark({ type: ba.getType(), igMark: L.mark, pageNumber: L.pageIndex + 1 }); this.dq[L.mark.get_markID()] = R; }, onAdded: rv() }; }; function aAU(ba) { return { onCreating: function (aB, L) { var R = new PCCViewer.Mark({ type: ba.getType(), igMark: L.mark, pageNumber: L.pageIndex + 1 }); this.dq[L.mark.get_markID()] = R; R.setReason(ba.getReason()); R.setBorderThickness(ba.getBorderThickness()); R.setFillColor(ba.getFillColor()); R.setBorderColor(ba.getBorderColor()); R.setFontColor(ba.getFontColor()); PCCViewer.Data.qH(ba, R); PCCViewer.Conversation.rD(ba.getConversation(), R.getConversation()); }, onAdded: rv() }; }; function aBT(ba) { return { onCreating: function (aB, L) { var R = new PCCViewer.Mark({ type: ba.getType(), igMark: L.mark, pageNumber: L.pageIndex + 1 }); this.dq[L.mark.get_markID()] = R; R.setBorderThickness(ba.getBorderThickness()); R.setFillColor(ba.getFillColor()); R.setBorderColor(ba.getBorderColor()); R.setOpacity(ba.getOpacity()); R.setFontName(ba.getFontName()); R.setFontColor(ba.getFontColor()); R.setFontSize(ba.getFontSize()); R.setFontStyle(ba.getFontStyle()); R.setHorizontalAlignment(ba.getHorizontalAlignment()); PCCViewer.Data.qH(ba, R); PCCViewer.Conversation.rD(ba.getConversation(), R.getConversation()); }, onAdded: rv() }; }; function XD(ba) { return { onCreating: function (aB, L) { var R = new PCCViewer.Mark({ type: ba.getType(), igMark: L.mark, pageNumber: L.pageIndex + 1 }); this.dq[L.mark.get_markID()] = R; R.setFontName(ba.getFontName()); R.setFontColor(ba.getFontColor()); R.setText(ba.getText()); if (R.setFontSize) { R.setFontSize(ba.getFontSize()); } PCCViewer.Data.qH(ba, R); PCCViewer.Conversation.rD(ba.getConversation(), R.getConversation()); }, onAdded: rv() }; }; function aBf(ba) { return { onCreating: function (aB, L) { var R = new PCCViewer.Mark({ type: ba.getType(), igMark: L.mark, pageNumber: L.pageIndex + 1 }); this.dq[L.mark.get_markID()] = R; if (ba.getType() === PCCViewer.MouseTool.Type.StampAnnotation) { R.setColor(ba.getColor()); } R.setLabel(ba.getLabel()); PCCViewer.Data.qH(ba, R); PCCViewer.Conversation.rD(ba.getConversation(), R.getConversation()); }, onAdded: rv() }; }; var aIJ; function Uf(ba) { return { onCreating: function (aB, L) { }, onAdded: rv() }; }; function avZ(ba) { return { onCreating: function (aB, L) { var R = new PCCViewer.Mark({ type: ba.getType(), igMark: L.mark, pageNumber: L.pageIndex + 1 }); this.dq[L.mark.get_markID()] = R; R.setThickness(ba.getThickness()); R.setColor(ba.getColor()); R.setOpacity(ba.getOpacity()); PCCViewer.Data.qH(ba, R); PCCViewer.Conversation.rD(ba.getConversation(), R.getConversation()); }, onAdded: rv() }; }; function akO(ba) { return { onCreating: function (aB, L) { var R = new PCCViewer.Mark({ type: ba.getType(), igMark: L.mark, pageNumber: L.pageIndex + 1 }); this.dq[L.mark.get_markID()] = R; R.setImage(ba.getImage()); PCCViewer.Data.qH(ba, R); PCCViewer.Conversation.rD(ba.getConversation(), R.getConversation()); }, onAdded: rv() }; }; function aze(ba) { return { onCreating: function (aB, L) { var R = new PCCViewer.Mark({ type: ba.getType(), igMark: L.mark, pageNumber: L.pageIndex + 1 }); this.dq[L.mark.get_markID()] = R; R.setThickness(ba.getThickness()); R.setColor(ba.getColor()); R.setOpacity(ba.getOpacity()); PCCViewer.Data.qH(ba, R); PCCViewer.Conversation.rD(ba.getConversation(), R.getConversation()); }, onAdded: rv() }; }; PCCViewer.ViewerControl.prototype.setMarkHandleMode = function (markHandleMode) { var yW; switch (markHandleMode) { case PCCViewer.MarkHandleMode.HideCornerHandlesWhenClose: yW = IPCC.Web.UI.MarkHandleMode.HideCornerHandlesWhenClose; break; case PCCViewer.MarkHandleMode.HideSideHandlesWhenClose: yW = IPCC.Web.UI.MarkHandleMode.HideSideHandlesWhenClose; break; default: throw new RangeError("The value of markHandleMode is not a supported value."); } if (this.bq && this.bq.set_markHandleMode) { this.bq.set_markHandleMode(yW); } else { this.aH.markHandleMode = yW; } return this; }; PCCViewer.ViewerControl.prototype.getMarkHandleMode = function () { var yW; if (this.bq && this.bq.get_markHandleMode) { yW = this.bq.get_markHandleMode(); } else { yW = this.aH.markHandleMode; } if (yW === IPCC.Web.UI.MarkHandleMode.HideCornerHandlesWhenClose) { return PCCViewer.MarkHandleMode.HideCornerHandlesWhenClose; } else { return PCCViewer.MarkHandleMode.HideSideHandlesWhenClose; } }; PCCViewer.ViewerControl.prototype.setConversationDOMFactory = function (factoryFunction) { if (typeof (factoryFunction) !== 'function') { throw new Error("The parameter factoryFunction is not a function."); } this.pE = factoryFunction; return this; }; PCCViewer.ViewerControl.prototype.getConversationDOMFactory = function () { return this.pE; }; PCCViewer.ViewerControl.prototype.refreshConversations = function (conversations) { var acM, aez = (conversations === undefined); function aoF(df, dJ) { throw new Error(df + ((dJ !== undefined) ? ' (Array index ' + dJ + ')' : '') + ' is not a valid PCCViewer.Conversation object.'); }; function aBL(df, dJ) { throw new Error(df + ((dJ !== undefined) ? ' (Array index ' + dJ + ')' : '') + ' is not a known conversation in this ViewerControl.'); }; if (conversations instanceof PCCViewer.Conversation) { acM = [conversations]; } else if (conversations instanceof Array) { acM = conversations; } else if (!aez) { aoF(conversations); } var amm = IPCC.J.map(this.getAllMarks(), function (bL) { return bL.getConversation(); }); var aac = IPCC.J.map(acM || amm, function (bL, G) { if (!(bL instanceof PCCViewer.Conversation)) { aoF(bL, G); } if (!aez && !IPCC.J.inArray(amm, bL)) { aBL(bL, G); } return bL.getMark().fg; }); this.bq.refreshConversations(aac); return this; }; PCCViewer.ViewerControl.prototype.openCommentsPanel = function () { if (this.eF === false) { throw new Error("The method openCommentsPanel is not available until 'ViewerReady' state is reached."); } if (this.getPageLayout() === PCCViewer.PageLayout.Horizontal) { throw new Error("The page layout must be set to vertical to use the comments panel."); } this.bq.openCommentsPanel(); var K = this; setTimeout(function () { K.trigger("CommentsPanelToggled", { isOpen: true }); }, 10); return this; }; PCCViewer.ViewerControl.prototype.closeCommentsPanel = function () { if (this.eF === false) { throw new Error("The method closeCommentsPanel is not available until 'ViewerReady' state is reached."); } this.bq.closeCommentsPanel(); var K = this; setTimeout(function () { K.trigger("CommentsPanelToggled", { isOpen: false }); }, 10); return this; }; PCCViewer.ViewerControl.prototype.getIsCommentsPanelOpen = function () { if (this.eF === false) { throw new Error("The method getIsCommentsPanelOpen is not available until 'ViewerReady' state is reached."); } if (this.getPageLayout() === PCCViewer.PageLayout.Horizontal) { return false; } return this.bq.get_isCommentsPanelOpen(); }; PCCViewer.ViewerControl.prototype.setSelectedConversation = function (conversation) { if (this.eF === false) { throw new Error("The method setSelectedConversation is not available until 'ViewerReady' state is reached."); } if (conversation === null || conversation === undefined) { this.bq.set_selectedConversation(undefined); return this; } if (!(conversation instanceof PCCViewer.Conversation)) { throw new Error("The parameter conversation is not an instance of PCCViewer.Conversation."); } var mN = conversation.getMark(); if (mN) { var xY = mN.H.get_conversation(); this.bq.set_selectedConversation(xY); } else { throw new Error("The conversation is unknown to the viewer control."); } return this; }; PCCViewer.ViewerControl.prototype.getSelectedConversation = function () { if (this.eF === false) { return null; } var ik = this.bq.get_selectedConversation(); if (ik) { var mN = this.dq[ik.get_mark().get_markID()]; if (mN) { return mN.getConversation(); } } return null; }; PCCViewer.ViewerControl.prototype.clearMouseSelectedText = function (textSelection) { if (!textSelection) { throw new Error('textSelection is a required parameter'); } else if (typeof textSelection.startIndex !== 'number' || textSelection.startIndex < 0) { throw new Error('Start index value ' + textSelection.startIndex + ' is not a valid value.'); } else if (typeof textSelection.pageNumber !== 'number' || textSelection.pageNumber < 1 || textSelection.pageNumber > this.getPageCount()) { throw new Error('Page number value ' + textSelection.pageNumber + ' is not a valid value.'); } else if (typeof textSelection.length !== 'number' || textSelection.length < 1) { throw new Error('Length value ' + textSelection.pageNumber + ' is not a valid value.'); } var K = this, Ee = K.dG; function aki(aD, iO, cz) { var Ys = [aD + 1]; var bI = K.cs.getPage(aD), gs = bI.cv(); if (gs.mw()) { var az = gs.FF(), ail = az.substr(iO); if (ail.length > cz) { return Ys; } else { return Ys.concat(aki(aD + 1, 0, cz - ail.length)); } } else { return Ys; } }; this.bq.AJ(); function Fv(WX, bp) { K.aiW(bp, WX); }; if (Ee && Ee.getResults().length) { var dP = aki(textSelection.pageNumber - 1, textSelection.startIndex, textSelection.length), fc = Ee.getResults(), als = false, QM = {}; if (fc.length) { IPCC.J.forEach(fc, function (bL) { var aCi = IPCC.J.contains(dP, bL.bp); if (aCi) { als = true; QM[bL.bp] = QM[bL.bp] || []; QM[bL.bp].push(bL); } }); } if (als) { IPCC.J.forEach(QM, function (WX, bp) { this.requestPageText(bp).then(Fv.bind(null, WX, bp)); }); } } return this; }; PCCViewer.ViewerControl.prototype.convertPageToWindowCoordinates = function (pageNumber, points) { if (this.eF === false) { throw new Error("The method setSelectedConversation is not available until 'ViewerReady' state is reached."); } if (!pageNumber || typeof pageNumber !== 'number' || pageNumber < 1 || pageNumber > this.getPageCount()) { throw new PCCViewer.Error('InvalidArgument', 'pageNumber is not a known page number in the document'); } var vo = function (n) { return typeof n === 'number' && !isNaN(n); }; var Aa, adZ = true; if (points && points.constructor === Array) { Aa = points; } else { Aa = [points]; adZ = false; } var aly = function (be, dJ, bj) { throw new PCCViewer.Error('InvalidArgument', be + ' (Array index ' + dJ + ') does not have a valid ' + bj + ' property'); }; if (Aa.length === 0 || !points) { throw new PCCViewer.Error('InvalidArgument', 'At least one point is required'); } IPCC.J.forEach(Aa, function (be, dJ) { if (!vo(be.x)) { aly(be, dJ, 'x'); } if (!vo(be.y)) { aly(be, dJ, 'y'); } }); var HH = this.bq.azx(pageNumber, Aa); if (HH === null) { return null; } else if (adZ) { return HH; } else { return HH[0]; } }; PCCViewer.ViewerControl.prototype.selectEditorText = function () { if (this.eF === false) { throw new Error("The method selectEditorText is not available until 'ViewerReady' state is reached."); } var K = this; var bq = K.bq; var YX = bq.Fa(); if (!YX) { throw new Error("The method selectEditorText is not available unless there is an active editor on the page."); } if (YX === 'singleline') { bq.KU(); } else if (YX === 'multiline') { throw new PCCViewer.Error('InvalidArgument', 'Only TextInputSignature Marks are supported at this time'); } return K; }; if (Object.defineProperties) { Object.defineProperties(PCCViewer.ViewerControl.prototype, { "pageCount": { enumerable: true, get: function () { return this.getPageCount(); } }, "pageNumber": { enumerable: true, get: function () { return this.getPageNumber(); }, set: function (value) { return this.setPageNumber(value); } }, "searchRequest": { enumerable: true, get: function () { return this.dG; } }, "selectedSearchResult": { enumerable: true, get: function () { return this.getSelectedSearchResult(); }, set: function (val) { return this.setSelectedSearchResult(val, true); } }, "currentMouseTool": { enumerable: true, get: function () { return this.getCurrentMouseTool(); }, set: function (value) { return this.setCurrentMouseTool(value); } }, "atMaxScale": { enumerable: true, get: PCCViewer.ViewerControl.prototype.getAtMaxScale }, "atMinScale": { enumerable: true, get: PCCViewer.ViewerControl.prototype.getAtMinScale }, "scaleFactor": { enumerable: true, get: function () { return this.getScaleFactor(); }, set: function (value) { return this.setScaleFactor(value); } }, "selectedMarks": { enumerable: true, get: PCCViewer.ViewerControl.prototype.getSelectedMarks }, "viewMode": { enumerable: true, get: function () { return this.getViewMode(); }, set: function (value) { return this.setViewMode(value); } }, "isCommentsPanelOpen": { enumerable: true, get: function () { return this.getIsCommentsPanelOpen(); } }, "selectedConversation": { enumerable: true, get: function () { return this.getSelectedConversation(); }, set: function (conversation) { return this.setSelectedConversation(conversation); } }, "redactionViewMode": { enumerable: true, get: function () { return this.getRedactionViewMode(); }, set: function (value) { return this.setRedactionViewMode(value); } }, "markHandleMode": { enumerable: true, get: function () { return this.getMarkHandleMode(); }, set: function (value) { return this.setMarkHandleMode(value); } } }); } PCCViewer.FitType = { FullWidth: "FullWidth", ShrinkToWidth: "ShrinkToWidth", ActualSize: "ActualSize", FullHeight: "FullHeight", FullPage: "FullPage" }; PCCViewer.ViewMode = { Document: "Document", EqualWidthPages: "EqualWidthPages", SinglePage: "SinglePage", EqualFitPages: "EqualFitPages" }; PCCViewer.PageLayout = { Horizontal: "Horizontal", Vertical: "Vertical" }; PCCViewer.EventType = { ViewerReady: "ViewerReady", PageCountReady: "PageCountReady", EstimatedPageCountReady: "EstimatedPageCountReady", PageChanged: "PageChanged", PageLoadFailed: "PageLoadFailed", PageDisplayed: "PageDisplayed", PageRotated: "PageRotated", DocumentRotated: "DocumentRotated", ScaleChanged: "ScaleChanged", DocumentPrinted: "DocumentPrinted", TextSelected: "TextSelected", MouseToolChanged: "MouseToolChanged", SearchPerformed: "SearchPerformed", PartialSearchResultsAvailable: "PartialSearchResultsAvailable", SearchCompleted: "SearchCompleted", SearchFailed: "SearchFailed", SearchCancelled: "SearchCancelled", SearchResultsAvailable: "SearchResultsAvailable", SearchCleared: "SearchCleared", SearchResultSelectionChanged: "SearchResultSelectionChanged", PrintRequested: "PrintRequested", MarkupLoaded: "MarkupLoaded", MarkupSaved: "MarkupSaved", MarkChanged: "MarkChanged", MarkCreated: "MarkCreated", MarkRemoved: "MarkRemoved", MarkReordered: "MarkReordered", MarkSelectionChanged: "MarkSelectionChanged", MarkMouseEnter: "MarkMouseEnter", MarkMouseOver: "MarkMouseOver", MarkMouseLeave: "MarkMouseLeave", CommentsPanelToggled: "CommentsPanelToggled", CommentCreated: "CommentCreated", CommentRemoved: "CommentRemoved", CommentChanged: "CommentChanged", PageTextReady: "PageTextReady", Click: "Click", PageOpening: "PageOpening" }; PCCViewer.RedactionViewMode = { Draft: "Draft", Normal: "Normal" }; PCCViewer.ScaleTrigger = { Pinch: "Pinch", Zoom: "Zoom", Fit: "Fit", ViewMode: "ViewMode" }; PCCViewer.MarkHandleMode = { HideSideHandlesWhenClose: "HideSideHandlesWhenClose", HideCornerHandlesWhenClose: "HideCornerHandlesWhenClose" }; PCCViewer.BV = {}; PCCViewer.BV.uQ = function (target) { var source; if (!target) { throw new Error("target must be defined."); } else if (typeof target !== 'object') { throw new Error("typeof target must be 'object'"); } else { for (var i = 1; i < arguments.length; i++) { source = arguments[i]; for (var property in source) { if (source.hasOwnProperty(property)) { target[property] = source[property]; } } } } return target; }; }(PCCViewer || {})); (function (PCCViewer) { "use strict"; var printAlgorithm = { standard: 1, contentWindowContents: 2 }; var VJ = function VJ(aC, cA, V) { if (aC.addEventListener) { aC.addEventListener(cA, V, false); } else if (aC.attachEvent) { aC.attachEvent('on' + cA, V); } }; var Yv = function Yv(aC, cA, V) { if (aC.removeEventListener) { aC.removeEventListener(cA, V, false); } else if (aC.detachEvent) { aC.detachEvent('on' + cA, V); } }; function aHx(fp) { var Sq = {}; fp = fp.split('&'); for (var i = fp.length; i--;) { var q = fp[i].split('='); Sq[q.shift()] = q.join('='); } return Sq; }; function aAj() { var CL = document.getElementById('pccPrintFrame'); if (CL) { if (CL.contentWindow && CL.contentWindow.destroy) { CL.contentWindow.destroy(); } if (CL.parentElement) { CL.parentElement.removeChild(CL); } } }; function arI(aH, wg, aiw, alf, nD) { aAj(); if (!aH.algorithm) { aH.algorithm = printAlgorithm.standard; } var bY; var gn = document.createElement('iframe'); gn.id = 'pccPrintFrame'; gn.className = 'pccPrintFrame'; gn.style.position = 'absolute'; gn.style.bottom = gn.style.right = '0px'; gn.style.width = gn.style.height = '1px'; gn.style.zIndex = '0'; gn.style.border = 'none'; if (aH.algorithm !== printAlgorithm.contentWindowContents) { gn.style.visibility = '0'; } function Rf() { Yv(window, 'message', anT); }; function aio() { Yv(gn, 'load', aio); if (gn.contentDocument) { bY = gn.contentDocument; } else if (gn.contentWindow) { bY = gn.contentWindow.document; } else { bY = gn.document; } if (aH.algorithm === printAlgorithm.contentWindowContents) { gn.contentWindow.contents = aH.template; gn.src = 'javascript:window["contents"]'; } else { bY.open(); bY.write(aH.template); bY.close(); } nD(); }; var anT = function (message) { message.source.PCCViewer.Ajax.setHeaders(PCCViewer.Ajax.getHeaders()).setOverrideMethod(PCCViewer.Ajax.getOverrideMethod()); if (message.data.match(/loadArt/)) { var amT = JSON.parse(message.data); var aX = aiw(amT.pageIndex); gn.contentWindow[amT.callbackName](aX); } else if (message.data === 'extra') { var JS = alf(aH); gn.contentWindow['extra'](aH.encryption, JS); } else if (message.data === 'done') { if (aH.algorithm === printAlgorithm.contentWindowContents) { setTimeout(function () { gn.contentWindow.focus(); gn.contentWindow.document.execCommand('print', false, null); window.focus(); Rf(); wg.trigger(PCCViewer.PrintRequest.EventType.PrintCompleted); }, 200); } else { setTimeout(function () { gn.contentWindow.focus(); gn.contentWindow.print(); window.focus(); Rf(); wg.trigger(PCCViewer.PrintRequest.EventType.PrintCompleted); }, 200); } } else if (message.data === 'fail') { Rf(); wg.trigger(PCCViewer.PrintRequest.EventType.PrintFailed); } else { var wx = aHx(message.data); wx.index = +wx.index; wx.pageNumber = +wx.pageNumber; wx.totalPages = +wx.totalPages; wg.anH = +wx.index + 1; wg.trigger(PCCViewer.PrintRequest.EventType.PrintPagePrepared, wx); } }; VJ(window, 'message', anT); VJ(gn, 'load', aio); document.body.appendChild(gn); return Rf; }; function axH(cL) { return function aiw(aD) { return cL.bq.hz(cL.cs.getPage(aD)); }; }; function apM(cL) { return function alf(options) { var bN, R, wY = [], ze = [], He = {}, Kt = {}, xG = {}, fr = {}, FO = '', agr, df, ak, Kx, ai, JB, bp, anF = {}, EH = {}, G = 0, dh = 0, aj = 0, aER = function (a, b) { return a - b; }; if (options.includeComments !== 'none' || options.includeReasons !== 'none') { bN = cL.getAllMarks(); for (G = 0; G < options.pages.length; G++) { anF[options.pages[G]] = true; } for (dh = 0; dh < bN.length; dh++) { R = bN[dh]; bp = R.bp; if (options.includeReasons !== 'none' && R.getReason) { FO = R.getReason(); if (FO) { if (!xG[bp]) { fr[FO] = 1; xG[bp] = fr; fr = {}; } else { if (xG[bp][FO]) { xG[bp][FO] += 1; } else { xG[bp][FO] = 1; } } } } if (R.qK || R.aa.search("Redaction") !== -1) { if (EH[bp]) { EH[bp] += 1; } else { EH[bp] = 1; } } if (options.range.length && anF[bp] !== true || !options.includeRedactions && R.qK || !options.includeAnnotations && !R.qK) { continue; } df = R.getConversation(); if (df && df.getComments().length) { if (!Kx) { Kx = bp; } else if (bp !== Kx) { wY.sort(aER); for (aj = 0; aj < wY.length; aj++) { ze = ze.concat(He[wY[aj]]); } Kt[Kx] = ze; Kx = bp; wY = []; He = {}; ze = []; } ak = cL.getCharacterIndex(R); agr = bp; ai = R.H.get_boundingRectangle(); JB = (ak > 0) ? ak * 10000 + ai.y : ai.y; wY.push(JB); if (!He[JB]) { He[JB] = [df]; } else { He[JB].push(df); } } } if (wY.length) { wY.sort(function (a, b) { return a - b; }); for (G = 0; G < wY.length; G++) { ze = ze.concat(He[wY[G]]); } Kt[agr] = ze; } } return { Kt: Kt, xG: xG, EH: EH }; }; }; PCCViewer.ViewerControl.prototype.print = function print(options) { options = options || {}; options.range = options.range || 'all'; options.orientation = (options.orientation && options.orientation.toLowerCase() === 'landscape') ? 'landscape' : 'portrait'; options.paperSize = options.paperSize || 'letter'; options.margins = (options.margins && options.margins.toLowerCase() === 'none') ? 'none' : 'default'; options.includeMarks = options.includeMarks !== undefined ? (! !options.includeMarks && this.canPrintMarks()) : undefined; options.includeAnnotations = options.includeAnnotations !== undefined ? (! !options.includeAnnotations && this.canPrintMarks()) : undefined; options.includeRedactions = options.includeRedactions !== undefined ? (! !options.includeRedactions && this.canPrintMarks()) : undefined; options.includeComments = (options.includeComments) ? options.includeComments : 'none'; options.includeReasons = (options.includeReasons) ? options.includeReasons : 'none'; options.redactionViewMode = (options.redactionViewMode) ? options.redactionViewMode : 'Normal'; if (options.includeAnnotations === undefined) { options.includeAnnotations = options.includeMarks; } if (options.includeRedactions === undefined) { options.includeRedactions = options.includeMarks; } var dP = PCCViewer.Util.convertPageRangeToArray(options.range.toString().toLowerCase(), { upperLimit: this.getPageCount() }); var sD = this.aH.imageHandlerUrl; var auZ = this.aH.documentID; var auE = this.aAr; options.vsID = auZ; options.handler = sD; options.pages = dP; var isOldIE = ! !navigator.appName.match('Microsoft'); var isIE = ! !navigator.userAgent.match('Trident'); var isSafari = ! !(navigator.userAgent.search('Safari') >= 0 && navigator.userAgent.search('Chrome') < 0); options.template = auE.replace(/{{viewingSessionId}}/g, options.vsID).replace(/{{handler}}/g, options.handler).replace(/{{pages}}/g, options.pages.join(',')).replace(/{{orientation}}/g, options.orientation).replace(/{{paperSize}}/g, options.paperSize).replace(/{{isIE}}/g, isIE.toString()).replace(/{{isSafari}}/g, isSafari.toString()).replace(/{{includeAnnotations}}/g, options.includeAnnotations).replace(/{{includeRedactions}}/g, options.includeRedactions).replace(/{{includeComments}}/g, options.includeComments).replace(/{{includeReasons}}/g, options.includeReasons).replace(/{{margins}}/g, options.margins).replace(/{{redactionViewMode}}/g, options.redactionViewMode).replace(/{{viewerAssetsPath}}/g, this.aH.viewerAssetsPath); options.encryption = ! !this.aH.encryption; if (isOldIE || IPCC.J.LK.SY) { options.algorithm = printAlgorithm.contentWindowContents; } var Xr; function aV() { if (! !Xr) { Xr(); } }; var wg = new PCCViewer.PrintRequest(options, dP.length, aV, this); this.trigger(PCCViewer.EventType.PrintRequested, { printRequest: wg }); Xr = arI(options, wg, axH(this), apM(this), function () { }); return wg; }; PCCViewer.ViewerControl.prototype.validatePrintRange = function validatePrintRange(range) { return PCCViewer.Util.validatePageRange(range.toString().toLowerCase(), { upperLimit: this.getPageCount() }); }; PCCViewer.ViewerControl.prototype.canPrintMarks = function canPrintMarks() { return (document.documentMode !== 8); }; PCCViewer.PrintRequest = function (options, totalPages, cancelFunc, that) { this.aH = options; this.aV = cancelFunc; this.anH = 0; PCCViewer.EventEmitter.extend(this); }; PCCViewer.PrintRequest.EventType = { PrintPagePrepared: "PrintPagePrepared", PrintCompleted: "PrintCompleted", PrintCancelled: "PrintCancelled", PrintFailed: "PrintFailed" }; PCCViewer.PrintRequest.prototype.cancel = function () { this.aV(); this.trigger(PCCViewer.PrintRequest.EventType.PrintCancelled); }; PCCViewer.PrintRequest.prototype.getOptions = function () { return { range: this.aH.pages.toString(), orientation: this.aH.orientation, paperSize: this.aH.paperSize, margins: this.aH.margins, includeMarks: this.aH.includeMarks, includeAnnotations: this.aH.includeAnnotations, includeRedactions: this.aH.includeRedactions, includeComments: this.aH.includeComments, includeReasons: this.aH.includeReasons, redactionViewMode: this.aH.redactionViewMode }; }; PCCViewer.PrintRequest.prototype.getPageCount = function () { return this.aH.pages.length; }; PCCViewer.PrintRequest.prototype.getPreparedCount = function () { return this.anH; }; if (Object.defineProperties) { Object.defineProperties(PCCViewer.PrintRequest.prototype, { "options": { enumerable: true, get: function () { return this.getOptions(); } }, "pageCount": { enumerable: true, get: function () { return this.getPageCount(); } }, "preparedCount": { enumerable: true, get: function () { return this.getPreparedCount(); } } }); } PCCViewer.PrintControl = function (domElement, options) { var amQ = []; IPCC.J.aoL = true; options.includeAnnotations = options.includeAnnotations !== 'false'; options.includeRedactions = options.includeRedactions !== 'false'; domElement.className = domElement.className + ' ' + options.orientation; function Cb(n) { (window.parent) ? window.parent.postMessage(n, '*') : window.opener.postMessage(n, '*'); }; function azZ(bp, NZ) { var hb = []; hb.push("pageNumber=" + (1 + bp)); hb.push("index=" + NZ); hb.push("totalPages=" + options.pages.length); return hb.join('&'); }; function jb(bp, NZ, next) { var bw = { documentIdentifier: options.vsID, pageNumber: bp, viewFitType: IPCC.Web.UI.FitType.FullImage, imageHandlerUrl: options.handler, encryption: options.encryption }; var kS = document.createElement('div'); kS.className = options.paperSize + " "; kS.className += options.isIE ? 'pageIE' : options.isSafari ? 'pageSafari' : 'page'; kS.id = 'printpage' + bp; if (options.margins === 'none') { kS.className += ' nomargins'; } domElement.appendChild(kS); var pv = IPCC.initializePageViewPlugin(kS, bw); pv.set_debug(false); amQ.push(pv); var xt = false; function Mv() { Cb(azZ(bp, NZ)); next(); }; pv.add_pageOpened(function () { var aJ = pv.kO(), by = pv.iE(); var xW = (options.orientation === 'portrait' && aJ > by) || (options.orientation === 'landscape' && by > aJ); if (xW) { pv.xW(90); } }); pv.add_pageDisplayed(function () { if (!xt) { Mv(); } }); pv.add_textPageReady(function () { if (xt) { pv.cn(); Mv(); } }); pv.add_pageOpenFailed(function () { Cb('fail'); }); pv.add_textExtractionFailed(function () { if (xt) { Cb('fail'); } }); if (options.redactionViewMode) { if (options.redactionViewMode.toLowerCase() === "draft") { pv.rq(true); } else if (options.redactionViewMode.toLowerCase() === "normal") { pv.rq(false); } } if (PCCViewer.ViewerControl.prototype.canPrintMarks() && (options.includeAnnotations || options.includeRedactions)) { var aog = 'loadArt' + bp; var wx = { pageIndex: bp, callbackName: aog }; window[aog] = function (aX) { var oY, SB, G, df = {}, RM = {}, BM = '', oO, LL, fr, Fg = ''; var Ov = []; aX.FJ(function (R) { if (R.get_type() === IPCC.Web.UI.MarkType.HighlightText) { xt = true; } if (options.includeRedactions && R.lh()) { Ov.push(R); } if (options.includeAnnotations && !R.lh()) { Ov.push(R); } }); var amt = new IPCC.Web.UI.ArtPage(); IPCC.J.forEach(Ov, function (R) { R.kc(undefined); amt.addMark(R); }); bw.artPage = amt; RM = options.pagedConversations[bp + 1]; if (options.pagedConversations && RM && options.includeComments === 'followingPage') { oY = document.createElement('div'); oY.className += 'commentPage'; oY.id = 'printcommentpage' + bp; if (options.margins === 'none') { oY.className += ' nomargins'; } SB = '<h1>Comments for Page {{pageNumber}}</h1><hr><div class="pageConversations">{{conversationList}}</div>'; for (G = 0; G < RM.length; G++) { df = RM[G]; BM += aiO(df, bp + 1); } oY.innerHTML = SB.replace('{{pageNumber}}', bp + 1).replace('{{conversationList}}', BM); domElement.appendChild(oY); } LL = options.pagedReasons[bp + 1]; if (options.pagedReasons && LL && options.includeReasons === 'followingPage') { oO = document.createElement('div'); oO.className += 'reasonPage'; oO.id = 'printreasonpage' + bp; if (options.margins === 'none') { oO.className += ' nomargins'; } SB = '<h1>Redaction Reasons for Page {{pageNumber}}</h1>' + '<div class="redactionReasonPageHeader"><ul><li>Date: {{date}}</li><li>Number of Redactions on this Page: {{count}}</li></div><hr>' + '<div class="pageReasons">{{reasonList}}</div>'; for (fr in LL) { if (LL.hasOwnProperty(fr)) { Fg += ale(fr, LL[fr]); } } oO.innerHTML = SB.replace('{{pageNumber}}', bp + 1).replace('{{reasonList}}', Fg).replace('{{date}}', akT()).replace('{{count}}', options.pagedRedactionCount[bp + 1]); domElement.appendChild(oO); } pv.openPage(bw); IPCC.J.forEach(Ov, function (R) { R.kc(aX); }); }; Cb(JSON.stringify(wx)); } else { pv.openPage(bw); } }; function aiO(df, bp) { var ahk = '', ib = '', R = df.getMark(), hd, cC, G; switch (R.H.jd()) { case IPCC.Web.UI.MarkType.Rectangle: ib = (R.H.lh()) ? 'Highlight Redaction ' : 'Rectangle Annotation'; break; case IPCC.Web.UI.MarkType.Ellipse: ib = 'Ellipse Annotation'; break; case IPCC.Web.UI.MarkType.RectangleRedaction: ib = 'Rectangle Redaction'; break; case IPCC.Web.UI.MarkType.Line: ib = (R.mW === 'None') ? 'Line Annotation' : 'Arrow Annotation'; break; case IPCC.Web.UI.MarkType.Polyline: ib = 'Polyline Annotation'; break; case IPCC.Web.UI.MarkType.Polygon: ib = 'Polygon Annotation'; break; case IPCC.Web.UI.MarkType.Text: ib = 'Text Annotation'; break; case IPCC.Web.UI.MarkType.Highlight: ib = 'Highlight Annotation'; break; case IPCC.Web.UI.MarkType.Stamp: ib = 'Stamp Annotation'; break; case IPCC.Web.UI.MarkType.HighlightText: ib = 'Highlight Text Annotation'; break; case IPCC.Web.UI.MarkType.SignaturePath: ib = 'Signature Path'; break; case IPCC.Web.UI.MarkType.Freehand: ib = 'Freehand Annotation'; break; case IPCC.Web.UI.MarkType.SignatureText: ib = 'Signature Text'; break; case IPCC.Web.UI.MarkType.TextLine: ib = 'Text Input Signature'; break; case IPCC.Web.UI.MarkType.TextAreaSignature: ib = 'Text Area Signature'; break; case IPCC.Web.UI.MarkType.SignatureImage: ib = 'Signature Image'; break; case IPCC.Web.UI.MarkType.TextSelectionRedaction: ib = 'Text Selection Redaction'; break; case IPCC.Web.UI.MarkType.ImageStampAnnotation: ib = 'Image Stamp Annotation'; break; case IPCC.Web.UI.MarkType.ImageStampRedaction: ib = 'Image Stamp Redaction'; break; case IPCC.Web.UI.MarkType.TextHyperlinkAnnotation: ib = 'Text Hyperlink Annotation'; break; case IPCC.Web.UI.MarkType.Strikethrough: ib = 'Strikethrough Annotation'; break; default: break; } hd = df.getComments(); for (G = 0; G < hd.length; G++) { cC = hd[G]; ahk += '<li>' + arw({ text: cC.getText(), createDate: cC.qR.abN, pageNumber: bp + 1 }) + '</li>'; } return '<h3>' + ib + '</h3><ul>' + ahk + '</ul>'; }; function arw(cC) { var gb = new Date(cC.createDate), acn = '{{month}}/{{day}}/{{year}} {{hour}}:{{minutes}}{{period}}'.replace('{{month}}', gb.getMonth() + 1).replace('{{day}}', gb.getDate()).replace('{{year}}', gb.getFullYear()).replace('{{hour}}', (gb.getHours() < 10 ? '0' : '') + gb.getHours()).replace('{{minutes}}', (gb.getMinutes() < 10 ? '0' : '') + gb.getMinutes()).replace('{{period}}', gb.getHours() < 12 ? 'am' : 'pm'); var az = cC.text.replace(/</g, '&#60;').replace(/>/g, '&#62;').replace(/\n/g, '<br/>'); return "{{comment}} - {{date}}".replace('{{comment}}', az).replace('{{date}}', acn); }; function akT() { var gb = new Date(); return '{{month}}/{{day}}/{{year}}'.replace('{{month}}', gb.getMonth() + 1).replace('{{day}}', gb.getDate()).replace('{{year}}', gb.getFullYear()); }; function ale(fr, pg) { fr = fr.replace(/</g, '&#60;').replace(/>/g, '&#62;').replace(/\n/g, '<br/>'); var ayD = (pg > 1) ? 'times' : 'time'; return '<li>"{{reason}}" occurs {{count}} {{times}}</li>'.replace('{{reason}}', fr).replace('{{count}}', pg).replace('{{times}}', ayD); }; function azl() { window.onerror = function (ev) { Cb('fail'); }; function sync(funcs, done) { var counter = funcs.length; var idx = 0; var next = function () { if (--counter === 0) done(); else funcs[idx++](next); }; funcs[idx++](next); }; function aHO(bp, NZ) { return function (next) { jb(bp, NZ, next); }; }; var funcs = []; for (var i = 0; i < options.pages.length; i++) { var bI = +options.pages[i] - 1; funcs.push(aHO(bI, i)); } sync(funcs, function () { var oY, PU = '', bI, FP = '', BM = '', df, R, ahh = '<h1>Comments</h1><hr>{{pageSections}}', oO, Fg = '', aBS = '<h1>Redaction Reasons</h1><hr>{{pageSections}}'; if (options.includeComments === 'documentEnd') { for (bI in options.pagedConversations) { if (options.pagedConversations.hasOwnProperty(bI)) { if (!oY) { oY = document.createElement('div'); oY.className += ' commentPage'; oY.id = 'printpage_comments'; if (options.margins === 'none') { oY.className += ' nomargins'; } } PU = '<div class="pageConversations"><h2>Page #{{pageNumber}}</h2><hr><ol>{{conversationList}}</ol></div>'; BM = ''; for (var G = 0; G < options.pagedConversations[bI].length; G++) { df = options.pagedConversations[bI][G]; R = df.getMark(); BM += aiO(df, R.pageNumber); } FP += PU.replace('{{pageNumber}}', R.pageNumber).replace('{{conversationList}}', BM); if (BM.length) { oY.innerHTML = ahh.replace('{{pageSections}}', FP); domElement.appendChild(oY); } } } } if (options.includeReasons === 'documentEnd') { FP = ''; ahh = ''; PU = '<div class="pageReasons"><h2>Page #{{pageNumber}}</h2><div class="redactionReasonPageHeader"><ul><li>Date: {{date}}</li><li>Number of Redactions on this Page: {{count}}</li></div><hr><ul>{{reasonList}}</ul></div>'; for (bI in options.pagedReasons) { if (options.pagedReasons.hasOwnProperty(bI)) { if (!oO) { oO = document.createElement('div'); oO.className += 'reasonPage'; oO.id = 'printpage_reason'; if (options.margins === 'none') { oO.className += ' nomargins'; } } Fg = ''; for (var fr in options.pagedReasons[bI]) { if (options.pagedReasons[bI].hasOwnProperty(fr)) { Fg += ale(fr, options.pagedReasons[bI][fr]); } } FP += PU.replace('{{pageNumber}}', bI).replace('{{reasonList}}', Fg).replace('{{date}}', akT()).replace('{{count}}', options.pagedRedactionCount[bI]); } } if (FP.length) { oO.innerHTML = aBS.replace('{{pageSections}}', FP); domElement.appendChild(oO); } } Cb('done'); }); }; function aqe() { window['extra'] = function (bool, JS) { options.encryption = ! !bool; options.pagedConversations = JS.Kt; options.pagedReasons = JS.xG; options.pagedRedactionCount = JS.EH; azl(); window['extra'] = function () { }; }; Cb('extra'); }; function awe() { var aX; IPCC.J.forEach(amQ, function (ao) { aX = ao.get_artPage(); if (aX) { aX.removeAllMarks(); } ao.dispose(); aX = undefined; }); }; window['destroy'] = awe; aqe(); }; }(PCCViewer || {})); (function (PCCViewer) { function aix(clientBB) { this.top = clientBB.top; this.bottom = clientBB.bottom; this.left = clientBB.left; this.right = clientBB.right; this.width = clientBB.width || clientBB.right - clientBB.left; this.height = clientBB.height || clientBB.bottom - clientBB.top; }; function Yl(x, y) { this.x = x; this.y = y; this.getDistance = function (point) { var x = point.x - this.x, y = point.y - this.y, d = x * x + y * y, squared = false; return squared ? d : Math.sqrt(d); }; this.equals = function (point) { return this === point || point && (this.x === point.x && this.y === point.y) || false; }; this.close = function (point) { return this.getDistance(point) < 4; }; this.clone = function () { return new Yl(this.x, this.y); }; }; function ZN(bL) { return (bL && bL.nodeType === 1); }; function Qk(gA, JR) { var adp = (JR && IPCC.J.Hd) ? 'm' : 'M'; var adv = (JR && IPCC.J.Hd) ? 'l' : 'L'; return IPCC.J.map(gA, function (el, i) { if (i === 0) { return adp + el.x + ',' + el.y; } else { return adv + el.x + ',' + el.y; } }).join(''); }; function aej(ca, ro, ec) { return function (au) { if (IPCC.J.DA && au.type.match('mouse')) { au.preventDefault(); au.stopPropagation(); return false; } if (au.preventDefault) { au.preventDefault(); } else { au.returnValue = false; } var x, y; if (au.changedTouches) { var ja = au.changedTouches[0]; if (au.type === 'touchstart') { ro = au.target.getBoundingClientRect(); } else if (au.type === 'touchend') { ec && ec(); return; } x = ja.clientX - ro.left; y = ja.clientY - ro.top; } else { x = au.clientX - ro.left; y = au.clientY - ro.top; } var be = new Yl(x, y); ca.gA.push(be); var sq = Qk(ca.gA); if (IPCC.J.Hd) { ca.cj.path = sq.toLowerCase(); } else { ca.cj.setAttribute('d', sq); } ec && ec(); }; }; function avI(points) { var DK = 3, cI = '', uq; var sS = (points.length < DK) ? points : IPCC.J.filter(points, function (el) { if (uq && uq.close(el)) { return false; } else { uq = el; return true; } }); if (sS.length < DK) { sS = [points[0], points[points.length - 1]]; } uq = undefined; if (sS.length < DK) { cI += Qk(sS); } else { cI = 'M' + IPCC.J.bspline(sS); cI = cI.replace(/\d*\.?\d*/g, function (bj) { var JV = bj.indexOf('.'); if (bj.length && JV > 0) { return bj.substr(0, JV + 3); } else if (bj !== "") { return bj; } else { return bj; } }); } return cI; }; function SignatureControl(dom) { var K = this; if (typeof dom === 'string') { this.aS = document.querySelector(dom); if (!(ZN(this.aS))) { throw new Error('The query selector "' + dom + '" did not match any DOM element.'); } } else if (ZN(dom)) { this.aS = dom; } else { throw new Error('The SignatureControl target is not a valid DOM element.'); } this.KK = []; this.ro = new aix(this.aS.getBoundingClientRect()); this.gC = IPCC.J.yg.SVG([0, 0, this.ro.width, this.ro.height].join(' ')); this.aS.appendChild(this.gC); function Ea(ev) { var cj = IPCC.J.yg.Path(undefined, { width: 2000, height: 2000, color: 'black', thickness: 4 }); K.gC.appendChild(cj); var ca = { gA: [], cj: cj, ec: function () { K.KK.push(ca.gA); IPCC.J.removeEvent(K.aS, 'mousemove', Cs); IPCC.J.removeEvent(K.aS, 'mouseup', Ix); if (IPCC.J.DA) { IPCC.J.removeEvent(K.aS, IPCC.J.pn['move'], Cs); IPCC.J.removeEvent(K.aS, IPCC.J.pn['up'], Ix); } if (IPCC.J.Op) { IPCC.J.removeEvent(K.aS, 'touchmove', Cs); IPCC.J.removeEvent(K.aS, 'touchend', Ix); } } }; var Cs = aej(ca, K.ro); var Ix = aej(ca, K.ro, ca.ec); Cs(ev); IPCC.J.addEvent(K.aS, 'mousemove', Cs); IPCC.J.addEvent(K.aS, 'mouseup', Ix); if (IPCC.J.DA) { IPCC.J.addEvent(K.aS, IPCC.J.pn['move'], Cs); IPCC.J.addEvent(K.aS, IPCC.J.pn['up'], Ix); } if (IPCC.J.Op) { IPCC.J.addEvent(K.aS, 'touchmove', Cs); IPCC.J.addEvent(K.aS, 'touchend', Ix); } }; IPCC.J.addEvent(K.aS, 'mousedown', Ea); if (IPCC.J.DA) { this.aS.style['-ms-touch-action'] = 'none'; this.aS.style['touch-action'] = 'none'; IPCC.J.addEvent(K.aS, IPCC.J.pn['down'], Ea); } if (IPCC.J.Op) { IPCC.J.addEvent(K.aS, 'touchstart', Ea); } this.Wm = function () { K.ro = new aix(K.aS.getBoundingClientRect()); K.gC.setAttribute('viewBox', [0, 0, K.ro.width, K.ro.height].join(' ')); }; IPCC.J.addEvent(window, 'resize', this.Wm); this.aeL = function () { IPCC.J.removeEvent(window, 'resize', K.Wm); IPCC.J.removeEvent(K.aS, 'mousedown', Ea); if (IPCC.J.DA) { IPCC.J.removeEvent(K.aS, IPCC.J.pn['down'], Ea); } if (IPCC.J.Op) { IPCC.J.removeEvent(K.aS, 'touchstart', Ea); } while (K.aS.firstChild) { K.aS.removeChild(K.aS.firstChild); } }; }; SignatureControl.prototype.done = function () { var lN, lK, oW, nF, sq = 'M0,0', akp = this; IPCC.J.forEach(akp.KK, function (pO) { IPCC.J.forEach(pO, function (p) { if (lN === undefined || lN > p.x) { lN = p.x; } if (lK === undefined || lK > p.y) { lK = p.y; } if (oW === undefined || oW < p.x) { oW = p.x; } if (nF === undefined || nF < p.y) { nF = p.y; } }); }); IPCC.J.forEach(akp.KK, function (pO) { var auX = IPCC.J.map(pO, function (p) { return new Yl(p.x - lN, p.y - lK); }); sq += avI(auX); }); this.aeL(); return { type: 'path', path: sq, width: (oW - lN) || 0, height: (nF - lK) || 0 }; }; SignatureControl.prototype.resize = function () { this.Wm(); return this; }; SignatureControl.prototype.clear = function () { var svg = this.gC; while (svg && svg.firstChild) { svg.removeChild(svg.firstChild); } this.KK = []; return this; }; SignatureControl.prototype.undo = function () { if (this.gC.lastChild) { this.gC.removeChild(this.gC.lastChild); } this.KK.pop(); return this; }; SignatureControl.prototype.cancel = function () { this.aeL(); return this; }; PCCViewer.SignatureControl = function (dom) { return new SignatureControl(dom); }; PCCViewer.Signatures = new PCCViewer.ObservableCollection(); PCCViewer.SignatureDisplay = function (domElement, signature) { function handleSignatureAsPath() { if (!signature.path || signature.path.match(/[^MLC0-9.,\s]/)) { throw new Error('A valid path is required in the signature object.'); } var tg = IPCC.J.aay(signature.path); var gC = IPCC.J.yg.SVG([0, 0, tg.width, tg.height].join(' ')); var cj = IPCC.J.yg.Path(signature.path, { width: tg.width, height: tg.height, color: 'black', thickness: 4 }); if (IPCC.J.Hd) { var aCo = (tg.height / tg.width) * 100; gC.style.width = cj.style.width = '100%'; gC.style.height = cj.style.height = '0px'; gC.style.paddingBottom = cj.style.paddingBottom = aCo + '%'; } else { gC.style.width = '100%'; gC.style.maxHeight = '100%'; gC.setAttribute('preserveAspectRatio', 'xMinYMin meet'); } gC.appendChild(cj); domElement.appendChild(gC); return { width: tg.width, height: tg.height, clear: function () { domElement.removeChild(gC); } }; }; function handleSignatureAsText() { if (!signature.text || typeof signature.text !== 'string') { throw new Error('The signature text is not a valid string.'); } var kS = document.createElement('div'); var oZ = document.createTextNode(signature.text); var kp = (typeof signature.fontName === 'string') ? signature.fontName : 'serif'; kS.appendChild(oZ); kS.style.textAlign = 'center'; kS.style.fontFamily = '"' + kp + '", cursive'; kS.style.fontSize = '2.5em'; kS.style.overflow = 'hidden'; domElement.appendChild(kS); var tg = IPCC.J.wZ(signature.text, kp); return { width: tg.width, height: tg.height, clear: function () { domElement.removeChild(kS); } }; }; if (!ZN(domElement)) { throw new Error('The `domElement` parameter is not a valid HTMLElement.'); } else if (!signature) { throw new Error('The `signature` parameter is required.'); } else if (signature.path) { return handleSignatureAsPath(); } else if (signature.text) { return handleSignatureAsText(); } else { throw new Error('The signature provided does not have a known type.'); } }; })(PCCViewer || {}); (function (PCCViewer) { PCCViewer.Comment = function Comment(comment, conversation) { if (!(comment instanceof IPCC.Web.UI.Comment) && (typeof comment !== 'string')) { throw new Error(comment + ' is not a string.'); } if (!(conversation instanceof PCCViewer.Conversation)) { throw new Error(conversation + ' is not a PCCViewer.Conversation object.'); } this.getConversation = function aII() { return conversation; }; if (typeof comment === 'string') { this.qR = new IPCC.Web.UI.Comment(comment); } else { this.qR = comment; } this.qR.HI = this; this.dc = this.qR.get_data(); PCCViewer.Data.extend(this); this.Fk = new IPCC.Web.UI.Data(); PCCViewer.SessionData.extend(this); }; PCCViewer.Comment.prototype.getMarkupLayer = function aJE() { return this.iR; }; PCCViewer.Comment.prototype.getText = function aIN() { return this.qR.get_text(); }; PCCViewer.Comment.prototype.setText = function aJT(text) { if (typeof text !== 'string') { throw new Error(text + ' is not a string.'); } this.qR.set_text(text); return this; }; PCCViewer.Comment.prototype.getCreationTime = function aJw() { var auc = IPCC.J.Lp(this.qR.get_creationTime()); return new Date(auc); }; PCCViewer.Comment.prototype.setCreationTime = function aLr(time) { function aeb() { throw new Error(time + ' is not a valid string or Date object.'); }; if (typeof time === 'string') { var ago = IPCC.J.Lp(time); if (ago instanceof Error) { aeb(); } time = new Date(ago); } if (!(time instanceof Date)) { aeb(); } this.qR.set_creationTime(IPCC.J.zO(time)); return this; }; if (Object.defineProperties) { Object.defineProperties(PCCViewer.Comment.prototype, { "text": { enumerable: true, get: function () { return this.getText(); }, set: function (text) { return this.setText(text); } }, "creationTime": { enumerable: true, get: function () { return this.getCreationTime(); }, set: function (time) { return this.setCreationTime(time); } } }); } PCCViewer.Conversation = function Conversation(mark) { if (!(mark instanceof PCCViewer.Mark)) { throw new Error(mark + ' is not a PCCViewer.Mark object.'); } this.getMark = function Rj() { return mark; }; this.kl = new PCCViewer.ObservableCollection(); if (typeof mark.H !== "undefined") { this.xY = mark.H.get_conversation(); this.xY.forEach(function (qR) { var cC = new PCCViewer.Comment(qR, this); this.kl.add(cC); }, this); } else { this.xY = new IPCC.Web.UI.Conversation(); } this.dc = this.xY.get_data(); PCCViewer.Data.extend(this); this.Fk = new IPCC.Web.UI.Data(); PCCViewer.SessionData.extend(this); }; PCCViewer.Conversation.prototype.addComment = function Ju(commentText) { var cC = new PCCViewer.Comment(commentText, this); this.kl.add(cC); this.xY.addComment(cC.qR); return cC; }; PCCViewer.Conversation.prototype.deleteComments = function (comments) { var K = this; var ako = this.kl.toArray(); var ant = function (cC) { for (var i = 0, length = ako.length; i < length; i++) { if (ako[i] === cC) { return true; } } return false; }; function aqA(cC, dJ) { throw new Error(cC + ((dJ !== undefined) ? ' (Array index ' + dJ + ')' : '') + ' is not a PCCViewer.Comment object.'); }; function aoJ(cC, dJ) { throw new Error(((dJ !== undefined) ? ' (Array index ' + dJ + ')' : '') + ' is not part of this Conversation object.'); }; if (comments instanceof PCCViewer.Comment) { if (!ant(comments)) { aoJ(comments); } K.kl.remove(comments); K.xY.removeCommentInstance(comments.qR); } else if (comments instanceof Array) { IPCC.J.forEach(comments, function (el, idx) { if (!(el instanceof PCCViewer.Comment)) { aqA(el, idx); } if (!ant(el)) { aoJ(el, idx); } }); IPCC.J.forEach(comments, function (el) { K.kl.remove(el); K.xY.removeCommentInstance(el.qR); }); } else { aqA(comments); } return this; }; PCCViewer.Conversation.prototype.getComments = function () { return this.kl.toArray().sort(function (a, b) { return a.getCreationTime().getTime() - b.getCreationTime().getTime(); }); }; PCCViewer.Conversation.rD = function (hj, qv) { if (typeof hj.getComments !== "function" || typeof qv.addComment !== "function") { throw new Error("Arguments `_source` and `_destination` must be Conversation objects."); } PCCViewer.Data.qH(hj, qv); var hd = hj.getComments(), i, length = hd.length; for (i = 0; i < length; i++) { var alg = hd[i]; var awZ = qv.addComment(alg.getText()); PCCViewer.Data.qH(alg, awZ); } }; })(PCCViewer || {}); (function (PCCViewer) { PCCViewer.ImageStamps = function (Options) { this.aH = PCCViewer.BV.uQ({}, Options); }; PCCViewer.ImageStamps.prototype.requestImageStampList = function () { var aT = PCCViewer.Deferred(); var cZ = aT.getPromise(); try { var am = this.aH.imageHandlerUrl + '/ImageStampList'; PCCViewer.Ajax.dZ({ method: 'GET', url: am }).then(function fa(bF) { var tn; if (bF.responseText.length > 0) { tn = JSON.parse(bF.responseText); if (bF.status === 200) { aT.resolve(tn); } else { aT.reject(new PCCViewer.Error("ImageStampListFail", "Unable to retrieve ImageStamp list from server.")); } } }, function eZ(bM) { aT.reject(bM.error); }); } catch (e) { aT.reject(new PCCViewer.Error("Error", e.message)); } return cZ; }; PCCViewer.ImageStamps.prototype.reqestImageSourceBase64 = function (ImageStampID) { if (!ImageStampID) { throw new Error("Parameter imageStampId is not valid."); } if (typeof ImageStampID !== 'string') { throw new Error("Parameter imageStampId should be of type string."); } var aT = PCCViewer.Deferred(); var cZ = aT.getPromise(); try { var am = this.aH.imageHandlerUrl + '/ImageStamp/' + ImageStampID + '/q?format=Base64'; PCCViewer.Ajax.dZ({ method: 'GET', url: am, }).then(function fa(bF) { var tn; if (bF.responseText.length > 0) { tn = JSON.parse(bF.responseText); if (bF.status === 200) { aT.resolve(tn); } else { aT.reject(new PCCViewer.Error("ImageStampDataFail", "Unable to retrieve image stamp data URL and dataHash from server.")); } } }, function eZ(bM) { aT.reject(bM.error); }); } catch (e) { aT.reject(new PCCViewer.Error("Error", e.message)); } return cZ; }; PCCViewer.ImageStamps.prototype.getImageSourceURL = function (ImageStampID) { if (!ImageStampID) { throw new Error("Parameter imageStampId is not valid."); } if (typeof ImageStampID !== 'string') { throw new Error("Parameter imageStampId should be of type string."); } return this.aH.imageHandlerUrl + '/ImageStamp/' + ImageStampID + '/q?format=Image'; }; })(PCCViewer || {}); (function (PCCViewer) { PCCViewer.DocumentHyperlink = function DocumentHyperlink(parameters) { this.Ce = parameters.Ce; this.bp = parameters.bp; }; PCCViewer.DocumentHyperlink.prototype.getHref = function () { return this.Ce.ajk(); }; PCCViewer.DocumentHyperlink.prototype.getPageNumber = function () { return this.bp; }; PCCViewer.DocumentHyperlink.prototype.getRectangle = function () { return this.Ce.fD(); }; if (Object.defineProperties) { Object.defineProperties(PCCViewer.DocumentHyperlink.prototype, { "href": { enumerable: true, get: function () { return this.getHref(); } }, "pageNumber": { enumerable: true, get: function () { return this.getPageNumber(); } }, "rectangle": { enumerable: true, get: function () { return this.getRectangle(); } } }); } PCCViewer.ViewerControl.prototype.requestDocumentHyperlinks = function (pageNumber) { var bp; var aT = PCCViewer.Deferred(); var cZ = aT.getPromise(); var cL = this; try { if (typeof (pageNumber) === 'number') { bp = pageNumber; } else { if (isNaN(+pageNumber)) { throw "The parameter pageNumber is not a number."; } else { bp = parseInt(pageNumber, 10); } } if (bp < 1 || bp > this.getPageCount() || !isFinite(pageNumber)) { throw "The specified page is out of range."; } var aao = this.LV[bp - 1]; if (!aao) { aao = this.LV[bp - 1] = new PCCViewer.Deferred(); this.CF.then(function () { var bI = cL.cs.getPage(bp - 1); bI.Bx(); }); } aT.resolve(aao.getPromise()); } catch (e) { aT.reject(new PCCViewer.Error('Error', e)); } return cZ; }; PCCViewer.ViewerControl.prototype.axy = function (ayq) { var i, j, zB; for (j = 0; j < this.TM.length; j++) { zB = this.TM[j]; if (zB) { for (i = 0; i < zB.length; i++) { if (zB[i].Ce.Ry() === ayq) { return zB[i]; } } } } return null; }; })(PCCViewer || {}); (function (PCCViewer) { PCCViewer._Search = function () { this.aP = ''; this.Jt = {}; this.dB = {}; this.Tl = 0; this.dG = new PCCViewer.SearchRequest(); var K = this; this.adO = function () { var RN = []; for (var G = 0; G < K.Jt.searchTerms.length; G++) { var aP = K.Jt.searchTerms[G]; var qN = IPCC.J.NQ(aP.type); var Ro; switch (qN) { case 'proximity': var AH = { zW: aP, dB: [], type: aP.type, highlightColor: this.aaR(aP.highlightColor), distance: aP.distance, contextPadding: aP.contextPadding }; for (var x = 0; x < aP.terms.length; x++) { var Xh = aP.terms[x]; Ro = this.akZ(Xh); AH.dB = AH.dB.concat(Ro); } RN.push(AH); break; default: Ro = this.akZ(aP); RN = RN.concat(Ro); break; } } return RN; }; this.akZ = function (aP) { var fc = []; var dB = {}; if (aP.matchingOptions.exactPhrase === false && aP.searchTermIsRegex === false) { var BH = aP.searchTerm.split(' '); for (var aj = 0; aj < BH.length; aj++) { dB = {}; if (BH[aj].length < 0) { continue; } dB.searchText = BH[aj]; dB.zW = aP; if (aP.matchingOptions.matchWholeWord) { dB.searchTerm = this.apV(this.Gg(BH[aj]), aP.matchingOptions); } else { if (aP.matchingOptions.wildcard === true) { dB.searchTerm = this.akr(this.Gg(BH[aj]), aP.matchingOptions); } else if (aP.matchingOptions.beginsWith === true || aP.matchingOptions.endsWith === true) { dB.searchTerm = this.akn(this.Gg(BH[aj]), aP.matchingOptions); } else { dB.searchTerm = this.akD(BH[aj], aP.matchingOptions, false); } } dB.highlightColor = this.aaR(aP.highlightColor); fc.push(dB); } } else { dB = {}; dB.searchText = aP.searchTerm; dB.zW = aP; if (aP.matchingOptions.matchWholeWord) { dB.searchTerm = this.apV(this.Gg(aP.searchTerm), aP.matchingOptions); } else { if (aP.matchingOptions.wildcard === true) { dB.searchTerm = this.akr(this.Gg(aP.searchTerm), aP.matchingOptions); } else if (aP.matchingOptions.beginsWith === true || aP.matchingOptions.endsWith === true) { dB.searchTerm = this.akn(this.Gg(aP.searchTerm), aP.matchingOptions); } else { dB.searchTerm = this.akD(aP.searchTerm, aP.matchingOptions, aP.searchTermIsRegex); } } dB.highlightColor = this.aaR(aP.highlightColor); fc.push(dB); } return fc; }; this.apV = function (vI, pQ) { var wi = new RegExp('\\b' + vI + '\\b', this.wV(pQ.matchCase)); return wi; }; this.akn = function (vI, pQ) { if (pQ.beginsWith) { return new RegExp("\\b" + vI + '(\\w+)', this.wV(pQ.matchCase)); } if (pQ.endsWith) { vI = vI.replace("*", ""); return new RegExp('(\\w+)' + vI + "\\b", this.wV(pQ.matchCase)); } }; this.Gg = function (vI) { return vI.replace(/([.?*+^$[\]\\(){}|-])/g, "\\$1"); }; this.akr = function (xa, pQ) { xa = xa.replace(/[*]{2,}/g, '*').replace(/(\\\*){2,}/g, '\\*'); if (xa === '\\*') { var bX = new Error("The search term must contain one or more non-wildcard characters."); bX.ayz = true; throw bX; } xa = xa.replace(/\\\?/g, '.'); var fX = this.Mz(xa); var Xi, Un, wi, aaZ; var Ml = xa.substring(0, 1); for (var G = 0; G < fX.length; ++G) { if (G > 0) { Xi = fX.substring(G - 1, G); } Ml = fX.substring(G, G + 1); if (G < fX.length) { Un = fX.substring(G + 1, G + 2); } if (G === 0) { if (Ml === '*' && Un === " " || Ml === '*' && Un === "*") { fX = fX.substring(2, fX.length); } } if (G + 1 === fX.length) { if (Ml === '*' && Xi === " " || Ml === '*' && Xi === "*") { fX = fX.substring(0, fX.length - 2); } } } fX = fX.replace(/^\s+|\s+$/g, ''); var apF = fX.indexOf('*'); if (apF === 1) { fX = fX.replace(/\\\*/g, '\\S*') + '\\S*'; } else if (apF === fX.length - 1) { fX = '\\S*' + fX.replace(/\\\*/g, '\\S*'); } else { if (pQ.exactPhrase === false) { fX = fX.replace(/\\\*/g, '.*?'); } else { fX = fX.replace(/\\\*/g, '\\S*'); } } wi = new RegExp(fX, this.wV(pQ.matchCase)); if (fX.substring(0, 1) !== '*' && aaZ !== '*') { wi = new RegExp('\\b' + fX + '\\b', this.wV(pQ.matchCase)); } if (fX.substring(0, 1) === '*' && aaZ !== '*') { wi = new RegExp(fX + '\\b', this.wV(pQ.matchCase)); } if (fX.substring(0, 1) !== '*' && aaZ === '*') { wi = new RegExp('\\b' + fX, this.wV(pQ.matchCase)); } return wi; }; this.Mz = function (vI) { return vI.replace(/\ /g, '\\s+'); }; this.akD = function (RR, matchingOptions, isRegex) { var vz = ''; if (isRegex === true) { vz = this.Mz(RR); } else if (matchingOptions.wildcard === true) { vz = RR.replace(/[-[\]{}()+,^$|#]/g, "\\$&"); vz = this.Mz(vz); } else if (matchingOptions.exactPhrase) { vz = RR.replace(/[-[\]{}()*+?.,\\^$|#]/g, "\\$&"); vz = this.Mz(vz); } else { vz = RR.replace(/[-[\]{}()*+?.,\\^$|#]/g, "\\$&"); } var aBo = vz.replace(/'/g, '[\'|‘|’]').replace(/"/g, '["|“|”]'); return new RegExp(aBo, this.wV(matchingOptions.matchCase)); }; this.wV = function (matchCase) { if (matchCase) { return 'gm'; } else { return 'igm'; } }; this.aJc = function (xa) { var wi = new RegExp('\\b' + xa + '\\b', K.wV()); return wi; }; var agD = ["#1c86ee", "#ff8c00", "#9932cc", "#FFBA00", "#00c5cd", "#ee3a8c", "#4169e1", "#00cd00", "#6959cd", "#ff4500"]; this.aaR = function (dU) { if (!dU) { return agD[K.Tl++ % agD.length]; } else { return dU; } }; this.Vj = function (dX) { if (typeof dX === 'string') { dX = { searchTerms: [{ searchTerm: dX, highlightColor: undefined, contextPadding: 25, searchTermIsRegex: false, matchingOptions: { exactPhrase: true, matchCase: false, matchWholeWord: false, beginsWith: false, endsWith: false, wildcard: false } }] }; return dX; } IPCC.J.forEach(dX.searchTerms, function (aP) { if (!aP.matchingOptions) { aP.matchingOptions = {}; } var qN = IPCC.J.NQ(aP.type); switch (qN) { case 'proximity': IPCC.J.forEach(aP.terms, function (Xh) { K.aob(Xh); }); break; default: K.aob(aP); break; } }); return dX; }; this.aob = function (aP) { if (typeof aP.contextPadding === "undefined") { aP.contextPadding = 25; } if (typeof aP.searchTermIsRegex === "undefined") { aP.searchTermIsRegex = false; } if (typeof aP.matchingOptions === "undefined") { aP.matchingOptions = {}; } if (!aP.matchingOptions.hasOwnProperty('matchCase')) { aP.matchingOptions.matchCase = false; } if (!aP.matchingOptions.hasOwnProperty('exactPhrase')) { aP.matchingOptions.exactPhrase = true; } if (!aP.matchingOptions.hasOwnProperty('matchWholeWord')) { aP.matchingOptions.matchWholeWord = false; } if (!aP.matchingOptions.hasOwnProperty('beginsWith')) { aP.matchingOptions.beginsWith = false; } if (!aP.matchingOptions.hasOwnProperty('endsWith')) { aP.matchingOptions.endsWith = false; } if (!aP.matchingOptions.hasOwnProperty('wildcard')) { aP.matchingOptions.wildcard = false; } if (typeof aP.highlightColor !== 'undefined') { try { IPCC.ad.dU(aP.highlightColor, "selectText"); } catch (e) { aP.highlightColor = undefined; } } }; this.aAm = function () { return K.dB; }; this.afY = function (e) { K.dG.cT = e.message; K.dG.je = "1010"; K.dG.wo = true; setTimeout(function () { K.dG.trigger("SearchFailed", { errorMessage: (e.message) }); }, 10); setTimeout(function () { K.dG.trigger("SearchCompleted", { completedSearchResults: (K.vy) }); }, 10); return K.dG; }; this.xe = function (dX, bE) { this.dB = {}; this.Jt = dX; this.aP = dX; this.Tl = 0; var xe = new PCCViewer.afe(); try { K.dB = this.adO(); return xe.aaU(bE, K.dB, dX, K.dG); } catch (e) { return K.afY(e); } }; this.Gk = function (dX, bE) { this.dB = {}; this.Jt = dX; this.aP = dX; this.Tl = 0; var Gk = new PCCViewer.aGP(); try { K.dB = this.adO(); return Gk.aaU(bE, K.dB, dX, K.dG); } catch (e) { return K.afY(e); } }; }; PCCViewer._Search.prototype.zU = function (searchQuery) { this.dB = {}; this.dG = new PCCViewer.SearchRequest(); this.Jt = searchQuery; this.dG.dX = searchQuery; this.aP = searchQuery; this.Tl = 0; return this.dG; }; PCCViewer.SearchTask = function (searchQuery) { this.afS(searchQuery); var _search = new PCCViewer._Search(); searchQuery = _search.Vj(searchQuery); this.dG = _search.zU(searchQuery); try { _search.dB = _search.adO(); } catch (e) { if (e.ayz) { throw new Error(e.message); } else { throw new Error(e.message); } } var xe = new PCCViewer.afe(); this.search = function (text) { xe.vy = []; xe.dJ = 0; xe.dB = _search.dB; xe.avE(text); return xe.vy; }; }; PCCViewer.SearchTask.prototype.afS = function (searchQuery) { if (typeof searchQuery === 'string') { return; } var BB; if (searchQuery && searchQuery.searchTerms && Object.prototype.toString.call(searchQuery.searchTerms) === '[object Array]') { BB = searchQuery.searchTerms; } else { throw new Error('The `searchQuery` parameter is not a string, or a search terms array was not present in the search query.'); } IPCC.J.forEach(BB, function (ws, G) { var qN = ws.type ? IPCC.J.trim(ws.type).toLowerCase() : undefined; switch (qN) { case 'proximity': IPCC.J.forEach(ws.terms, function (aCk, aY) { if (!amq(aCk)) { throw new Error("Search term index " + aY + " under Proximity search term index " + G + " does not have a valid `searchTerm` string property."); } }); break; default: if (!amq(ws)) { throw new Error("Search term index " + G + " does not have a valid `searchTerm` string property."); } break; } }); function amq(ws) { return (typeof ws.searchTerm === 'string'); } }; })(PCCViewer || {}); (function (PCCViewer) { function ara(bE, aD) { var bI = bE.dP.jb(aD); var gs = bI.cv(); return gs.FF(); }; function apZ(bE, aD) { var bI = bE.dP.jb(aD); var gs = bI.cv(); var Lq = gs.gl(); return Lq.aAn(); }; function auO(BQ, awK) { var dg = BQ.length; if (dg === 0) { return false; } if (dg !== awK) { return false; } for (var G = 0; G < dg; G++) { if (BQ[G] !== true) { return false; } } return true; }; PCCViewer.afe = function () { var K = this; this.IV = false; this.BQ = []; this.vy = []; this.Es = []; this.apb = 0; this.dJ = 0; this.hV = false; function uv(Kg, adu) { switch (Kg) { case 'failed': setTimeout(function () { K.dG.trigger('SearchFailed', adu); }, 10); break; case 'complete': K.dG.fc = K.vy; K.dG.Ye = K.Es; K.dG.wo = true; setTimeout(function () { K.dG.trigger('SearchResultsAvailable', { completedSearchResults: (K.vy) }); }, 10); break; case 'cancelled': break; } setTimeout(function () { K.dG.trigger('SearchCompleted', { completedSearchResults: (K.vy) }); }, 10); }; function aDU() { K.dG.cT = 'Unable to communicate with server, please retry loading the document.'; K.dG.je = '1011'; K.dG.wo = true; uv('failed', { errorMessage: ('Unable to communicate with server, please retry loading the document.') }); K.hV = true; }; function aja(aH, aCR) { var aCF = IPCC.J.trim(aH.type || '').toLowerCase(); var bM; switch (aCF) { case 'taskresult': bM = new PCCViewer.SearchTaskResult(); break; default: bM = new PCCViewer.SearchResult(); break; } IPCC.J.extend(bM, aCR); var afq = bM.rI + bM.text.length - 1; var ca = PCCViewer.BL.formatter.getContext({ text: aH.searchText, startIndex: bM.rI, endIndex: afq, padding: bM.aP.contextPadding }); bM.ca = ca.context; bM.CP = ca.startIndex; if (aH.rectangles) { var aeH = { rectangles: aH.rectangles, startIndex: bM.rI, endIndex: afq }; bM.nV = PCCViewer.BL.formatter.getBoundingRectangle(aeH); bM.bV = PCCViewer.BL.formatter.getLineRectangles(aeH); } return bM; }; function ajN(nT, AH, Lh, gp, gT) { var Mf = []; var aas = !gp; var oE = AH.distance; var BB = []; IPCC.J.forEach(AH.dB, function (dB) { BB.push(dB.searchTerm); }); var aDs = PCCViewer.BL.proximity.getResults(Lh, BB, oE); IPCC.J.forEach(aDs, function (bM) { var eg = aja({ type: aas ? 'TaskResult' : 'Result', searchText: Lh, rectangles: gp }, { gT: gT, aP: AH.zW, nT: nT, rN: AH.highlightColor, rI: bM.startIndex, az: bM.text }); Mf.push(eg); }); return Mf; }; function QE(nT, dB, Lh, gp, gT) { var aas = !gp; var Mf = []; var RI = [dB.searchTerm]; var fc = PCCViewer.BL.regex.getResults(Lh, RI); IPCC.J.forEach(fc, function (bM) { var eg = aja({ type: aas ? 'TaskResult' : 'Result', searchText: Lh, rectangles: gp }, { gT: gT, nT: nT, dB: dB, aP: dB.zW, rI: bM.startIndex, az: bM.text, rN: dB.highlightColor }); Mf.push(eg); }); return Mf; }; function atp(apq, aD, bE, gp) { var Xf = []; var nT = Date.now(); IPCC.J.forEach(K.dB, function (dB, G) { var fc; var qN = IPCC.J.NQ(dB.type); var bI = bE.dP.jb(aD); var gT = { width: bI.kO(), height: bI.iE() }; switch (qN) { case 'proximity': fc = ajN(nT, dB, apq, gp, gT); break; default: fc = QE(nT, dB, apq, gp, gT); break; } IPCC.J.forEach(fc, function (bM) { bM.fg = K.dJ; bM.bp = aD + 1; bM.KH = bE.get_documentIdentifier(); K.vy[K.dJ] = bM; K.dJ++; Xf.push(bM); }); }); K.dG.fc = K.vy; if (Xf.length) { setTimeout(function () { K.dG.trigger('PartialSearchResultsAvailable', { partialSearchResults: (Xf), pagesWithoutText: (K.Es) }); }, 10); } }; function auy(az) { var nT = Date.now(); IPCC.J.forEach(K.dB, function (dB, G) { var qN = IPCC.J.NQ(dB.type); var fc; switch (qN) { case 'proximity': fc = ajN(nT, dB, az); break; default: fc = QE(nT, dB, az); break; } IPCC.J.forEach(fc, function (bM) { bM.fg = K.dJ; K.vy[K.dJ] = bM; K.dJ++; }); }); K.dG.fc = K.vy; }; function acD(CW, bE) { for (var G = 0; G < CW.length; G++) { if (K.BQ[CW[G]] === false) { K.BQ[CW[G]] = true; var az = ara(bE, CW[G]); var gp = apZ(bE, CW[G]); if (!az && az !== null) { K.Es[K.apb] = CW[G]; K.apb++; continue; } atp(az, CW[G], bE, gp); if (K.dG.rA) { if (K.IV) { uv('cancelled'); K.IV = false; bE.remove_textPagesReceived(Tz); return; } break; } } } if (auO(K.BQ, bE.eD) && !K.dG.wo) { uv('complete'); K.IV = false; bE.remove_textPagesReceived(Tz); } }; function Tz(sender, L) { if (L.error === -1) { aDU(); return K.dG; } try { if (K.hV === false) { acD(L.textPagesReceived, sender); } } catch (e) { K.dG.cT = e.message; K.dG.je = '1010'; K.dG.wo = true; uv('failed', { errorMessage: (e.message) }); K.hV = true; return K.dG; } }; this.aaU = function (bE, dB, dX, dG) { K.dB = dB; K.dG = dG; K.dG.dX = dX; K.dG.on('SearchCancelled', function () { uv('cancelled'); K.IV = false; bE.remove_textPagesReceived(Tz); }); for (var G = 0; G < bE.eD; G++) { K.BQ[G] = false; } if (bE.akG().fb() > bE.get_numberOfPagesWithText()) { K.IV = true; bE.add_textPagesReceived(Tz); } if (bE.get_numberOfPagesWithText() > 0) { acD(bE.get_pagesWithText(), bE); } return K.dG; }; this.avE = function (az) { this.dG = new PCCViewer.SearchRequest(); try { auy(az); } catch (e) { K.dG.cT = e.message; K.dG.je = '1010'; return; } }; }; }(PCCViewer || {})); (function (PCCViewer) { function apJ(dX) { var BB = dX.map(function (aP, ajQ) { if (aP.type === 'proximity') { return { type: 'proximity', distance: aP.distance, subTerms: aP.dB.map(function (akF) { return { pattern: akF.searchTerm.source, caseSensitive: akF.zW.matchingOptions.matchCase }; }), termId: ajQ.toString(), contextPadding: aP.contextPadding }; } return { type: 'simple', pattern: aP.searchTerm.source, caseSensitive: aP.zW.matchingOptions.matchCase, termId: ajQ.toString(), contextPadding: aP.contextPadding }; }); return { input: { searchTerms: BB } }; }; PCCViewer.aGP = function () { var K = this; var zU, abj, afG; var Pf = []; this.DR = false; this.Ee = {}; this.Es = []; function apz() { var awj = abj ? '&continueToken=' + abj : ''; return K.bE.np + '/v2/searchTasks/' + zU.processId + '/results?limit=100' + awj; }; function ayZ(fc) { var RI = K.Ee.input.searchTerms.reduce(function (sp, ws) { sp[ws.termId] = K.dB[ws.termId]; return sp; }, {}); return fc.map(function (bM) { var eg = new PCCViewer.SearchResult(); eg.nV = bM.boundingRectangle; eg.ca = bM.context; eg.CP = bM.startIndexInContext; eg.nT = bM.id; eg.dB = K.dB; eg.bV = bM.lineRectangles; eg.gT = bM.pageData; eg.rI = bM.startIndex; eg.az = bM.text; eg.bp = bM.pageIndex + 1; eg.fg = bM.id; eg.KH = K.bE.get_documentIdentifier(); eg.aP = RI[bM.searchTerm.termId].zW; eg.rN = RI[bM.searchTerm.termId].highlightColor; return eg; }); }; function uv(Kg, adu) { switch (Kg) { case 'failed': setTimeout(function () { K.dG.trigger(PCCViewer.EventType.SearchFailed, adu); }, 10); break; case 'complete': K.dG.Ye = K.Es; K.dG.wo = true; setTimeout(function () { K.dG.trigger(PCCViewer.EventType.SearchResultsAvailable, { completedSearchResults: (K.dG.getResults()) }); }, 10); break; case 'cancelled': break; } setTimeout(function () { K.dG.trigger(PCCViewer.EventType.SearchCompleted, { completedSearchResults: (K.dG.getResults()) }); }, 10); }; function ayg(mY) { var am = K.bE.np + '/v2/viewingSessions/' + encodeURIComponent(K.bE.get_documentIdentifier()) + '/searchTasks'; function fa(bF) { var bM = JSON.parse(bF.responseText); zU = bM; if (Pf.length) { Pf.forEach(function (Fp) { Fp(); }); } Pf = []; mY(); }; function eZ(au) { K.dG.off('SearchCancelled', K.agZ); K.dG.cT = 'The request to create a search task failed.'; var aIh = au && au.response && au.response.status === 501; var aAi = au && au.response && au.response.status === 480 && (function (asQ) { try { return JSON.parse(asQ).errorCode === 'FeatureDisabled'; } catch (e) { return false; } }(au.response.responseText)); if (aIh || aAi) { K.dG.je = 'ServerSearchUnavailable'; K.dG.cT = 'Server-side search is not available.'; uv('failed', { errorMessage: K.dG.cT }); return; } uv('failed', { errorMessage: K.dG.cT }); }; PCCViewer.Ajax.dZ({ url: am, method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(K.Ee) }).then(fa, eZ); }; function QE(mY) { var am = apz(); var hY = {}; if (zU.affinityToken) { hY['Accusoft-Affinity-Token'] = zU.affinityToken; } if (!K.DR) { return; } function fa(bF) { if (!K.DR) { return; } var bM = JSON.parse(bF.responseText); var WS = ayZ(bM.results); K.Es = bM.pagesWithoutText; K.dG.fc.push.apply(K.dG.fc, WS); if (WS.length) { setTimeout(function () { IPCC.J.forEach(WS.reduce(function (sp, bM) { var cO = bM.bp; if (!sp[cO]) { sp[cO] = []; } sp[cO].push(bM); return sp; }, {}), function (fc, cO) { K.dG.trigger('PartialSearchResultsAvailable', { partialSearchResults: fc, pagesWithoutText: K.Es }); }); }, 10); } if (bM.continueToken) { abj = bM.continueToken; afG = bM.continueAfter; mY(); } else if (K.DR) { uv('complete'); } }; function eZ(bM) { if (!K.DR) { return; } K.DR = false; K.dG.cT = 'The request to poll the search task failed.'; K.dG.wo = true; uv('failed', { errorMessage: K.dG.cT }); }; PCCViewer.Ajax.dZ({ method: 'GET', url: am, headers: hY }).then(fa, eZ); }; function aAt() { (function azP() { setTimeout(function () { QE(azP); }, afG || 0); }()); }; function agZ() { uv('cancelled'); K.DR = false; function ajP() { }; if (!zU) { Pf.push(ajP); return; } ajP(); }; this.aaU = function (bE, dB, dX, dG) { K.bE = bE; K.dB = dB; K.dG = dG; K.dG.dX = dX; K.Ee = apJ(K.dB); K.DR = true; K.dG.on('SearchCancelled', agZ); ayg(function () { aAt(); }); return K.dG; }; }; })(PCCViewer || {}); var PCCViewer = window.PCCViewer || {}; PCCViewer.SearchRequest = function (KV) { this.ln = {}; this.dX = {}; this.fc = []; this.wo = false; this.je = null; this.cT = null; this.Ye = []; if (Object.defineProperties) { Object.defineProperties(this, { "searchQuery": { configurable: ! !KV, enumerable: true, get: function () { return this.dX; } }, "results": { configurable: ! !KV, enumerable: true, get: function () { return this.fc; } }, "isComplete": { configurable: ! !KV, enumerable: true, get: function () { return this.wo; } }, "errorCode": { configurable: ! !KV, enumerable: true, get: function () { return this.je; } }, "errorMessage": { configurable: ! !KV, enumerable: true, get: function () { return this.cT; } } }); } PCCViewer.EventEmitter.extend(this); }; PCCViewer.SearchRequest.prototype.getSearchQuery = function () { return this.dX; }; PCCViewer.SearchRequest.prototype.getResults = function () { return this.fc; }; PCCViewer.SearchRequest.prototype.getIsComplete = function () { return this.wo; }; PCCViewer.SearchRequest.prototype.getErrorCode = function () { return this.je; }; PCCViewer.SearchRequest.prototype.getErrorMessage = function () { return this.cT; }; PCCViewer.SearchRequest.prototype.getPagesWithoutText = function () { return this.Ye; }; PCCViewer.SearchRequest.prototype.cancel = function () { this.rA = true; this.trigger('SearchCancelled'); }; var PCCViewer = window.PCCViewer || {}; PCCViewer.SearchResult = function () { this.fg = 0; this.bp = 0; this.bh = 0; this.az = ''; this.rN = ''; this.rI = 0; this.ca = ''; this.CP = 0; this.aP = ''; this.KH = ''; this.nV = null; }; PCCViewer.SearchResult.prototype.getId = function () { return this.fg; }; PCCViewer.SearchResult.prototype.getPageNumber = function () { return this.bp; }; PCCViewer.SearchResult.prototype.getText = function () { return this.az; }; PCCViewer.SearchResult.prototype.getHighlightColor = function () { return this.rN; }; PCCViewer.SearchResult.prototype.getStartIndexInPage = function () { return this.rI; }; PCCViewer.SearchResult.prototype.getContext = function () { return this.ca; }; PCCViewer.SearchResult.prototype.getStartIndexInContext = function () { return this.CP; }; PCCViewer.SearchResult.prototype.getSearchTerm = function () { return this.aP; }; PCCViewer.SearchResult.prototype.getBoundingRectangle = function () { return this.nV; }; if (Object.defineProperties) { Object.defineProperties(PCCViewer.SearchResult.prototype, { "pageNumber": { enumerable: true, get: function () { return this.bp; } }, "id": { enumerable: true, get: function () { return this.fg; } }, "text": { enumerable: true, get: function () { return this.az; } }, "highlightColor": { enumerable: true, get: function () { return this.rN; } }, "startIndexInPage": { enumerable: true, get: function () { return this.rI; } }, "context": { enumerable: true, get: function () { return this.ca; } }, "startIndexInContext": { enumerable: true, get: function () { return this.CP; } }, "searchTerm": { enumerable: true, get: function () { return this.aP; } }, "boundingRectangle": { enumerable: true, get: function () { return this.getBoundingRectangle(); } } }); } PCCViewer.SearchTaskResult = function () { this.fg = 0; this.bh = 0; this.az = ''; this.rN = ''; this.rI = 0; this.ca = ''; this.CP = 0; this.aP = ''; }; PCCViewer.SearchTaskResult.prototype.getId = function () { return this.fg; }; PCCViewer.SearchTaskResult.prototype.getText = function () { return this.az; }; PCCViewer.SearchTaskResult.prototype.getHighlightColor = function () { return this.rN; }; PCCViewer.SearchTaskResult.prototype.getStartIndexInInput = function () { return this.rI; }; PCCViewer.SearchTaskResult.prototype.getContext = function () { return this.ca; }; PCCViewer.SearchTaskResult.prototype.getStartIndexInContext = function () { return this.CP; }; PCCViewer.SearchTaskResult.prototype.getSearchTerm = function () { return this.aP; }; if (Object.defineProperties) { Object.defineProperties(PCCViewer.SearchTaskResult.prototype, { "id": { enumerable: true, get: function () { return this.fg; } }, "text": { enumerable: true, get: function () { return this.az; } }, "highlightColor": { enumerable: true, get: function () { return this.rN; } }, "startIndexInInput": { enumerable: true, get: function () { return this.rI; } }, "context": { enumerable: true, get: function () { return this.ca; } }, "startIndexInContext": { enumerable: true, get: function () { return this.CP; } }, "searchTerm": { enumerable: true, get: function () { return this.aP; } } }); } (function (PCCViewer) { PCCViewer.BurnRequest = function (aH) { this.pY = ""; this.dW = ""; this.mU = 0; this.rM = ""; this.je = ""; this.uz = 0; this.gk = false; this.uw = 0; this.VF = ""; this.rA = false; this.aT = PCCViewer.Deferred(); this.cZ = this.aT.getPromise(); this.then = this.cZ.then; this.aH = aH; this.je = null; this.gY = undefined; this.uY = false; this.OR = null; PCCViewer.EventEmitter.extend(this); var K = this; if (aH.pD) { var pD = new PCCViewer.Error(aH.pD.code, aH.pD.message); delete K.aH.pD; setTimeout(function () { K.trigger(PCCViewer.BurnRequest.EventType.BurnCancelled, {}); K.trigger(PCCViewer.BurnRequest.EventType.BurnFailed, {}); K.je = pD.code; K.aT.reject(pD); }, 0); } }; PCCViewer.BurnRequest.EventType = { BurnProgress: "BurnProgress", BurnCompleted: "BurnCompleted", BurnFailed: "BurnFailed", BurnCancelled: "BurnCancelled", BurnWorkerCreated: "BurnWorkerCreated" }; PCCViewer.BurnRequest.prototype.cancel = function () { var K = this; this.rA = true; this.je = "User Cancelled"; setTimeout(function () { K.trigger(PCCViewer.BurnRequest.EventType.BurnCancelled, {}); K.trigger(PCCViewer.BurnRequest.EventType.BurnFailed, {}); K.aT.reject(new PCCViewer.Error("UserCancelled", "User Cancelled")); }, 0); return this; }; PCCViewer.BurnRequest.prototype.getProgress = function () { return this.mU; }; PCCViewer.BurnRequest.prototype.getWorkerID = function () { return this.pY; }; PCCViewer.BurnRequest.prototype.getOptions = function () { return this.aH; }; PCCViewer.BurnRequest.prototype.getErrorCode = function () { return this.je; }; PCCViewer.BurnRequest.prototype.getBurnedDocumentDownloadURL = function () { return this.OR; }; PCCViewer.BurnRequest.prototype.aGs = function (kI) { this.VF = kI; }; PCCViewer.BurnRequest.prototype.Qz = function (gY) { this.gY = gY; }; PCCViewer.BurnRequest.prototype.Zq = function () { var K = this; this.je = "Failure to generate Markup XML"; setTimeout(function () { K.trigger(PCCViewer.BurnRequest.EventType.BurnFailed, {}); K.aT.reject(new PCCViewer.Error("MarkupXMLFail", K.je)); }, 0); return this; }; PCCViewer.BurnRequest.prototype.DG = function () { function fa(bF) { var gM, bM; try { gM = bF.responseText; if (!gM) { setTimeout(function () { K.trigger(PCCViewer.BurnRequest.EventType.BurnFailed, {}); K.aT.reject(new PCCViewer.Error("ResponseEmpty", "Empty/invalid response from the server")); }, 0); K.uY = true; return; } else { if (typeof JSON !== 'undefined') { bM = JSON.parse(gM); } else { bM = IPCC.ct.pG(gM); } setTimeout(function () { azs(bM); }, 0); } } catch (e) { setTimeout(function () { K.trigger(PCCViewer.BurnRequest.EventType.BurnFailed, {}); K.aT.reject(new PCCViewer.Error("BurnFailErrorCode", "Burn process failed, error: " + e.message)); }, 0); K.uY = true; return; } }; function eZ(bM) { K.gk = false; var aw = bM.response.status + " " + bM.response.statusText; setTimeout(function () { K.trigger(PCCViewer.BurnRequest.EventType.BurnFailed, {}); K.aT.reject(new PCCViewer.Error("StatusCode", "Status Code " + aw)); }, 0); K.uY = true; return; }; try { if (!this.VF) { throw new Error("XMl Markup data for burn is missing"); } var K = this; var apY = function () { var VA; if (!(/^[\x00-\x7F]*$/.test(K.gY.bE.get_documentIdentifier()))) { VA = K.gY.aH.imageHandlerUrl + '/ViewingSession/e' + K.gY.aH.documentID + '/MarkupBurner/' + K.pY; } else { VA = K.gY.aH.imageHandlerUrl + '/ViewingSession/u' + encodeURIComponent(K.gY.aH.documentID) + '/MarkupBurner/' + K.pY; } PCCViewer.Ajax.dZ({ method: 'GET', url: VA, headers: { 'Content-Type': 'application/json' } }).then(fa, eZ); }; var azs = function (ge) { if (ge) { if (K.rA === true) { K.gk = false; return; } if (ge.percentComplete >= 0 && K.gk === true) { if (ge.percentComplete === 100 && ge.state === 'complete') { if (ge.processId) { K.gk = false; K.pY = ge.processId; K.dW = ge.state; K.uz += 1; K.uw = 1000; K.mU = +(ge.percentComplete); var Iv; if (!(/^[\x00-\x7F]*$/.test(K.gY.bE.get_documentIdentifier()))) { Iv = K.gY.aH.imageHandlerUrl + '/ViewingSession/e' + K.gY.aH.documentID + '/MarkupBurner/' + K.pY + "/Document"; } else { Iv = K.gY.aH.imageHandlerUrl + '/ViewingSession/u' + encodeURIComponent(K.gY.aH.documentID) + '/MarkupBurner/' + K.pY + "/Document"; } if (K.aH.filename) { Iv += "?ContentDispositionFilename=" + K.aH.filename; } K.OR = Iv; K.uY = true; var aHp = +(ge.percentComplete); setTimeout(function () { K.trigger(PCCViewer.BurnRequest.EventType.BurnCompleted, {}); K.trigger(PCCViewer.BurnRequest.EventType.BurnProgress, { progress: aHp }); K.aT.resolve(Iv); }, 10); return; } } else { if (ge.state === 'error') { K.gk = false; K.je = ge.errorCode; setTimeout(function () { K.trigger(PCCViewer.BurnRequest.EventType.BurnFailed, {}); K.aT.reject(new PCCViewer.Error("BurnFailError", "BurnProcess failed, errorCode: " + K.je)); }, 0); K.gk = false; K.uY = true; return; } if (ge.processId) { var WA = +(ge.percentComplete); if (K.mU !== WA) { setTimeout(function () { K.trigger(PCCViewer.BurnRequest.EventType.BurnProgress, { progress: WA }); }, 10); } if (!K.pY) { K.pY = ge.processId; setTimeout(function () { K.trigger(PCCViewer.BurnRequest.EventType.BurnWorkerCreated, {}); }, 0); K.dW = ge.state; K.uz = 1; K.gk = true; K.uw = 1000; K.mU = +(ge.percentComplete); } if (ge.percentComplete < 100) { if (K.uz > 1) { K.uw += 1000; } K.uz += 1; K.dW = ge.state; K.mU = +(ge.percentComplete); if (K.gk === true && K.rA === false && K.uY === false) { setTimeout(apY, K.uw); } } } } } else { if (K.uY === false) { var Wf = false; if (K.gk === false) { if (ge.state === 'complete') { if (!K.OR) { Wf = true; } else { K.uY = true; setTimeout(function () { K.trigger(PCCViewer.BurnRequest.EventType.BurnCompleted, {}); K.aT.resolve(K.OR); }, 10); return; } } if (ge.state === 'processing' && ge.errorCode === null) { if (ge.percentComplete >= 0 && ge.percentComplete < 100) { if (K.uz > 1) { K.uw += 1000; } K.uz += 1; K.gk = true; K.dW = ge.state; K.mU = +(ge.percentComplete); if (K.gk === true && K.rA === false) { setTimeout(apY, K.uw); } } else { Wf = true; } } if (ge.state === 'error' || Wf === true) { K.gk = false; K.je = ge.errorCode; setTimeout(function () { K.trigger(PCCViewer.BurnRequest.EventType.BurnFailed, {}); K.aT.reject(new PCCViewer.Error("BurnFailError", "BurnProcess failed, errorCode: " + ge.errorCode)); }, 0); K.gk = false; K.uY = true; return; } } } } } }; var am; if (!(/^[\x00-\x7F]*$/.test(K.gY.bE.get_documentIdentifier()))) { am = K.gY.aH.imageHandlerUrl + '/ViewingSession/e' + K.gY.aH.documentID + '/MarkupBurner'; } else { am = K.gY.aH.imageHandlerUrl + '/ViewingSession/u' + encodeURIComponent(K.gY.aH.documentID) + '/MarkupBurner'; } if (K.aH.removeFormFields) { am += '?RemoveFormFields=acroform'; } PCCViewer.Ajax.dZ({ method: 'POST', url: am, headers: { 'Content-Type': 'application/xml' }, body: K.VF }).then(fa, eZ); K.gk = true; } catch (e) { this.gk = false; var aO = this, hb = e.message; setTimeout(function () { aO.trigger(PCCViewer.BurnRequest.EventType.BurnFailed, {}); aO.aT.reject(new PCCViewer.Error("BurnFailErrorCode", "The burn process failed, error: " + hb)); }, 0); this.uY = true; } }; if (Object.defineProperties) { Object.defineProperties(PCCViewer.BurnRequest.prototype, { "options": { enumerable: true, get: function () { return this.getOptions(); } }, "progress": { enumerable: true, get: function () { return this.getProgress(); } }, "workerID": { enumerable: true, get: function () { return this.getWorkerID(); } }, "errorCode": { enumerable: true, get: function () { return this.getErrorCode(); } }, "burnedDocumentDownloadURL": { enumerable: true, get: function () { return this.getBurnedDocumentDownloadURL(); } } }); } })(PCCViewer || {}); (function (PCCViewer) { var Zl = function () { }, oj = { aeJ: 0, aFT: 1, azT: 2 }; PCCViewer.ThumbnailControl = function (domElement, viewerControl) { if (!domElement || !IPCC.J.yP(domElement)) { throw new Error('The "domElement" parameter is not a valid HTML Element'); } if (!viewerControl || !(viewerControl instanceof PCCViewer.ViewerControl)) { throw new Error('The "viewerControl" parameter is not a valid PCCViewer.ViewerControl object'); } var K = this; this.oj = oj.aeJ; this.aH = viewerControl.aH; this._debug = ! !this.aH.debug; this.PW = "Single"; this.LA = []; this.sz = {}; if (!this.cL) { this.cL = viewerControl; } else { throw new Error("This instance of thumbnail already is attached to a ViewerControl."); } PCCViewer.EventEmitter.extend(this); this.aG = domElement; if (viewerControl.rj) { K.oj = oj.azT; K.WR(viewerControl.getPageCount()); K.Xc(K.aG); } else { K.oj = oj.aFT; K.WR(1, 0); viewerControl.on('PageCountReady', function () { K.WR(viewerControl.getPageCount(), 1); K.Xc(K.aG); }); } viewerControl.on('PageRotated', function (au) { IPCC.J.forEach(K.sz, function (dw) { if (dw.aD === (au.pageNumber - 1)) { if (dw.AG === true) { K.YS(dw); } } }); }); viewerControl.on('DocumentRotated', function (au) { IPCC.J.forEach(K.sz, function (dw) { if (dw.AG === true) { K.YS(dw); } }); }); }; PCCViewer.ThumbnailControl.prototype.getViewerControl = function () { return this.cL; }; PCCViewer.ThumbnailControl.prototype.WR = function (eD, gL) { gL = gL || 0; var K = this, NB = document.createDocumentFragment(); for (var i = gL; i < eD; i++) { var _parent = document.createElement('div'); _parent.className = 'pccThumbnailWrapper'; var ck = document.createElement('div'); ck.className = 'pccThumbnail'; var rz = document.createElement('div'); rz.className = 'pccThumbnailView'; rz.id = 'pcc-thumbnailPage-' + i + '-' + IPCC.FA(); ck.appendChild(rz); _parent.appendChild(ck); NB.appendChild(_parent); K.sz[i] = { XQ: _parent, aS: ck, rz: rz, aD: i, ao: {}, AG: false, kL: 0, kT: 0, ce: 0 }; } IPCC.J.forEach(K.sz, function (dw) { var acP = document.createElement('div'), wU = document.createElement('span'), aIp = document.createTextNode(dw.aD + 1); acP.className = 'pccThumbnailLabel'; wU.appendChild(aIp); acP.appendChild(wU); dw.aS.appendChild(acP); dw.aS.onclick = function () { K.afP([dw.aD + 1]); }; }); K.aG.appendChild(NB); this.Zb(); return this; }; PCCViewer.ThumbnailControl.EventType = { PageSelectionChanged: "PageSelectionChanged" }; PCCViewer.ThumbnailControl.prototype.getSelectedPages = function getSelectedPages() { if (!this.oj) { return []; } return [].concat(this.LA); }; PCCViewer.ThumbnailControl.prototype.setSelectedPages = function setSelectedPages(pageNumbers) { if (!this.oj) { return this; } var eD = this.cL.getPageCount(); if (typeof pageNumbers === 'number') { pageNumbers = [pageNumbers]; } else if (Object.prototype.toString.call(pageNumbers) !== '[object Array]') { throw new Error(pageNumbers + ' is not a number or an array of numbers'); } IPCC.J.forEach(pageNumbers, function (eo, G) { if (isNaN(eo)) { throw new Error(eo + ' (array index ' + G + ') is not a number'); } if (eo < 1 || eo > eD) { throw new Error(eo + ' (array index ' + G + ') is out of range'); } }); this.afP([].concat(pageNumbers).sort()); return this; }; if (Object.defineProperties) { Object.defineProperties(PCCViewer.ThumbnailControl.prototype, { "selectedPages": { enumerable: true, get: function () { return this.getSelectedPages(); }, set: function (pageNumbers) { return this.setSelectedPages(pageNumbers); } }, "viewerControl": { enumerable: true, get: function () { return this.getViewerControl(); } }, "visiblePages": { emunerable: true, get: function () { return this.getVisiblePages(); } } }); } PCCViewer.ThumbnailControl.prototype.scrollTo = function (pageNumber, options) { var eo = Number(pageNumber); if (eo !== (eo | 0) || eo < 1 || eo > this.cL.getPageCount()) { throw new Error(pageNumber + ' is not a valid page number'); } var nm = false, K = this, aH = options || {}; IPCC.J.forEach(this.sz, function (dw) { if (nm) { return; } if (dw.aD + 1 === eo) { nm = true; K.YC(dw, undefined, ! !aH.forceAlignTop); } }); return this; }; PCCViewer.ThumbnailControl.prototype.YC = function (dw, nx, avB) { nx = nx || IPCC.J.ZP(this.aG.getBoundingClientRect()); var wP = IPCC.J.ZP(dw.XQ.getBoundingClientRect()); if (wP.top > nx.top && wP.bottom < nx.bottom) { return; } var alG = window.getComputedStyle ? getComputedStyle(dw.XQ) : dw.XQ.currentStyle, iC; if (wP.top < nx.top || avB) { iC = wP.top - nx.top + this.aG.scrollTop - parseInt(alG.marginTop, 10); } else if (wP.bottom > nx.bottom) { iC = wP.bottom - nx.top - nx.height + this.aG.scrollTop + parseInt(alG.marginBottom, 10); } if (iC !== undefined) { this.aG.scrollTop = iC; } return this; }; PCCViewer.ThumbnailControl.prototype.afP = function (ka) { if (IPCC.J.awW(this.LA, ka)) { return this; } var YV = 'pcc-thumbnail-selected', Jm = new RegExp(YV), Zs = false, aoq = [].concat(ka), apy = aoq.shift(), agB = false, nx = IPCC.J.ZP(this.aG.getBoundingClientRect()), K = this; IPCC.J.forEach(this.sz, function (dw) { if (dw.aD === apy - 1) { IPCC.J.ait(dw.aS, YV); Zs = true; apy = aoq.shift() || 0; if (!agB) { agB = true; K.YC(dw, nx); } return; } if (Jm.test(dw.aS.className)) { IPCC.J.agb(dw.aS, YV); Zs = true; } }); this.LA = ka; if (Zs) { this.trigger(PCCViewer.ThumbnailControl.EventType.PageSelectionChanged, { pageNumbers: [].concat(this.LA) }); } return this; }; PCCViewer.ThumbnailControl.prototype.aHD = function () { var ep = this.Tf(), K = this, yt; IPCC.J.forEach(ep, function (dw) { if (!yt && IPCC.J.inArray(K.LA, dw.aD + 1)) { yt = dw; } }); if (!yt) { yt = ep[0]; } return yt; }; PCCViewer.ThumbnailControl.prototype.reflow = function () { if (!this.oj) { return this; } var Gi, DJ, aJ, by, ML, QT, ce, yt = this.aHD(); IPCC.J.forEach(this.sz, function (dw) { if (dw.AG) { dw.aS.style.height = dw.rz.style.height = ''; dw.aS.style.width = dw.rz.style.width = ''; } }); IPCC.J.forEach(this.sz, function (dw) { if (dw.AG && dw.ao.gJ()) { Gi = dw.aS.offsetWidth; DJ = dw.aS.offsetHeight; ce = dw.ao.aFk(); if (Math.abs(ce) === 90 || Math.abs(ce) === 270) { by = dw.ao.kO(); aJ = dw.ao.iE(); } else { aJ = dw.ao.kO(); by = dw.ao.iE(); } ML = aJ / by; QT = Gi / DJ; var kL, kT; if (ML < QT) { kT = DJ; kL = Math.floor(kT * aJ / by); } else { kL = Gi; kT = Math.floor(kL * by / aJ); } dw.kL = kL; dw.kT = kT; } }); IPCC.J.forEach(this.sz, function (dw) { if (dw.AG && dw.ao && dw.ao.gJ()) { dw.rz.style.height = dw.kT + 'px'; dw.rz.style.width = dw.kL + 'px'; dw.ao.aba(IPCC.Web.UI.FitType.FullImage); dw.ao.cn(); } }); if (yt) { this.YC(yt); } this.Zb(); return this; }; PCCViewer.ThumbnailControl.prototype.destroy = function () { if (!this.oj) { return this; } this.oj = oj.aeJ; IPCC.J.forEach(this.sz, function (dw) { if (dw.ao && dw.ao.dispose) { dw.ao.dispose(); } }); while (this.aG.firstChild) { this.aG.removeChild(this.aG.firstChild); } this.on = this.off = this.trigger = Zl; this.ln = {}; }; PCCViewer.ThumbnailControl.prototype.getVisiblePages = function () { if (!this.oj) { return []; } var ep = this.Tf(); return IPCC.J.map(ep, function (dw) { return dw.aD + 1; }); }; PCCViewer.ThumbnailControl.prototype.Tf = function Tf() { var II = this.aG.getBoundingClientRect(), wP; function Yr(nx, Rk) { return (!(Rk.top >= nx.bottom || Rk.left >= nx.right || Rk.bottom <= nx.top || Rk.right <= nx.left)); }; return IPCC.J.filter(this.sz, function (dw) { wP = dw.aS.getBoundingClientRect(); return Yr(II, wP); }); }; PCCViewer.ThumbnailControl.prototype.Zb = function () { var K = this, ep = K.Tf(); IPCC.J.forEach(ep, function (dw) { if (!dw.AG) { dw.ao = K.jb(dw); dw.AG = true; } }); return this; }; PCCViewer.ThumbnailControl.prototype.Xc = function Xc(aS) { var OI = {}, K = this; function aBn(dC, Fp, tE) { if (OI[dC]) { clearTimeout(OI[dC]); OI[dC] = undefined; } OI[dC] = setTimeout(Fp, tE || 0); }; IPCC.Web.UI.al.addHandler(aS, 'scroll', function (ev) { aBn('scroll', function () { K.Zb(); }, 300); }); }; PCCViewer.ThumbnailControl.prototype.jb = function (dw, mY) { var K = this; mY = mY || Zl; var bw = { documentIdentifier: K.aH.documentID, pageNumber: dw.aD, viewFitType: IPCC.Web.UI.FitType.FullImage, imageHandlerUrl: K.aH.imageHandlerUrl, encryption: K.aH.encryption, handleTouchEvents: false }; var ao = IPCC.initializePageViewPlugin(dw.rz, bw); ao.set_debug(K._debug); ao.set_mouseTool(IPCC.Web.UI.MouseTool.None); var xt = false; function Mv() { mY(); }; ao.add_pageOpened(function () { K.YS(dw); }); ao.add_pageDisplayed(function () { if (!xt) { Mv(); } }); ao.add_textPageReady(function () { if (xt) { ao.cn(); Mv(); } }); ao.add_pageOpenFailed(function () { }); ao.add_textExtractionFailed(function () { }); bw.artPage = K.cL.bq.hz(K.cL.cs.getPage(dw.aD)); bw.artPage.FJ(function (R) { if (R.get_type() === 608) { xt = true; } }); ao.axZ(bw); ao.set_mouseTool(IPCC.Web.UI.MouseTool.None); return ao; }; PCCViewer.ThumbnailControl.prototype.YS = function (dw) { var K = this; var If = K.cL.bq.Zo(dw.aD); var ce = dw.ce; var agL = ce; if (If !== dw.ce) { agL = If - ce; } var ao = dw.ao, kS = dw.rz, by, aJ; if (!dw.AG || !ao.gJ()) { return; } kS.style.height = ''; kS.style.width = ''; if (Math.abs(If) === 90 || Math.abs(If) === 270) { by = ao.kO(); aJ = ao.iE(); } else { by = ao.iE(); aJ = ao.kO(); } var Gi = kS.offsetWidth, DJ = kS.offsetHeight; if (dw.ce !== If) { ao.rotate(agL); dw.ce = If; } var ML = aJ / by, QT = Gi / DJ; var kL, kT; if (ML < QT) { kT = DJ; kL = Math.floor(kT * aJ / by); } else { kL = Gi; kT = Math.floor(kL * by / aJ); } kS.style.height = kT + 'px'; kS.style.width = kL + 'px'; }; })(PCCViewer || {}); (function (PCCViewer) { PCCViewer.ConversionRequest = function (aH) { this.pY = ""; this.dW = ""; this.mU = 0; this.je = ""; this.gk = false; this.rA = false; this.aH = aH; this.BF = null; this.Er = null; this.gY = undefined; this.aT = PCCViewer.Deferred(); this.cZ = this.aT.getPromise(); this.then = this.cZ.then; PCCViewer.EventEmitter.extend(this); }; PCCViewer.ConversionRequest.EventType = { ConversionProgress: "ConversionProgress", ConversionCompleted: "ConversionCompleted", ConversionFailed: "ConversionFailed", ConversionCancelled: "ConversionCancelled", ConversionWorkerCreated: "ConversionWorkerCreated" }; PCCViewer.ConversionRequest.prototype.cancel = function () { var K = this; this.rA = true; this.je = "User Cancelled"; setTimeout(function () { K.trigger(PCCViewer.ConversionRequest.EventType.ConversionCancelled, {}); K.trigger(PCCViewer.ConversionRequest.EventType.ConversionFailed, {}); K.aT.reject(new PCCViewer.Error("UserCancelled", "User Cancelled")); }, 0); return this; }; PCCViewer.ConversionRequest.prototype.getProgress = function () { return this.mU; }; PCCViewer.ConversionRequest.prototype.getWorkerID = function () { return this.pY; }; PCCViewer.ConversionRequest.prototype.getOptions = function () { return this.aH; }; PCCViewer.ConversionRequest.prototype.getErrorCode = function () { return this.je; }; PCCViewer.ConversionRequest.prototype.getConvertedDocumentDownloadURL = function () { return this.BF; }; PCCViewer.ConversionRequest.prototype.getConvertedDocumentDownloadURLs = function () { if (this.Er) { return this.Er.slice(); } return null; }; PCCViewer.ConversionRequest.prototype.Qz = function (gY) { this.gY = gY; }; PCCViewer.ConversionRequest.prototype.DG = function () { var K = this; K.gk = true; K.aFC().then(function onResolve(sO) { K.pY = sO.processId; K.mU = sO.percentComplete; K.dW = sO.state; K.trigger(PCCViewer.ConversionRequest.EventType.ConversionWorkerCreated, {}); K.aAV(sO).then(function onResolve(ayK) { K.gk = false; K.Er = []; if (K.aH.wX > 1) { for (var G = 0; G < K.aCO; G++) { var BF = K.gY.aH.imageHandlerUrl + '/v2/viewingSessions/' + K.gY.aH.documentID + '/contentConverters/' + K.pY + '/results/' + G + '/file?ContentDispositionFilename=' + encodeURIComponent(K.aH.filename); K.Er.push(BF); } K.aT.resolve(K.Er); } else { K.BF = K.gY.aH.imageHandlerUrl + '/WorkFile/' + ayK + "?ContentDispositionFilename=" + encodeURIComponent(K.aH.filename); if (sO.affinityToken) { K.BF += "&affinityToken=" + encodeURIComponent(sO.affinityToken); } K.Er.push(K.BF); K.aT.resolve(K.BF); } K.trigger(PCCViewer.ConversionRequest.EventType.ConversionCompleted, {}); }, function onReject(reason) { K.gk = false; K.aT.reject(reason); K.trigger(PCCViewer.ConversionRequest.EventType.ConversionFailed, {}); }); }, function onReject(reason) { K.gk = false; K.aT.reject(reason); K.trigger(PCCViewer.ConversionRequest.EventType.ConversionFailed, {}); }); }; PCCViewer.ConversionRequest.prototype.aFC = function () { var am, nJ = PCCViewer.Deferred(); var acF; if (this.aH.wX > 1) { am = this.gY.aH.imageHandlerUrl + '/v2/viewingSessions/' + this.gY.aH.documentID + '/contentConverters/'; acF = { url: am, method: 'POST', headers: { "Content-Type": "application/json" } }; } else { am = this.gY.aH.imageHandlerUrl + '/contentConverters/'; acF = { url: am, method: 'POST', headers: { "Content-Type": "application/json" }, body: JSON.stringify({ viewingSessionId: this.gY.aH.documentID }) }; } PCCViewer.Ajax.dZ(acF).then(function fa(bF) { var bM = JSON.parse(bF.responseText); nJ.resolve(bM); }, function eZ(bM) { nJ.reject(bM.error); }); return nJ.getPromise(); }; PCCViewer.ConversionRequest.prototype.aAV = function (sO) { var am, nJ = PCCViewer.Deferred(), K = this, hY; if (K.aH.wX > 1) { am = this.gY.aH.imageHandlerUrl + '/v2/viewingSessions/' + this.gY.aH.documentID + '/contentConverters/' + sO.processId; } else { am = this.gY.aH.imageHandlerUrl + '/contentConverters/' + sO.processId; } if (sO.affinityToken) { hY = { "Accusoft-Affinity-Token": sO.affinityToken }; } (function poll() { setTimeout(function () { PCCViewer.Ajax.dZ({ method: 'GET', url: am, headers: hY }).then(function fa(bF) { var bM = JSON.parse(bF.responseText); K.pY = bM.processId; K.mU = bM.percentComplete; K.dW = bM.state; if (K.aH.wX > 1 && bM.output) { K.aCO = bM.output.results.length; } K.trigger(PCCViewer.ConversionRequest.EventType.ConversionProgress, { progress: K.mU }); if (bM.percentComplete === 100) { nJ.resolve(bM.output.results[0].fileId); } else { poll(); } }, function eZ(bM) { nJ.reject(bM.error); }); }, 3000); })(); return nJ.getPromise(); }; if (Object.defineProperties) { Object.defineProperties(PCCViewer.ConversionRequest.prototype, { "options": { enumerable: true, get: function () { return this.getOptions(); } }, "progress": { enumerable: true, get: function () { return this.getProgress(); } }, "workerID": { enumerable: true, get: function () { return this.getWorkerID(); } }, "errorCode": { enumerable: true, get: function () { return this.getErrorCode(); } }, "convertedDocumentDownloadURL": { enumerable: true, get: function () { return this.getConvertedDocumentDownloadURL(); } }, "convertedDocumentDownloadURLs": { enumerable: true, get: function () { return this.getConvertedDocumentDownloadURLs(); } } }); } })(PCCViewer || {}); (function (PCCViewer) { PCCViewer.fG = { serializeMask: function (iJ) { var afH = { value: iJ.value, translations: {} }; IPCC.J.forEach(iJ.translations, function (bj, aq) { afH.translations[aq] = bj.toString(); }); return afH; }, copyRectangle: function (h) { return { x: h.x, y: h.y, width: h.width, height: h.height }; }, Common: function (bw, db) { var by; var aJ; if (bw.page) { by = bw.page.get_pageHeight(); aJ = bw.page.get_pageWidth(); } else { by = null; aJ = null; } var bp = bw.mark.getPageNumber(); var aC = { uid: bw.mark.getUid(), interactionMode: bw.mark.getInteractionMode(), pageNumber: bp, type: bw.mark.getType(), creationDateTime: IPCC.J.zO(bw.mark.H.ahY()), modificationDateTime: IPCC.J.zO(bw.mark.H.ahO()), data: PCCViewer.fG.Data(bw.mark), conversation: PCCViewer.fG.Conversation(bw.mark.getConversation()) }; function Bq(be) { return { x: be.x, y: be.y }; }; function awi() { var LN = IPCC.J.map([].concat(bw.mark.H, bw.mark.dF), function (H) { if (aJ !== null) { return { pageNumber: H.aD + 1, pageData: { width: aJ, height: by }, startIndex: H.get_startIndex(), textLength: H.get_textLength(), lines: IPCC.J.map(H.bV, function (ai) { if (ai.get_rectangle) { return PCCViewer.fG.copyRectangle(ai.get_rectangle()); } else { return PCCViewer.fG.copyRectangle(ai); } }) }; } else { return { pageNumber: H.aD + 1, startIndex: H.get_startIndex(), textLength: H.get_textLength(), lines: IPCC.J.map(H.bV, function (ai) { if (ai.get_rectangle) { return PCCViewer.fG.copyRectangle(ai.get_rectangle()); } else { return PCCViewer.fG.copyRectangle(ai); } }) }; } }); aC.lineGroups = LN; }; function ajt() { if (bw.mark.getRectangle) { aC.rectangle = PCCViewer.fG.copyRectangle(bw.mark.getRectangle()); if (aJ !== null) { aC.pageData = { width: aJ, height: by }; } } if (bw.mark.getStartPoint) { aC.startPoint = Bq(bw.mark.getStartPoint()); if (aJ !== null) { aC.pageData = aC.pageData || { width: aJ, height: by }; } } if (bw.mark.getEndPoint) { aC.endPoint = Bq(bw.mark.getEndPoint()); if (aJ !== null) { aC.pageData = aC.pageData || { width: aJ, height: by }; } } if (bw.mark.getPoints) { var ag = bw.mark.getPoints(); aC.points = IPCC.J.map(ag, Bq); if (aJ !== null) { aC.pageData = { width: aJ, height: by }; } } if (bw.mark.H.bV) { awi(); } }; if (aJ !== undefined && by !== undefined && aJ !== 0 && by !== 0) { ajt(); db(undefined, aC); } else { bw.vc.requestPageAttributes(bp).then(function aIB(anC) { by = anC.height; aJ = anC.width; ajt(); db(undefined, aC); }, function aKv(fr) { db(fr); }); } }, Data: function (aC) { return IPCC.J.reduce(aC.getDataKeys(), function (eb, aq) { eb[aq] = aC.getData(aq); return eb; }, {}); }, Comment: function (cC) { return { text: cC.getText(), data: PCCViewer.fG.Data(cC), creationDateTime: IPCC.J.zO(cC.getCreationTime()) }; }, Conversation: function (df) { return { comments: IPCC.J.map(df.getComments(), function (cC) { return PCCViewer.fG.Comment(cC); }), data: PCCViewer.fG.Data(df) }; }, EllipseAnnotation: function (bw, db) { PCCViewer.fG.RectangleAnnotation(bw, db); }, FreehandAnnotation: function (bw, db) { PCCViewer.fG.Common(bw, function (bX, aC) { if (bX) { db(bX); return; } aC = IPCC.J.extend(aC, { color: bw.mark.getColor(), opacity: bw.mark.getOpacity(), path: bw.mark.getPath(), thickness: bw.mark.getThickness() }); db(undefined, aC); }); }, FreehandSignature: function (bw, db) { PCCViewer.fG.Common(bw, function (bX, aC) { if (bX) { db(bX); return; } aC = IPCC.J.extend(aC, { color: bw.mark.getColor(), path: bw.mark.getPath(), thickness: bw.mark.getThickness(), horizontalAlignment: bw.mark.getHorizontalAlignment() }); db(undefined, aC); }); }, HighlightAnnotation: function (bw, db) { PCCViewer.fG.Common(bw, function (bX, aC) { if (bX) { db(bX); return; } var cF = bw.mark.getPosition(); aC = IPCC.J.extend(aC, { fillColor: bw.mark.getFillColor(), textLength: cF.length, startIndex: cF.startIndex, selectedText: bw.mark.getText() }); db(undefined, aC); }); }, ImageStampAnnotation: function (bw, db) { PCCViewer.fG.Common(bw, function (bX, aC) { if (bX) { db(bX); return; } var ap = bw.mark.getImage(); aC = IPCC.J.extend(aC, { imageDataUrl: ap.dataUrl, imageId: ap.id }); db(undefined, aC); }); }, ImageStampRedaction: function (bw, db) { PCCViewer.fG.ImageStampAnnotation(bw, db); }, LineAnnotation: function (bw, db) { PCCViewer.fG.Common(bw, function (bX, aC) { if (bX) { db(bX); return; } aC = IPCC.J.extend(aC, { color: bw.mark.getColor(), endHeadType: bw.mark.getEndHeadType(), opacity: bw.mark.getOpacity(), thickness: bw.mark.getThickness() }); db(undefined, aC); }); }, PolylineAnnotation: function (bw, db) { PCCViewer.fG.Common(bw, function (bX, aC) { if (bX) { db(bX); return; } aC = IPCC.J.extend(aC, { color: bw.mark.getColor(), opacity: bw.mark.getOpacity(), thickness: bw.mark.getThickness() }); db(undefined, aC); }); }, RectangleAnnotation: function (bw, db) { PCCViewer.fG.Common(bw, function (bX, aC) { if (bX) { db(bX); return; } aC = IPCC.J.extend(aC, { borderColor: bw.mark.getBorderColor(), borderThickness: bw.mark.getBorderThickness(), fillColor: bw.mark.getFillColor(), opacity: bw.mark.getOpacity() }); db(undefined, aC); }); }, RectangleRedaction: function (bw, db) { PCCViewer.fG.Common(bw, function (bX, aC) { if (bX) { db(bX); return; } aC = IPCC.J.extend(aC, { reason: bw.mark.getReason(), fillColor: bw.mark.getFillColor(), borderColor: bw.mark.getBorderColor(), borderThickness: bw.mark.getBorderThickness(), fontColor: bw.mark.getFontColor() }); db(undefined, aC); }); }, StampAnnotation: function (bw, db) { PCCViewer.fG.Common(bw, function (bX, aC) { if (bX) { db(bX); return; } aC = IPCC.J.extend(aC, { label: bw.mark.getLabel(), color: bw.mark.getColor() }); db(undefined, aC); }); }, StampRedaction: function (bw, db) { PCCViewer.fG.Common(bw, function (bX, aC) { if (bX) { db(bX); return; } aC = IPCC.J.extend(aC, { label: bw.mark.getLabel() }); db(undefined, aC); }); }, StrikethroughAnnotation: function (bw, db) { PCCViewer.fG.Common(bw, function (bX, aC) { if (bX) { db(bX); return; } var cF = bw.mark.getPosition(); aC = IPCC.J.extend(aC, { color: bw.mark.getColor(), thickness: bw.mark.getThickness(), textLength: cF.length, startIndex: cF.startIndex, selectedText: bw.mark.getText() }); db(undefined, aC); }); }, TextAnnotation: function (bw, db) { PCCViewer.fG.Common(bw, function (bX, aC) { if (bX) { db(bX); return; } aC = IPCC.J.extend(aC, { borderColor: bw.mark.getBorderColor(), borderThickness: bw.mark.getBorderThickness(), fillColor: bw.mark.getFillColor(), fontColor: bw.mark.getFontColor(), fontName: bw.mark.getFontName(), fontSize: bw.mark.getFontSize(), fontStyle: bw.mark.getFontStyle(), maxLength: bw.mark.getMaxLength(), horizontalAlignment: bw.mark.getHorizontalAlignment(), opacity: bw.mark.getOpacity(), text: bw.mark.getText() }); db(undefined, aC); }); }, TextAreaSignature: function (bw, db) { PCCViewer.fG.Common(bw, function (bX, aC) { if (bX) { db(bX); return; } aC = IPCC.J.extend(aC, { text: bw.mark.getText(), fontColor: bw.mark.getFontColor(), fontName: bw.mark.getFontName(), fontStyle: bw.mark.getFontStyle(), maxFontSize: bw.mark.getMaxFontSize(), maxLength: bw.mark.getMaxLength(), horizontalAlignment: bw.mark.getHorizontalAlignment(), }); db(undefined, aC); }); }, TextHyperlinkAnnotation: function (bw, db) { PCCViewer.fG.Common(bw, function (bX, aC) { if (bX) { db(bX); return; } var cF = bw.mark.getPosition(); aC = IPCC.J.extend(aC, { href: bw.mark.getHref(), fillColor: bw.mark.getFillColor(), textLength: cF.length, startIndex: cF.startIndex, selectedText: bw.mark.getText() }); db(undefined, aC); }); }, TextInputSignature: function (bw, db) { PCCViewer.fG.Common(bw, function (bX, aC) { if (bX) { db(bX); return; } aC = IPCC.J.extend(aC, { fontColor: bw.mark.getFontColor(), fontName: bw.mark.getFontName(), text: bw.mark.getText(), mask: bw.mark.getMask(), maxLength: bw.mark.getMaxLength(), horizontalAlignment: bw.mark.getHorizontalAlignment() }); if (bw.mark.getMask()) { aC.mask = PCCViewer.fG.serializeMask(bw.mark.getMask()); } db(undefined, aC); }); }, TextRedaction: function (bw, db) { PCCViewer.fG.Common(bw, function (bX, aC) { if (bX) { db(bX); return; } aC = IPCC.J.extend(aC, { fontColor: bw.mark.getFontColor(), fontName: bw.mark.getFontName(), fontSize: bw.mark.getFontSize(), text: bw.mark.getText(), maxLength: bw.mark.getMaxLength(), horizontalAlignment: bw.mark.getHorizontalAlignment() }); db(undefined, aC); }); }, TextSelectionRedaction: function (bw, db) { PCCViewer.fG.Common(bw, function (bX, aC) { if (bX) { db(bX); return; } var cF = bw.mark.getPosition(); aC = IPCC.J.extend(aC, { reason: bw.mark.getReason(), textLength: cF.length, startIndex: cF.startIndex, selectedText: bw.mark.getText() }); db(undefined, aC); }); }, TextSignature: function (bw, db) { PCCViewer.fG.Common(bw, function (bX, aC) { if (bX) { db(bX); return; } aC = IPCC.J.extend(aC, { color: bw.mark.getColor(), fontName: bw.mark.getFontName(), text: bw.mark.getText(), horizontalAlignment: bw.mark.getHorizontalAlignment() }); db(undefined, aC); }); }, TransparentRectangleRedaction: function (bw, db) { PCCViewer.fG.Common(bw, db); } }; PCCViewer.ViewerControl.prototype.serializeMarks = function serializeMarks(marks) { var aT = PCCViewer.Deferred(); var cZ = aT.getPromise(); var K = this, bN, aCp = false; function aho(fr) { setTimeout(function () { aT.reject(fr); }, 0); }; if (Object.prototype.toString.call(marks) === '[object Array]') { bN = marks; } else if (marks) { bN = [marks]; aCp = true; } else { aho(new PCCViewer.Error('InvalidArgument', '`marks` is not defined or falsy.')); return cZ; } var TE; bN = IPCC.J.filter(bN, function (lH, dJ) { var KD = lH instanceof PCCViewer.Mark && lH === K.getMarkById(lH.getId()) && ! !PCCViewer.fG[lH.getType()]; if (!KD && !TE) { TE = dJ; } return KD; }); if (TE) { aho(new PCCViewer.Error('InvalidArgument', 'Cannot serialize object at index ' + TE + ' because it is not a valid mark or a mark known to ViewerControl')); return cZ; } var Yy = K.bE.get_pages(); var dP = IPCC.J.reduce(bN, function (eb, lH) { var bp = lH.getPageNumber(); if (eb[bp]) { return eb; } eb[bp] = Yy.getPage(bp - 1); return eb; }, {}); function avG(R, bI, atY) { return function (mY) { PCCViewer.fG[R.getType()]({ mark: R, page: bI, vc: K }, function (bX, dc) { if (!bX) { atY(dc); mY(); } else { aT.reject(bX); } }); }; }; var uu = []; var atQ = IPCC.J.map(bN, function (lH, dJ) { return avG(lH, dP[lH.getPageNumber()], function (dc) { uu[dJ] = dc; }); }); IPCC.J.YY(atQ, function () { aT.resolve(uu); }); return cZ; }; })(PCCViewer || {}); (function (PCCViewer) { PCCViewer.dr = { setMask: function (R, iJ) { var Od = {}; IPCC.J.forEach(iJ.translations, function (bj, aq) { Od[aq] = new RegExp(bj.replace(/^\/|\/$/g, '')); }); R.setMask({ value: iJ.value, translations: Od }); }, calculateRectangle: function (aC, aH) { if (aC.pageData === undefined || (aC.pageData.width === aH.aJ && aC.pageData.height === aH.by)) { return aC.rectangle; } else { var oz = aH.aJ / aC.pageData.width; return { x: aC.rectangle.x * oz, y: aC.rectangle.y * oz, width: aC.rectangle.width * oz, height: aC.rectangle.height * oz }; } }, setRectangle: function (R, aC, aH) { R.setRectangle(PCCViewer.dr.calculateRectangle(aC, aH)); }, setLines: function (R, aC, aH) { var ael, ow, fF = aC.textLength + aC.startIndex - 1, cl = aC.selectedText, cF = { startIndex: aC.startIndex, length: aC.textLength }; ow = []; var aD, BP; ael = IPCC.J.reduce(aC.lineGroups, function (eb, pO) { aD = pO.pageNumber - 1; eb[aD] = IPCC.J.map(pO.lines, function (iC) { if (pO.pageData !== undefined) { BP = PCCViewer.dr.calculateRectangle({ rectangle: iC, pageData: pO.pageData }, aH); return new IPCC.Web.UI.Rectangle(BP.x, BP.y, BP.width, BP.height); } else { return new IPCC.Web.UI.Rectangle(iC.x, iC.y, iC.width, iC.height); } }); ow.push({ pageIndex: aD, endIndex: pO.startIndex + pO.textLength - 1 }); return eb; }, {}); R.Ns(ow, fF, cl, cF, ael); }, postCreate: function (R, aC) { R.H.afC(new Date(IPCC.J.Lp(aC.creationDateTime))); R.H.ZH(new Date(IPCC.J.Lp(aC.modificationDateTime))); return R; }, calculatePoint: function (be, gT, aH) { if (gT === undefined || (gT.width === aH.aJ && gT.height === aH.by)) { return be; } else { return { x: be.x * aH.aJ / gT.width, y: be.y * aH.by / gT.height }; } }, Data: function (aC, dc) { IPCC.J.forEach(dc, function (bj, aq) { aC.setData(aq, bj); }); }, Comment: function (df, cC) { var pJ = df.addComment(cC.text); pJ.setCreationTime(cC.creationDateTime); PCCViewer.dr.Data(pJ, cC.data); }, Conversation: function (R, df) { var adY = R.getConversation(); IPCC.J.forEach(df.comments ? df.comments : [], function (pJ) { PCCViewer.dr.Comment(adY, pJ); }); PCCViewer.dr.Data(adY, df.data); }, Common: function (aC, aH) { if (aC.uid === undefined) { aC.uid = IPCC.J.acu(); } var R = this.aks(aC.pageNumber, aC.type, { uid: aC.uid }); if (aC.rectangle && R.setRectangle) { PCCViewer.dr.setRectangle(R, aC, aH); } if (aC.startPoint && R.setStartPoint) { R.setStartPoint(PCCViewer.dr.calculatePoint(aC.startPoint, aC.pageData, aH)); } if (aC.endPoint && R.setEndPoint) { R.setEndPoint(PCCViewer.dr.calculatePoint(aC.endPoint, aC.pageData, aH)); } if (aC.points && R.setPoints) { R.setPoints(IPCC.J.map(aC.points, function (be) { return PCCViewer.dr.calculatePoint(be, aC.pageData, aH); })); } if (aC.lineGroups && R.Ns) { R.cE = aC.uid; PCCViewer.dr.setLines(R, aC, aH); } if (aC.interactionMode) { R.setInteractionMode(aC.interactionMode); } R = this.apT(R); PCCViewer.dr.Data(R, aC.data); PCCViewer.dr.Conversation(R, aC.conversation); return R; }, EllipseAnnotation: function (aC, aH) { var R = PCCViewer.dr.Common.apply(this, arguments); if (aC.borderColor) { R.setBorderColor(aC.borderColor); } if (aC.borderThickness) { R.setBorderThickness(aC.borderThickness); } if (aC.fillColor) { R.setFillColor(aC.fillColor); } if (aC.opacity) { R.setOpacity(aC.opacity); } return PCCViewer.dr.postCreate(R, aC); }, FreehandAnnotation: function (aC, aH) { var R = PCCViewer.dr.Common.apply(this, arguments); if (aC.color) { R.setColor(aC.color); } if (aC.opacity) { R.setOpacity(aC.opacity); } if (aC.path) { R.setPath(aC.path); } if (aC.thickness) { R.setThickness(aC.thickness); } return PCCViewer.dr.postCreate(R, aC); }, FreehandSignature: function (aC, aH) { var R = PCCViewer.dr.Common.apply(this, arguments); if (aC.color) { R.setColor(aC.color); } if (aC.path) { R.setPath(aC.path); } if (aC.thickness) { R.setThickness(aC.thickness); } if (aC.horizontalAlignment) { R.setHorizontalAlignment(aC.horizontalAlignment); } return PCCViewer.dr.postCreate(R, aC); }, HighlightAnnotation: function (aC, aH) { var R = PCCViewer.dr.Common.apply(this, arguments); if (aC.fillColor) { R.setFillColor(aC.fillColor); } return PCCViewer.dr.postCreate(R, aC); }, ImageStampAnnotation: function (aC, aH) { var R = PCCViewer.dr.Common.apply(this, arguments); if (aC.imageDataUrl && aC.imageId) { R.setImage({ id: aC.imageId, dataUrl: aC.imageDataUrl }); } return PCCViewer.dr.postCreate(R, aC); }, ImageStampRedaction: function (aC, aH) { return PCCViewer.dr.ImageStampAnnotation.apply(this, arguments); }, LineAnnotation: function (aC, aH) { var R = PCCViewer.dr.Common.apply(this, arguments); if (aC.color) { R.setColor(aC.color); } if (aC.endHeadType) { R.setEndHeadType(aC.endHeadType); } if (aC.opacity) { R.setOpacity(aC.opacity); } if (aC.thickness) { R.setThickness(aC.thickness); } return PCCViewer.dr.postCreate(R, aC); }, PolylineAnnotation: function (aC, aH) { var R = PCCViewer.dr.Common.apply(this, arguments); if (aC.color) { R.setColor(aC.color); } if (aC.opacity) { R.setOpacity(aC.opacity); } if (aC.thickness) { R.setThickness(aC.thickness); } return PCCViewer.dr.postCreate(R, aC); }, RectangleAnnotation: function (aC, aH) { var R = PCCViewer.dr.Common.apply(this, arguments); if (aC.borderColor) { R.setBorderColor(aC.borderColor); } if (aC.borderThickness) { R.setBorderThickness(aC.borderThickness); } if (aC.fillColor) { R.setFillColor(aC.fillColor); } if (aC.opacity) { R.setOpacity(aC.opacity); } return PCCViewer.dr.postCreate(R, aC); }, RectangleRedaction: function (aC, aH) { var R = PCCViewer.dr.Common.apply(this, arguments); if (aC.reason) { R.setReason(aC.reason); } if (aC.fillColor) { R.setFillColor(aC.fillColor); } if (aC.borderColor) { R.setBorderColor(aC.borderColor); } if (aC.borderThickness) { R.setBorderThickness(aC.borderThickness); } if (aC.fontColor) { R.setFontColor(aC.fontColor); } return PCCViewer.dr.postCreate(R, aC); }, StampAnnotation: function (aC, aH) { var R = PCCViewer.dr.Common.apply(this, arguments); if (aC.label) { R.setLabel(aC.label); } if (aC.color) { R.setColor(aC.color); } return PCCViewer.dr.postCreate(R, aC); }, StampRedaction: function (aC, aH) { var R = PCCViewer.dr.Common.apply(this, arguments); if (aC.label) { R.setLabel(aC.label); } return PCCViewer.dr.postCreate(R, aC); }, StrikethroughAnnotation: function (aC, aH) { var R = PCCViewer.dr.Common.apply(this, arguments); if (aC.color) { R.setColor(aC.color); } if (aC.thickness) { R.setThickness(aC.thickness); } return PCCViewer.dr.postCreate(R, aC); }, TextAnnotation: function (aC, aH) { var R = PCCViewer.dr.Common.apply(this, arguments); if (aC.borderColor) { R.setBorderColor(aC.borderColor); } if (aC.borderThickness) { R.setBorderThickness(aC.borderThickness); } if (aC.fillColor) { R.setFillColor(aC.fillColor); } if (aC.fontColor) { R.setFontColor(aC.fontColor); } if (aC.fontName) { R.setFontName(aC.fontName); } if (aC.fontSize) { R.setFontSize(aC.fontSize); } if (aC.fontStyle) { R.setFontStyle(aC.fontStyle); } if (aC.maxLength) { R.setMaxLength(aC.maxLength); } if (aC.horizontalAlignment) { R.setHorizontalAlignment(aC.horizontalAlignment); } if (aC.opacity) { R.setOpacity(aC.opacity); } if (aC.text) { R.setText(aC.text); } return PCCViewer.dr.postCreate(R, aC); }, TextAreaSignature: function (aC, aH) { var R = PCCViewer.dr.Common.apply(this, arguments); if (aC.text) { R.setText(aC.text); } if (aC.fontColor) { R.setFontColor(aC.fontColor); } if (aC.fontName) { R.setFontName(aC.fontName); } if (aC.maxFontSize) { R.setMaxFontSize(aC.maxFontSize); } if (aC.fontStyle) { R.setFontStyle(aC.fontStyle); } if (aC.maxLength) { R.setMaxLength(aC.maxLength); } if (aC.horizontalAlignment) { R.setHorizontalAlignment(aC.horizontalAlignment); } return PCCViewer.dr.postCreate(R, aC); }, TextHyperlinkAnnotation: function (aC, aH) { var R = PCCViewer.dr.Common.apply(this, arguments); if (aC.fillColor) { R.setFillColor(aC.fillColor); } if (aC.href) { R.setHref(aC.href); } return PCCViewer.dr.postCreate(R, aC); }, TextInputSignature: function (aC, aH) { var R = PCCViewer.dr.Common.apply(this, arguments); if (aC.fontColor) { R.setFontColor(aC.fontColor); } if (aC.fontName) { R.setFontName(aC.fontName); } if (aC.text) { R.setText(aC.text); } if (aC.maxLength) { R.setMaxLength(aC.maxLength); } if (aC.mask) { PCCViewer.dr.setMask(R, aC.mask); } if (aC.horizontalAlignment) { R.setHorizontalAlignment(aC.horizontalAlignment); } return PCCViewer.dr.postCreate(R, aC); }, TextRedaction: function (aC, aH) { var R = PCCViewer.dr.Common.apply(this, arguments); if (aC.fontColor) { R.setFontColor(aC.fontColor); } if (aC.fontName) { R.setFontName(aC.fontName); } if (aC.fontSize) { R.setFontSize(aC.fontSize); } if (aC.maxLength) { R.setMaxLength(aC.maxLength); } if (aC.text) { R.setText(aC.text); } if (aC.horizontalAlignment) { R.setHorizontalAlignment(aC.horizontalAlignment); } return PCCViewer.dr.postCreate(R, aC); }, TextSelectionRedaction: function (aC, aH) { var R = PCCViewer.dr.Common.apply(this, arguments); if (aC.reason) { R.setReason(aC.reason); } return PCCViewer.dr.postCreate(R, aC); }, TextSignature: function (aC, aH) { var R = PCCViewer.dr.Common.apply(this, arguments); if (aC.color) { R.setColor(aC.color); } if (aC.fontName) { R.setFontName(aC.fontName); } if (aC.text) { R.setText(aC.text); } if (aC.horizontalAlignment) { R.setHorizontalAlignment(aC.horizontalAlignment); } return PCCViewer.dr.postCreate(R, aC); }, TransparentRectangleRedaction: function (aC, aH) { var R = PCCViewer.dr.Common.apply(this, arguments); return PCCViewer.dr.postCreate(R, aC); } }; PCCViewer.ViewerControl.prototype.deserializeMarks = function deserializeMarks(values) { if (this.eF === false) { throw new Error("The method addMark is not available until 'ViewerReady' state is reached."); } var K = this; var eD = K.getPageCount(); var ei; if (typeof values === 'string') { try { ei = JSON.parse(values); } catch (e) { throw new Error('JSON parse error: ' + e.message); } } else { ei = values; } if (ei.constructor !== Array) { ei = [ei]; } function ZF(fr, dJ) { throw new Error('Cannot serialize mark (at index ' + dJ + ') because of ' + fr); }; var aaM = IPCC.J.map(K.getAllMarks(), function (R) { return R.getUid(); }); IPCC.J.forEach(ei, function validateObject(aC, dJ) { if (!aC.pageNumber || isNaN(+aC.pageNumber) || aC.pageNumber < 1 || aC.pageNumber > eD) { ZF('unknown page number ' + aC.pageNumber, dJ); } if (!PCCViewer.Mark.Type[aC.type]) { ZF('unknown type ' + aC.type, dJ); } if (IPCC.J.contains(aaM, aC.uid)) { ZF('uid ' + aC.uid + ' is being duplicated or already exists', dJ); } else if (aC.uid !== undefined) { aaM.push(aC.uid); } }); if (ei.length === 0) { return []; } var dP = K.bE.get_pages(); var ayM = []; dP.mR(function (bI) { ayM.push(K.bq.hz(bI)); }); var bN = IPCC.J.map(ei, function (aC) { var bI = dP.jb(aC.pageNumber - 1); var abl = bI.get_pageWidth(); var ahl = bI.get_pageHeight(); var gT = aC.pageData; if (!gT && (!abl || !ahl)) { var arZ = IPCC.J.find(aC.lineGroups, function (agg) { return (agg.pageNumber && agg.pageNumber === aC.pageNumber); }); gT = arZ.pageData; } var aJ = abl || gT.width; var by = ahl || gT.height; var R = PCCViewer.dr[aC.type].call(K, aC, { aJ: aJ, by: by }); if (aC.uid === undefined) { aaM.push(R.getUid()); } if (!abl) { bI.Hs = true; bI.aek(aJ); bI.afv(by); } return R; }); return bN; }; })(PCCViewer || {}); (function (PCCViewer) { PCCViewer.LoadMarkupLayersRequest = function (layerRecordIds, viewerControl, options) { this.xu = layerRecordIds; this.cL = viewerControl; this.je = ""; this.gk = false; this.rA = false; this.mU = 0; this.aT = PCCViewer.Deferred(); this.cZ = this.aT.getPromise(); this.then = this.cZ.then; this.wD = options.loadAsHidden === true; PCCViewer.EventEmitter.extend(this); }; PCCViewer.LoadMarkupLayersRequest.EventType = { LoadMarkupLayersFailed: "LoadMarkupLayersFailed", LoadMarkupLayersCompleted: "LoadMarkupLayersCompleted", LoadMarkupLayersCancelled: "LoadMarkupLayersCancelled", LoadMarkupLayersProgress: "LoadMarkupLayersProgress" }; PCCViewer.LoadMarkupLayersRequest.prototype.getProgress = function () { return this.mU; }; PCCViewer.LoadMarkupLayersRequest.prototype.cancel = function () { var K = this; this.rA = true; this.je = "User Cancelled"; setTimeout(function () { K.trigger(PCCViewer.LoadMarkupLayersRequest.EventType.LoadMarkupLayersCancelled, {}); K.trigger(PCCViewer.LoadMarkupLayersRequest.EventType.LoadMarkupLayersFailed, {}); K.aT.reject(new PCCViewer.Error("UserCancelled", "User Cancelled")); }, 0); return this; }; PCCViewer.LoadMarkupLayersRequest.prototype.getViewerControl = function () { return this.cL; }; PCCViewer.LoadMarkupLayersRequest.prototype.getErrorCode = function () { return this.je; }; PCCViewer.LoadMarkupLayersRequest.prototype.DG = function () { var K = this, adA = 1, VP, abE = []; var wD = this.wD; var tF = function (arl) { function fa(bF) { var uo = JSON.parse(bF.responseText), TN = K.aEp(uo), gI, uu = [], bN, jl = [], amG = {}, MJ = 0, Pd; for (var pf in TN.jl) { if (TN.jl.hasOwnProperty(pf)) { jl = jl.concat(TN.jl[pf]); } } gI = new PCCViewer.MarkupLayer(K.cL, jl); gI.aKg = { am: am }; IPCC.J.forEach(TN.uu, function (adI) { uu.push(adI); MJ++; amG[adI.uid] = true; }); if (uo.name) { gI.setName(uo.name); } if (uo.originalXmlName) { gI.setOriginalXmlName(uo.originalXmlName); } if (MJ > 0) { Pd = function (ev) { if (amG[ev.mark.getUid()]) { MJ--; } if (!MJ) { K.cL.off(PCCViewer.EventType.MarkCreated, Pd); K.cL.tu = true; } }; K.cL.on(PCCViewer.EventType.MarkCreated, Pd); K.cL.tu = false; try { bN = K.cL.deserializeMarks(uu); } catch (bX) { K.gk = false; K.cL.off(PCCViewer.EventType.MarkCreated, Pd); K.cL.tu = true; K.aT.reject(new PCCViewer.Error('Error', bX.message)); K.trigger(PCCViewer.LoadMarkupLayersRequest.EventType.LoadMarkupLayersFailed, {}); return; } if (wD) { IPCC.J.forEach(bN, function (R) { R.setVisible(false); }); } gI.addMarks(bN); } gI.Wp = arl; for (var wa in uo.data) { if (uo.data.hasOwnProperty(wa)) { gI.setData(wa, uo.data[wa]); } } K.cL.getMarkupLayerCollection().addItem(gI); abE.push(gI); adA--; K.mU = (K.xu.length - adA) / K.xu.length; K.trigger(PCCViewer.LoadMarkupLayersRequest.EventType.LoadMarkupLayersProgress, { progress: K.mU }); if (K.mU === 1) { K.gk = false; K.aT.resolve(abE); K.trigger(PCCViewer.LoadMarkupLayersRequest.EventType.LoadMarkupLayersCompleted, { markupLayers: abE }); } }; function eZ(bM) { K.gk = false; K.aT.reject(bM.error); K.trigger(PCCViewer.LoadMarkupLayersRequest.EventType.LoadMarkupLayersFailed, {}); }; var am = VP + arl + '?' + new Date().getTime(); PCCViewer.Ajax.dZ({ url: am, method: 'GET' }).then(fa, eZ); }; if (!(/^[\x00-\x7F]*$/.test(this.cL.bE.get_documentIdentifier()))) { VP = this.cL.aH.imageHandlerUrl + '/MarkupLayers/e' + this.cL.aH.documentID + '/'; } else { VP = this.cL.aH.imageHandlerUrl + '/MarkupLayers/u' + encodeURIComponent(this.cL.aH.documentID) + '/'; } if (this.rA) { return; } if (Object.prototype.toString.call(this.xu) === '[object Array]' && this.xu.length > 0) { adA = this.xu.length; this.gk = true; IPCC.J.forEach(this.xu, tF, this); } else if (typeof this.xu === "string") { this.gk = true; tF(this.xu); } else { this.gk = false; this.aT.reject(new PCCViewer.Error("InvalidParameter", 'layerRecordIds parameter is missing or invalid.')); this.trigger(PCCViewer.LoadMarkupLayersRequest.EventType.LoadMarkupLayersFailed, {}); return; } }; PCCViewer.LoadMarkupLayersRequest.prototype.aEp = function (uo) { var NH = {}, PY = {}; IPCC.J.forEach(uo.marks, function (ZM) { ZM.conversation.comments = []; NH[ZM.uid] = ZM; }, this); IPCC.J.forEach(uo.comments, function (zD) { if (NH[zD.markUid]) { NH[zD.markUid].conversation.comments.push(zD); } else if (PY[zD.markUid]) { PY[zD.markUid].push(zD); } else { PY[zD.markUid] = [zD]; } }, this); return { uu: NH, jl: PY }; }; if (Object.defineProperties) { Object.defineProperties(PCCViewer.LoadMarkupLayersRequest.prototype, { "errorCode": { enumerable: true, get: function () { return this.getErrorCode(); } }, "progress": { enumerable: true, get: function () { return this.getProgress(); } }, "viewerControl": { enumerable: true, get: function () { return this.getViewerControl(); } } }); } })(PCCViewer || {}); (function (PCCViewer) { PCCViewer.MarkupLayer = function (viewerControl, markReferences) { var K = this; if (!viewerControl) { throw new Error('`viewerControl` param is missing.'); } this.fg = function () { var d = new Date().getTime(); var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) { var r = (d + Math.random() * 16) % 16 | 0; d = Math.floor(d / 16); return (c === 'x' ? r : (r & 0x3 | 0x8)).toString(16); }); return uuid; }(); this.cL = viewerControl; this.dC = undefined; this.Wp = undefined; this.apc = undefined; this.bN = []; this.jl = {}; this.qi = PCCViewer.Mark.InteractionMode.Full; if (markReferences !== undefined) { switch (Object.prototype.toString.call(markReferences)) { case "[object Object]": markReferences = [markReferences]; break; case "[object Array]": break; default: throw new Error('`markReferences` param is not an object or an array.'); } IPCC.J.forEach(markReferences, function (si) { var Ny = si.markUid; si.markupLayer = K; if (K.jl[Ny]) { K.jl[Ny] = K.jl[Ny].concat(si); } else { K.jl[Ny] = [si]; } }); } var rh = {}; PCCViewer.EventEmitter.extend(rh); rh.Ox = function (Gq, dm) { var K = this; return setTimeout(function () { K.trigger(Gq, dm); }, 0); }; PCCViewer.EventEmitter.extend(this); this.dc = new IPCC.Web.UI.Data(); PCCViewer.Data.extend(this); this.Fk = new IPCC.Web.UI.Data(); PCCViewer.SessionData.extend(this); setTimeout(function () { K.trigger(PCCViewer.MarkupLayer.EventType.MarkupLayerCreated, {}); }, 0); }; PCCViewer.MarkupLayer.EventType = { MarkupLayerCreated: "MarkupLayerCreated", MarkupLayerDestroyed: "MarkupLayerDestroyed", MarksAddedToLayer: "MarksAddedToLayer", MarksRemovedFromLayer: "MarksRemovedFromLayer", MarkupLayerInteractionModeChanged: "MarkupLayerInteractionModeChanged", MarkupLayerHidden: "MarkupLayerHidden", MarkupLayerShown: "MarkupLayerShown" }; PCCViewer.MarkupLayer.prototype.getViewerControl = function () { return this.cL; }; PCCViewer.MarkupLayer.prototype.addMarks = function (marks) { var K = this, aqN = function (cC) { cC.iR = K; }; switch (Object.prototype.toString.call(marks)) { case "[object Object]": marks = [marks]; break; case "[object Array]": break; default: throw new Error('`marks` param is not an object or an array.'); } for (var G = 0; G < marks.length; G++) { if (!(marks[G] instanceof PCCViewer.Mark)) { throw new Error('`marks` param contains an item that is not an instanceof `PCCViewer.Mark`'); } if (this.hasMark(marks[G].getId())) { marks.splice(G, 1); continue; } IPCC.J.forEach(marks[G].getConversation().getComments(), aqN); } if (marks.length) { this.bN = this.bN.concat(marks); this.trigger(PCCViewer.MarkupLayer.EventType.MarksAddedToLayer, { marks: marks }); } return this; }; PCCViewer.MarkupLayer.prototype.removeMarks = function (marks) { switch (Object.prototype.toString.call(marks)) { case "[object Object]": marks = [marks]; break; case "[object Array]": break; default: throw new Error('`marks` param is not an object or an array.'); } for (var G = 0; G < this.bN.length; G++) { for (var aj = 0; aj < marks.length; aj++) { if (this.bN[G].getUid() === marks[aj].getUid()) { this.bN.splice(G, 1); this.trigger(PCCViewer.MarkupLayer.EventType.MarksRemovedFromLayer, { marks: [marks[aj]] }); break; } } } }; PCCViewer.MarkupLayer.prototype.getMarks = function () { var amL = []; IPCC.J.forEach(this.bN, function (R) { amL.push(R); }); return amL; }; PCCViewer.MarkupLayer.prototype.hasMark = function (markId) { if (typeof markId !== 'string') { throw new Error('`markId` param is not a string.'); } var G = 0, ahg = false, R; for (G; G < this.bN.length; G++) { R = this.bN[G]; if (R.getId() === markId) { ahg = true; break; } } return ahg; }; PCCViewer.MarkupLayer.prototype.getMarkReferences = function () { var jl = []; for (var pf in this.jl) { if (this.jl.hasOwnProperty(pf)) { jl = jl.concat(this.jl[pf]); } } return jl; }; PCCViewer.MarkupLayer.prototype.hide = function () { var cL = this.cL; cL.hideMarks(this.getMarks()); this.trigger(PCCViewer.MarkupLayer.EventType.MarkupLayerHidden, {}); return this; }; PCCViewer.MarkupLayer.prototype.show = function () { var cL = this.cL; cL.showMarks(this.getMarks()); this.trigger(PCCViewer.MarkupLayer.EventType.MarkupLayerShown, {}); return this; }; PCCViewer.MarkupLayer.prototype.copyLayers = function (markupLayers) { var cL = this.cL, K = this; if (markupLayers instanceof PCCViewer.MarkupLayer) { markupLayers = [markupLayers]; } if (markupLayers instanceof Array === false) { throw new PCCViewer.Error("InvalidArgument", "The parameter, markupLayers, is not an Array of MarkupLayers or a single MarkupLayer."); } var bN = []; IPCC.J.forEach(markupLayers, function (iR) { cL.getMarkupLayerCollection().getItem(iR.getId()); bN = bN.concat(iR.getMarks()); }); var copiedMarks = cL.copyMarks(bN); this.addMarks(copiedMarks); IPCC.J.forEach(this.bN, function (R) { IPCC.J.forEach(R.getConversation().getComments(), function (cC) { cC.iR = K; }); }); return this; }; PCCViewer.MarkupLayer.prototype.getId = function () { return this.fg; }; PCCViewer.MarkupLayer.prototype.getName = function () { return this.dC; }; PCCViewer.MarkupLayer.prototype.setName = function (name) { if (typeof name !== 'string') { throw new Error('`name` param is not a string.'); } this.dC = name; return this; }; PCCViewer.MarkupLayer.prototype.getRecordId = function () { return this.Wp; }; PCCViewer.MarkupLayer.prototype.destroy = function () { this.cL.getMarkupLayerCollection().removeItem(this.fg); this.trigger(PCCViewer.MarkupLayer.EventType.MarkupLayerDestroyed, {}); }; PCCViewer.MarkupLayer.prototype.setInteractionMode = function (interactionMode) { if (typeof interactionMode !== 'string') { throw new Error('`interactionMode` param is not a string.'); } this.qi = interactionMode; IPCC.J.forEach(this.bN, function (R) { R.setInteractionMode(interactionMode); }); this.trigger(PCCViewer.MarkupLayer.EventType.MarkupLayerInteractionModeChanged, { interactionMode: interactionMode }); return this; }; PCCViewer.MarkupLayer.prototype.getOriginalXmlName = function () { return this.apc; }; PCCViewer.MarkupLayer.prototype.setOriginalXmlName = function (name) { if (typeof name !== 'string') { throw new Error('`name` param is not a string.'); } this.apc = name; return this; }; if (Object.defineProperties) { Object.defineProperties(PCCViewer.MarkupLayer.prototype, { "id": { enumerable: true, get: function () { return this.getId(); } }, "recordId": { enumerable: true, get: function () { return this.getRecordId(); } }, "name": { enumerable: true, get: function () { return this.getName(); }, set: function (name) { return this.setName(name); } }, "viewerControl": { enumerable: true, get: function () { return this.getViewerControl(); } }, "originalXmlName": { enumerable: true, get: function () { return this.getOriginalXmlName(); }, set: function (name) { return this.setOriginalXmlName(name); } }, }); } })(PCCViewer || {}); (function (PCCViewer) { PCCViewer.MarkupLayerCollection = function (viewerControl) { if (!viewerControl) { throw new Error('`viewerControl` param is missing.'); } this.cL = viewerControl; this.uj = {}; this.bN = {}; this.iX = {}; this.pg = 0; PCCViewer.EventEmitter.extend(this); }; PCCViewer.MarkupLayerCollection.EventType = { MarkupLayerAdded: "MarkupLayerAdded", MarkupLayerRemoved: "MarkupLayerRemoved" }; PCCViewer.MarkupLayerCollection.prototype.getViewerControl = function () { return this.cL; }; PCCViewer.MarkupLayerCollection.prototype.forEach = function (iterator, thisArg) { if (typeof iterator !== 'function') { throw new TypeError('The iterator parameter is not a function'); } IPCC.J.forEach(this.uj, iterator, thisArg); return this; }; PCCViewer.MarkupLayerCollection.prototype.getItem = function (layerId) { if (typeof layerId !== 'string') { throw new Error('`layerId` param is not a string.'); } return this.uj[layerId]; }; PCCViewer.MarkupLayerCollection.prototype.getCount = function () { return this.pg; }; PCCViewer.MarkupLayerCollection.prototype.getAll = function () { var aqq = [], adK; for (adK in this.uj) { if (this.uj.hasOwnProperty(adK)) { aqq.push(this.uj[adK]); } } return aqq; }; PCCViewer.MarkupLayerCollection.prototype.addItem = function (layer) { var K = this, jl, acx = layer.jl, Ju = function (R, si) { var cC = R.getConversation().addComment(si.text); cC.creationTime = new Date(si.creationDateTime); cC.iR = si.markupLayer; for (var wa in si.data) { if (si.data.hasOwnProperty(wa)) { cC.setData(wa, si.data[wa]); } } }, aEs = function (aFt) { Ju(K.bN[xZ], aFt); }, apS = function (R) { var pf = R.getUid(); K.bN[R.getUid()] = R; if (K.iX[pf]) { IPCC.J.forEach(K.iX[pf], function (pS) { Ju(R, pS); }); delete K.iX[pf]; } }; if (!(layer instanceof PCCViewer.MarkupLayer)) { throw new Error('`layer` param is not an instance of PCCViewer.MarkupLayer.'); } this.uj[layer.getId()] = layer; for (var xZ in acx) { if (acx.hasOwnProperty(xZ)) { jl = acx[xZ]; if (K.bN[xZ]) { IPCC.J.forEach(jl, aEs); } else if (K.iX[xZ]) { K.iX[xZ] = K.iX[xZ].concat(jl); } else { K.iX[xZ] = jl; } } } IPCC.J.forEach(layer.getMarks(), function (R) { apS(R); }); this.pg++; this.trigger(PCCViewer.MarkupLayerCollection.EventType.MarkupLayerAdded, { layerId: layer.getId() }); layer.on(PCCViewer.MarkupLayer.EventType.MarksAddedToLayer, function (ev) { IPCC.J.forEach(ev.marks, function (R) { apS(R); }); }); layer.on(PCCViewer.MarkupLayer.EventType.MarksRemovedFromLayer, function (ev) { var aDi = ev.cD; IPCC.J.forEach(ev.marks, function (R) { var pf = R.getUid(); IPCC.J.forEach(K.bN[pf].getConversation().getComments(), function (JG) { if (aDi.id !== JG.iR.id) { var pS = { creationDateTime: IPCC.J.zO(JG.creationTime), data: JG.dc.yF(), markUid: R.getUid(), markupLayer: JG.iR, text: JG.text }; if (K.iX[pf]) { K.iX[pf] = K.iX[pf].concat([pS]); } else { K.iX[pf] = [pS]; } } }); K.vA(R); }); }); return this; }; PCCViewer.MarkupLayerCollection.prototype.vA = function (R) { var Ph; IPCC.J.forEach(this.uj, function (gI) { var amB = gI.hasMark(R.getId()); Ph = (typeof Ph !== 'undefined') ? +amB ^ Ph : +amB; }); if (Ph === 0) { delete this.bN[R.getUid()]; } }; PCCViewer.MarkupLayerCollection.prototype.removeItem = function (layerId) { var gI = this.uj[layerId], K = this, aEg = function (pS, ak) { if (pS.markupLayer.getId() === layerId) { K.iX[fg].splice(ak); } }; if (typeof layerId !== 'string') { throw new Error('`layerId` param is not a string.'); } IPCC.J.forEach(this.bN, function (R) { var hd = R.getConversation().getComments(); var Pn = gI.hasMark(R.getId()); IPCC.J.forEach(hd, function (cC) { if (Pn && cC.iR.getId() !== layerId) { var adX = { "markUid": R.getUid(), "markupLayer": cC.iR, "text": cC.getText(), "data": cC.dc.dc, "creationDateTime": IPCC.J.zO(cC.getCreationTime()) }; if (K.iX[R.getUid()]) { K.iX[R.getUid()].push(adX); } else { K.iX[R.getUid()] = [adX]; } R.getConversation().deleteComments(cC); } else if (Pn && cC.iR.getId() === layerId) { R.getConversation().deleteComments(cC); } else if (!Pn && cC.iR.getId() === layerId) { R.getConversation().deleteComments(cC); } }); if (Pn && K.bN[R.getUid()]) { K.vA(R); } }); for (var fg in this.iX) { if (this.iX.hasOwnProperty(fg)) { IPCC.J.forEach(this.iX[fg], aEg); } } delete this.uj[layerId]; this.pg--; this.trigger(PCCViewer.MarkupLayerCollection.EventType.MarkupLayerRemoved, { layerId: layerId }); return this; }; PCCViewer.MarkupLayerCollection.prototype.removeAll = function () { this.uj = {}; this.pg = 0; return this; }; if (Object.defineProperties) { Object.defineProperties(PCCViewer.MarkupLayerCollection.prototype, { "viewerControl": { enumerable: true, get: function () { return this.getViewerControl(); } }, "count": { enumerable: true, get: function () { return this.getCount(); } } }); } })(PCCViewer || {}); (function (PCCViewer) { PCCViewer.PasswordProtectedDocumentLoader = function PasswordProtectedDocumentLoader(WW) { this.WW = WW; }; PCCViewer.PasswordProtectedDocumentLoader.prototype.load = function (password) { return this.WW(password); }; })(PCCViewer || {}); (function e(t, n, r) { function s(o, u) { if (!n[o]) { if (!t[o]) { var a = typeof require == "function" && require; if (!u && a) return a(o, !0); if (i) return i(o, !0); var f = new Error("Cannot find module '" + o + "'"); throw f.code = "MODULE_NOT_FOUND", f } var l = n[o] = { exports: {} }; t[o][0].call(l.exports, function (e) { var n = t[o][1][e]; return s(n ? n : e) }, l, l.exports, e, t, n, r) } return n[o].exports } var i = typeof require == "function" && require; for (var o = 0; o < r.length; o++) s(r[o]); return s })({ 1: [function (require, module, exports) { var BL = require('prizmdoc-search'); var acJ = require('prizmdoc-input-mask'); PCCViewer.BL = BL; PCCViewer.acJ = acJ; }, { "prizmdoc-input-mask": 2, "prizmdoc-search": 7 }], 2: [function (require, module, exports) { var cursor = require('./util/cursor.js'); var mask = require('./util/mask.js'); function InputMask(elem, options) { var originalPlaceholder = elem.placeholder; var regexMask = mask.getRegex(options.value, options.translations); function onInput() { var cursorPos = cursor.get(elem); var oldVal = elem.value; var newVal = mask.getValue(oldVal, options.value, options.translations, cursorPos); elem.value = newVal.val; setTimeout(function () { cursor.set(elem, cursorPos + newVal.cursorAdjustment); }, 1); }; function clearInvalidValue() { elem.value = mask.fill(elem.value, options.value, options.translations); if (!regexMask.test(elem.value)) { elem.value = ''; } } (function init() { clearInvalidValue(); elem.placeholder = mask.getPlaceholder(options.value, options.translations); elem.addEventListener('input', onInput); elem.addEventListener('focusout', clearInvalidValue); elem.addEventListener('blur', clearInvalidValue); }()); this.destroy = function () { clearInvalidValue(); elem.placeholder = originalPlaceholder; elem.removeEventListener('input', onInput); elem.removeEventListener('focusout', clearInvalidValue); elem.removeEventListener('blur', clearInvalidValue); }; }; module.exports = InputMask; }, { "./util/cursor.js": 3, "./util/mask.js": 4 }], 3: [function (require, module, exports) { function getCursor(elem) { var position = 0; if (elem.selectionEnd) { position = elem.selectionEnd; } return Number(position); }; function setCursor(elem, position) { elem.setSelectionRange(position, position); }; module.exports = { get: getCursor, set: setCursor }; }, {}], 4: [function (require, module, exports) { var reRegExpChar = /[\\^$.*+?()[\]{}|]/g; var reHasRegExpChar = new RegExp(reRegExpChar.source); function getMaskRegex(mask, translations) { var maskRegex = ''; var char, translation, i; for (i = 0; i < mask.length; i++) { char = mask.charAt(i); translation = translations[char]; if (translation) { maskRegex += translation.toString().replace(/.{1}$|^.{1}/g, ''); } else if (reHasRegExpChar.test(char)) { maskRegex += char.replace(reRegExpChar, '\\$&'); } else { maskRegex += char; } } return new RegExp(maskRegex); }; function getMaskPlaceholder(mask, translations) { var placeholder = mask; var key; for (key in translations) { if (translations.hasOwnProperty(key)) { if (reHasRegExpChar.test(key)) { key = key.replace(reRegExpChar, '\\$&'); } placeholder = placeholder.replace(new RegExp(key, 'g'), '_'); } } return placeholder; }; function getMaskValue(value, mask, translations, cursorPos) { var result = { val: '', cursorAdjustment: 0 }; var m = 0; var v = 0; var lastUntranslatedMaskChar, maskChar, valChar, translation; while (m < mask.length && v < value.length) { maskChar = mask.charAt(m); valChar = value.charAt(v); translation = translations[maskChar]; if (translation) { if (valChar.match(translation)) { result.val += valChar; m += 1; } else if (v < cursorPos) { result.cursorAdjustment -= 1; } else if (valChar === lastUntranslatedMaskChar) { lastUntranslatedMaskChar = null; } v += 1; } else { result.val += maskChar; if (valChar === maskChar) { v += 1; } else { if (v < cursorPos) { result.cursorAdjustment += 1; } lastUntranslatedMaskChar = maskChar; } m += 1; } } return result; }; function fillMask(value, mask, translations) { var newVal = value; var index = value.length; var maskChar; while (index < mask.length) { maskChar = mask[index]; if (translations[maskChar]) { break; } newVal += maskChar; index += 1; } return newVal; }; module.exports = { getRegex: getMaskRegex, getPlaceholder: getMaskPlaceholder, getValue: getMaskValue, fill: fillMask }; }, {}], 5: [function (require, module, exports) { var util = require('./util.js'); var regexSearch = require('./regex-search.js'); var proximitySearch = require('./proximity-search.js'); function isSimpleSearchInput(input) { return (typeof input.pattern === 'string' && (typeof input.caseSensitive === 'boolean' || typeof input.caseSensitive === 'undefined')); }; function isProximitySearchInput(input) { if (!util.isPositiveInteger(input.distance) || !(input.subTerms instanceof Array)) { return false; } return util.every(input.subTerms, isSimpleSearchInput); }; function isSearchInput(input) { if (util.isPlainObject(input) && typeof input.type === 'string') { if (input.type === 'simple') { return isSimpleSearchInput(input); } if (input.type === 'proximity') { return isProximitySearchInput(input); } } return false; }; function isArrayOfSearchInputs(input) { if (!(input instanceof Array)) { return false; } return util.every(input, isSearchInput); }; function getRegExp(searchInput) { return (new RegExp(searchInput.pattern, searchInput.caseSensitive ? 'g' : 'gi')); }; function cleanSearchResult(searchInput) { return function (val) { return { input: searchInput, text: val.text, startIndex: val.startIndex }; }; }; function getRegexResults(text, searchInput) { var regex = getRegExp(searchInput); var results = regexSearch.getResultsForTerm(text, regex); return results.map(cleanSearchResult(searchInput)); }; function getProximityResults(text, searchInput) { var regexes = searchInput.subTerms.map(getRegExp); var results = proximitySearch.getResults(text, regexes, searchInput.distance); return results.map(cleanSearchResult(searchInput)); }; function getResults(text, searchInputs) { if (typeof text !== 'string') { throw util.inputError('text', 'string'); } if (!isArrayOfSearchInputs(searchInputs)) { throw util.inputError('searchInputs', 'array of search inputs'); } var combinedResults = []; searchInputs.forEach(function (term, i) { if (term.type === 'simple') { combinedResults = combinedResults.concat(getRegexResults(text, term)); } else if (term.type === 'proximity') { combinedResults = combinedResults.concat(getProximityResults(text, term)); } else { throw util.inputError('searchInputs[' + i + '].type', 'string equal to "simple" or "proximity"'); } }); util.sortResults(combinedResults); return combinedResults; }; module.exports = { getResults: getResults }; }, { "./proximity-search.js": 8, "./regex-search.js": 9, "./util.js": 10 }], 6: [function (require, module, exports) { var util = require('./util.js'); function validateGetContextOptions(options) { var rules = [{ property: 'options', validator: function () { return util.isPlainObject(options); }, error: 'object' }, { property: 'options.text', validator: function () { return (typeof options.text === 'string'); }, error: 'string' }, { property: 'options.startIndex', validator: function () { return util.isMinInteger(options.startIndex, 0); }, error: 'integer that is at least 0' }, { property: 'options.endIndex', validator: function () { return util.isMinInteger(options.endIndex, 0); }, error: 'integer that is at least 0' }, { property: 'options.padding', validator: function () { return util.isMinInteger(options.padding, 0); }, error: 'integer that is at least 0' }, { property: 'options.startIndex', validator: function () { return (options.startIndex < options.text.length); }, error: 'integer that is less than "options.text.length"' }, { property: 'options.endIndex', validator: function () { return (options.endIndex < options.text.length); }, error: 'integer that is less than "options.text.length"' }, { property: 'options.startIndex', validator: function () { return (options.startIndex <= options.endIndex); }, error: 'integer that is at most "options.endIndex"' }]; util.validateInput(rules); }; function validateRectangleOptions(options) { var rules = [{ property: 'options', validator: function () { return util.isPlainObject(options); }, error: 'object' }, { property: 'options.rectangles', validator: function () { return (options.rectangles instanceof Array); }, error: 'array' }, { property: 'options.startIndex', validator: function () { return util.isMinInteger(options.startIndex, 0); }, error: 'integer that is at least 0' }, { property: 'options.endIndex', validator: function () { return util.isMinInteger(options.endIndex, 0); }, error: 'integer that is at least 0' }, { property: 'options.startIndex', validator: function () { return util.isMaxInteger(options.startIndex, options.endIndex); }, error: 'integer that is at most "options.endIndex"' }]; util.validateInput(rules); }; function getContext(options) { validateGetContextOptions(options); var startIndex = Math.max(options.startIndex - options.padding, 0); var endIndex = Math.min(options.endIndex + options.padding, options.text.length - 1); return { startIndex: (startIndex === 0) ? options.startIndex : options.padding, context: options.text.substring(startIndex, endIndex + 1) }; }; function getBoundingRectangle(options) { validateRectangleOptions(options); var boundingRectangle = { left: Number.MAX_VALUE, right: 0, top: Number.MAX_VALUE, bottom: 0 }; var rectangle; for (var i = options.startIndex; i <= options.endIndex; i++) { rectangle = options.rectangles[i]; boundingRectangle.left = Math.min(rectangle[0], boundingRectangle.left); boundingRectangle.right = Math.max(rectangle[0] + rectangle[2], boundingRectangle.right); boundingRectangle.top = Math.min(rectangle[1], boundingRectangle.top); boundingRectangle.bottom = Math.max(rectangle[1] + rectangle[3], boundingRectangle.bottom); } return { x: boundingRectangle.left, y: boundingRectangle.top, width: boundingRectangle.right - boundingRectangle.left, height: boundingRectangle.bottom - boundingRectangle.top }; }; function getLineRectangles(options) { validateRectangleOptions(options); var lineRectangles = []; function processCharacter(rectangle) { var character = util.getRectangleObject(rectangle); var line = lineRectangles[lineRectangles.length - 1]; if (util.isCharacterAtEndOfLine(character, line)) { lineRectangles.splice(-1, 1, util.joinRectangles(line, character)); return; } lineRectangles.push(character); }; for (var i = options.startIndex; i <= options.endIndex; i++) { processCharacter(options.rectangles[i]); } return lineRectangles; }; module.exports = { getContext: getContext, getBoundingRectangle: getBoundingRectangle, getLineRectangles: getLineRectangles }; }, { "./util.js": 10 }], 7: [function (require, module, exports) { var formatter = require('./formatter.js'); var regexSearch = require('./regex-search.js'); var proximitySearch = require('./proximity-search.js'); var combinedSearch = require('./combined-search.js'); module.exports = { formatter: formatter, regex: regexSearch, proximity: proximitySearch, combined: combinedSearch }; }, { "./combined-search.js": 5, "./formatter.js": 6, "./proximity-search.js": 8, "./regex-search.js": 9 }], 8: [function (require, module, exports) { var regexSearch = require('./regex-search.js'); var util = require('./util.js'); function isAProximityResult(matching, searchTerms) { return (Object.keys(matching).length === searchTerms.length); }; function getStartIndex(wordIndex, searchResult) { var startIndex = -1; for (var i = 1; i < wordIndex.length; i++) { if (wordIndex[i] > searchResult.startIndex) { startIndex = i - 1; break; } } if (startIndex === -1 && searchResult.startIndex > wordIndex[wordIndex.length - 1]) { startIndex = wordIndex.length - 1; } return startIndex; }; function getEndIndex(wordIndex, searchResult, termsLength, distance) { var startIndex = getStartIndex(wordIndex, searchResult); var endIndex = null; if (distance === 0) { endIndex = startIndex + termsLength - 1; } else { endIndex = startIndex + ((termsLength - 1) * distance + termsLength) - 1; } return wordIndex[endIndex < wordIndex.length ? endIndex : wordIndex.length - 1]; }; function getWordIndex(text) { if (typeof text !== 'string') { throw util.inputError('text', 'string'); } var wordIndex = []; var regex = (/[^\s]+/gm); var regexResult; while ((regexResult = regex.exec(text)) !== null) { wordIndex.push(regexResult.index); } return wordIndex; }; function getResults(text, searchTerms, distance) { if (!util.isPositiveInteger(distance)) { throw util.inputError('distance', 'integer that is greater than 0'); } var wordIndex = getWordIndex(text); var searchResults = regexSearch.getResults(text, searchTerms); var proximityResults = []; searchResults.forEach(function (searchResult, i) { var opts = { nextIndex: -1, currentIndex: i, matches: {}, nextResult: null }; opts.endIndex = getEndIndex(wordIndex, searchResult, searchTerms.length, distance); opts.matches[searchResult.term] = true; while (opts.nextIndex < opts.endIndex && !isAProximityResult(opts.matches, searchTerms) && opts.currentIndex + 1 < searchResults.length) { opts.nextResult = searchResults[++opts.currentIndex]; opts.nextIndex = opts.nextResult.startIndex; if (opts.nextIndex <= opts.endIndex) { opts.matches[opts.nextResult.term] = true; } } if (isAProximityResult(opts.matches, searchTerms)) { proximityResults.push({ text: text.substring(searchResult.startIndex, opts.nextResult.startIndex + opts.nextResult.text.length), startIndex: searchResult.startIndex }); } }); return proximityResults; }; module.exports = { getWordIndex: getWordIndex, getResults: getResults }; }, { "./regex-search.js": 9, "./util.js": 10 }], 9: [function (require, module, exports) { var util = require('./util.js'); function isRegExp(input) { return (input instanceof RegExp); }; function isArrayOfRegExp(input) { if (!(input instanceof Array)) { return false; } return util.every(input, isRegExp); }; function validateGetResultsForTerm(text, searchTerm) { if (typeof text !== 'string') { throw util.inputError('text', 'string'); } if (!isRegExp(searchTerm)) { throw util.inputError('searchTerm', 'regular expression'); } }; function getResultsForTerm(text, searchTerm) { validateGetResultsForTerm(text, searchTerm); var searchResults = []; var regexResult; while ((regexResult = searchTerm.exec(text)) !== null) { if (regexResult[0]) { searchResults.push({ term: searchTerm.toString(), text: regexResult[0], startIndex: regexResult.index }); } else { searchTerm.lastIndex += 1; } } return searchResults; }; function getResults(text, searchTerms) { if (typeof text !== 'string') { throw util.inputError('text', 'string'); } if (!isArrayOfRegExp(searchTerms)) { throw util.inputError('searchTerms', 'array of regular expressions'); } var combinedResults = []; for (var i = 0; i < searchTerms.length; i++) { combinedResults = combinedResults.concat(getResultsForTerm(text, searchTerms[i])); } util.sortResults(combinedResults); return combinedResults; }; module.exports = { getResultsForTerm: getResultsForTerm, getResults: getResults }; }, { "./util.js": 10 }], 10: [function (require, module, exports) { function inputError(property, expected) { var a = (['a', 'e', 'i', 'o', 'u'].indexOf(expected.charAt(0)) > -1) ? 'an' : 'a'; return new Error('Invalid argument. Argument "' + property + '" must be ' + a + ' ' + expected + '.'); }; function isInteger(input) { return (typeof input === 'number' && Math.round(input) === input); }; function isMinInteger(input, min) { if (typeof min !== 'number') { throw inputError('min', 'number'); } return (isInteger(input) && input >= min); }; function isMaxInteger(input, max) { if (typeof max !== 'number') { throw inputError('max', 'number'); } return (isInteger(input) && input <= max); }; function isPositiveInteger(input) { return isMinInteger(input, 0); }; function isPlainObject(input) { return (typeof input === 'object' && input !== null && !(input instanceof Array) && input.constructor === Object); }; function validateInput(rules) { rules.forEach(function (rule) { if (!rule.validator()) { throw inputError(rule.property, rule.error); } }); return true; }; function every(obj, fn) { for (var key in obj) { if (obj.hasOwnProperty(key)) { if (!fn(obj[key], key)) { return false; } } } return true; }; function sortResults(results) { results.sort(function (a, b) { return a.startIndex - b.startIndex; }); }; function joinRectangles(rectA, rectB) { var left = Math.min(rectA.x, rectB.x); var top = Math.min(rectA.y, rectB.y); var right = Math.max(rectA.x + rectA.width, rectB.x + rectB.width); var bottom = Math.max(rectA.y + rectA.height, rectB.y + rectB.height); return { x: left, y: top, width: right - left, height: bottom - top }; }; function isCharacterAtEndOfLine(character, line) { if (line && Math.abs(character.y - line.y) < 1 && Math.abs(character.height - line.height) < 1 && (character.x + character.width) >= (line.x + line.width)) { return true; } return false; }; function getRectangleObject(rect) { return { x: rect[0], y: rect[1], width: rect[2], height: rect[3] }; }; module.exports = { inputError: inputError, isInteger: isInteger, isMinInteger: isMinInteger, isMaxInteger: isMaxInteger, isPositiveInteger: isPositiveInteger, isPlainObject: isPlainObject, validateInput: validateInput, every: every, sortResults: sortResults, joinRectangles: joinRectangles, isCharacterAtEndOfLine: isCharacterAtEndOfLine, getRectangleObject: getRectangleObject }; }, {}] }, {}, [1])